!function(){function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},a=n.parcelRequire3607;null==a&&(a=function(t){if(t in i)return i[t].exports;if(t in r){var e=r[t];delete r[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a},a.register=function(t,e){r[t]=e},n.parcelRequire3607=a),a.register("iE7OH",(function(e,n){var i,r;t(e.exports,"register",(function(){return i}),(function(t){return i=t})),t(e.exports,"resolve",(function(){return r}),(function(t){return r=t}));var a={};i=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)a[e[n]]=t[e[n]]},r=function(t){var e=a[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),a.register("aNJCr",(function(e,n){var i;t(e.exports,"getBundleURL",(function(){return i}),(function(t){return i=t}));var r={};function a(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}i=function(t){var e=r[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}(),r[t]=e),e}})),a("iE7OH").register(JSON.parse('{"7EiNB":"index.dbab0dfd.js","9VljA":"title.6a70130b.svg"}'));var o={};function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,u(t,e,"get"))}function h(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(t,e,n){h(t,e),e.set(t,n)}function v(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,u(t,e,"set"),n),n}function d(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function f(t,e){h(t,e),e.add(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t,e){return m(t,e)}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t,e,n){return(g=_()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&b(r,n.prototype),r}).apply(null,arguments)}function w(t,e,n){return g.apply(null,arguments)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t){return k(t)}function P(t,e){return!e||"object"!=((n=e)&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?s(t):e;var n}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var r=E(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return P(this,n)}}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V(t,e,n){return(V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n||t):r.value}})(t,e,n)}function L(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}function T(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function S(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||T(t)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t){return function(t){if(Array.isArray(t))return A(t)}(t)||T(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}
/*! Tweakpane 3.0.8 (c) 2016 cocopon, licensed under the MIT license. */!function(t){"use strict";var e=function(){function t(e){l(this,t);var n=R(e.split("-"),2),i=n[0],r=n[1],a=i.split(".");this.major=parseInt(a[0],10),this.minor=parseInt(a[1],10),this.patch=parseInt(a[2],10),this.prerelease=null!=r?r:null}return x(t,[{key:"toString",value:function(){var t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}]),t}(),n=function(){function t(e){l(this,t),this.controller_=e}return x(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"hidden",get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)}},{key:"dispose",value:function(){this.controller_.viewProps.set("disposed",!0)}}]),t}(),i=function t(e){l(this,t),this.target=e},r=function(t){L(n,t);var e=C(n);function n(t,i,r,a){var o;return l(this,n),(o=e.call(this,t)).value=i,o.presetKey=r,o.last=null==a||a,o}return n}(i),a=function(t){L(n,t);var e=C(n);function n(t,i,r){var a;return l(this,n),(a=e.call(this,t)).value=i,a.presetKey=r,a}return n}(i),o=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t)).expanded=i,r}return n}(i);function u(t){return t}function c(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var p={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '".concat(t.name,"'")},nomatchingcontroller:function(t){return"No matching controller for '".concat(t.key,"'")},nomatchingview:function(t){return"No matching view for '".concat(JSON.stringify(t.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '".concat(t.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},v=function(){function t(e){var n;l(this,t),this.message=null!==(n=p[e.type](u(e.context)))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return x(t,null,[{key:"alreadyDisposed",value:function(){return new t({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new t({type:"notbindable"})}},{key:"propertyNotFound",value:function(e){return new t({type:"propertynotfound",context:{name:e}})}},{key:"shouldNeverHappen",value:function(){return new t({type:"shouldneverhappen"})}}]),t}(),d=function(){function t(e,n,i){l(this,t),this.obj_=e,this.key_=n,this.presetKey_=null!=i?i:n}return x(t,[{key:"key",get:function(){return this.key_}},{key:"presetKey",get:function(){return this.presetKey_}},{key:"read",value:function(){return this.obj_[this.key_]}},{key:"write",value:function(t){this.obj_[this.key_]=t}},{key:"writeProperty",value:function(e,n){var i=this.read();if(!t.isBindable(i))throw v.notBindable();if(!(e in i))throw v.propertyNotFound(e);i[e]=n}}],[{key:"isBindable",value:function(t){return null!==t&&"object"==typeof t}}]),t}(),f=function(t){L(n,t);var e=C(n);function n(){return l(this,n),e.apply(this,arguments)}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.valueController.props.set("title",t)}},{key:"on",value:function(t,e){var n=this,r=e.bind(this);return this.controller_.valueController.emitter.on(t,(function(){r(new i(n))})),this}}]),n}(n),m=function(){function t(){l(this,t),this.observers_={}}return x(t,[{key:"on",value:function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}},{key:"off",value:function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this}},{key:"emit",value:function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))}}]),t}(),b="tp";function _(t){return function(e,n){return[b,"-",t,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")}}function g(t,e){return function(n){return e(t(n))}}function y(t){return t.rawValue}function k(t,e){t.emitter.on("change",g(y,e)),e(t.rawValue)}function P(t,e,n){k(t.value(e),n)}function T(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function A(t,e){return function(n){T(t,e,n)}}function S(t,e){k(t,(function(t){e.textContent=null!=t?t:""}))}var z=_("btn"),B=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(z()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("button");i.classList.add(z("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var r=e.createElement("div");r.classList.add(z("t")),S(n.props.value("title"),r),this.buttonElement.appendChild(r)},I=function(){function t(e,n){l(this,t),this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new B(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return x(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),U=function(){function t(e,n){var i;l(this,t),this.constraint_=null==n?void 0:n.constraint,this.equals_=null!==(i=null==n?void 0:n.equals)&&void 0!==i?i:function(t,e){return t===e},this.emitter=new m,this.rawValue_=e}return x(t,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}]),t}(),N=function(){function t(e){l(this,t),this.emitter=new m,this.value_=e}return x(t,[{key:"rawValue",get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}]),t}();function j(t,e){var n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new U(t,e):new N(t)}var F=function(){function t(e){var n=this,i=function(t){var e=n;n.valMap_[t].emitter.on("change",(function(){e.emitter.emit("change",{key:t,sender:e})}))};for(var r in l(this,t),this.emitter=new m,this.valMap_=e,this.valMap_)i(r)}return x(t,[{key:"get",value:function(t){return this.valMap_[t].rawValue}},{key:"set",value:function(t,e){this.valMap_[t].rawValue=e}},{key:"value",value:function(t){return this.valMap_[t]}}],[{key:"createCore",value:function(t){return Object.keys(t).reduce((function(e,n){return Object.assign(e,M({},n,j(t[n])))}),{})}},{key:"fromObject",value:function(e){return new t(this.createCore(e))}}]),t}();function O(t,e){return u(Object.keys(e).reduce((function(n,i){if(void 0!==n){var r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),M({},i,r.value)):void 0}}),{}))}function K(t,e){return t.reduce((function(t,n){if(void 0!==t){var i=e(n);if(i.succeeded&&void 0!==i.value)return D(t).concat([i.value])}}),[])}function q(t){return null!==t&&"object"==typeof t}function H(t){return function(e){return function(n){if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};var i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}}function G(t){return{custom:function(e){return H(e)(t)},boolean:H((function(t){return"boolean"==typeof t?t:void 0}))(t),number:H((function(t){return"number"==typeof t?t:void 0}))(t),string:H((function(t){return"string"==typeof t?t:void 0}))(t),function:H((function(t){return"function"==typeof t?t:void 0}))(t),constant:function(e){return H((function(t){return t===e?e:void 0}))(t)},raw:H((function(t){return t}))(t),object:function(e){return H((function(t){if(q(t))return O(t,e)}))(t)},array:function(e){return H((function(t){if(Array.isArray(t))return K(t,e)}))(t)}}}var W={optional:G(!0),required:G(!1)};function Y(t,e){var n=W.required.object(e)(t);return n.succeeded?n.value:void 0}function X(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function Z(){return["veryfirst","first","last","verylast"]}var $=_(""),Q={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},J=function(){function t(e){var n=this;l(this,t),this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var i=this.view.element;this.blade.value("positions").emitter.on("change",(function(){Z().forEach((function(t){i.classList.remove($(void 0,Q[t]))})),n.blade.get("positions").forEach((function(t){i.classList.add($(void 0,Q[t]))}))})),this.viewProps.handleDispose((function(){X(i)}))}return x(t,[{key:"parent",get:function(){return this.parent_}}]),t}(),tt="http://www.w3.org/2000/svg";function et(t){t.offsetHeight}function nt(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function it(t){return void 0!==t.ontouchstart}function rt(){return new Function("return this")()}function at(){return u(rt()).document}function ot(t){var e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}var st={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function lt(t,e){var n=t.createElementNS(tt,"svg");return n.innerHTML=st[e],n}function ut(t,e,n){t.insertBefore(e,t.children[n])}function ct(t){t.parentElement&&t.parentElement.removeChild(t)}function ht(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function pt(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function vt(t){return t.relatedTarget?u(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}var dt=_("lbl");function ft(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,i){i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var mt=function t(e,n){var i=this;l(this,t),this.element=e.createElement("div"),this.element.classList.add(dt()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(dt("l")),P(n.props,"label",(function(t){c(t)?i.element.classList.add(dt(void 0,"nol")):(i.element.classList.remove(dt(void 0,"nol")),pt(r),r.appendChild(ft(e,t)))})),this.element.appendChild(r),this.labelElement=r;var a=e.createElement("div");a.classList.add(dt("v")),this.element.appendChild(a),this.valueElement=a},bt=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{view:new mt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(J),_t={id:"button",type:"blade",accept:function(t){var e=W,n=Y(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new bt(t.document,{blade:t.blade,props:F.fromObject({label:t.params.label}),valueController:new I(t.document,{props:F.fromObject({title:t.params.title}),viewProps:t.viewProps})})},api:function(t){return t.controller instanceof bt&&t.controller.valueController instanceof I?new f(t.controller):null}},gt=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).value=t.value,i}return n}(J);function wt(){return new F({positions:j([],{equals:h})})}var yt=function(t){L(n,t);var e=C(n);function n(t){return l(this,n),e.call(this,t)}return x(n,[{key:"styleExpanded",get:function(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(t)?"".concat(t,"px"):"auto"}},{key:"bindExpandedClass",value:function(t,e){var n=this,i=function(){n.styleExpanded?t.classList.add(e):t.classList.remove(e)};P(this,"expanded",i),P(this,"temporaryExpanded",i)}},{key:"cleanUpTransition",value:function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}],[{key:"create",value:function(t){var e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(F.createCore(e))}}]),n}(F);function xt(t,e){var n=0;return nt(e,(function(){t.set("expandedHeight",null),t.set("temporaryExpanded",!0),et(e),n=e.clientHeight,t.set("temporaryExpanded",null),et(e)})),n}function kt(t,e){e.style.height=t.styleHeight}function Et(t,e){t.value("expanded").emitter.on("beforechange",(function(){t.set("completed",!1),c(t.get("expandedHeight"))&&t.set("expandedHeight",xt(t,e)),t.set("shouldFixHeight",!0),et(e)})),t.emitter.on("change",(function(){kt(t,e)})),kt(t,e),e.addEventListener("transitionend",(function(e){"height"===e.propertyName&&t.cleanUpTransition()}))}var Pt=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t)).rackApi_=i,r}return n}(n);function Ct(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Mt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Vt(t,e){var n=e||{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function Lt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}var Tt=function(){function t(e){l(this,t),this.emitter=new m,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return x(t,[{key:"items",get:function(){return this.items_}},{key:"allItems",value:function(){return Array.from(this.cache_)}},{key:"find",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,a=this.allItems()[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value;if(t(o))return o}}catch(t){n=!0,i=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"includes",value:function(t){return this.cache_.has(t)}},{key:"add",value:function(t,e){if(this.includes(t))throw v.shouldNeverHappen();var n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);var i=this.extract_(t);if(i){var r=this;i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((function(t){r.cache_.add(t)}))}this.emitter.emit("add",{index:n,item:t,root:this,target:this})}},{key:"remove",value:function(t){var e=this.items_.indexOf(t);if(!(e<0)){this.items_.splice(e,1),this.cache_.delete(t);var n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}}},{key:"onSubListAdd_",value:function(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}},{key:"onSubListRemove_",value:function(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}]),t}(),At=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).onBindingChange_=i.onBindingChange_.bind(s(i)),i.emitter_=new m,i.controller_.binding.emitter.on("change",i.onBindingChange_),i}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingChange_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("change",{event:new r(this,u(e),this.controller_.binding.target.presetKey,t.options.last)})}}]),n}(n),St=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t,i)).binding=i.binding,r}return n}(bt),Rt=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).onBindingUpdate_=i.onBindingUpdate_.bind(s(i)),i.emitter_=new m,i.controller_.binding.emitter.on("update",i.onBindingUpdate_),i}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingUpdate_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("update",{event:new a(this,u(e),this.controller_.binding.target.presetKey)})}}]),n}(n),Dt=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t,i)).binding=i.binding,r.viewProps.bindDisabled(r.binding.ticker),r.viewProps.handleDispose((function(){r.binding.dispose()})),r}return n}(bt);function zt(t){return t instanceof Ut?t.apiSet_:t instanceof Pt?t.rackApi_.apiSet_:null}function Bt(t,e){var n=t.find((function(t){return t.controller_===e}));if(!n)throw v.shouldNeverHappen();return n}function It(t,e,n){if(!d.isBindable(t))throw v.notBindable();return new d(t,e,n)}var Ut=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n),(r=e.call(this,t)).onRackAdd_=r.onRackAdd_.bind(s(r)),r.onRackRemove_=r.onRackRemove_.bind(s(r)),r.onRackInputChange_=r.onRackInputChange_.bind(s(r)),r.onRackMonitorUpdate_=r.onRackMonitorUpdate_.bind(s(r)),r.emitter_=new m,r.apiSet_=new Tt(zt),r.pool_=i;var a=r.controller_.rack;return a.emitter.on("add",r.onRackAdd_),a.emitter.on("remove",r.onRackRemove_),a.emitter.on("inputchange",r.onRackInputChange_),a.emitter.on("monitorupdate",r.onRackMonitorUpdate_),a.children.forEach((function(t){r.setUpApi_(t)})),r}return x(n,[{key:"children",get:function(){var t=this;return this.controller_.rack.children.map((function(e){return Bt(t.apiSet_,e)}))}},{key:"addInput",value:function(t,e,n){var i=n||{},r=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(r,It(t,e,i.presetKey),i),o=new At(a);return this.add(o,i.index)}},{key:"addMonitor",value:function(t,e,n){var i=n||{},r=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(r,It(t,e),i),o=new Rt(a);return u(this.add(o,i.index))}},{key:"addFolder",value:function(t){return Mt(this,t)}},{key:"addButton",value:function(t){return Ct(this,t)}},{key:"addSeparator",value:function(t){return Vt(this,t)}},{key:"addTab",value:function(t){return Lt(this,t)}},{key:"add",value:function(t,e){this.controller_.rack.add(t.controller_,e);var n=this.apiSet_.find((function(e){return e.controller_===t.controller_}));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}},{key:"remove",value:function(t){this.controller_.rack.remove(t.controller_)}},{key:"addBlade",value:function(t){var e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpApi_",value:function(t){this.apiSet_.find((function(e){return e.controller_===t}))||this.apiSet_.add(this.pool_.createBladeApi(t))}},{key:"onRackAdd_",value:function(t){this.setUpApi_(t.bladeController)}},{key:"onRackRemove_",value:function(t){if(t.isRoot){var e=Bt(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}},{key:"onRackInputChange_",value:function(t){var e=t.bladeController;if(e instanceof St){var n=Bt(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new r(n,u(i.target.read()),i.target.presetKey,t.options.last)})}else if(e instanceof gt){var a=Bt(this.apiSet_,e);this.emitter_.emit("change",{event:new r(a,e.value.rawValue,void 0,t.options.last)})}}},{key:"onRackMonitorUpdate_",value:function(t){if(!(t.bladeController instanceof Dt))throw v.shouldNeverHappen();var e=Bt(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new a(e,u(n.target.read()),n.target.presetKey)})}}]),n}(n),Nt=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t,new Ut(t.rackController,i))).emitter_=new m,r.controller_.foldable.value("expanded").emitter.on("change",(function(t){r.emitter_.emit("fold",{event:new o(s(r),t.sender.rawValue)})})),r.rackApi_.on("change",(function(t){r.emitter_.emit("change",{event:t})})),r.rackApi_.on("update",(function(t){r.emitter_.emit("update",{event:t})})),r}return x(n,[{key:"expanded",get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)}},{key:"title",get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){return this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(Pt),jt=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})).rackController=t.rackController,i}return n}(J),Ft=function t(e,n){l(this,t);var i=_(n.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),n.viewProps.bindClassModifiers(this.element)};function Ot(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof St&&i.binding===e)return i}return null}function Kt(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof Dt&&i.binding===e)return i}return null}function qt(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof gt&&i.value===e)return i}return null}function Ht(t){return t instanceof Yt?t.rack:t instanceof jt?t.rackController.rack:null}function Gt(t){var e=Ht(t);return e?e.bcSet_:null}var Wt=function(){function t(e){var n;l(this,t),this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new m,this.blade_=null!=e?e:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new Tt(Gt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return x(t,[{key:"children",get:function(){return this.bcSet_.items}},{key:"add",value:function(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}},{key:"remove",value:function(t){t.parent_=null,this.bcSet_.remove(t)}},{key:"find",value:function(t){return u(this.bcSet_.allItems().filter((function(e){return e instanceof t})))}},{key:"onSetAdd_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),e){var n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof St)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Dt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof gt)n.value.emitter.on("change",this.onChildValueChange_);else{var i=Ht(n);if(i){var r=i.emitter;r.on("layout",this.onDescendantLayout_),r.on("inputchange",this.onDescendantInputChange_),r.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"onSetRemove_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),e){var n=t.item;if(n instanceof St)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Dt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof gt)n.value.emitter.off("change",this.onChildValueChange_);else{var i=Ht(n);if(i){var r=i.emitter;r.off("layout",this.onDescendantLayout_),r.off("inputchange",this.onDescendantInputChange_),r.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"updatePositions_",value:function(){var t=this,e=this.bcSet_.items.filter((function(t){return!t.viewProps.get("hidden")})),n=e[0],i=e[e.length-1];this.bcSet_.items.forEach((function(e){var r=[];e===n&&(r.push("first"),t.blade_&&!t.blade_.get("positions").includes("veryfirst")||r.push("veryfirst")),e===i&&(r.push("last"),t.blade_&&!t.blade_.get("positions").includes("verylast")||r.push("verylast")),e.blade.set("positions",r)}))}},{key:"onChildPositionsChange_",value:function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildViewPropsChange_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildDispose_",value:function(){var t=this;this.bcSet_.items.filter((function(t){return t.viewProps.get("disposed")})).forEach((function(e){t.bcSet_.remove(e)}))}},{key:"onChildInputChange_",value:function(t){var e=Ot(this.find(St),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onChildMonitorUpdate_",value:function(t){var e=Kt(this.find(Dt),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}},{key:"onChildValueChange_",value:function(t){var e=qt(this.find(gt),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onDescendantLayout_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onDescendantInputChange_",value:function(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}},{key:"onDescendantMonitorUpdate_",value:function(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}},{key:"onBladePositionsChange_",value:function(){this.updatePositions_()}}]),t}(),Yt=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n),(r=e.call(this,Object.assign(Object.assign({},i),{view:new Ft(t,{viewName:"brk",viewProps:i.viewProps})}))).onRackAdd_=r.onRackAdd_.bind(s(r)),r.onRackRemove_=r.onRackRemove_.bind(s(r));var a=new Wt(i.root?void 0:i.blade);return a.emitter.on("add",r.onRackAdd_),a.emitter.on("remove",r.onRackRemove_),r.rack=a,r.viewProps.handleDispose((function(){for(var t=r.rack.children.length-1;t>=0;t--)r.rack.children[t].viewProps.set("disposed",!0)})),r}return x(n,[{key:"onRackAdd_",value:function(t){t.isRoot&&ut(this.view.element,t.bladeController.view.element,t.index)}},{key:"onRackRemove_",value:function(t){t.isRoot&&ct(t.bladeController.view.element)}}]),n}(J),Xt=_("cnt"),Zt=function t(e,n){var i=this;l(this,t),this.className_=_(n.viewName||"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Xt()),n.viewProps.bindClassModifiers(this.element),this.foldable_=n.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),P(this.foldable_,"completed",A(this.element,this.className_(void 0,"cpl")));var r=e.createElement("button");r.classList.add(this.className_("b")),P(n.props,"title",(function(t){c(t)?i.element.classList.add(i.className_(void 0,"not")):i.element.classList.remove(i.className_(void 0,"not"))})),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var a=e.createElement("div");a.classList.add(this.className_("t")),S(n.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;var o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);var s=n.containerElement;s.classList.add(this.className_("c")),this.element.appendChild(s),this.containerElement=s},$t=function(t){L(n,t);var e=C(n);function n(t,i){var r,a;l(this,n);var o=yt.create(null===(a=i.expanded)||void 0===a||a),u=new Yt(t,{blade:i.blade,root:i.root,viewProps:i.viewProps});return(r=e.call(this,Object.assign(Object.assign({},i),{rackController:u,view:new Zt(t,{containerElement:u.view.element,foldable:o,props:i.props,viewName:i.root?"rot":void 0,viewProps:i.viewProps})}))).onTitleClick_=r.onTitleClick_.bind(s(r)),r.props=i.props,r.foldable=o,Et(r.foldable,r.view.containerElement),r.rackController.rack.emitter.on("add",(function(){r.foldable.cleanUpTransition()})),r.rackController.rack.emitter.on("remove",(function(){r.foldable.cleanUpTransition()})),r.view.buttonElement.addEventListener("click",r.onTitleClick_),r}return x(n,[{key:"document",get:function(){return this.view.element.ownerDocument}},{key:"onTitleClick_",value:function(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}]),n}(jt),Qt={id:"folder",type:"blade",accept:function(t){var e=W,n=Y(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:function(t){return new $t(t.document,{blade:t.blade,expanded:t.params.expanded,props:F.fromObject({title:t.params.title}),viewProps:t.viewProps})},api:function(t){return t.controller instanceof $t?new Nt(t.controller,t.pool):null}},Jt=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{value:i.valueController.value,view:new mt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(gt),te=function(t){L(n,t);var e=C(n);function n(){return l(this,n),e.apply(this,arguments)}return n}(n),ee=_("spr"),ne=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(ee()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("hr");i.classList.add(ee("r")),this.element.appendChild(i)},ie=function(t){L(n,t);var e=C(n);function n(t,i){return l(this,n),e.call(this,Object.assign(Object.assign({},i),{view:new ne(t,{viewProps:i.viewProps})}))}return n}(J),re={id:"separator",type:"blade",accept:function(t){var e=Y(t,{view:W.required.constant("separator")});return e?{params:e}:null},controller:function(t){return new ie(t.document,{blade:t.blade,viewProps:t.viewProps})},api:function(t){return t.controller instanceof ie?new te(t.controller):null}},ae=_("");function oe(t,e){return A(t,ae(void 0,e))}var se=function(t){L(n,t);var e=C(n);function n(t){return l(this,n),e.call(this,t)}return x(n,[{key:"bindClassModifiers",value:function(t){P(this,"disabled",oe(t,"disabled")),P(this,"hidden",oe(t,"hidden"))}},{key:"bindDisabled",value:function(t){P(this,"disabled",(function(e){t.disabled=e}))}},{key:"bindTabIndex",value:function(t){P(this,"disabled",(function(e){t.tabIndex=e?-1:0}))}},{key:"handleDispose",value:function(t){this.value("disposed").emitter.on("change",(function(e){e&&t()}))}}],[{key:"create",value:function(t){var e,i,r=null!=t?t:{},a={disabled:null!==(e=r.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=r.hidden)&&void 0!==i&&i};return new n(F.createCore(a))}}]),n}(F),le=_("tbi"),ue=function t(e,n){var i=this;l(this,t),this.element=e.createElement("div"),this.element.classList.add(le()),n.viewProps.bindClassModifiers(this.element),P(n.props,"selected",(function(t){t?i.element.classList.add(le(void 0,"sel")):i.element.classList.remove(le(void 0,"sel"))}));var r=e.createElement("button");r.classList.add(le("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var a=e.createElement("div");a.classList.add(le("t")),S(n.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a},ce=function(){function t(e,n){l(this,t),this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new ue(e,{props:n.props,viewProps:n.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return x(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),he=function(){function t(e,n){var i=this;l(this,t),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ce(e,{props:n.itemProps,viewProps:se.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Yt(e,{blade:wt(),viewProps:se.create()}),this.props=n.props,P(this.props,"selected",(function(t){i.itemController.props.set("selected",t),i.contentController.viewProps.set("hidden",!t)}))}return x(t,[{key:"itemController",get:function(){return this.ic_}},{key:"contentController",get:function(){return this.cc_}},{key:"onItemClick_",value:function(){this.props.set("selected",!0)}}]),t}(),pe=function(){function t(e,n){l(this,t),this.controller_=e,this.rackApi_=n}return x(t,[{key:"title",get:function(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.itemController.props.set("title",t)}},{key:"selected",get:function(){return this.controller_.props.get("selected")},set:function(t){this.controller_.props.set("selected",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}}]),t}(),ve=function(t){L(n,t);var e=C(n);function n(t,i){var r;return l(this,n),(r=e.call(this,t,new Ut(t.rackController,i))).onPageAdd_=r.onPageAdd_.bind(s(r)),r.onPageRemove_=r.onPageRemove_.bind(s(r)),r.emitter_=new m,r.pageApiMap_=new Map,r.rackApi_.on("change",(function(t){r.emitter_.emit("change",{event:t})})),r.rackApi_.on("update",(function(t){r.emitter_.emit("update",{event:t})})),r.controller_.pageSet.emitter.on("add",r.onPageAdd_),r.controller_.pageSet.emitter.on("remove",r.onPageRemove_),r.controller_.pageSet.items.forEach((function(t){r.setUpPageApi_(t)})),r}return x(n,[{key:"pages",get:function(){var t=this;return this.controller_.pageSet.items.map((function(e){var n=t.pageApiMap_.get(e);if(!n)throw v.shouldNeverHappen();return n}))}},{key:"addPage",value:function(t){var e=this.controller_.view.element.ownerDocument,n=new he(e,{itemProps:F.fromObject({selected:!1,title:t.title}),props:F.fromObject({selected:!1})});this.controller_.add(n,t.index);var i=this.pageApiMap_.get(n);if(!i)throw v.shouldNeverHappen();return i}},{key:"removePage",value:function(t){this.controller_.remove(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpPageApi_",value:function(t){var e=this.rackApi_.apiSet_.find((function(e){return e.controller_===t.contentController}));if(!e)throw v.shouldNeverHappen();var n=new pe(t,e);this.pageApiMap_.set(t,n)}},{key:"onPageAdd_",value:function(t){this.setUpPageApi_(t.item)}},{key:"onPageRemove_",value:function(t){if(!this.pageApiMap_.get(t.item))throw v.shouldNeverHappen();this.pageApiMap_.delete(t.item)}}]),n}(Pt),de=_("tab"),fe=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(de(),Xt()),n.viewProps.bindClassModifiers(this.element),k(n.empty,A(this.element,de(void 0,"nop")));var i=e.createElement("div");i.classList.add(de("i")),this.element.appendChild(i),this.itemsElement=i;var r=n.contentsElement;r.classList.add(de("c")),this.element.appendChild(r),this.contentsElement=r},me=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n);var a=new Yt(t,{blade:i.blade,viewProps:i.viewProps}),o=j(!0);return(r=e.call(this,{blade:i.blade,rackController:a,view:new fe(t,{contentsElement:a.view.element,empty:o,viewProps:i.viewProps})})).onPageAdd_=r.onPageAdd_.bind(s(r)),r.onPageRemove_=r.onPageRemove_.bind(s(r)),r.onPageSelectedChange_=r.onPageSelectedChange_.bind(s(r)),r.pageSet_=new Tt((function(){return null})),r.pageSet_.emitter.on("add",r.onPageAdd_),r.pageSet_.emitter.on("remove",r.onPageRemove_),r.empty_=o,r.applyPages_(),r}return x(n,[{key:"pageSet",get:function(){return this.pageSet_}},{key:"add",value:function(t,e){this.pageSet_.add(t,null!=e?e:this.pageSet_.items.length)}},{key:"remove",value:function(t){this.pageSet_.remove(this.pageSet_.items[t])}},{key:"applyPages_",value:function(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}},{key:"onPageAdd_",value:function(t){var e=t.item;ut(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),e.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}},{key:"onPageRemove_",value:function(t){var e=t.item;ct(e.itemController.view.element),this.rackController.rack.remove(e.contentController),e.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}},{key:"keepSelection_",value:function(){if(0!==this.pageSet_.items.length){var t=this.pageSet_.items.findIndex((function(t){return t.props.get("selected")}));t<0?this.pageSet_.items.forEach((function(t,e){t.props.set("selected",0===e)})):this.pageSet_.items.forEach((function(e,n){e.props.set("selected",n===t)}))}}},{key:"onPageSelectedChange_",value:function(t){if(t.rawValue){var e=this.pageSet_.items.findIndex((function(e){return e.props.value("selected")===t.sender}));this.pageSet_.items.forEach((function(t,n){t.props.set("selected",n===e)}))}else this.keepSelection_()}}]),n}(jt),be={id:"tab",type:"blade",accept:function(t){var e=W,n=Y(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller:function(t){var e=new me(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((function(n){var i=new he(t.document,{itemProps:F.fromObject({selected:!1,title:n.title}),props:F.fromObject({selected:!1})});e.add(i)})),e},api:function(t){return t.controller instanceof me?new ve(t.controller,t.pool):null}};function _e(t,e){var n=t.accept(e.params);if(!n)return null;var i=W.optional.boolean(e.params.disabled).value,r=W.optional.boolean(e.params.hidden).value;return t.controller({blade:wt(),document:e.document,params:u(Object.assign(Object.assign({},n.params),{disabled:i,hidden:r})),viewProps:se.create({disabled:i,hidden:r})})}var ge=function(){function t(){l(this,t),this.disabled=!1,this.emitter=new m}return x(t,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),t}(),we=function(){function t(e,n){l(this,t),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new m,this.interval_=n,this.setTimer_()}return x(t,[{key:"disabled",get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),t}(),ye=function(){function t(e){l(this,t),this.constraints=e}return x(t,[{key:"constrain",value:function(t){return this.constraints.reduce((function(t,e){return e.constrain(t)}),t)}}]),t}();function xe(t,e){if(t instanceof e)return t;if(t instanceof ye){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var ke=function(){function t(e){l(this,t),this.options=e}return x(t,[{key:"constrain",value:function(t){var e=this.options;return 0===e.length||e.filter((function(e){return e.value===t})).length>0?t:e[0].value}}]),t}(),Ee=function(){function t(e){l(this,t),this.maxValue=e.max,this.minValue=e.min}return x(t,[{key:"constrain",value:function(t){var e=t;return c(this.minValue)||(e=Math.max(e,this.minValue)),c(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}]),t}(),Pe=function(){function t(e){l(this,t),this.step=e}return x(t,[{key:"constrain",value:function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}]),t}(),Ce=_("lst"),Me=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.element=e.createElement("div"),this.element.classList.add(Ce()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("select");i.classList.add(Ce("s")),P(this.props_,"options",(function(t){ht(i),t.forEach((function(t,n){var r=e.createElement("option");r.dataset.index=String(n),r.textContent=t.text,r.value=String(t.value),i.appendChild(r)}))})),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;var r=e.createElement("div");r.classList.add(Ce("m")),r.appendChild(lt(e,"dropdown")),this.element.appendChild(r),n.value.emitter.on("change",this.onValueChange_),this.value_=n.value,this.update_()}return x(t,[{key:"update_",value:function(){this.selectElement.value=String(this.value_.rawValue)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Ve=function(){function t(e,n){l(this,t),this.onSelectChange_=this.onSelectChange_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Me(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return x(t,[{key:"onSelectChange_",value:function(t){var e=u(t.currentTarget).selectedOptions.item(0);if(e){var n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}}}]),t}(),Le=_("pop"),Te=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(Le()),n.viewProps.bindClassModifiers(this.element),k(n.shows,A(this.element,Le(void 0,"v")))},Ae=function t(e,n){l(this,t),this.shows=j(!1),this.viewProps=n.viewProps,this.view=new Te(e,{shows:this.shows,viewProps:this.viewProps})},Se=_("txt"),Re=function(){function t(e,n){l(this,t),this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Se()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var i=e.createElement("input");i.classList.add(Se("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return x(t,[{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),De=function(){function t(e,n){l(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Re(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return x(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget).value,n=this.parser_(e);c(n)||(this.value.rawValue=n),this.view.refresh()}}]),t}();function ze(t){return String(t)}function Be(t){return"false"!==t&&!!t}function Ie(t){return ze(t)}var Ue=function(){function t(e){l(this,t),this.text=e}return x(t,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),t}(),Ne={"**":function(t,e){return Math.pow(t,e)},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<<":function(t,e){return t<<e},">>":function(t,e){return t>>e},">>>":function(t,e){return t>>>e},"&":function(t,e){return t&e},"^":function(t,e){return t^e},"|":function(t,e){return t|e}},je=function(){function t(e,n,i){l(this,t),this.left=n,this.operator=e,this.right=i}return x(t,[{key:"evaluate",value:function(){var t=Ne[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),t}(),Fe={"+":function(t){return t},"-":function(t){return-t},"~":function(t){return~t}},Oe=function(){function t(e,n){l(this,t),this.operator=e,this.expression=n}return x(t,[{key:"evaluate",value:function(){var t=Fe[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),t}();function Ke(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i](e,n);if(""!==r)return r}return""}}function qe(t,e){var n,i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function He(t,e){var n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Ge(t,e){var n,i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function We(t,e){var n=Ge(t,e);if(""!==n)return n;var i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";var r=Ge(t,e+=1);return""===r?"":i+r}function Ye(t,e){var n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";var i=We(t,e);return""===i?"":n+i}function Xe(t,e){var n=t.substr(e,1);if("0"===n)return n;var i=He(t,e);return e+=i.length,""===i?"":i+Ge(t,e)}function Ze(t,e){var n=Xe(t,e);if(e+=n.length,""===n)return"";var i=t.substr(e,1);if(e+=i.length,"."!==i)return"";var r=Ge(t,e);return n+i+r+Ye(t,e+=r.length)}function $e(t,e){var n=t.substr(e,1);if(e+=n.length,"."!==n)return"";var i=Ge(t,e);return e+=i.length,""===i?"":n+i+Ye(t,e)}function Qe(t,e){var n=Xe(t,e);return e+=n.length,""===n?"":n+Ye(t,e)}var Je=Ke([Ze,$e,Qe]);function tn(t,e){var n,i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function en(t,e){var n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";var i=tn(t,e);return""===i?"":n+i}function nn(t,e){var n,i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function rn(t,e){var n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";var i=nn(t,e);return""===i?"":n+i}function an(t,e){var n,i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function on(t,e){var n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";var i=an(t,e);return""===i?"":n+i}var sn=Ke([en,rn,on]),ln=Ke([sn,Je]);function un(t,e){var n=ln(t,e);return e+=n.length,""===n?null:{evaluable:new Ue(n),cursor:e}}function cn(t,e){var n=t.substr(e,1);if(e+=n.length,"("!==n)return null;var i=mn(t,e);if(!i)return null;e=i.cursor,e+=qe(t,e).length;var r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function hn(t,e){return un(t,e)||cn(t,e)}function pn(t,e){var n=hn(t,e);if(n)return n;var i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;var r=pn(t,e);return r?{cursor:e=r.cursor,evaluable:new Oe(i,r.evaluable)}:null}function vn(t,e,n){n+=qe(e,n).length;var i=t.filter((function(t){return e.startsWith(t,n)}))[0];return i?(n+=i.length,{cursor:n+=qe(e,n).length,operator:i}):null}function dn(t,e){return function(n,i){var r=t(n,i);if(!r)return null;i=r.cursor;for(var a=r.evaluable;;){var o=vn(e,n,i);if(!o)break;i=o.cursor;var s=t(n,i);if(!s)return null;i=s.cursor,a=new je(o.operator,a,s.evaluable)}return a?{cursor:i,evaluable:a}:null}}var fn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(t,e){return dn(t,e)}),pn);function mn(t,e){return e+=qe(t,e).length,fn(t,e)}function bn(t){var e=mn(t,0);return e?e.cursor+qe(t,e.cursor).length!==t.length?null:e.evaluable:null}function _n(t){var e,n=bn(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function gn(t){if("number"==typeof t)return t;if("string"==typeof t){var e=_n(t);if(!c(e))return e}return 0}function wn(t){return String(t)}function yn(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}var xn=yn(0);function kn(t){return xn(t)+"%"}function En(t){return String(t)}function Pn(t){return t}function Cn(t,e){for(;t.length<e;)t.push(void 0)}function Mn(t){var e=[];return Cn(e,t),j(e)}function Vn(t){var e=t.indexOf(void 0);return u(e<0?t:t.slice(0,e))}function Ln(t,e){var n=D(Vn(t)).concat([e]);return n.length>t.length?n.splice(0,n.length-t.length):Cn(n,t.length),n}function Tn(t){var e=t.primary,n=t.secondary,i=t.forward,r=t.backward,a=!1;function o(t){a||(a=!0,t(),a=!1)}e.emitter.on("change",(function(t){o((function(){n.setRawValue(i(e,n),t.options)}))})),n.emitter.on("change",(function(t){o((function(){e.setRawValue(r(e,n),t.options)})),o((function(){n.setRawValue(i(e,n),t.options)}))})),o((function(){n.setRawValue(i(e,n),{forceEmit:!1,last:!0})}))}function An(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Sn(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Rn(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Dn(t){return"ArrowUp"===t||"ArrowDown"===t}function zn(t){return Dn(t)||"ArrowLeft"===t||"ArrowRight"===t}function Bn(t,e){var n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}var In=function(){function t(e){l(this,t),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new m,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return x(t,[{key:"computePosition_",value:function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}},{key:"onMouseDown_",value:function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Bn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseMove_",value:function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Bn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseUp_",value:function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Bn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onTouchStart_",value:function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchMove_",value:function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchEnd_",value:function(t){var e,n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}]),t}();function Un(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function Nn(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function jn(t,e,n){return Math.min(Math.max(t,e),n)}function Fn(t,e){return(t%e+e)%e}var On=_("txt"),Kn=function(){function t(e,n){l(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(On(),On(void 0,"num")),n.arrayPosition&&this.element.classList.add(On(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(On("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(On()),this.inputElement.classList.add(On("i"));var r=e.createElement("div");r.classList.add(On("k")),this.element.appendChild(r),this.knobElement=r;var a=e.createElementNS(tt,"svg");a.classList.add(On("g")),this.knobElement.appendChild(a);var o=e.createElementNS(tt,"path");o.classList.add(On("gb")),a.appendChild(o),this.guideBodyElem_=o;var s=e.createElementNS(tt,"path");s.classList.add(On("gh")),a.appendChild(s),this.guideHeadElem_=s;var u=e.createElement("div");u.classList.add(_("tt")()),this.knobElement.appendChild(u),this.tooltipElem_=u,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return x(t,[{key:"onDraggingChange_",value:function(t){if(null!==t.rawValue){this.element.classList.add(On(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=jn(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+i,",0 L").concat(n,",4 L").concat(n+i,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")}else this.element.classList.remove(On(void 0,"drg"))}},{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),qn=function(){function t(e,n){l(this,t),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=j(null),this.view=new Kn(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new In(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return x(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget).value,n=this.parser_(e);c(n)||(this.value.rawValue=n),this.view.refresh()}},{key:"onInputKeyDown_",value:function(t){var e=An(this.baseStep_,Sn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(t){0!==An(this.baseStep_,Sn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}},{key:"onPointerMove_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),t}(),Hn=_("sld"),Gn=function(){function t(e,n){l(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Hn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(Hn("t")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;var r=e.createElement("div");r.classList.add(Hn("k")),this.trackElement.appendChild(r),this.knobElement=r,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.update_()}return x(t,[{key:"update_",value:function(){var t=jn(Un(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width="".concat(t,"%")}},{key:"onChange_",value:function(){this.update_()}}]),t}(),Wn=function(){function t(e,n){l(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.value=n.value,this.viewProps=n.viewProps,this.props=n.props,this.view=new Gn(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new In(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return x(t,[{key:"handlePointerEvent_",value:function(t,e){t.point&&this.value.setRawValue(Un(jn(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}},{key:"onPointerDownOrMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=An(this.baseStep_,Rn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){0!==An(this.baseStep_,Rn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),Yn=_("sldtxt"),Xn=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(Yn());var i=e.createElement("div");i.classList.add(Yn("s")),this.sliderView_=n.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Yn("t")),this.textView_=n.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)},Zn=function(){function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.sliderC_=new Wn(e,{baseStep:n.baseStep,props:n.sliderProps,value:n.value,viewProps:this.viewProps}),this.textC_=new qn(e,{baseStep:n.baseStep,parser:n.parser,props:n.textProps,value:n.value,viewProps:n.viewProps}),this.view=new Xn(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return x(t,[{key:"sliderController",get:function(){return this.sliderC_}},{key:"textController",get:function(){return this.textC_}}]),t}();function $n(t,e){t.write(e)}function Qn(t){var e=W;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Jn(t){if("inline"===t||"popup"===t)return t}function ti(t){var e=W;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function ei(t){if(Array.isArray(t))return t;var e=[];return Object.keys(t).forEach((function(n){e.push({text:n,value:t[n]})})),e}function ni(t){return c(t)?null:new ke(ei(u(t)))}function ii(t){var e=t?xe(t,ke):null;return e?e.options:null}function ri(t){var e=t?xe(t,Pe):null;return e?e.step:null}function ai(t,e){var n=t&&xe(t,Pe);return n?Nn(n.step):Math.max(Nn(e),2)}function oi(t){var e=ri(t);return null!=e?e:1}function si(t,e){var n,i=t&&xe(t,Pe),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}var li=_("ckb"),ui=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(li()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("label");i.classList.add(li("l")),this.element.appendChild(i);var r=e.createElement("input");r.classList.add(li("i")),r.type="checkbox",i.appendChild(r),this.inputElement=r,n.viewProps.bindDisabled(this.inputElement);var a=e.createElement("div");a.classList.add(li("w")),i.appendChild(a);var o=lt(e,"check");a.appendChild(o),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return x(t,[{key:"update_",value:function(){this.inputElement.checked=this.value.rawValue}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),ci=function(){function t(e,n){l(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new ui(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return x(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget);this.value.rawValue=e.checked}}]),t}();function hi(t){var e=[],n=ni(t.options);return n&&e.push(n),new ye(e)}var pi={id:"input-bool",type:"input",accept:function(t,e){if("boolean"!=typeof t)return null;var n=Y(e,{options:W.optional.custom(Qn)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Be},constraint:function(t){return hi(t.params)},writer:function(t){return $n}},controller:function(t){var e,n=t.document,i=t.value,r=t.constraint;return r&&xe(r,ke)?new Ve(n,{props:F.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new ci(n,{value:i,viewProps:t.viewProps})}},vi=_("col"),di=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(vi()),n.foldable.bindExpandedClass(this.element,vi(void 0,"expanded")),P(n.foldable,"completed",A(this.element,vi(void 0,"cpl")));var i=e.createElement("div");i.classList.add(vi("h")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(vi("s")),i.appendChild(r),this.swatchElement=r;var a=e.createElement("div");if(a.classList.add(vi("t")),i.appendChild(a),this.textElement=a,"inline"===n.pickerLayout){var o=e.createElement("div");o.classList.add(vi("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null};function fi(t,e,n){var i=jn(t/255,0,1),r=jn(e/255,0,1),a=jn(n/255,0,1),o=Math.max(i,r,a),s=Math.min(i,r,a),l=o-s,u=0,c=0,h=(s+o)/2;return 0!==l&&(c=l/(1-Math.abs(o+s-1)),u=(u=i===o?(r-a)/l:r===o?2+(a-i)/l:4+(i-r)/l)/6+(u<0?1:0)),[360*u,100*c,100*h]}function mi(t,e,n){var i,r,a,o,s,l,u,c,h,p=(t%360+360)%360,v=jn(e/100,0,1),d=jn(n/100,0,1),f=(1-Math.abs(2*d-1))*v,m=f*(1-Math.abs(p/60%2-1)),b=d-f/2;return p>=0&&p<60?(i=(o=[f,m,0])[0],r=o[1],a=o[2]):p>=60&&p<120?(i=(s=[m,f,0])[0],r=s[1],a=s[2]):p>=120&&p<180?(i=(l=[0,f,m])[0],r=l[1],a=l[2]):p>=180&&p<240?(i=(u=[0,m,f])[0],r=u[1],a=u[2]):p>=240&&p<300?(i=(c=[m,0,f])[0],r=c[1],a=c[2]):(i=(h=[f,0,m])[0],r=h[1],a=h[2]),[255*(i+b),255*(r+b),255*(a+b)]}function bi(t,e,n){var i=jn(t/255,0,1),r=jn(e/255,0,1),a=jn(n/255,0,1),o=Math.max(i,r,a),s=o-Math.min(i,r,a);return[0===s?0:o===i?((r-a)/s%6+6)%6*60:o===r?60*((a-i)/s+2):60*((i-r)/s+4),100*(0===o?0:s/o),100*o]}function _i(t,e,n){var i,r,a,o,s,l,u,c,h,p=Fn(t,360),v=jn(e/100,0,1),d=jn(n/100,0,1),f=d*v,m=f*(1-Math.abs(p/60%2-1)),b=d-f;return p>=0&&p<60?(i=(o=[f,m,0])[0],r=o[1],a=o[2]):p>=60&&p<120?(i=(s=[m,f,0])[0],r=s[1],a=s[2]):p>=120&&p<180?(i=(l=[0,f,m])[0],r=l[1],a=l[2]):p>=180&&p<240?(i=(u=[0,m,f])[0],r=u[1],a=u[2]):p>=240&&p<300?(i=(c=[m,0,f])[0],r=c[1],a=c[2]):(i=(h=[f,0,m])[0],r=h[1],a=h[2]),[255*(i+b),255*(r+b),255*(a+b)]}function gi(t,e,n){var i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]}function wi(t,e,n){var i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]}function yi(t){return[t[0],t[1],t[2]]}function xi(t,e){return[t[0],t[1],t[2],e]}var ki={hsl:{hsl:function(t,e,n){return[t,e,n]},hsv:gi,rgb:mi},hsv:{hsl:wi,hsv:function(t,e,n){return[t,e,n]},rgb:_i},rgb:{hsl:fi,hsv:bi,rgb:function(t,e,n){return[t,e,n]}}};function Ei(t,e,n){var i;return(i=ki[e])[n].apply(i,D(t))}var Pi={hsl:function(t){var e;return[Fn(t[0],360),jn(t[1],0,100),jn(t[2],0,100),jn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:function(t){var e;return[Fn(t[0],360),jn(t[1],0,100),jn(t[2],0,100),jn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:function(t){var e;return[jn(t[0],0,255),jn(t[1],0,255),jn(t[2],0,255),jn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function Ci(t,e){return"object"==typeof t&&!c(t)&&e in t&&"number"==typeof t[e]}var Mi=function(){function t(e,n){l(this,t),this.mode_=n,this.comps_=Pi[n](e)}return x(t,[{key:"mode",get:function(){return this.mode_}},{key:"getComponents",value:function(t){return xi(Ei(yi(this.comps_),this.mode_,t||this.mode_),this.comps_[3])}},{key:"toRgbaObject",value:function(){var t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}],[{key:"black",value:function(){return new t([0,0,0],"rgb")}},{key:"fromObject",value:function(e){return new t("a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b],"rgb")}},{key:"toRgbaObject",value:function(t){return t.toRgbaObject()}},{key:"isRgbColorObject",value:function(t){return Ci(t,"r")&&Ci(t,"g")&&Ci(t,"b")}},{key:"isRgbaColorObject",value:function(t){return this.isRgbColorObject(t)&&Ci(t,"a")}},{key:"isColorObject",value:function(t){return this.isRgbColorObject(t)}},{key:"equals",value:function(t,e){if(t.mode_!==e.mode_)return!1;for(var n=t.comps_,i=e.comps_,r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}}]),t}(),Vi=_("colp"),Li=function(){function t(e,n){l(this,t),this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Vi());var i=e.createElement("div");i.classList.add(Vi("hsv"));var r=e.createElement("div");r.classList.add(Vi("sv")),this.svPaletteView_=n.svPaletteView,r.appendChild(this.svPaletteView_.element),i.appendChild(r);var a=e.createElement("div");a.classList.add(Vi("h")),this.hPaletteView_=n.hPaletteView,a.appendChild(this.hPaletteView_.element),i.appendChild(a),this.element.appendChild(i);var o=e.createElement("div");if(o.classList.add(Vi("rgb")),this.textView_=n.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),n.alphaViews){this.alphaViews_={palette:n.alphaViews.palette,text:n.alphaViews.text};var s=e.createElement("div");s.classList.add(Vi("a"));var u=e.createElement("div");u.classList.add(Vi("ap")),u.appendChild(this.alphaViews_.palette.element),s.appendChild(u);var c=e.createElement("div");c.classList.add(Vi("at")),c.appendChild(this.alphaViews_.text.element),s.appendChild(c),this.element.appendChild(s)}}return x(t,[{key:"allFocusableElements",get:function(){var t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement].concat(D(this.textView_.textViews.map((function(t){return t.inputElement}))));return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}]),t}();function Ti(t){var e=W;return Y(t,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Jn)})}function Ai(t){return t?.1:1}function Si(t,e){var n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}var Ri={deg:function(t){return t},grad:function(t){return 360*t/400},rad:function(t){return 360*t/(2*Math.PI)},turn:function(t){return 360*t}};function Di(t){var e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);var n=parseFloat(e[1]),i=e[2];return Ri[i](n)}var zi={"func.rgb":function(t){var e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Si(e[1],255),Si(e[2],255),Si(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Mi(n,"rgb")},"func.rgba":function(t){var e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Si(e[1],255),Si(e[2],255),Si(e[3],255),Si(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Mi(n,"rgb")},"func.hsl":function(t){var e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Di(e[1]),Si(e[2],100),Si(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Mi(n,"hsl")},"func.hsla":function(t){var e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Di(e[1]),Si(e[2],100),Si(e[3],100),Si(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Mi(n,"hsl")},"hex.rgb":function(t){var e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Mi([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");var n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Mi([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":function(t){var e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Mi([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Un(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");var n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Mi([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Un(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function Bi(t){return Object.keys(zi).reduce((function(e,n){return e||((0,zi[n])(t)?n:null)}),null)}var Ii=function(t){var e=Bi(t);return e?zi[e](t):null};function Ui(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Ni(t){if("string"==typeof t){var e=Ii(t);if(e)return e}return Mi.black()}function ji(t){var e=jn(Math.floor(t),0,255).toString(16);return 1===e.length?"0".concat(e):e}function Fi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=yi(t.getComponents("rgb")).map(ji).join("");return"".concat(e).concat(n)}function Oi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=t.getComponents("rgb"),i=[n[0],n[1],n[2],255*n[3]].map(ji).join("");return"".concat(e).concat(i)}function Ki(t){var e=yn(0),n=yi(t.getComponents("rgb")).map((function(t){return e(t)}));return"rgb(".concat(n.join(", "),")")}function qi(t){var e=yn(2),n=yn(0),i=t.getComponents("rgb").map((function(t,i){return(3===i?e:n)(t)}));return"rgba(".concat(i.join(", "),")")}function Hi(t){var e=[yn(0),kn,kn],n=yi(t.getComponents("hsl")).map((function(t,n){return e[n](t)}));return"hsl(".concat(n.join(", "),")")}function Gi(t){var e=[yn(0),kn,kn,yn(2)],n=t.getComponents("hsl").map((function(t,n){return e[n](t)}));return"hsla(".concat(n.join(", "),")")}var Wi={"func.hsl":Hi,"func.hsla":Gi,"func.rgb":Ki,"func.rgba":qi,"hex.rgb":Fi,"hex.rgba":Oi};function Yi(t){return Wi[t]}var Xi=_("apl"),Zi=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Xi()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(Xi("b")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Xi("c")),i.appendChild(r),this.colorElem_=r;var a=e.createElement("div");a.classList.add(Xi("m")),this.element.appendChild(a),this.markerElem_=a;var o=e.createElement("div");o.classList.add(Xi("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return x(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t.getComponents("rgb"),n=new Mi([e[0],e[1],e[2],0],"rgb"),i=new Mi([e[0],e[1],e[2],255],"rgb"),r=["to right",qi(n),qi(i)];this.colorElem_.style.background="linear-gradient(".concat(r.join(","),")"),this.previewElem_.style.backgroundColor=qi(t);var a=Un(e[3],0,1,0,100);this.markerElem_.style.left="".concat(a,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),$i=function(){function t(e,n){l(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Zi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new In(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return x(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=t.point.x/t.bounds.width,i=R(this.value.rawValue.getComponents("hsv"),3),r=i[0],a=i[1],o=i[2];this.value.setRawValue(new Mi([r,a,o,n],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=An(Ai(!0),Rn(t));if(0!==e){var n=R(this.value.rawValue.getComponents("hsv"),4),i=n[0],r=n[1],a=n[2],o=n[3];this.value.setRawValue(new Mi([i,r,a,o+e],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==An(Ai(!0),Rn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),Qi=_("coltxt");function Ji(t){var e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce((function(e,n){var i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}var tr=function(){function t(e,n){var i=this;l(this,t),this.element=e.createElement("div"),this.element.classList.add(Qi());var r=e.createElement("div");r.classList.add(Qi("m")),this.modeElem_=Ji(e),this.modeElem_.classList.add(Qi("ms")),r.appendChild(this.modeSelectElement);var a=e.createElement("div");a.classList.add(Qi("mm")),a.appendChild(lt(e,"dropdown")),r.appendChild(a),this.element.appendChild(r);var o=e.createElement("div");o.classList.add(Qi("w")),this.element.appendChild(o),this.textsElem_=o,this.textViews_=n.textViews,this.applyTextViews_(),k(n.colorMode,(function(t){i.modeElem_.value=t}))}return x(t,[{key:"modeSelectElement",get:function(){return this.modeElem_}},{key:"textViews",get:function(){return this.textViews_},set:function(t){this.textViews_=t,this.applyTextViews_()}},{key:"applyTextViews_",value:function(){var t=this;ht(this.textsElem_);var e=this.element.ownerDocument;this.textViews_.forEach((function(n){var i=e.createElement("div");i.classList.add(Qi("c")),i.appendChild(n.element),t.textsElem_.appendChild(i)}))}}]),t}(),er=yn(0),nr={rgb:function(){return new Ee({min:0,max:255})},hsl:function(t){return new Ee(0===t?{min:0,max:360}:{min:0,max:100})},hsv:function(t){return new Ee(0===t?{min:0,max:360}:{min:0,max:100})}};function ir(t,e,n){return new qn(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:Ai(!1),parser:e.parser,props:F.fromObject({draggingScale:1,formatter:er}),value:j(0,{constraint:nr[e.colorMode](n)}),viewProps:e.viewProps})}var rr=function(){function t(e,n){l(this,t),this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=n.parser,this.value=n.value,this.viewProps=n.viewProps,this.colorMode=j(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new tr(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return x(t,[{key:"createComponentControllers_",value:function(t){var e=this,n={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},i=[ir(t,n,0),ir(t,n,1),ir(t,n,2)];return i.forEach((function(t,n){var i=e;Tn({primary:e.value,secondary:t.value,forward:function(t){return t.rawValue.getComponents(i.colorMode.rawValue)[n]},backward:function(t,e){var r=i.colorMode.rawValue,a=t.rawValue.getComponents(r);return a[n]=e.rawValue,new Mi(xi(yi(a),a[3]),r)}})})),i}},{key:"onModeSelectChange_",value:function(t){var e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}]),t}(),ar=_("hpl"),or=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ar()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(ar("c")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(ar("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return x(t,[{key:"update_",value:function(){var t=R(this.value.rawValue.getComponents("hsv"),1)[0];this.markerElem_.style.backgroundColor=Ki(new Mi([t,100,100],"hsv"));var e=Un(t,0,360,0,100);this.markerElem_.style.left="".concat(e,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),sr=function(){function t(e,n){l(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new or(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new In(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return x(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Un(jn(t.point.x,0,t.bounds.width),0,t.bounds.width,0,359),i=R(this.value.rawValue.getComponents("hsv"),4),r=i[1],a=i[2],o=i[3];this.value.setRawValue(new Mi([n,r,a,o],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=An(Ai(!1),Rn(t));if(0!==e){var n=R(this.value.rawValue.getComponents("hsv"),4),i=n[0],r=n[1],a=n[2],o=n[3];this.value.setRawValue(new Mi([i+e,r,a,o],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==An(Ai(!1),Rn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),lr=_("svp"),ur=64,cr=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(lr()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("canvas");i.height=ur,i.width=ur,i.classList.add(lr("c")),this.element.appendChild(i),this.canvasElement=i;var r=e.createElement("div");r.classList.add(lr("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return x(t,[{key:"update_",value:function(){var t=ot(this.canvasElement);if(t){for(var e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,r=t.getImageData(0,0,n,i),a=r.data,o=0;o<i;o++)for(var s=0;s<n;s++){var l=Un(s,0,n,0,100),u=Un(o,0,i,100,0),c=_i(e[0],l,u),h=4*(o*n+s);a[h]=c[0],a[h+1]=c[1],a[h+2]=c[2],a[h+3]=255}t.putImageData(r,0,0);var p=Un(e[1],0,100,0,100);this.markerElem_.style.left="".concat(p,"%");var v=Un(e[2],0,100,100,0);this.markerElem_.style.top="".concat(v,"%")}}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),hr=function(){function t(e,n){l(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new cr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new In(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return x(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Un(t.point.x,0,t.bounds.width,0,100),i=Un(t.point.y,0,t.bounds.height,100,0),r=R(this.value.rawValue.getComponents("hsv"),4),a=r[0],o=r[3];this.value.setRawValue(new Mi([a,n,i,o],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){zn(t.key)&&t.preventDefault();var e=R(this.value.rawValue.getComponents("hsv"),4),n=e[0],i=e[1],r=e[2],a=e[3],o=Ai(!1),s=An(o,Rn(t)),l=An(o,Sn(t));0===s&&0===l||this.value.setRawValue(new Mi([n,i+s,r+l,a],"hsv"),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){var e=Ai(!1),n=An(e,Rn(t)),i=An(e,Sn(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),pr=function(){function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.hPaletteC_=new sr(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new hr(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=n.supportsAlpha?{palette:new $i(e,{value:this.value,viewProps:this.viewProps}),text:new qn(e,{parser:_n,baseStep:.1,props:F.fromObject({draggingScale:.01,formatter:yn(2)}),value:j(0,{constraint:new Ee({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Tn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(t){return t.rawValue.getComponents()[3]},backward:function(t,e){var n=t.rawValue.getComponents();return n[3]=e.rawValue,new Mi(n,t.rawValue.mode)}}),this.textC_=new rr(e,{parser:_n,value:this.value,viewProps:this.viewProps}),this.view=new Li(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:n.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}return x(t,[{key:"textController",get:function(){return this.textC_}}]),t}(),vr=_("colsw"),dr=function(){function t(e,n){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.element=e.createElement("div"),this.element.classList.add(vr()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(vr("sw")),this.element.appendChild(i),this.swatchElem_=i;var r=e.createElement("button");r.classList.add(vr("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}return x(t,[{key:"update_",value:function(){var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Oi(t)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),fr=function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new dr(e,{value:this.value,viewProps:this.viewProps})},mr=function(){function t(e,n){var i=this;l(this,t),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=yt.create(n.expanded),this.swatchC_=new fr(e,{value:this.value,viewProps:this.viewProps});var r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new De(e,{parser:n.parser,props:F.fromObject({formatter:n.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new di(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===n.pickerLayout?new Ae(e,{viewProps:this.viewProps}):null;var a=new pr(e,{supportsAlpha:n.supportsAlpha,value:this.value,viewProps:this.viewProps});a.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",i.onPopupChildBlur_),t.addEventListener("keydown",i.onPopupChildKeydown_)})),this.pickerC_=a,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(a.view.element),Tn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Et(this.foldable_,this.view.pickerElement))}return x(t,[{key:"textController",get:function(){return this.textC_}},{key:"onButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=u(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=vt(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!it(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}]),t}();function br(t){return Mi.isColorObject(t)?Mi.fromObject(t):Mi.black()}function _r(t){return yi(t.getComponents("rgb")).reduce((function(t,e){return t<<8|255&Math.floor(e)}),0)}function gr(t){return t.getComponents("rgb").reduce((function(t,e,n){return t<<8|255&Math.floor(3===n?255*e:e)}),0)>>>0}function wr(t){return new Mi([t>>16&255,t>>8&255,255&t],"rgb")}function yr(t){return new Mi([t>>24&255,t>>16&255,t>>8&255,Un(255&t,0,255,0,1)],"rgb")}function xr(t){return"number"!=typeof t?Mi.black():wr(t)}function kr(t){return"number"!=typeof t?Mi.black():yr(t)}function Er(t){var e=Yi(t);return function(t,n){$n(t,e(n))}}function Pr(t){var e=t?gr:_r;return function(t,n){$n(t,e(n))}}function Cr(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function Mr(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function Vr(t){return t?Cr:Mr}function Lr(t){return"alpha"in t&&!0===t.alpha}function Tr(t){return t?function(t){return Oi(t,"0x")}:function(t){return Fi(t,"0x")}}var Ar={id:"input-color-number",type:"input",accept:function(t,e){if("number"!=typeof t)return null;if(!("view"in e))return null;if("color"!==e.view)return null;var n=Ti(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Lr(t.params)?kr:xr},equals:Mi.equals,writer:function(t){return Pr(Lr(t.params))}},controller:function(t){var e=Lr(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new mr(t.document,{expanded:null!=n&&n,formatter:Tr(e),parser:Ii,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function Sr(t){return Mi.isRgbaColorObject(t)}var Rr={id:"input-color-object",type:"input",accept:function(t,e){if(!Mi.isColorObject(t))return null;var n=Ti(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return br},equals:Mi.equals,writer:function(t){return Vr(Sr(t.initialValue))}},controller:function(t){var e=Mi.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,r=e?Oi:Fi;return new mr(t.document,{expanded:null!=n&&n,formatter:r,parser:Ii,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},Dr={id:"input-color-string",type:"input",accept:function(t,e){if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;if(!Bi(t))return null;var n=Ti(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Ni},equals:Mi.equals,writer:function(t){var e=Bi(t.initialValue);if(!e)throw v.shouldNeverHappen();return Er(e)}},controller:function(t){var e=Bi(t.initialValue);if(!e)throw v.shouldNeverHappen();var n=Yi(e),i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new mr(t.document,{expanded:null!=i&&i,formatter:n,parser:Ii,pickerLayout:null!=r?r:"popup",supportsAlpha:Ui(e),value:t.value,viewProps:t.viewProps})}},zr=function(){function t(e){l(this,t),this.components=e.components,this.asm_=e.assembly}return x(t,[{key:"constrain",value:function(t){var e=this,n=this.asm_.toComponents(t).map((function(t,n){var i,r;return null!==(r=null===(i=e.components[n])||void 0===i?void 0:i.constrain(t))&&void 0!==r?r:t}));return this.asm_.fromComponents(n)}}]),t}(),Br=_("pndtxt"),Ir=function t(e,n){var i=this;l(this,t),this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(Br()),this.textViews.forEach((function(t){var n=e.createElement("div");n.classList.add(Br("a")),n.appendChild(t.element),i.element.appendChild(n)}))};function Ur(t,e,n){return new qn(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:j(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}var Nr=function t(e,n){var i=this;l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(t,i){return Ur(e,n,i)})),this.acs_.forEach((function(t,e){Tn({primary:i.value,secondary:t.value,forward:function(t){return n.assembly.toComponents(t.rawValue)[e]},backward:function(t,i){var r=n.assembly.toComponents(t.rawValue);return r[e]=i.rawValue,n.assembly.fromComponents(r)}})})),this.view=new Ir(e,{textViews:this.acs_.map((function(t){return t.view}))})};function jr(t){return"step"in t&&!c(t.step)?new Pe(t.step):null}function Fr(t){return"max"in t&&!c(t.max)||"min"in t&&!c(t.min)?new Ee({max:t.max,min:t.min}):null}function Or(t){var e=[],n=jr(t);n&&e.push(n);var i=Fr(t);i&&e.push(i);var r=ni(t.options);return r&&e.push(r),new ye(e)}function Kr(t){var e=t?xe(t,Ee):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function qr(t){var e=R(Kr(t),2),n=e[0],i=e[1];return[null!=n?n:0,null!=i?i:100]}var Hr={id:"input-number",type:"input",accept:function(t,e){if("number"!=typeof t)return null;var n=W,i=Y(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Qn),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return gn},constraint:function(t){return Or(t.params)},writer:function(t){return $n}},controller:function(t){var e,n,i=t.value,r=t.constraint;if(r&&xe(r,ke))return new Ve(t.document,{props:F.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps});var a=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:yn(ai(r,i.rawValue));if(r&&xe(r,Ee)){var o=R(qr(r),2),s=o[0],l=o[1];return new Zn(t.document,{baseStep:oi(r),parser:_n,sliderProps:F.fromObject({maxValue:l,minValue:s}),textProps:F.fromObject({draggingScale:si(r,i.rawValue),formatter:a}),value:i,viewProps:t.viewProps})}return new qn(t.document,{baseStep:oi(r),parser:_n,props:F.fromObject({draggingScale:si(r,i.rawValue),formatter:a}),value:i,viewProps:t.viewProps})}},Gr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=e,this.y=n}return x(t,[{key:"getComponents",value:function(){return[this.x,this.y]}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}],[{key:"isObject",value:function(t){if(c(t))return!1;var e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}}]),t}(),Wr={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return w(Gr,D(t))}},Yr=_("p2d"),Xr=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(Yr()),n.viewProps.bindClassModifiers(this.element),k(n.expanded,A(this.element,Yr(void 0,"expanded")));var i=e.createElement("div");i.classList.add(Yr("h")),this.element.appendChild(i);var r=e.createElement("button");r.classList.add(Yr("b")),r.appendChild(lt(e,"p2dpad")),n.viewProps.bindDisabled(r),i.appendChild(r),this.buttonElement=r;var a=e.createElement("div");if(a.classList.add(Yr("t")),i.appendChild(a),this.textElement=a,"inline"===n.pickerLayout){var o=e.createElement("div");o.classList.add(Yr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null},Zr=_("p2dp"),$r=function(){function t(e,n){l(this,t),this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=n.invertsY,this.maxValue_=n.maxValue,this.element=e.createElement("div"),this.element.classList.add(Zr()),"popup"===n.layout&&this.element.classList.add(Zr(void 0,"p"));var i=e.createElement("div");i.classList.add(Zr("p")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;var r=e.createElementNS(tt,"svg");r.classList.add(Zr("g")),this.padElement.appendChild(r),this.svgElem_=r;var a=e.createElementNS(tt,"line");a.classList.add(Zr("ax")),a.setAttributeNS(null,"x1","0"),a.setAttributeNS(null,"y1","50%"),a.setAttributeNS(null,"x2","100%"),a.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(a);var o=e.createElementNS(tt,"line");o.classList.add(Zr("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var s=e.createElementNS(tt,"line");s.classList.add(Zr("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;var u=e.createElement("div");u.classList.add(Zr("m")),this.padElement.appendChild(u),this.markerElem_=u,n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return x(t,[{key:"allFocusableElements",get:function(){return[this.padElement]}},{key:"update_",value:function(){var t=R(this.value.rawValue.getComponents(),2),e=t[0],n=t[1],i=this.maxValue_,r=Un(e,-i,+i,0,100),a=Un(n,-i,+i,0,100),o=this.invertsY_?100-a:a;this.lineElem_.setAttributeNS(null,"x2","".concat(r,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(o,"%")),this.markerElem_.style.left="".concat(r,"%"),this.markerElem_.style.top="".concat(o,"%")}},{key:"onValueChange_",value:function(){this.update_()}},{key:"onFoldableChange_",value:function(){this.update_()}}]),t}();function Qr(t,e,n){return[An(e[0],Rn(t)),An(e[1],Sn(t))*(n?1:-1)]}var Jr=function(){function t(e,n){l(this,t),this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.baseSteps_=n.baseSteps,this.maxValue_=n.maxValue,this.invertsY_=n.invertsY,this.view=new $r(e,{invertsY:this.invertsY_,layout:n.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new In(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return x(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=this.maxValue_,i=Un(t.point.x,0,t.bounds.width,-n,+n),r=Un(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new Gr(i,r),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onPadKeyDown_",value:function(t){zn(t.key)&&t.preventDefault();var e=R(Qr(t,this.baseSteps_,this.invertsY_),2),n=e[0],i=e[1];0===n&&0===i||this.value.setRawValue(new Gr(this.value.rawValue.x+n,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}},{key:"onPadKeyUp_",value:function(t){var e=R(Qr(t,this.baseSteps_,this.invertsY_),2),n=e[0],i=e[1];0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),ta=function(){function t(e,n){var i,r,a=this;l(this,t),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=yt.create(n.expanded),this.popC_="popup"===n.pickerLayout?new Ae(e,{viewProps:this.viewProps}):null;var o=new Jr(e,{baseSteps:[n.axes[0].baseStep,n.axes[1].baseStep],invertsY:n.invertsY,layout:n.pickerLayout,maxValue:n.maxValue,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",a.onPopupChildBlur_),t.addEventListener("keydown",a.onPopupChildKeydown_)})),this.pickerC_=o,this.textC_=new Nr(e,{assembly:Wr,axes:n.axes,parser:n.parser,value:this.value,viewProps:this.viewProps}),this.view=new Xr(e,{expanded:this.foldable_.value("expanded"),pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Tn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Et(this.foldable_,this.view.pickerElement))}return x(t,[{key:"onPadButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=u(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onPadButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=vt(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!it(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}]),t}();function ea(t){return Gr.isObject(t)?new Gr(t.x,t.y):new Gr}function na(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function ia(t){if(t){var e=[];return c(t.step)||e.push(new Pe(t.step)),c(t.max)&&c(t.min)||e.push(new Ee({max:t.max,min:t.min})),new ye(e)}}function ra(t){return new zr({assembly:Wr,components:[ia("x"in t?t.x:void 0),ia("y"in t?t.y:void 0)]})}function aa(t,e){var n=t&&xe(t,Ee);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));var i=oi(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function oa(t,e){var n=e instanceof zr?e.components[0]:void 0,i=e instanceof zr?e.components[1]:void 0,r=aa(n,t.x),a=aa(i,t.y);return Math.max(r,a)}function sa(t,e){return{baseStep:oi(e),constraint:e,textProps:F.fromObject({draggingScale:si(e,t),formatter:yn(ai(e,t))})}}function la(t){if(!("y"in t))return!1;var e=t.y;return!!e&&"inverted"in e&&!!e.inverted}var ua={id:"input-point2d",type:"input",accept:function(t,e){if(!Gr.isObject(t))return null;var n=W,i=Y(e,{expanded:n.optional.boolean,picker:n.optional.custom(Jn),x:n.optional.custom(ti),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return ea},constraint:function(t){return ra(t.params)},equals:Gr.equals,writer:function(t){return na}},controller:function(t){var e=t.document,n=t.value,i=t.constraint;if(!(i instanceof zr))throw v.shouldNeverHappen();var r="expanded"in t.params?t.params.expanded:void 0,a="picker"in t.params?t.params.picker:void 0;return new ta(e,{axes:[sa(n.rawValue.x,i.components[0]),sa(n.rawValue.y,i.components[1])],expanded:null!=r&&r,invertsY:la(t.params),maxValue:oa(n.rawValue,i),parser:_n,pickerLayout:null!=a?a:"popup",value:n,viewProps:t.viewProps})}},ca=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;l(this,t),this.x=e,this.y=n,this.z=i}return x(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z}}}],[{key:"isObject",value:function(t){if(c(t))return!1;var e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}}]),t}(),ha={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return w(ca,D(t))}};function pa(t){return ca.isObject(t)?new ca(t.x,t.y,t.z):new ca}function va(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function da(t){if(t){var e=[];return c(t.step)||e.push(new Pe(t.step)),c(t.max)&&c(t.min)||e.push(new Ee({max:t.max,min:t.min})),new ye(e)}}function fa(t){return new zr({assembly:ha,components:[da("x"in t?t.x:void 0),da("y"in t?t.y:void 0),da("z"in t?t.z:void 0)]})}function ma(t,e){return{baseStep:oi(e),constraint:e,textProps:F.fromObject({draggingScale:si(e,t),formatter:yn(ai(e,t))})}}var ba={id:"input-point3d",type:"input",accept:function(t,e){if(!ca.isObject(t))return null;var n=W,i=Y(e,{x:n.optional.custom(ti),y:n.optional.custom(ti),z:n.optional.custom(ti)});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return pa},constraint:function(t){return fa(t.params)},equals:ca.equals,writer:function(t){return va}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof zr))throw v.shouldNeverHappen();return new Nr(t.document,{assembly:ha,axes:[ma(e.rawValue.x,n.components[0]),ma(e.rawValue.y,n.components[1]),ma(e.rawValue.z,n.components[2])],parser:_n,value:e,viewProps:t.viewProps})}},_a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;l(this,t),this.x=e,this.y=n,this.z=i,this.w=r}return x(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}],[{key:"isObject",value:function(t){if(c(t))return!1;var e=t.x,n=t.y,i=t.z,r=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof r}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}}]),t}(),ga={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return w(_a,D(t))}};function wa(t){return _a.isObject(t)?new _a(t.x,t.y,t.z,t.w):new _a}function ya(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function xa(t){if(t){var e=[];return c(t.step)||e.push(new Pe(t.step)),c(t.max)&&c(t.min)||e.push(new Ee({max:t.max,min:t.min})),new ye(e)}}function ka(t){return new zr({assembly:ga,components:[xa("x"in t?t.x:void 0),xa("y"in t?t.y:void 0),xa("z"in t?t.z:void 0),xa("w"in t?t.w:void 0)]})}function Ea(t,e){return{baseStep:oi(e),constraint:e,textProps:F.fromObject({draggingScale:si(e,t),formatter:yn(ai(e,t))})}}var Pa={id:"input-point4d",type:"input",accept:function(t,e){if(!_a.isObject(t))return null;var n=W,i=Y(e,{x:n.optional.custom(ti),y:n.optional.custom(ti),z:n.optional.custom(ti),w:n.optional.custom(ti)});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return wa},constraint:function(t){return ka(t.params)},equals:_a.equals,writer:function(t){return ya}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof zr))throw v.shouldNeverHappen();return new Nr(t.document,{assembly:ga,axes:e.rawValue.getComponents().map((function(t,e){return Ea(t,n.components[e])})),parser:_n,value:e,viewProps:t.viewProps})}};function Ca(t){var e=[],n=ni(t.options);return n&&e.push(n),new ye(e)}var Ma={id:"input-string",type:"input",accept:function(t,e){if("string"!=typeof t)return null;var n=Y(e,{options:W.optional.custom(Qn)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return En},constraint:function(t){return Ca(t.params)},writer:function(t){return $n}},controller:function(t){var e,n=t.document,i=t.value,r=t.constraint;return r&&xe(r,ke)?new Ve(n,{props:F.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new De(n,{parser:function(t){return t},props:F.fromObject({formatter:Pn}),value:i,viewProps:t.viewProps})}},Va={monitor:{defaultInterval:200,defaultLineCount:3}},La=_("mll"),Ta=function(){function t(e,n){l(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(La()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("textarea");i.classList.add(La("i")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),i.readOnly=!0,n.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return x(t,[{key:"update_",value:function(){var t=this,e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach((function(e){void 0!==e&&i.push(t.formatter_(e))})),e.textContent=i.join("\n"),n&&(e.scrollTop=e.scrollHeight)}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),Aa=function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new Ta(e,{formatter:n.formatter,lineCount:n.lineCount,value:this.value,viewProps:this.viewProps})},Sa=_("sgl"),Ra=function(){function t(e,n){l(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(Sa()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(Sa("i")),i.readOnly=!0,i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return x(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),Da=function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new Ra(e,{formatter:n.formatter,value:this.value,viewProps:this.viewProps})},za={id:"monitor-bool",type:"monitor",accept:function(t,e){if("boolean"!=typeof t)return null;var n=Y(e,{lineCount:W.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Be}},controller:function(t){var e;return 1===t.value.rawValue.length?new Da(t.document,{formatter:Ie,value:t.value,viewProps:t.viewProps}):new Aa(t.document,{formatter:Ie,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Va.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},Ba=function(){function t(){l(this,t),this.emitter=new m,this.index_=-1}return x(t,[{key:"index",get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}]),t}(),Ia=_("grl"),Ua=function(){function t(e,n){l(this,t),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ia()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.minValue_=n.minValue,this.maxValue_=n.maxValue,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var i=e.createElementNS(tt,"svg");i.classList.add(Ia("g")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),this.element.appendChild(i),this.svgElem_=i;var r=e.createElementNS(tt,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var a=e.createElement("div");a.classList.add(Ia("t"),_("tt")()),this.element.appendChild(a),this.tooltipElem_=a,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return x(t,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach((function(a,o){if(void 0!==a){var s=Un(o,0,e,0,t.width),l=Un(a,n,i,t.height,0);r.push([s,l].join(","))}})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));var a=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0!==o){var s=Un(this.cursor_.index,0,e,0,t.width),l=Un(o,n,i,t.height,0);a.style.left="".concat(s,"px"),a.style.top="".concat(l,"px"),a.textContent="".concat(this.formatter_(o)),a.classList.contains(Ia("t","a"))||(a.classList.add(Ia("t","a"),Ia("t","in")),et(a),a.classList.remove(Ia("t","in")))}else a.classList.remove(Ia("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),t}(),Na=function(){function t(e,n){if(l(this,t),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.cursor_=new Ba,this.view=new Ua(e,{cursor:this.cursor_,formatter:n.formatter,lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:this.viewProps}),it(e)){var i=new In(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return x(t,[{key:"onGraphMouseLeave_",value:function(){this.cursor_.index=-1}},{key:"onGraphMouseMove_",value:function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Un(t.offsetX,0,e.width,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(t){this.onGraphPointerMove_(t)}},{key:"onGraphPointerMove_",value:function(t){t.data.point?this.cursor_.index=Math.floor(Un(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.index=-1}}]),t}();function ja(t){return"format"in t&&!c(t.format)?t.format:yn(2)}function Fa(t){var e;return 1===t.value.rawValue.length?new Da(t.document,{formatter:ja(t.params),value:t.value,viewProps:t.viewProps}):new Aa(t.document,{formatter:ja(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Va.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function Oa(t){var e,n,i;return new Na(t.document,{formatter:ja(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Va.monitor.defaultLineCount,maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0,value:t.value,viewProps:t.viewProps})}function Ka(t){return"view"in t&&"graph"===t.view}var qa={id:"monitor-number",type:"monitor",accept:function(t,e){if("number"!=typeof t)return null;var n=W,i=Y(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:function(t){return Ka(t)?64:1},reader:function(t){return gn}},controller:function(t){return Ka(t.params)?Oa(t):Fa(t)}},Ha={id:"monitor-string",type:"monitor",accept:function(t,e){if("string"!=typeof t)return null;var n=W,i=Y(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return En}},controller:function(t){var e,n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Aa(t.document,{formatter:Pn,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Va.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new Da(t.document,{formatter:Pn,value:n,viewProps:t.viewProps})}},Ga=function(){function t(e){l(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new m,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return x(t,[{key:"read",value:function(){var t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}},{key:"write_",value:function(t){this.writer(this.target,t)}},{key:"onValueChange_",value:function(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}]),t}();function Wa(t,e){var n=t.accept(e.target.read(),e.params);if(c(n))return null;var i=W,r={target:e.target,initialValue:n.initialValue,params:n.params},a=t.binding.reader(r),o=t.binding.constraint?t.binding.constraint(r):void 0,s=j(a(n.initialValue),{constraint:o,equals:t.binding.equals}),l=new Ga({reader:a,target:e.target,value:s,writer:t.binding.writer(r)}),u=i.optional.boolean(e.params.disabled).value,h=i.optional.boolean(e.params.hidden).value,p=t.controller({constraint:o,document:e.document,initialValue:n.initialValue,params:n.params,value:l.value,viewProps:se.create({disabled:u,hidden:h})}),v=i.optional.string(e.params.label).value;return new St(e.document,{binding:l,blade:wt(),props:F.fromObject({label:v||e.target.key}),valueController:p})}var Ya=function(){function t(e){l(this,t),this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new m,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return x(t,[{key:"dispose",value:function(){this.ticker.dispose()}},{key:"read",value:function(){var t=this.target.read();if(void 0!==t){var e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=Ln(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}}},{key:"onTick_",value:function(t){this.read()}}]),t}();function Xa(t,e){return 0===e?new ge:new we(t,null!=e?e:Va.monitor.defaultInterval)}function Za(t,e){var n,i,r,a=W,o=t.accept(e.target.read(),e.params);if(c(o))return null;var s={target:e.target,initialValue:o.initialValue,params:o.params},l=t.binding.reader(s),u=null!==(i=null!==(n=a.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(o.params))&&void 0!==i?i:1,h=a.optional.number(e.params.interval).value,p=new Ya({reader:l,target:e.target,ticker:Xa(e.document,h),value:Mn(u)}),v=a.optional.boolean(e.params.disabled).value,d=a.optional.boolean(e.params.hidden).value,f=t.controller({document:e.document,params:o.params,value:p.value,viewProps:se.create({disabled:v,hidden:d})}),m=null!==(r=a.optional.string(e.params.label).value)&&void 0!==r?r:e.target.key;return new Dt(e.document,{binding:p,blade:wt(),props:F.fromObject({label:m}),valueController:f})}var $a=function(){function t(){l(this,t),this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return x(t,[{key:"getAll",value:function(){return D(this.pluginsMap_.blades).concat(D(this.pluginsMap_.inputs),D(this.pluginsMap_.monitors))}},{key:"register",value:function(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}},{key:"createInput",value:function(t,e,n){if(c(e.read()))throw new v({context:{key:e.key},type:"nomatchingcontroller"});var i=this.pluginsMap_.inputs.reduce((function(i,r){return i||Wa(r,{document:t,target:e,params:n})}),null);if(i)return i;throw new v({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createMonitor",value:function(t,e,n){var i=this.pluginsMap_.monitors.reduce((function(i,r){return i||Za(r,{document:t,params:n,target:e})}),null);if(i)return i;throw new v({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createBlade",value:function(t,e){var n=this.pluginsMap_.blades.reduce((function(n,i){return n||_e(i,{document:t,params:e})}),null);if(!n)throw new v({type:"nomatchingview",context:{params:e}});return n}},{key:"createBladeApi",value:function(t){var e=this;if(t instanceof St)return new At(t);if(t instanceof Dt)return new Rt(t);if(t instanceof Yt)return new Ut(t,this);var n=this.pluginsMap_.blades.reduce((function(n,i){return n||i.api({controller:t,pool:e})}),null);if(!n)throw v.shouldNeverHappen();return n}}]),t}();function Qa(){var t=new $a;return[ua,ba,Pa,Ma,Hr,Dr,Rr,Ar,pi,za,Ha,qa,_t,Qt,re,be].forEach((function(e){t.register(e)})),t}var Ja=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"options",get:function(){return this.controller_.valueController.props.get("options")},set:function(t){this.controller_.valueController.props.set("options",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),to=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"maxValue",get:function(){return this.controller_.valueController.sliderController.props.get("maxValue")},set:function(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}},{key:"minValue",get:function(){return this.controller_.valueController.sliderController.props.get("minValue")},set:function(t){this.controller_.valueController.sliderController.props.set("minValue",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),eo=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"formatter",get:function(){return this.controller_.valueController.props.get("formatter")},set:function(t){this.controller_.valueController.props.set("formatter",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),no={id:"list",type:"blade",accept:function(t){var e=W,n=Y(t,{options:e.required.custom(Qn),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller:function(t){var e=new Ve(t.document,{props:F.fromObject({options:ei(t.params.options)}),value:j(t.params.value),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:F.fromObject({label:t.params.label}),valueController:e})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof Ve?new Ja(t.controller):null}};function io(t){return t.reduce((function(t,e){return Object.assign(t,M({},e.presetKey,e.read()))}),{})}function ro(t,e){t.forEach((function(t){var n=e[t.presetKey];void 0!==n&&t.write(n)}))}var ao=function(t){L(n,t);var e=C(n);function n(t,i){return l(this,n),e.call(this,t,i)}return x(n,[{key:"element",get:function(){return this.controller_.view.element}},{key:"importPreset",value:function(t){ro(this.controller_.rackController.rack.find(St).map((function(t){return t.binding.target})),t),this.refresh()}},{key:"exportPreset",value:function(){return io(this.controller_.rackController.rack.find(St).map((function(t){return t.binding.target})))}},{key:"refresh",value:function(){this.controller_.rackController.rack.find(St).forEach((function(t){t.binding.read()})),this.controller_.rackController.rack.find(Dt).forEach((function(t){t.binding.read()}))}}]),n}(Nt),oo=function(t){L(n,t);var e=C(n);function n(t,i){return l(this,n),e.call(this,t,{expanded:i.expanded,blade:i.blade,props:i.props,root:!0,viewProps:i.viewProps})}return n}($t),so={id:"slider",type:"blade",accept:function(t){var e=W,n=Y(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller:function(t){var e,n,i=null!==(e=t.params.value)&&void 0!==e?e:0,r=new Zn(t.document,{baseStep:1,parser:_n,sliderProps:F.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:F.fromObject({draggingScale:si(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:wn}),value:j(i),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:F.fromObject({label:t.params.label}),valueController:r})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof Zn?new to(t.controller):null}},lo={id:"text",type:"blade",accept:function(t){var e=W,n=Y(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller:function(t){var e,n=new De(t.document,{parser:t.params.parse,props:F.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:function(t){return String(t)}}),value:j(t.params.value),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:F.fromObject({label:t.params.label}),valueController:n})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof De?new eo(t.controller):null}};function uo(t){var e=t.createElement("div");return e.classList.add(_("dfw")()),t.body&&t.body.appendChild(e),e}function co(t,e,n){if(!t.querySelector("style[data-tp-style=".concat(e,"]"))){var i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}}var ho=function(t){L(n,t);var e=C(n);function n(t){var i,r;l(this,n);var a=t||{},o=null!==(r=a.document)&&void 0!==r?r:at(),s=Qa(),u=new oo(o,{expanded:a.expanded,blade:wt(),props:F.fromObject({title:a.title}),viewProps:se.create()});return(i=e.call(this,u,s)).pool_=s,i.containerElem_=a.container||uo(o),i.containerElem_.appendChild(i.element),i.doc_=o,i.usesDefaultWrapper_=!a.container,i.setUpDefaultPlugins_(),i}return x(n,[{key:"document",get:function(){if(!this.doc_)throw v.alreadyDisposed();return this.doc_}},{key:"dispose",value:function(){var t,e,i,r=this.containerElem_;if(!r)throw v.alreadyDisposed();if(this.usesDefaultWrapper_){var a=r.parentElement;a&&a.removeChild(r)}this.containerElem_=null,this.doc_=null,(t=E(n.prototype),e="dispose",i=this,V(t,e,i)).call(this)}},{key:"registerPlugin",value:function(t){var e=this;("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((function(t){e.pool_.register(t),e.embedPluginStyle_(t)}))}},{key:"embedPluginStyle_",value:function(t){t.css&&co(this.document,"plugin-".concat(t.id),t.css)}},{key:"setUpDefaultPlugins_",value:function(){var t=this;co(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((function(e){t.embedPluginStyle_(e)})),this.registerPlugin({plugins:[so,no,be,lo]})}}]),n}(ao),po=new e("3.0.8");t.BladeApi=n,t.ButtonApi=f,t.FolderApi=Nt,t.InputBindingApi=At,t.ListApi=Ja,t.MonitorBindingApi=Rt,t.Pane=ho,t.SeparatorApi=te,t.SliderApi=to,t.TabApi=ve,t.TabPageApi=pe,t.TextApi=eo,t.TpChangeEvent=r,t.VERSION=po,Object.defineProperty(t,"__esModule",{value:!0})}(o);var z={};!function(t){"use strict";var e=function(){function t(e){l(this,t),this.controller_=e}return x(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"hidden",get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)}},{key:"dispose",value:function(){this.controller_.viewProps.set("disposed",!0)}}]),t}(),n=function t(e){l(this,t),this.target=e},i=function(t){L(n,t);var e=C(n);function n(t,i,r,a){var o;return l(this,n),(o=e.call(this,t)).value=i,o.presetKey=r,o.last=null==a||a,o}return n}(n);function r(t){return t}function a(t){return null==t}var o={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '".concat(t.name,"'")},nomatchingcontroller:function(t){return"No matching controller for '".concat(t.key,"'")},nomatchingview:function(t){return"No matching view for '".concat(JSON.stringify(t.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '".concat(t.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},u=function(){function t(e){var n;l(this,t),this.message=null!==(n=o[e.type](r(e.context)))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return x(t,null,[{key:"alreadyDisposed",value:function(){return new t({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new t({type:"notbindable"})}},{key:"propertyNotFound",value:function(e){return new t({type:"propertynotfound",context:{name:e}})}},{key:"shouldNeverHappen",value:function(){return new t({type:"shouldneverhappen"})}}]),t}(),c=function(){function t(){l(this,t),this.observers_={}}return x(t,[{key:"on",value:function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}},{key:"off",value:function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this}},{key:"emit",value:function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))}}]),t}(),h="tp";function p(t){return function(e,n){return[h,"-",t,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")}}function v(t,e){return function(n){return e(t(n))}}function d(t){return t.rawValue}function f(t,e){t.emitter.on("change",v(d,e)),e(t.rawValue)}function m(t,e,n){f(t.value(e),n)}function b(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function _(t,e){return function(n){b(t,e,n)}}function g(t,e){f(t,(function(t){e.textContent=null!=t?t:""}))}var y=p("btn"),k=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(y()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("button");i.classList.add(y("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var r=e.createElement("div");r.classList.add(y("t")),g(n.props.value("title"),r),this.buttonElement.appendChild(r)},E=function(){function t(e,n){l(this,t),this.emitter=new c,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new k(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return x(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),P=function(){function t(e,n){var i;l(this,t),this.constraint_=null==n?void 0:n.constraint,this.equals_=null!==(i=null==n?void 0:n.equals)&&void 0!==i?i:function(t,e){return t===e},this.emitter=new c,this.rawValue_=e}return x(t,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}]),t}(),V=function(){function t(e){l(this,t),this.emitter=new c,this.value_=e}return x(t,[{key:"rawValue",get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}]),t}();function T(t,e){var n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new P(t,e):new V(t)}var A=function(){function t(e){var n=this,i=function(t){var e=n;n.valMap_[t].emitter.on("change",(function(){e.emitter.emit("change",{key:t,sender:e})}))};for(var r in l(this,t),this.emitter=new c,this.valMap_=e,this.valMap_)i(r)}return x(t,[{key:"get",value:function(t){return this.valMap_[t].rawValue}},{key:"set",value:function(t,e){this.valMap_[t].rawValue=e}},{key:"value",value:function(t){return this.valMap_[t]}}],[{key:"createCore",value:function(t){return Object.keys(t).reduce((function(e,n){return Object.assign(e,M({},n,T(t[n])))}),{})}},{key:"fromObject",value:function(e){return new t(this.createCore(e))}}]),t}();function S(t,e){return r(Object.keys(e).reduce((function(n,i){if(void 0!==n){var r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),M({},i,r.value)):void 0}}),{}))}function z(t,e){return t.reduce((function(t,n){if(void 0!==t){var i=e(n);if(i.succeeded&&void 0!==i.value)return D(t).concat([i.value])}}),[])}function B(t){return null!==t&&"object"==typeof t}function I(t){return function(e){return function(n){if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};var i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}}function U(t){return{custom:function(e){return I(e)(t)},boolean:I((function(t){return"boolean"==typeof t?t:void 0}))(t),number:I((function(t){return"number"==typeof t?t:void 0}))(t),string:I((function(t){return"string"==typeof t?t:void 0}))(t),function:I((function(t){return"function"==typeof t?t:void 0}))(t),constant:function(e){return I((function(t){return t===e?e:void 0}))(t)},raw:I((function(t){return t}))(t),object:function(e){return I((function(t){if(B(t))return S(t,e)}))(t)},array:function(e){return I((function(t){if(Array.isArray(t))return z(t,e)}))(t)}}}var N={optional:U(!0),required:U(!1)};function j(t,e){var n=N.required.object(e)(t);return n.succeeded?n.value:void 0}function F(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function O(){return["veryfirst","first","last","verylast"]}var K=p(""),q={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},H=function(){function t(e){var n=this;l(this,t),this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var i=this.view.element;this.blade.value("positions").emitter.on("change",(function(){O().forEach((function(t){i.classList.remove(K(void 0,q[t]))})),n.blade.get("positions").forEach((function(t){i.classList.add(K(void 0,q[t]))}))})),this.viewProps.handleDispose((function(){F(i)}))}return x(t,[{key:"parent",get:function(){return this.parent_}}]),t}(),G="http://www.w3.org/2000/svg";function W(t){t.offsetHeight}function Y(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function X(t){return void 0!==t.ontouchstart}function Z(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function $(t){return t.relatedTarget?r(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}var Q=p("lbl");function J(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,i){i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var tt=function t(e,n){var i=this;l(this,t),this.element=e.createElement("div"),this.element.classList.add(Q()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(Q("l")),m(n.props,"label",(function(t){a(t)?i.element.classList.add(Q(void 0,"nol")):(i.element.classList.remove(Q(void 0,"nol")),Z(r),r.appendChild(J(e,t)))})),this.element.appendChild(r),this.labelElement=r;var o=e.createElement("div");o.classList.add(Q("v")),this.element.appendChild(o),this.valueElement=o},et=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{view:new tt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(H),nt=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).value=t.value,i}return n}(H),it=function(t){L(n,t);var e=C(n);function n(t){return l(this,n),e.call(this,t)}return x(n,[{key:"styleExpanded",get:function(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!a(t)?"".concat(t,"px"):"auto"}},{key:"bindExpandedClass",value:function(t,e){var n=this;m(this,"expanded",(function(){n.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}],[{key:"create",value:function(t){var e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(A.createCore(e))}}]),n}(A);function rt(t){return it.create(t)}function at(t,e){var n=0;return Y(e,(function(){t.set("expandedHeight",null),t.set("temporaryExpanded",!0),W(e),n=e.clientHeight,t.set("temporaryExpanded",null),W(e)})),n}function ot(t,e){e.style.height=t.styleHeight}function st(t,e){t.value("expanded").emitter.on("beforechange",(function(){t.set("completed",!1),a(t.get("expandedHeight"))&&t.set("expandedHeight",at(t,e)),t.set("shouldFixHeight",!0),W(e)})),t.emitter.on("change",(function(){ot(t,e)})),ot(t,e),e.addEventListener("transitionend",(function(e){"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}var lt=function t(e,n){l(this,t);var i=p(n.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),n.viewProps.bindClassModifiers(this.element)},ut=function(t){L(n,t);var e=C(n);function n(t,i){var r;l(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{value:i.valueController.value,view:new tt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(nt),ct=p("");function ht(t,e){return _(t,ct(void 0,e))}var pt=function(t){L(n,t);var e=C(n);function n(t){return l(this,n),e.call(this,t)}return x(n,[{key:"bindClassModifiers",value:function(t){m(this,"disabled",ht(t,"disabled")),m(this,"hidden",ht(t,"hidden"))}},{key:"bindDisabled",value:function(t){m(this,"disabled",(function(e){t.disabled=e}))}},{key:"bindTabIndex",value:function(t){m(this,"disabled",(function(e){t.tabIndex=e?-1:0}))}},{key:"handleDispose",value:function(t){this.value("disposed").emitter.on("change",(function(e){e&&t()}))}}],[{key:"create",value:function(t){var e,i,r=null!=t?t:{},a={disabled:null!==(e=r.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=r.hidden)&&void 0!==i&&i};return new n(A.createCore(a))}}]),n}(A),vt=function(){function t(){l(this,t),this.disabled=!1,this.emitter=new c}return x(t,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),t}(),dt=function(){function t(e,n){l(this,t),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new c,this.interval_=n,this.setTimer_()}return x(t,[{key:"disabled",get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),t}(),ft=function(){function t(e){l(this,t),this.constraints=e}return x(t,[{key:"constrain",value:function(t){return this.constraints.reduce((function(t,e){return e.constrain(t)}),t)}}]),t}();function mt(t,e){if(t instanceof e)return t;if(t instanceof ft){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var bt=function(){function t(e){l(this,t),this.maxValue=e.max,this.minValue=e.min}return x(t,[{key:"constrain",value:function(t){var e=t;return a(this.minValue)||(e=Math.max(e,this.minValue)),a(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}]),t}(),_t=function(){function t(e){l(this,t),this.step=e}return x(t,[{key:"constrain",value:function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}]),t}(),gt=p("pop"),wt=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(gt()),n.viewProps.bindClassModifiers(this.element),f(n.shows,_(this.element,gt(void 0,"v")))},yt=function t(e,n){l(this,t),this.shows=T(!1),this.viewProps=n.viewProps,this.view=new wt(e,{shows:this.shows,viewProps:this.viewProps})},xt=p("txt"),kt=function(){function t(e,n){l(this,t),this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(xt()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var i=e.createElement("input");i.classList.add(xt("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return x(t,[{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Et=function(){function t(e,n){l(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new kt(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return x(t,[{key:"onInputChange_",value:function(t){var e=r(t.currentTarget).value,n=this.parser_(e);a(n)||(this.value.rawValue=n),this.view.refresh()}}]),t}(),Pt=function(){function t(e){l(this,t),this.text=e}return x(t,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),t}(),Ct={"**":function(t,e){return Math.pow(t,e)},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<<":function(t,e){return t<<e},">>":function(t,e){return t>>e},">>>":function(t,e){return t>>>e},"&":function(t,e){return t&e},"^":function(t,e){return t^e},"|":function(t,e){return t|e}},Mt=function(){function t(e,n,i){l(this,t),this.left=n,this.operator=e,this.right=i}return x(t,[{key:"evaluate",value:function(){var t=Ct[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),t}(),Vt={"+":function(t){return t},"-":function(t){return-t},"~":function(t){return~t}},Lt=function(){function t(e,n){l(this,t),this.operator=e,this.expression=n}return x(t,[{key:"evaluate",value:function(){var t=Vt[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),t}();function Tt(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i](e,n);if(""!==r)return r}return""}}function At(t,e){var n,i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function St(t,e){var n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Rt(t,e){var n,i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Dt(t,e){var n=Rt(t,e);if(""!==n)return n;var i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";var r=Rt(t,e+=1);return""===r?"":i+r}function zt(t,e){var n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";var i=Dt(t,e);return""===i?"":n+i}function Bt(t,e){var n=t.substr(e,1);if("0"===n)return n;var i=St(t,e);return e+=i.length,""===i?"":i+Rt(t,e)}function It(t,e){var n=Bt(t,e);if(e+=n.length,""===n)return"";var i=t.substr(e,1);if(e+=i.length,"."!==i)return"";var r=Rt(t,e);return n+i+r+zt(t,e+=r.length)}function Ut(t,e){var n=t.substr(e,1);if(e+=n.length,"."!==n)return"";var i=Rt(t,e);return e+=i.length,""===i?"":n+i+zt(t,e)}function Nt(t,e){var n=Bt(t,e);return e+=n.length,""===n?"":n+zt(t,e)}var jt=Tt([It,Ut,Nt]);function Ft(t,e){var n,i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ot(t,e){var n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";var i=Ft(t,e);return""===i?"":n+i}function Kt(t,e){var n,i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function qt(t,e){var n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";var i=Kt(t,e);return""===i?"":n+i}function Ht(t,e){var n,i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Gt(t,e){var n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";var i=Ht(t,e);return""===i?"":n+i}var Wt=Tt([Ot,qt,Gt]),Yt=Tt([Wt,jt]);function Xt(t,e){var n=Yt(t,e);return e+=n.length,""===n?null:{evaluable:new Pt(n),cursor:e}}function Zt(t,e){var n=t.substr(e,1);if(e+=n.length,"("!==n)return null;var i=ne(t,e);if(!i)return null;e=i.cursor,e+=At(t,e).length;var r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function $t(t,e){return Xt(t,e)||Zt(t,e)}function Qt(t,e){var n=$t(t,e);if(n)return n;var i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;var r=Qt(t,e);return r?{cursor:e=r.cursor,evaluable:new Lt(i,r.evaluable)}:null}function Jt(t,e,n){n+=At(e,n).length;var i=t.filter((function(t){return e.startsWith(t,n)}))[0];return i?(n+=i.length,{cursor:n+=At(e,n).length,operator:i}):null}function te(t,e){return function(n,i){var r=t(n,i);if(!r)return null;i=r.cursor;for(var a=r.evaluable;;){var o=Jt(e,n,i);if(!o)break;i=o.cursor;var s=t(n,i);if(!s)return null;i=s.cursor,a=new Mt(o.operator,a,s.evaluable)}return a?{cursor:i,evaluable:a}:null}}var ee=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(t,e){return te(t,e)}),Qt);function ne(t,e){return e+=At(t,e).length,ee(t,e)}function ie(t){var e=ne(t,0);return e?e.cursor+At(t,e.cursor).length!==t.length?null:e.evaluable:null}function re(t){var e,n=ie(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function ae(t){if("number"==typeof t)return t;if("string"==typeof t){var e=re(t);if(!a(e))return e}return 0}function oe(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}function se(t,e){for(;t.length<e;)t.push(void 0)}function le(t){var e=[];return se(e,t),T(e)}function ue(t){var e=t.indexOf(void 0);return r(e<0?t:t.slice(0,e))}function ce(t,e){var n=D(ue(t)).concat([e]);return n.length>t.length?n.splice(0,n.length-t.length):se(n,t.length),n}function he(t){var e=t.primary,n=t.secondary,i=t.forward,r=t.backward,a=!1;function o(t){a||(a=!0,t(),a=!1)}e.emitter.on("change",(function(t){o((function(){n.setRawValue(i(e,n),t.options)}))})),n.emitter.on("change",(function(t){o((function(){e.setRawValue(r(e,n),t.options)})),o((function(){n.setRawValue(i(e,n),t.options)}))})),o((function(){n.setRawValue(i(e,n),{forceEmit:!1,last:!0})}))}function pe(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function ve(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function de(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function fe(t){return"ArrowUp"===t||"ArrowDown"===t}function me(t){return fe(t)||"ArrowLeft"===t||"ArrowRight"===t}function be(t,e){var n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}var _e=function(){function t(e){l(this,t),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new c,e.addEventListener("touchstart",this.onTouchStart_),e.addEventListener("touchmove",this.onTouchMove_),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return x(t,[{key:"computePosition_",value:function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}},{key:"onMouseDown_",value:function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(be(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseMove_",value:function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(be(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseUp_",value:function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(be(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onTouchStart_",value:function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchMove_",value:function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchEnd_",value:function(t){var e,n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}]),t}();function ge(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function we(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function ye(t,e,n){return Math.min(Math.max(t,e),n)}var xe=p("txt"),ke=function(){function t(e,n){l(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(xe(),xe(void 0,"num")),n.arrayPosition&&this.element.classList.add(xe(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(xe("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(xe()),this.inputElement.classList.add(xe("i"));var r=e.createElement("div");r.classList.add(xe("k")),this.element.appendChild(r),this.knobElement=r;var a=e.createElementNS(G,"svg");a.classList.add(xe("g")),this.knobElement.appendChild(a);var o=e.createElementNS(G,"path");o.classList.add(xe("gb")),a.appendChild(o),this.guideBodyElem_=o;var s=e.createElementNS(G,"path");s.classList.add(xe("gh")),a.appendChild(s),this.guideHeadElem_=s;var u=e.createElement("div");u.classList.add(p("tt")()),this.knobElement.appendChild(u),this.tooltipElem_=u,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return x(t,[{key:"onDraggingChange_",value:function(t){if(null!==t.rawValue){this.element.classList.add(xe(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=ye(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+i,",0 L").concat(n,",4 L").concat(n+i,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")}else this.element.classList.remove(xe(void 0,"drg"))}},{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Ee=function(){function t(e,n){l(this,t),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=T(null),this.view=new ke(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new _e(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return x(t,[{key:"onInputChange_",value:function(t){var e=r(t.currentTarget).value,n=this.parser_(e);a(n)||(this.value.rawValue=n),this.view.refresh()}},{key:"onInputKeyDown_",value:function(t){var e=pe(this.baseStep_,ve(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(t){0!==pe(this.baseStep_,ve(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}},{key:"onPointerMove_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),t}();function Pe(t,e){t.write(e)}function Ce(t){var e=t?mt(t,_t):null;return e?e.step:null}function Me(t,e){var n=t&&mt(t,_t);return n?we(n.step):Math.max(we(e),2)}function Ve(t){var e=Ce(t);return null!=e?e:1}function Le(t,e){var n,i=t&&mt(t,_t),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}var Te=function(){function t(e){l(this,t),this.components=e.components,this.asm_=e.assembly}return x(t,[{key:"constrain",value:function(t){var e=this,n=this.asm_.toComponents(t).map((function(t,n){var i,r;return null!==(r=null===(i=e.components[n])||void 0===i?void 0:i.constrain(t))&&void 0!==r?r:t}));return this.asm_.fromComponents(n)}}]),t}(),Ae=p("pndtxt"),Se=function t(e,n){var i=this;l(this,t),this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(Ae()),this.textViews.forEach((function(t){var n=e.createElement("div");n.classList.add(Ae("a")),n.appendChild(t.element),i.element.appendChild(n)}))};function Re(t,e,n){return new Ee(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:T(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}var De=function t(e,n){var i=this;l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(t,i){return Re(e,n,i)})),this.acs_.forEach((function(t,e){he({primary:i.value,secondary:t.value,forward:function(t){return n.assembly.toComponents(t.rawValue)[e]},backward:function(t,i){var r=n.assembly.toComponents(t.rawValue);return r[e]=i.rawValue,n.assembly.fromComponents(r)}})})),this.view=new Se(e,{textViews:this.acs_.map((function(t){return t.view}))})};function ze(t){return"step"in t&&!a(t.step)?new _t(t.step):null}function Be(t){return"max"in t&&!a(t.max)||"min"in t&&!a(t.min)?new bt({max:t.max,min:t.min}):null}var Ie={monitor:{defaultInterval:200,defaultLineCount:3}},Ue=function(){function t(){l(this,t),this.emitter=new c,this.index_=-1}return x(t,[{key:"index",get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}]),t}(),Ne=p("grl"),je=function(){function t(e,n){l(this,t),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ne()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.minValue_=n.minValue,this.maxValue_=n.maxValue,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var i=e.createElementNS(G,"svg");i.classList.add(Ne("g")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),this.element.appendChild(i),this.svgElem_=i;var r=e.createElementNS(G,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var a=e.createElement("div");a.classList.add(Ne("t"),p("tt")()),this.element.appendChild(a),this.tooltipElem_=a,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return x(t,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach((function(a,o){if(void 0!==a){var s=ge(o,0,e,0,t.width),l=ge(a,n,i,t.height,0);r.push([s,l].join(","))}})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));var a=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0!==o){var s=ge(this.cursor_.index,0,e,0,t.width),l=ge(o,n,i,t.height,0);a.style.left="".concat(s,"px"),a.style.top="".concat(l,"px"),a.textContent="".concat(this.formatter_(o)),a.classList.contains(Ne("t","a"))||(a.classList.add(Ne("t","a"),Ne("t","in")),W(a),a.classList.remove(Ne("t","in")))}else a.classList.remove(Ne("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),t}(),Fe=function(){function t(e,n){if(l(this,t),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.cursor_=new Ue,this.view=new je(e,{cursor:this.cursor_,formatter:n.formatter,lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:this.viewProps}),X(e)){var i=new _e(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return x(t,[{key:"onGraphMouseLeave_",value:function(){this.cursor_.index=-1}},{key:"onGraphMouseMove_",value:function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(ge(t.offsetX,0,e.width,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(t){this.onGraphPointerMove_(t)}},{key:"onGraphPointerMove_",value:function(t){t.data.point?this.cursor_.index=Math.floor(ge(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.index=-1}}]),t}(),Oe=function(){function t(e){l(this,t),this.controller_=e}return x(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.props.set("title",t)}},{key:"on",value:function(t,e){var i=this,r=e.bind(this);return this.controller_.emitter.on(t,(function(){r(new n(i))})),this}}]),t}(),Ke=function(t){L(n,t);var e=C(n);function n(t,i,r){var a;return l(this,n),(a=e.call(this,t)).cell=i,a.index=r,a}return n}(n),qe=function(t){L(n,t);var e=C(n);function n(t){var i;l(this,n),(i=e.call(this,t)).cellToApiMap_=new Map,i.emitter_=new c;var r=i.controller_.valueController;return r.cellControllers.forEach((function(t,e){var n=new Oe(t);i.cellToApiMap_.set(t,n),t.emitter.on("click",(function(){var t=e%r.size[0],a=Math.floor(e/r.size[0]);i.emitter_.emit("click",{event:new Ke(s(i),n,[t,a])})}))})),i}return x(n,[{key:"cell",value:function(t,e){var n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(e),He=function(){function t(e,n){var i=this;l(this,t),this.size=n.size;for(var r=R(this.size,2),a=r[0],o=r[1],s=[],u=0;u<o;u++)for(var c=0;c<a;c++){var h=new E(e,{props:A.fromObject(Object.assign({},n.cellConfig(c,u))),viewProps:pt.create()});s.push(h)}this.cellCs_=s,this.viewProps=pt.create(),this.viewProps.handleDispose((function(){i.cellCs_.forEach((function(t){t.viewProps.set("disposed",!0)}))})),this.view=new lt(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns="repeat(".concat(a,", 1fr)"),this.cellCs_.forEach((function(t){i.view.element.appendChild(t.view.element)}))}return x(t,[{key:"cellControllers",get:function(){return this.cellCs_}}]),t}(),Ge={id:"buttongrid",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t){var e=N,n=j(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new et(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:new He(t.document,{cellConfig:t.params.cells,size:t.params.size})})},api:function(t){return t.controller instanceof et&&t.controller.valueController instanceof He?new qe(t.controller):null}},We=function(t){L(n,t);var e=C(n);function n(){return l(this,n),e.apply(this,arguments)}return x(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=this,r=e.bind(this);return this.controller_.valueController.value.emitter.on(t,(function(t){r(new i(n,t.rawValue,void 0,t.options.last))})),this}}]),n}(e);function Ye(t,e,n){return t*(1-n)+e*n}var Xe=20,Ze=.001,$e=100;function Qe(t,e){for(var n=.25,i=.5,r=-1,a=0;a<Xe;a++){var o=R(t.curve(i),2),s=o[0];if(i+=n*(s<e?1:-1),r=o[1],n*=.5,Math.abs(e-s)<Ze)break}return r}var Je=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;l(this,t),this.cache_=[],this.comps_=[e,n,i,r]}return x(t,[{key:"x1",get:function(){return this.comps_[0]}},{key:"y1",get:function(){return this.comps_[1]}},{key:"x2",get:function(){return this.comps_[2]}},{key:"y2",get:function(){return this.comps_[3]}},{key:"curve",value:function(t){var e=Ye(0,this.x1,t),n=Ye(0,this.y1,t),i=Ye(this.x1,this.x2,t),r=Ye(this.y1,this.y2,t),a=Ye(this.x2,1,t),o=Ye(this.y2,1,t),s=Ye(e,i,t),l=Ye(n,r,t),u=Ye(i,a,t),c=Ye(r,o,t);return[Ye(s,u,t),Ye(l,c,t)]}},{key:"y",value:function(t){if(0===this.cache_.length){for(var e=[],n=0;n<$e;n++)e.push(Qe(this,ge(n,0,$e-1,0,1)));this.cache_=e}return this.cache_[Math.round(ge(ye(t,0,1),0,1,0,$e-1))]}},{key:"toObject",value:function(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}],[{key:"isObject",value:function(t){return!a(t)&&!!Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}},{key:"equals",value:function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}}]),t}(),tn={toComponents:function(t){return t.toObject()},fromComponents:function(t){return w(Je,D(t))}};function en(t){var e=oe(2),n=t.toObject().map((function(t){return e(t)}));return"cubic-bezier(".concat(n.join(", "),")")}var nn=[0,.5,.5,1];function rn(t){var e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return w(Je,D(nn));var n=[e[1],e[2],e[3],e[4]].reduce((function(t,e){if(!t)return null;var n=Number(e);return isNaN(n)?null:D(t).concat([n])}),[]);return w(Je,D(null!=n?n:nn))}var an=p("cbz"),on=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(an()),n.viewProps.bindClassModifiers(this.element),n.foldable.bindExpandedClass(this.element,an(void 0,"expanded")),m(n.foldable,"completed",_(this.element,an(void 0,"cpl")));var i=e.createElement("div");i.classList.add(an("h")),this.element.appendChild(i);var r=e.createElement("button");r.classList.add(an("b")),n.viewProps.bindDisabled(r);var a=e.createElementNS(G,"svg");a.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',r.appendChild(a),i.appendChild(r),this.buttonElement=r;var o=e.createElement("div");if(o.classList.add(an("t")),i.appendChild(o),this.textElement=o,"inline"===n.pickerLayout){var s=e.createElement("div");s.classList.add(an("p")),this.element.appendChild(s),this.pickerElement=s}else this.pickerElement=null},sn=p("cbzp"),ln=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(sn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(sn("g")),this.element.appendChild(i),this.graphElement=i;var r=e.createElement("div");r.classList.add(sn("t")),this.element.appendChild(r),this.textElement=r};function un(t,e){var n=new MutationObserver((function(t){var i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;"childList"===l.type&&l.addedNodes.forEach((function(t){t.contains(t)&&(e(),n.disconnect())}))}}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}})),i=t.ownerDocument;n.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}var cn=p("cbzg");function hn(t,e){return function(n){return e(t(n))}}var pn=function(){function t(e,n){var i=this;l(this,t),this.element=e.createElement("div"),this.element.classList.add(cn()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(cn("p")),this.element.appendChild(r),this.previewElement=r;var a=e.createElementNS(G,"svg");a.classList.add(cn("g")),this.element.appendChild(a),this.svgElem_=a;var o=e.createElementNS(G,"path");o.classList.add(cn("u")),this.svgElem_.appendChild(o),this.guideElem_=o;var s=e.createElementNS(G,"polyline");s.classList.add(cn("l")),this.svgElem_.appendChild(s),this.lineElem_=s,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach((function(t){t.classList.add(cn("h")),i.element.appendChild(t)})),this.vectorElems_=[e.createElementNS(G,"line"),e.createElementNS(G,"line")],this.vectorElems_.forEach((function(t){t.classList.add(cn("v")),i.svgElem_.appendChild(t)})),this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=n.selection,this.handleElems_.forEach((function(t,e){f(i.sel_,hn((function(t){return t===e}),_(t,cn("h","sel"))))})),un(this.element,(function(){i.refresh()}))}return x(t,[{key:"getVertMargin_",value:function(t){return.25*t}},{key:"valueToPosition",value:function(t,e){var n=this.element.getBoundingClientRect(),i=n.width,r=n.height,a=this.getVertMargin_(r);return{x:ge(t,0,1,0,i),y:ge(e,0,1,r-a,a)}}},{key:"positionToValue",value:function(t,e){var n=this.element.getBoundingClientRect(),i=n.width,r=n.height,a=this.getVertMargin_(r);return{x:ye(ge(t,0,i,0,1),0,1),y:ge(e,r-a,a,0,1)}}},{key:"refresh",value:function(){var t=this;this.guideElem_.setAttributeNS(null,"d",[0,1].map((function(e){var n=t.valueToPosition(0,e),i=t.valueToPosition(1,e);return["M ".concat(n.x,",").concat(n.y),"L ".concat(i.x,",").concat(i.y)].join(" ")})).join(" "));for(var e=this.value_.rawValue,n=[],i=0;;){var r=this.valueToPosition.apply(this,D(e.curve(i)));if(n.push([r.x,r.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",n.join(" "));var a=e.toObject();[0,1].forEach((function(e){var n=t.valueToPosition(e,e),i=t.valueToPosition(a[2*e],a[2*e+1]),r=t.vectorElems_[e];r.setAttributeNS(null,"x1",String(n.x)),r.setAttributeNS(null,"y1",String(n.y)),r.setAttributeNS(null,"x2",String(i.x)),r.setAttributeNS(null,"y2",String(i.y));var o=t.handleElems_[e];o.style.left="".concat(i.x,"px"),o.style.top="".concat(i.y,"px")}))}},{key:"onValueChange_",value:function(){this.refresh()}}]),t}(),vn=24,dn=400,fn=1e3,mn=p("cbzprv"),bn=function(){function t(e,n){var i=this;l(this,t),this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(mn()),n.viewProps.bindClassModifiers(this.element);var r=e.createElementNS(G,"svg");r.classList.add(mn("g")),this.element.appendChild(r),this.svgElem_=r;var a=e.createElementNS(G,"path");a.classList.add(mn("t")),this.svgElem_.appendChild(a),this.ticksElem_=a;var o=e.createElement("div");o.classList.add(mn("m")),this.element.appendChild(o),this.markerElem_=o,this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_),n.viewProps.handleDispose(this.onDispose_),un(this.element,(function(){i.refresh()}))}return x(t,[{key:"play",value:function(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(mn("m","a")),this.startTime_=(new Date).getTime()+dn,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}},{key:"stop",value:function(){this.stopped_=!0,this.markerElem_.classList.remove(mn("m","a"))}},{key:"onDispose_",value:function(){this.stop()}},{key:"updateMarker_",value:function(t){var e=this.value_.rawValue.y(ye(t,0,1));this.markerElem_.style.left="".concat(100*e,"%")}},{key:"refresh",value:function(){for(var t=this.svgElem_.getBoundingClientRect(),e=t.width,n=t.height,i=[],r=this.value_.rawValue,a=0;a<vn;a++){var o=ge(a,0,vn-1,0,1),s=ge(r.y(o),0,1,0,e);i.push("M ".concat(s,",0 v").concat(n))}this.ticksElem_.setAttributeNS(null,"d",i.join(" "))}},{key:"onTimer_",value:function(){if(null!==this.startTime_){var t=(new Date).getTime()-this.startTime_,e=t/fn;this.updateMarker_(e),t>fn+dn&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}}},{key:"onValueChange_",value:function(){this.refresh(),this.play()}}]),t}();function _n(t,e,n,i){var r=n-t,a=i-e;return Math.sqrt(r*r+a*a)}function gn(t,e,n,i){var r=_n(t,e,n,i),a=Math.atan2(i-e,n-t),o=Math.round(a/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(o)*r,y:e+Math.sin(o)*r}}var wn=function(){function t(e,n){var i=this;l(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.value=n.value,this.sel_=T(0),this.viewProps=n.viewProps,this.view=new pn(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new bn(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(function(t){t.stopImmediatePropagation(),t.preventDefault(),i.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);var r=new _e(this.view.element);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}return x(t,[{key:"refresh",value:function(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}},{key:"updateValue_",value:function(t,e,n){var i=this.sel_.rawValue,r=this.value.rawValue.toObject(),a=this.view.positionToValue(t.x,t.y),o=e?gn(i,i,a.x,a.y):a;r[2*i]=o.x,r[2*i+1]=o.y,this.value.setRawValue(w(Je,D(r)),n)}},{key:"onPointerDown_",value:function(t){var e=t.data;if(e.point){var n=this.value.rawValue,i=this.view.valueToPosition(n.x1,n.y1),r=_n(e.point.x,e.point.y,i.x,i.y),a=this.view.valueToPosition(n.x2,n.y2),o=_n(e.point.x,e.point.y,a.x,a.y);this.sel_.rawValue=r<=o?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}}},{key:"onPointerMove_",value:function(t){var e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){var e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){me(t.key)&&t.preventDefault();var e=this.sel_.rawValue,n=this.value.rawValue.toObject();n[2*e]+=pe(this.baseStep_,de(t)),n[2*e+1]+=pe(this.baseStep_,ve(t)),this.value.setRawValue(w(Je,D(n)),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){me(t.key)&&t.preventDefault();var e=pe(this.baseStep_,de(t)),n=pe(this.baseStep_,ve(t));0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),yn=function(){function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new ln(e,{viewProps:this.viewProps}),this.gc_=new wn(e,{baseStep:n.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);var i=Object.assign(Object.assign({},n.axis),{constraint:new bt({max:1,min:0})}),r=Object.assign(Object.assign({},n.axis),{constraint:void 0});this.tc_=new De(e,{assembly:tn,axes:[i,r,i,r],parser:re,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}return x(t,[{key:"allFocusableElements",get:function(){return[this.gc_.view.element].concat(D(this.tc_.view.textViews.map((function(t){return t.inputElement}))))}},{key:"refresh",value:function(){this.gc_.refresh()}}]),t}(),xn=function(){function t(e,n){var i=this;l(this,t),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=rt(n.expanded),this.view=new on(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Et(e,{parser:rn,props:A.fromObject({formatter:en}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===n.pickerLayout?new yt(e,{viewProps:this.viewProps}):null;var r=new yn(e,{axis:n.axis,value:this.value,viewProps:this.viewProps});r.allFocusableElements.forEach((function(t){t.addEventListener("blur",i.onPopupChildBlur_),t.addEventListener("keydown",i.onPopupChildKeydown_)})),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),f(this.popC_.shows,(function(t){t&&r.refresh()})),he({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),st(this.foldable_,this.view.pickerElement))}return x(t,[{key:"onButtonBlur_",value:function(t){if(this.popC_){var e=r(t.relatedTarget);e&&this.popC_.view.element.contains(e)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=$(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!X(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}]),t}();function kn(){return new Te({assembly:tn,components:[0,1,2,3].map((function(t){return t%2==0?new bt({min:0,max:1}):void 0}))})}var En={id:"cubic-bezier",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t){var e=N,n=j(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((function(t){return"inline"===t||"popup"===t?t:void 0}))});return n?{params:n}:null},controller:function(t){var e,n,i=T(w(Je,D(t.params.value)),{constraint:kn(),equals:Je.equals}),r=new xn(t.document,{axis:{baseStep:.1,textProps:A.fromObject({draggingScale:.01,formatter:oe(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(n=t.params.picker)&&void 0!==n?n:"popup",value:i,viewProps:t.viewProps});return new ut(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:r})},api:function(t){return t.controller instanceof ut&&t.controller.valueController instanceof xn?new We(t.controller):null}},Pn=function(t){L(n,t);var e=C(n);function n(){return l(this,n),e.apply(this,arguments)}return x(n,[{key:"begin",value:function(){this.controller_.valueController.begin()}},{key:"end",value:function(){this.controller_.valueController.end()}}]),n}(e),Cn=20,Mn=function(){function t(){l(this,t),this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}return x(t,[{key:"duration",get:function(){return this.duration_}},{key:"fps",get:function(){return this.fps_}},{key:"begin",value:function(t){this.start_=t.getTime()}},{key:"calculateFps_",value:function(t){if(0===this.timestamps_.length)return null;var e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}},{key:"compactTimestamps_",value:function(){if(!(this.timestamps_.length<=Cn)){var t=this.timestamps_.length-Cn;this.timestamps_.splice(0,t);var e=this.timestamps_[0].frameCount;this.timestamps_.forEach((function(t){t.frameCount-=e})),this.frameCount_-=e}}},{key:"end",value:function(t){if(null!==this.start_){var e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}}]),t}(),Vn=p("fps"),Ln=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(Vn()),n.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(Vn("g")),this.element.appendChild(this.graphElement);var i=e.createElement("div");i.classList.add(Vn("l")),this.element.appendChild(i);var r=e.createElement("span");r.classList.add(Vn("v")),r.textContent="--",i.appendChild(r),this.valueElement=r;var a=e.createElement("span");a.classList.add(Vn("u")),a.textContent="FPS",i.appendChild(a)},Tn=function(){function t(e,n){var i=this;l(this,t),this.stopwatch_=new Mn,this.onTick_=this.onTick_.bind(this),this.ticker_=n.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=n.value,this.viewProps=n.viewProps,this.view=new Ln(e,{viewProps:this.viewProps}),this.graphC_=new Fe(e,{formatter:oe(0),lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((function(){i.graphC_.viewProps.set("disposed",!0),i.ticker_.dispose()}))}return x(t,[{key:"begin",value:function(){this.stopwatch_.begin(new Date)}},{key:"end",value:function(){this.stopwatch_.end(new Date)}},{key:"onTick_",value:function(){var t=this.stopwatch_.fps;if(null!==t){var e=this.value_.rawValue;this.value_.rawValue=ce(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}]),t}();function An(t,e){return 0===e?new vt:new dt(t,null!=e?e:Ie.monitor.defaultInterval)}var Sn={id:"fpsgraph",type:"blade",accept:function(t){var e=N,n=j(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return n?{params:n}:null},controller:function(t){var e,n,i,r,a=null!==(e=t.params.interval)&&void 0!==e?e:500;return new et(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:new Tn(t.document,{lineCount:null!==(n=t.params.lineCount)&&void 0!==n?n:2,maxValue:null!==(i=t.params.max)&&void 0!==i?i:90,minValue:null!==(r=t.params.min)&&void 0!==r?r:0,ticker:An(t.document,a),value:le(80),viewProps:t.viewProps})})},api:function(t){return t.controller instanceof et&&t.controller.valueController instanceof Tn?new Pn(t.controller):null}},Rn=function(){function t(e,n){l(this,t),this.min=e,this.max=n}return x(t,[{key:"length",get:function(){return this.max-this.min}},{key:"toObject",value:function(){return{min:this.min,max:this.max}}}],[{key:"isObject",value:function(t){if("object"!=typeof t||null===t)return!1;var e=t.min,n=t.max;return"number"==typeof e&&"number"==typeof n}},{key:"equals",value:function(t,e){return t.min===e.min&&t.max===e.max}}]),t}(),Dn={fromComponents:function(t){return new Rn(t[0],t[1])},toComponents:function(t){return[t.min,t.max]}},zn=function(){function t(e){l(this,t),this.edge=e}return x(t,[{key:"constrain",value:function(t){var e,n,i,r,a,o,s,l;if(t.min<=t.max)return new Rn(null!==(n=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==n?n:t.min,null!==(r=null===(i=this.edge)||void 0===i?void 0:i.constrain(t.max))&&void 0!==r?r:t.max);var u=(t.min+t.max)/2;return new Rn(null!==(o=null===(a=this.edge)||void 0===a?void 0:a.constrain(u))&&void 0!==o?o:u,null!==(l=null===(s=this.edge)||void 0===s?void 0:s.constrain(u))&&void 0!==l?l:u)}}]),t}(),Bn=p("rsltxt"),In=function t(e,n){l(this,t),this.sliderView_=n.sliderView,this.textView_=n.textView,this.element=e.createElement("div"),this.element.classList.add(Bn());var i=e.createElement("div");i.classList.add(Bn("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Bn("t")),r.appendChild(this.textView_.element),this.element.appendChild(r)},Un=p("rsl"),Nn=function(){function t(e,n){l(this,t),this.maxValue_=n.maxValue,this.minValue_=n.minValue,this.element=e.createElement("div"),this.element.classList.add(Un()),n.viewProps.bindClassModifiers(this.element),this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));var i=e.createElement("div");i.classList.add(Un("t")),this.element.appendChild(i),this.trackElement=i;var r=e.createElement("div");r.classList.add(Un("b")),i.appendChild(r),this.barElement=r;var a=["min","max"].map((function(t){var n=e.createElement("div");return n.classList.add(Un("k"),Un("k",t)),i.appendChild(n),n}));this.knobElements=[a[0],a[1]],this.update()}return x(t,[{key:"valueToX_",value:function(t){return 100*ye(ge(t,this.minValue_,this.maxValue_,0,1),0,1)}},{key:"update",value:function(){var t=this.value_.rawValue;0===t.length?this.element.classList.add(Un(void 0,"zero")):this.element.classList.remove(Un(void 0,"zero"));var e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left="".concat(e[0],"%"),this.barElement.style.right="".concat(100-e[1],"%"),this.knobElements.forEach((function(t,n){t.style.left="".concat(e[n],"%")}))}},{key:"onValueChange_",value:function(){this.update()}}]),t}(),jn=function(){function t(e,n){l(this,t),this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=n.maxValue,this.minValue_=n.minValue,this.viewProps=n.viewProps,this.value=n.value,this.view=new Nn(e,{maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:n.viewProps});var i=new _e(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return x(t,[{key:"ofs_",value:function(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}},{key:"valueFromData_",value:function(t){return t.point?ge((t.point.x+this.ofs_())/t.bounds.width,0,1,this.minValue_,this.maxValue_):null}},{key:"onPointerDown_",value:function(t){if(t.data.point){var e=t.data.point.x/t.data.bounds.width,n=this.value.rawValue,i=ge(n.min,this.minValue_,this.maxValue_,0,1),r=ge(n.max,this.minValue_,this.maxValue_,0,1);Math.abs(r-e)<=.025?this.grabbing_="max":Math.abs(i-e)<=.025?this.grabbing_="min":e>=i&&e<=r?(this.grabbing_="length",this.grabOffset_=ge(e-i,0,1,0,this.maxValue_-this.minValue_)):e<i?(this.grabbing_="min",this.onPointerMove_(t)):e>r&&(this.grabbing_="max",this.onPointerMove_(t))}}},{key:"applyPointToValue_",value:function(t,e){var n=this.valueFromData_(t);if(null!==n)if("min"===this.grabbing_)this.value.setRawValue(new Rn(n,this.value.rawValue.max),e);else if("max"===this.grabbing_)this.value.setRawValue(new Rn(this.value.rawValue.min,n),e);else if("length"===this.grabbing_){var i=this.value.rawValue.length,r=n-this.grabOffset_,a=r+i;r<this.minValue_?(r=this.minValue_,a=this.minValue_+i):a>this.maxValue_&&(r=this.maxValue_-i,a=this.maxValue_),this.value.setRawValue(new Rn(r,a),e)}}},{key:"onPointerMove_",value:function(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}]),t}(),Fn=function(){function t(e,n){l(this,t),this.value=n.value,this.viewProps=n.viewProps,this.sc_=new jn(e,n);var i={baseStep:n.baseStep,constraint:n.constraint,textProps:A.fromObject({draggingScale:n.draggingScale,formatter:n.formatter})};this.tc_=new De(e,{assembly:Dn,axes:[i,i],parser:n.parser,value:this.value,viewProps:n.viewProps}),this.view=new In(e,{sliderView:this.sc_.view,textView:this.tc_.view})}return x(t,[{key:"textController",get:function(){return this.tc_}}]),t}();function On(t){return Rn.isObject(t)?new Rn(t.min,t.max):new Rn(0,0)}function Kn(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function qn(t){var e=[],n=Be(t);n&&e.push(n);var i=ze(t);return i&&e.push(i),new zn(new ft(e))}var Hn={id:"input-interval",type:"input",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t,e){if(!Rn.isObject(t))return null;var n=N,i=j(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,step:n.optional.number});return i?{initialValue:new Rn(t.min,t.max),params:i}:null},binding:{reader:function(t){return On},constraint:function(t){return qn(t.params)},equals:Rn.equals,writer:function(t){return Kn}},controller:function(t){var e,n=t.value,i=t.constraint;if(!(i instanceof zn))throw u.shouldNeverHappen();var r=(n.rawValue.min+n.rawValue.max)/2,a=null!==(e=t.params.format)&&void 0!==e?e:oe(Me(i.edge,r)),o=i.edge&&mt(i.edge,bt);if(void 0!==(null==o?void 0:o.minValue)&&void 0!==(null==o?void 0:o.maxValue))return new Fn(t.document,{baseStep:Ve(i.edge),constraint:i.edge,draggingScale:Le(o,r),formatter:a,maxValue:o.maxValue,minValue:o.minValue,parser:re,value:n,viewProps:t.viewProps});var s={baseStep:Ve(i.edge),constraint:i.edge,textProps:A.fromObject({draggingScale:r,formatter:a})};return new De(t.document,{assembly:Dn,axes:[s,s],parser:re,value:n,viewProps:t.viewProps})}},Gn=function(){function t(e){l(this,t),this.controller_=e}return x(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.props.set("title",t)}}]),t}(),Wn=function(t){L(n,t);var e=C(n);function n(t,i,r,a,o){var s;return l(this,n),(s=e.call(this,t,a,o)).cell=i,s.index=r,s}return n}(i),Yn=function(t){L(n,t);var e=C(n);function n(t){var i;return l(this,n),(i=e.call(this,t)).cellToApiMap_=new Map,i.controller_.valueController.cellControllers.forEach((function(t){var e=new Gn(t);i.cellToApiMap_.set(t,e)})),i}return x(n,[{key:"value",get:function(){return this.controller_.value}},{key:"cell",value:function(t,e){var n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}},{key:"on",value:function(t,e){var n=this,i=e.bind(this);this.controller_.value.emitter.on(t,(function(t){var e=n.controller_.valueController,r=e.findCellByValue(t.rawValue);if(r){var a=n.cellToApiMap_.get(r);if(a){var o=e.cellControllers.indexOf(r);i(new Wn(n,a,[o%e.size[0],Math.floor(o/e.size[0])],t.rawValue,void 0))}}}))}}]),n}(e),Xn=p("rad"),Zn=function t(e,n){l(this,t),this.element=e.createElement("div"),this.element.classList.add(Xn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("label");i.classList.add(Xn("l")),this.element.appendChild(i);var r=e.createElement("input");r.classList.add(Xn("i")),r.name=n.name,r.type="radio",n.viewProps.bindDisabled(r),i.appendChild(r),this.inputElement=r;var a=e.createElement("div");a.classList.add(Xn("b")),i.appendChild(a);var o=e.createElement("div");o.classList.add(Xn("t")),a.appendChild(o),m(n.props,"title",(function(t){o.textContent=t}))},$n=function t(e,n){l(this,t),this.props=n.props,this.viewProps=n.viewProps,this.view=new Zn(e,{name:n.name,props:this.props,viewProps:this.viewProps})},Qn=function(){function t(e,n){var i=this;l(this,t),this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=n.size;for(var r=R(this.size,2),a=r[0],o=r[1],s=0;s<o;s++)for(var u=0;u<a;u++){var c=new $n(e,{name:n.groupName,props:A.fromObject(Object.assign({},n.cellConfig(u,s))),viewProps:pt.create()});this.cellCs_.push(c),this.cellValues_.push(n.cellConfig(u,s).value)}this.value=n.value,f(this.value,(function(t){var e=i.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=pt.create(),this.view=new lt(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns="repeat(".concat(a,", 1fr)"),this.cellCs_.forEach((function(t){t.view.inputElement.addEventListener("change",i.onCellInputChange_),i.view.element.appendChild(t.view.element)}))}return x(t,[{key:"cellControllers",get:function(){return this.cellCs_}},{key:"findCellByValue",value:function(t){var e=this.cellValues_.findIndex((function(e){return e===t}));return e<0?null:this.cellCs_[e]}},{key:"onCellInputChange_",value:function(t){var e=t.currentTarget,n=this.cellCs_.findIndex((function(t){return t.view.inputElement===e}));n<0||(this.value.rawValue=this.cellValues_[n])}}]),t}(),Jn={id:"radiogrid",type:"blade",accept:function(t){var e=N,n=j(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new ut(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:new Qn(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:T(t.params.value)})})},api:function(t){return t.controller instanceof ut&&t.controller.valueController instanceof Qn?new Yn(t.controller):null}},ti=[Ge,En,Sn,Hn,Jn,{id:"input-radiogrid",type:"input",accept:function(t,e){if("number"!=typeof t)return null;var n=N,i=j(e,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return ae},writer:function(t){return Pe}},controller:function(t){return new Qn(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}];t.CubicBezier=Je,t.plugins=ti,Object.defineProperty(t,"__esModule",{value:!0})}(z);var B={};t(B,"create",(function(){return j})),t(B,"clone",(function(){return F})),t(B,"copy",(function(){return O})),t(B,"fromValues",(function(){return K})),t(B,"set",(function(){return q})),t(B,"identity",(function(){return H})),t(B,"transpose",(function(){return G})),t(B,"invert",(function(){return W})),t(B,"adjoint",(function(){return Y})),t(B,"determinant",(function(){return X})),t(B,"multiply",(function(){return Z})),t(B,"translate",(function(){return $})),t(B,"scale",(function(){return Q})),t(B,"rotate",(function(){return J})),t(B,"rotateX",(function(){return tt})),t(B,"rotateY",(function(){return et})),t(B,"rotateZ",(function(){return nt})),t(B,"fromTranslation",(function(){return it})),t(B,"fromScaling",(function(){return rt})),t(B,"fromRotation",(function(){return at})),t(B,"fromXRotation",(function(){return ot})),t(B,"fromYRotation",(function(){return st})),t(B,"fromZRotation",(function(){return lt})),t(B,"fromRotationTranslation",(function(){return ut})),t(B,"fromQuat2",(function(){return ct})),t(B,"getTranslation",(function(){return ht})),t(B,"getScaling",(function(){return pt})),t(B,"getRotation",(function(){return vt})),t(B,"fromRotationTranslationScale",(function(){return dt})),t(B,"fromRotationTranslationScaleOrigin",(function(){return ft})),t(B,"fromQuat",(function(){return mt})),t(B,"frustum",(function(){return bt})),t(B,"perspectiveNO",(function(){return _t})),t(B,"perspective",(function(){return gt})),t(B,"perspectiveZO",(function(){return wt})),t(B,"perspectiveFromFieldOfView",(function(){return yt})),t(B,"orthoNO",(function(){return xt})),t(B,"ortho",(function(){return kt})),t(B,"orthoZO",(function(){return Et})),t(B,"lookAt",(function(){return Pt})),t(B,"targetTo",(function(){return Ct})),t(B,"str",(function(){return Mt})),t(B,"frob",(function(){return Vt})),t(B,"add",(function(){return Lt})),t(B,"subtract",(function(){return Tt})),t(B,"multiplyScalar",(function(){return At})),t(B,"multiplyScalarAndAdd",(function(){return St})),t(B,"exactEquals",(function(){return Rt})),t(B,"equals",(function(){return Dt})),t(B,"mul",(function(){return zt})),t(B,"sub",(function(){return Bt}));var I=1e-6,U="undefined"!=typeof Float32Array?Float32Array:Array,N=Math.random;Math.PI;function j(){var t=new U(16);return U!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function F(t){var e=new U(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function O(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function K(t,e,n,i,r,a,o,s,l,u,c,h,p,v,d,f){var m=new U(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=r,m[5]=a,m[6]=o,m[7]=s,m[8]=l,m[9]=u,m[10]=c,m[11]=h,m[12]=p,m[13]=v,m[14]=d,m[15]=f,m}function q(t,e,n,i,r,a,o,s,l,u,c,h,p,v,d,f,m){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=p,t[12]=v,t[13]=d,t[14]=f,t[15]=m,t}function H(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=r,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function W(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],v=e[11],d=e[12],f=e[13],m=e[14],b=e[15],_=n*s-i*o,g=n*l-r*o,w=n*u-a*o,y=i*l-r*s,x=i*u-a*s,k=r*u-a*l,E=c*f-h*d,P=c*m-p*d,C=c*b-v*d,M=h*m-p*f,V=h*b-v*f,L=p*b-v*m,T=_*L-g*V+w*M+y*C-x*P+k*E;return T?(T=1/T,t[0]=(s*L-l*V+u*M)*T,t[1]=(r*V-i*L-a*M)*T,t[2]=(f*k-m*x+b*y)*T,t[3]=(p*x-h*k-v*y)*T,t[4]=(l*C-o*L-u*P)*T,t[5]=(n*L-r*C+a*P)*T,t[6]=(m*w-d*k-b*g)*T,t[7]=(c*k-p*w+v*g)*T,t[8]=(o*V-s*C+u*E)*T,t[9]=(i*C-n*V-a*E)*T,t[10]=(d*x-f*w+b*_)*T,t[11]=(h*w-c*x-v*_)*T,t[12]=(s*P-o*M-l*E)*T,t[13]=(n*M-i*P+r*E)*T,t[14]=(f*g-d*y-m*_)*T,t[15]=(c*y-h*g+p*_)*T,t):null}function Y(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],v=e[11],d=e[12],f=e[13],m=e[14],b=e[15];return t[0]=s*(p*b-v*m)-h*(l*b-u*m)+f*(l*v-u*p),t[1]=-(i*(p*b-v*m)-h*(r*b-a*m)+f*(r*v-a*p)),t[2]=i*(l*b-u*m)-s*(r*b-a*m)+f*(r*u-a*l),t[3]=-(i*(l*v-u*p)-s*(r*v-a*p)+h*(r*u-a*l)),t[4]=-(o*(p*b-v*m)-c*(l*b-u*m)+d*(l*v-u*p)),t[5]=n*(p*b-v*m)-c*(r*b-a*m)+d*(r*v-a*p),t[6]=-(n*(l*b-u*m)-o*(r*b-a*m)+d*(r*u-a*l)),t[7]=n*(l*v-u*p)-o*(r*v-a*p)+c*(r*u-a*l),t[8]=o*(h*b-v*f)-c*(s*b-u*f)+d*(s*v-u*h),t[9]=-(n*(h*b-v*f)-c*(i*b-a*f)+d*(i*v-a*h)),t[10]=n*(s*b-u*f)-o*(i*b-a*f)+d*(i*u-a*s),t[11]=-(n*(s*v-u*h)-o*(i*v-a*h)+c*(i*u-a*s)),t[12]=-(o*(h*m-p*f)-c*(s*m-l*f)+d*(s*p-l*h)),t[13]=n*(h*m-p*f)-c*(i*m-r*f)+d*(i*p-r*h),t[14]=-(n*(s*m-l*f)-o*(i*m-r*f)+d*(i*l-r*s)),t[15]=n*(s*p-l*h)-o*(i*p-r*h)+c*(i*l-r*s),t}function X(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11],v=t[12],d=t[13],f=t[14],m=t[15];return(e*o-n*a)*(h*m-p*f)-(e*s-i*a)*(c*m-p*d)+(e*l-r*a)*(c*f-h*d)+(n*s-i*o)*(u*m-p*v)-(n*l-r*o)*(u*f-h*v)+(i*l-r*s)*(u*d-c*v)}function Z(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],v=e[10],d=e[11],f=e[12],m=e[13],b=e[14],_=e[15],g=n[0],w=n[1],y=n[2],x=n[3];return t[0]=g*i+w*s+y*h+x*f,t[1]=g*r+w*l+y*p+x*m,t[2]=g*a+w*u+y*v+x*b,t[3]=g*o+w*c+y*d+x*_,g=n[4],w=n[5],y=n[6],x=n[7],t[4]=g*i+w*s+y*h+x*f,t[5]=g*r+w*l+y*p+x*m,t[6]=g*a+w*u+y*v+x*b,t[7]=g*o+w*c+y*d+x*_,g=n[8],w=n[9],y=n[10],x=n[11],t[8]=g*i+w*s+y*h+x*f,t[9]=g*r+w*l+y*p+x*m,t[10]=g*a+w*u+y*v+x*b,t[11]=g*o+w*c+y*d+x*_,g=n[12],w=n[13],y=n[14],x=n[15],t[12]=g*i+w*s+y*h+x*f,t[13]=g*r+w*l+y*p+x*m,t[14]=g*a+w*u+y*v+x*b,t[15]=g*o+w*c+y*d+x*_,t}function $(t,e,n){var i,r,a,o,s,l,u,c,h,p,v,d,f=n[0],m=n[1],b=n[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*b+e[12],t[13]=e[1]*f+e[5]*m+e[9]*b+e[13],t[14]=e[2]*f+e[6]*m+e[10]*b+e[14],t[15]=e[3]*f+e[7]*m+e[11]*b+e[15]):(i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],v=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=v,t[11]=d,t[12]=i*f+s*m+h*b+e[12],t[13]=r*f+l*m+p*b+e[13],t[14]=a*f+u*m+v*b+e[14],t[15]=o*f+c*m+d*b+e[15]),t}function Q(t,e,n){var i=n[0],r=n[1],a=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function J(t,e,n,i){var r,a,o,s,l,u,c,h,p,v,d,f,m,b,_,g,w,y,x,k,E,P,C,M,V=i[0],L=i[1],T=i[2],A=Math.hypot(V,L,T);return A<I?null:(V*=A=1/A,L*=A,T*=A,r=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],l=e[1],u=e[2],c=e[3],h=e[4],p=e[5],v=e[6],d=e[7],f=e[8],m=e[9],b=e[10],_=e[11],g=V*V*o+a,w=L*V*o+T*r,y=T*V*o-L*r,x=V*L*o-T*r,k=L*L*o+a,E=T*L*o+V*r,P=V*T*o+L*r,C=L*T*o-V*r,M=T*T*o+a,t[0]=s*g+h*w+f*y,t[1]=l*g+p*w+m*y,t[2]=u*g+v*w+b*y,t[3]=c*g+d*w+_*y,t[4]=s*x+h*k+f*E,t[5]=l*x+p*k+m*E,t[6]=u*x+v*k+b*E,t[7]=c*x+d*k+_*E,t[8]=s*P+h*C+f*M,t[9]=l*P+p*C+m*M,t[10]=u*P+v*C+b*M,t[11]=c*P+d*C+_*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function tt(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+u*i,t[5]=o*r+c*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=u*r-a*i,t[9]=c*r-o*i,t[10]=h*r-s*i,t[11]=p*r-l*i,t}function et(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-u*i,t[1]=o*r-c*i,t[2]=s*r-h*i,t[3]=l*r-p*i,t[8]=a*i+u*r,t[9]=o*i+c*r,t[10]=s*i+h*r,t[11]=l*i+p*r,t}function nt(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+u*i,t[1]=o*r+c*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=u*r-a*i,t[5]=c*r-o*i,t[6]=h*r-s*i,t[7]=p*r-l*i,t}function it(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function rt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function at(t,e,n){var i,r,a,o=n[0],s=n[1],l=n[2],u=Math.hypot(o,s,l);return u<I?null:(o*=u=1/u,s*=u,l*=u,i=Math.sin(e),a=1-(r=Math.cos(e)),t[0]=o*o*a+r,t[1]=s*o*a+l*i,t[2]=l*o*a-s*i,t[3]=0,t[4]=o*s*a-l*i,t[5]=s*s*a+r,t[6]=l*s*a+o*i,t[7]=0,t[8]=o*l*a+s*i,t[9]=s*l*a-o*i,t[10]=l*l*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function ot(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function st(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ut(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=i+i,l=r+r,u=a+a,c=i*s,h=i*l,p=i*u,v=r*l,d=r*u,f=a*u,m=o*s,b=o*l,_=o*u;return t[0]=1-(v+f),t[1]=h+_,t[2]=p-b,t[3]=0,t[4]=h-_,t[5]=1-(c+f),t[6]=d+m,t[7]=0,t[8]=p+b,t[9]=d-m,t[10]=1-(c+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ct(t,e){var n=new U(3),i=-e[0],r=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=i*i+r*r+a*a+o*o;return h>0?(n[0]=2*(s*o+c*i+l*a-u*r)/h,n[1]=2*(l*o+c*r+u*i-s*a)/h,n[2]=2*(u*o+c*a+s*r-l*i)/h):(n[0]=2*(s*o+c*i+l*a-u*r),n[1]=2*(l*o+c*r+u*i-s*a),n[2]=2*(u*o+c*a+s*r-l*i)),ut(t,e,n),t}function ht(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function pt(t,e){var n=e[0],i=e[1],r=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,u,c),t}function vt(t,e){var n=new U(3);pt(n,e);var i=1/n[0],r=1/n[1],a=1/n[2],o=e[0]*i,s=e[1]*r,l=e[2]*a,u=e[4]*i,c=e[5]*r,h=e[6]*a,p=e[8]*i,v=e[9]*r,d=e[10]*a,f=o+c+d,m=0;return f>0?(m=2*Math.sqrt(f+1),t[3]=.25*m,t[0]=(h-v)/m,t[1]=(p-l)/m,t[2]=(s-u)/m):o>c&&o>d?(m=2*Math.sqrt(1+o-c-d),t[3]=(h-v)/m,t[0]=.25*m,t[1]=(s+u)/m,t[2]=(p+l)/m):c>d?(m=2*Math.sqrt(1+c-o-d),t[3]=(p-l)/m,t[0]=(s+u)/m,t[1]=.25*m,t[2]=(h+v)/m):(m=2*Math.sqrt(1+d-o-c),t[3]=(s-u)/m,t[0]=(p+l)/m,t[1]=(h+v)/m,t[2]=.25*m),t}function dt(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=e[3],l=r+r,u=a+a,c=o+o,h=r*l,p=r*u,v=r*c,d=a*u,f=a*c,m=o*c,b=s*l,_=s*u,g=s*c,w=i[0],y=i[1],x=i[2];return t[0]=(1-(d+m))*w,t[1]=(p+g)*w,t[2]=(v-_)*w,t[3]=0,t[4]=(p-g)*y,t[5]=(1-(h+m))*y,t[6]=(f+b)*y,t[7]=0,t[8]=(v+_)*x,t[9]=(f-b)*x,t[10]=(1-(h+d))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ft(t,e,n,i,r){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,c=o+o,h=s+s,p=a*u,v=a*c,d=a*h,f=o*c,m=o*h,b=s*h,_=l*u,g=l*c,w=l*h,y=i[0],x=i[1],k=i[2],E=r[0],P=r[1],C=r[2],M=(1-(f+b))*y,V=(v+w)*y,L=(d-g)*y,T=(v-w)*x,A=(1-(p+b))*x,S=(m+_)*x,R=(d+g)*k,D=(m-_)*k,z=(1-(p+f))*k;return t[0]=M,t[1]=V,t[2]=L,t[3]=0,t[4]=T,t[5]=A,t[6]=S,t[7]=0,t[8]=R,t[9]=D,t[10]=z,t[11]=0,t[12]=n[0]+E-(M*E+T*P+R*C),t[13]=n[1]+P-(V*E+A*P+D*C),t[14]=n[2]+C-(L*E+S*P+z*C),t[15]=1,t}function mt(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n+n,s=i+i,l=r+r,u=n*o,c=i*o,h=i*s,p=r*o,v=r*s,d=r*l,f=a*o,m=a*s,b=a*l;return t[0]=1-h-d,t[1]=c+b,t[2]=p-m,t[3]=0,t[4]=c-b,t[5]=1-u-d,t[6]=v+f,t[7]=0,t[8]=p+m,t[9]=v-f,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bt(t,e,n,i,r,a,o){var s=1/(n-e),l=1/(r-i),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function _t(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=(r+i)*a,t[14]=2*r*i*a):(t[10]=-1,t[14]=-2*i),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var gt=_t;function wt(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=r*a,t[14]=r*i*a):(t[10]=-1,t[14]=-i),t}function yt(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(r+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-s)*l*.5,t[9]=(r-a)*u*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function xt(t,e,n,i,r,a,o){var s=1/(e-n),l=1/(i-r),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(o+a)*u,t[15]=1,t}var kt=xt;function Et(t,e,n,i,r,a,o){var s=1/(e-n),l=1/(i-r),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=a*u,t[15]=1,t}function Pt(t,e,n,i){var r,a,o,s,l,u,c,h,p,v,d=e[0],f=e[1],m=e[2],b=i[0],_=i[1],g=i[2],w=n[0],y=n[1],x=n[2];return Math.abs(d-w)<I&&Math.abs(f-y)<I&&Math.abs(m-x)<I?H(t):(c=d-w,h=f-y,p=m-x,r=_*(p*=v=1/Math.hypot(c,h,p))-g*(h*=v),a=g*(c*=v)-b*p,o=b*h-_*c,(v=Math.hypot(r,a,o))?(r*=v=1/v,a*=v,o*=v):(r=0,a=0,o=0),s=h*o-p*a,l=p*r-c*o,u=c*a-h*r,(v=Math.hypot(s,l,u))?(s*=v=1/v,l*=v,u*=v):(s=0,l=0,u=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=p,t[11]=0,t[12]=-(r*d+a*f+o*m),t[13]=-(s*d+l*f+u*m),t[14]=-(c*d+h*f+p*m),t[15]=1,t)}function Ct(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=i[0],l=i[1],u=i[2],c=r-n[0],h=a-n[1],p=o-n[2],v=c*c+h*h+p*p;v>0&&(c*=v=1/Math.sqrt(v),h*=v,p*=v);var d=l*p-u*h,f=u*c-s*p,m=s*h-l*c;return(v=d*d+f*f+m*m)>0&&(d*=v=1/Math.sqrt(v),f*=v,m*=v),t[0]=d,t[1]=f,t[2]=m,t[3]=0,t[4]=h*m-p*f,t[5]=p*d-c*m,t[6]=c*f-h*d,t[7]=0,t[8]=c,t[9]=h,t[10]=p,t[11]=0,t[12]=r,t[13]=a,t[14]=o,t[15]=1,t}function Mt(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Vt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Lt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Tt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function At(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function St(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function Rt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Dt(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],v=t[11],d=t[12],f=t[13],m=t[14],b=t[15],_=e[0],g=e[1],w=e[2],y=e[3],x=e[4],k=e[5],E=e[6],P=e[7],C=e[8],M=e[9],V=e[10],L=e[11],T=e[12],A=e[13],S=e[14],R=e[15];return Math.abs(n-_)<=I*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-g)<=I*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(r-w)<=I*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(a-y)<=I*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(o-x)<=I*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-k)<=I*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-E)<=I*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-P)<=I*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(c-C)<=I*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-M)<=I*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(p-V)<=I*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(v-L)<=I*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(d-T)<=I*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(f-A)<=I*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-S)<=I*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(b-R)<=I*Math.max(1,Math.abs(b),Math.abs(R))}var zt=Z,Bt=Tt,It={};t(It,"create",(function(){return Be})),t(It,"identity",(function(){return Ie})),t(It,"setAxisAngle",(function(){return Ue})),t(It,"getAxisAngle",(function(){return Ne})),t(It,"getAngle",(function(){return je})),t(It,"dot",(function(){return bn})),t(It,"multiply",(function(){return Fe})),t(It,"rotateX",(function(){return Oe})),t(It,"rotateY",(function(){return Ke})),t(It,"rotateZ",(function(){return qe})),t(It,"calculateW",(function(){return He})),t(It,"exp",(function(){return Ge})),t(It,"ln",(function(){return We})),t(It,"pow",(function(){return Ye})),t(It,"scale",(function(){return mn})),t(It,"slerp",(function(){return Xe})),t(It,"random",(function(){return Ze})),t(It,"invert",(function(){return $e})),t(It,"conjugate",(function(){return Qe})),t(It,"fromMat3",(function(){return Je})),t(It,"fromEuler",(function(){return tn})),t(It,"str",(function(){return en})),t(It,"clone",(function(){return cn})),t(It,"fromValues",(function(){return hn})),t(It,"copy",(function(){return pn})),t(It,"set",(function(){return vn})),t(It,"add",(function(){return dn})),t(It,"mul",(function(){return fn})),t(It,"lerp",(function(){return _n})),t(It,"length",(function(){return gn})),t(It,"len",(function(){return wn})),t(It,"squaredLength",(function(){return yn})),t(It,"sqrLen",(function(){return xn})),t(It,"normalize",(function(){return kn})),t(It,"exactEquals",(function(){return En})),t(It,"equals",(function(){return Pn})),t(It,"rotationTo",(function(){return Cn})),t(It,"sqlerp",(function(){return Mn})),t(It,"setAxes",(function(){return Vn}));var Ut={};function Nt(){var t=new U(3);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jt(t){var e=new U(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ft(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function Ot(t,e,n){var i=new U(3);return i[0]=t,i[1]=e,i[2]=n,i}function Kt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qt(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Ht(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Gt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Wt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Yt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Xt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Zt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function $t(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Qt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Jt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function te(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function ee(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function ne(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function ie(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function re(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function ae(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function oe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function se(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function le(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ue(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=r*l-a*s,t[1]=a*o-i*l,t[2]=i*s-r*o,t}function ce(t,e,n,i){var r=e[0],a=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=o+i*(n[2]-o),t}function he(t,e,n,i,r,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),c=o*(3-2*a);return t[0]=e[0]*s+n[0]*l+i[0]*u+r[0]*c,t[1]=e[1]*s+n[1]*l+i[1]*u+r[1]*c,t[2]=e[2]*s+n[2]*l+i[2]*u+r[2]*c,t}function pe(t,e,n,i,r,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,h=3*l*o,p=l*a;return t[0]=e[0]*u+n[0]*c+i[0]*h+r[0]*p,t[1]=e[1]*u+n[1]*c+i[1]*h+r[1]*p,t[2]=e[2]*u+n[2]*c+i[2]*h+r[2]*p,t}function ve(t,e){e=e||1;var n=2*N()*Math.PI,i=2*N()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function de(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[3]*i+n[7]*r+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/o,t}function fe(t,e,n){var i=e[0],r=e[1],a=e[2];return t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8],t}function me(t,e,n){var i=n[0],r=n[1],a=n[2],o=n[3],s=e[0],l=e[1],u=e[2],c=r*u-a*l,h=a*s-i*u,p=i*l-r*s,v=r*p-a*h,d=a*c-i*p,f=i*h-r*c,m=2*o;return c*=m,h*=m,p*=m,v*=2,d*=2,f*=2,t[0]=s+c+v,t[1]=l+h+d,t[2]=u+p+f,t}function be(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0],a[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),a[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function _e(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),a[1]=r[1],a[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ge(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),a[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),a[2]=r[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function we(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(a*a+o*o+s*s),u=l&&le(t,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function ye(t){return t[0]=0,t[1]=0,t[2]=0,t}function xe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function ke(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Ee(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=I*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=I*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-s)<=I*Math.max(1,Math.abs(r),Math.abs(s))}t(Ut,"create",(function(){return Nt})),t(Ut,"clone",(function(){return jt})),t(Ut,"length",(function(){return Ft})),t(Ut,"fromValues",(function(){return Ot})),t(Ut,"copy",(function(){return Kt})),t(Ut,"set",(function(){return qt})),t(Ut,"add",(function(){return Ht})),t(Ut,"subtract",(function(){return Gt})),t(Ut,"multiply",(function(){return Wt})),t(Ut,"divide",(function(){return Yt})),t(Ut,"ceil",(function(){return Xt})),t(Ut,"floor",(function(){return Zt})),t(Ut,"min",(function(){return $t})),t(Ut,"max",(function(){return Qt})),t(Ut,"round",(function(){return Jt})),t(Ut,"scale",(function(){return te})),t(Ut,"scaleAndAdd",(function(){return ee})),t(Ut,"distance",(function(){return ne})),t(Ut,"squaredDistance",(function(){return ie})),t(Ut,"squaredLength",(function(){return re})),t(Ut,"negate",(function(){return ae})),t(Ut,"inverse",(function(){return oe})),t(Ut,"normalize",(function(){return se})),t(Ut,"len",(function(){return Ae})),t(Ut,"dot",(function(){return le})),t(Ut,"cross",(function(){return ue})),t(Ut,"lerp",(function(){return ce})),t(Ut,"hermite",(function(){return he})),t(Ut,"bezier",(function(){return pe})),t(Ut,"random",(function(){return ve})),t(Ut,"transformMat4",(function(){return de})),t(Ut,"transformMat3",(function(){return fe})),t(Ut,"transformQuat",(function(){return me})),t(Ut,"rotateX",(function(){return be})),t(Ut,"rotateY",(function(){return _e})),t(Ut,"rotateZ",(function(){return ge})),t(Ut,"angle",(function(){return we})),t(Ut,"zero",(function(){return ye})),t(Ut,"str",(function(){return xe})),t(Ut,"exactEquals",(function(){return ke})),t(Ut,"equals",(function(){return Ee})),t(Ut,"sub",(function(){return Ce})),t(Ut,"mul",(function(){return Me})),t(Ut,"div",(function(){return Ve})),t(Ut,"dist",(function(){return Le})),t(Ut,"sqrDist",(function(){return Te})),t(Ut,"sqrLen",(function(){return Se})),t(Ut,"forEach",(function(){return Re}));var Pe,Ce=Gt,Me=Wt,Ve=Yt,Le=ne,Te=ie,Ae=Ft,Se=re,Re=(Pe=Nt(),function(t,e,n,i,r,a){var o,s;for(e||(e=3),n||(n=0),s=i?Math.min(i*e+n,t.length):t.length,o=n;o<s;o+=e)Pe[0]=t[o],Pe[1]=t[o+1],Pe[2]=t[o+2],r(Pe,Pe,a),t[o]=Pe[0],t[o+1]=Pe[1],t[o+2]=Pe[2];return t});function De(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function ze(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}!function(){var t,e=(t=new U(4),U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function Be(){var t=new U(4);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ie(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ue(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Ne(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>I?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function je(t,e){var n=bn(t,e);return Math.acos(2*n*n-1)}function Fe(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=n[0],l=n[1],u=n[2],c=n[3];return t[0]=i*c+o*s+r*u-a*l,t[1]=r*c+o*l+a*s-i*u,t[2]=a*c+o*u+i*l-r*s,t[3]=o*c-i*s-r*l-a*u,t}function Oe(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*s,t[1]=r*l+a*s,t[2]=a*l-r*s,t[3]=o*l-i*s,t}function Ke(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l-a*s,t[1]=r*l+o*s,t[2]=a*l+i*s,t[3]=o*l-r*s,t}function qe(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*s,t[1]=r*l-i*s,t[2]=a*l+o*s,t[3]=o*l-a*s,t}function He(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Ge(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=Math.sqrt(n*n+i*i+r*r),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0;return t[0]=n*l,t[1]=i*l,t[2]=r*l,t[3]=s*Math.cos(o),t}function We(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=Math.sqrt(n*n+i*i+r*r),s=o>0?Math.atan2(o,a)/o:0;return t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=.5*Math.log(n*n+i*i+r*r+a*a),t}function Ye(t,e,n){return We(t,e),mn(t,t,n),Ge(t,t),t}function Xe(t,e,n,i){var r,a,o,s,l,u=e[0],c=e[1],h=e[2],p=e[3],v=n[0],d=n[1],f=n[2],m=n[3];return(a=u*v+c*d+h*f+p*m)<0&&(a=-a,v=-v,d=-d,f=-f,m=-m),1-a>I?(r=Math.acos(a),o=Math.sin(r),s=Math.sin((1-i)*r)/o,l=Math.sin(i*r)/o):(s=1-i,l=i),t[0]=s*u+l*v,t[1]=s*c+l*d,t[2]=s*h+l*f,t[3]=s*p+l*m,t}function Ze(t){var e=N(),n=N(),i=N(),r=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*i),t[3]=a*Math.cos(2*Math.PI*i),t}function $e(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=a*s,t}function Qe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Je(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var a=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*a+a]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+r]+e[3*r+a])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t}function tn(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return t[0]=a*l*c-o*s*u,t[1]=o*s*c+a*l*u,t[2]=o*l*u-a*s*c,t[3]=o*l*c+a*s*u,t}function en(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var nn,rn,an,on,sn,ln,un,cn=function(t){var e=new U(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},hn=function(t,e,n,i){var r=new U(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},pn=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},vn=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},dn=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},fn=Fe,mn=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},bn=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},_n=function(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=o+i*(n[2]-o),t[3]=s+i*(n[3]-s),t},gn=De,wn=gn,yn=ze,xn=yn,kn=function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=a*o,t},En=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Pn=function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(n-o)<=I*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=I*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-l)<=I*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-u)<=I*Math.max(1,Math.abs(a),Math.abs(u))},Cn=(nn=Nt(),rn=Ot(1,0,0),an=Ot(0,1,0),function(t,e,n){var i=le(e,n);return i<-.999999?(ue(nn,rn,e),Ae(nn)<1e-6&&ue(nn,an,e),se(nn,nn),Ue(t,nn,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ue(nn,e,n),t[0]=nn[0],t[1]=nn[1],t[2]=nn[2],t[3]=1+i,kn(t,t))}),Mn=(on=Be(),sn=Be(),function(t,e,n,i,r,a){return Xe(on,e,r,a),Xe(sn,n,i,a),Xe(t,on,sn,2*a*(1-a)),t}),Vn=(ln=new U(9),U!=Float32Array&&(ln[1]=0,ln[2]=0,ln[3]=0,ln[5]=0,ln[6]=0,ln[7]=0),ln[0]=1,ln[4]=1,ln[8]=1,un=ln,function(t,e,n,i){return un[0]=n[0],un[3]=n[1],un[6]=n[2],un[1]=i[0],un[4]=i[1],un[7]=i[2],un[2]=-e[0],un[5]=-e[1],un[8]=-e[2],kn(t,Je(t,un))}),Ln={};function Tn(){var t=new U(2);return U!=Float32Array&&(t[0]=0,t[1]=0),t}function An(t){var e=new U(2);return e[0]=t[0],e[1]=t[1],e}function Sn(t,e){var n=new U(2);return n[0]=t,n[1]=e,n}function Rn(t,e){return t[0]=e[0],t[1]=e[1],t}function Dn(t,e,n){return t[0]=e,t[1]=n,t}function zn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Bn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function In(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Un(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Nn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function jn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Fn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function On(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function Kn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function qn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Hn(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function Gn(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}function Wn(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function Yn(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Xn(t){var e=t[0],n=t[1];return e*e+n*n}function Zn(t,e){return t[0]=-e[0],t[1]=-e[1],t}function $n(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Qn(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}function Jn(t,e){return t[0]*e[0]+t[1]*e[1]}function ti(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t}function ei(t,e,n,i){var r=e[0],a=e[1];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t}function ni(t,e){e=e||1;var n=2*N()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function ii(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function ri(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function ai(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function oi(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}function si(t,e,n,i){var r=e[0]-n[0],a=e[1]-n[1],o=Math.sin(i),s=Math.cos(i);return t[0]=r*s-a*o+n[0],t[1]=r*o+a*s+n[1],t}function li(t,e){var n=t[0],i=t[1],r=e[0],a=e[1],o=Math.sqrt(n*n+i*i)*Math.sqrt(r*r+a*a),s=o&&(n*r+i*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function ui(t){return t[0]=0,t[1]=0,t}function ci(t){return"vec2("+t[0]+", "+t[1]+")"}function hi(t,e){return t[0]===e[0]&&t[1]===e[1]}function pi(t,e){var n=t[0],i=t[1],r=e[0],a=e[1];return Math.abs(n-r)<=I*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-a)<=I*Math.max(1,Math.abs(i),Math.abs(a))}t(Ln,"create",(function(){return Tn})),t(Ln,"clone",(function(){return An})),t(Ln,"fromValues",(function(){return Sn})),t(Ln,"copy",(function(){return Rn})),t(Ln,"set",(function(){return Dn})),t(Ln,"add",(function(){return zn})),t(Ln,"subtract",(function(){return Bn})),t(Ln,"multiply",(function(){return In})),t(Ln,"divide",(function(){return Un})),t(Ln,"ceil",(function(){return Nn})),t(Ln,"floor",(function(){return jn})),t(Ln,"min",(function(){return Fn})),t(Ln,"max",(function(){return On})),t(Ln,"round",(function(){return Kn})),t(Ln,"scale",(function(){return qn})),t(Ln,"scaleAndAdd",(function(){return Hn})),t(Ln,"distance",(function(){return Gn})),t(Ln,"squaredDistance",(function(){return Wn})),t(Ln,"length",(function(){return Yn})),t(Ln,"squaredLength",(function(){return Xn})),t(Ln,"negate",(function(){return Zn})),t(Ln,"inverse",(function(){return $n})),t(Ln,"normalize",(function(){return Qn})),t(Ln,"len",(function(){return vi})),t(Ln,"dot",(function(){return Jn})),t(Ln,"cross",(function(){return ti})),t(Ln,"lerp",(function(){return ei})),t(Ln,"random",(function(){return ni})),t(Ln,"transformMat2",(function(){return ii})),t(Ln,"transformMat2d",(function(){return ri})),t(Ln,"transformMat3",(function(){return ai})),t(Ln,"transformMat4",(function(){return oi})),t(Ln,"rotate",(function(){return si})),t(Ln,"angle",(function(){return li})),t(Ln,"zero",(function(){return ui})),t(Ln,"str",(function(){return ci})),t(Ln,"exactEquals",(function(){return hi})),t(Ln,"equals",(function(){return pi})),t(Ln,"sub",(function(){return di})),t(Ln,"mul",(function(){return fi})),t(Ln,"div",(function(){return mi})),t(Ln,"dist",(function(){return bi})),t(Ln,"sqrDist",(function(){return _i})),t(Ln,"sqrLen",(function(){return gi})),t(Ln,"forEach",(function(){return wi}));var vi=Yn,di=Bn,fi=In,mi=Un,bi=Gn,_i=Wn,gi=Xn,wi=function(){var t=Tn();return function(e,n,i,r,a,o){var s,l;for(n||(n=2),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,s=i;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}();function yi(t,e,n,i){var r=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach((function(n,i){var a=function(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.error(t.getShaderInfoLog(i)),t.deleteShader(i)}(t,n,e[i]);t.attachShader(r,a)})),n&&t.transformFeedbackVaryings(r,n,t.SEPARATE_ATTRIBS),i)for(var a in i)t.bindAttribLocation(r,i[a],a);if(t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS))return r;console.error(t.getProgramInfoLog(r)),t.deleteProgram(r)}function xi(t,e,n){var i=t.createVertexArray();t.bindVertexArray(i);var r=!0,a=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=R(s.value,3),c=u[0],h=u[1],p=u[2];-1!=h&&(t.bindBuffer(t.ARRAY_BUFFER,c),t.enableVertexAttribArray(h),t.vertexAttribPointer(h,p,t.FLOAT,!1,0,0))}}catch(t){a=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}if(n){var v=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,v),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),t.STATIC_DRAW)}return t.bindVertexArray(null),i}function ki(t,e,n){var i=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,n),t.bindBuffer(t.ARRAY_BUFFER,null),i}function Ei(t,e,n){var i=t.createFramebuffer(),r=[];return t.bindFramebuffer(t.FRAMEBUFFER,i),e.forEach((function(e,n){var i=t["COLOR_ATTACHMENT".concat(n)];t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,e,0),r.push(i)})),n&&t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,n,0),t.drawBuffers(r),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup",t.checkFramebufferStatus(t.FRAMEBUFFER)),t.bindFramebuffer(t.FRAMEBUFFER,null),i}function Pi(t,e,n,i){t.bindFramebuffer(t.FRAMEBUFFER,e),t.viewport(0,0,n,i)}function Ci(t,e,n,i,r){var a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),a}var Mi=new WeakSet,Vi=function(){"use strict";function t(e,n){var i=this;l(this,t),f(this,Mi),M(this,"rotationQuat",It.create()),this.canvas=e,this.updateCallback=n||function(){return null},this.pointerDown=!1,this.pointerDownPos=Ln.create(),this.pointerPos=Ln.create(),this.followPos=Ut.create(),this.prevFollowPos=Ut.create(),this.autoRotationSpeed=0,this.velocity=.0025,this.rotationAxis=Ut.fromValues(0,1,0),e.style.touchAction="none",e.addEventListener("pointerdown",(function(t){i.pointerDownPos=Ln.fromValues(t.clientX,t.clientY),i.followPos=Ut.fromValues(t.clientX,t.clientY,0),i.pointerPos=Ln.fromValues(t.clientX,t.clientY),i.prevFollowPos=Ut.fromValues(t.clientX,t.clientY,0),i.pointerDown=!0,i.autoRotationSpeed=0})),e.addEventListener("pointerup",(function(t){i.pointerDown=!1})),e.addEventListener("pointerleave",(function(t){i.pointerDown=!1})),e.addEventListener("pointermove",(function(t){i.pointerDown&&(i.pointerPos[0]=t.clientX,i.pointerPos[1]=t.clientY)}))}return x(t,[{key:"update",value:function(t){var e,n=16/(t+.01),i=10*n;if(this.followPos[0]+=(this.pointerPos[0]-this.followPos[0])/i,this.followPos[1]+=(this.pointerPos[1]-this.followPos[1])/i,this.pointerDown){var r=d(this,Mi,Li).call(this,this.followPos),a=d(this,Mi,Li).call(this,this.prevFollowPos),o=Ut.normalize(Ut.create(),r),s=Ut.normalize(Ut.create(),a),l=Ut.cross(Ut.create(),r,a);Ut.normalize(l,l);var u=Math.max(-1,Math.min(1,Ut.dot(o,s))),c=Math.acos(u)*n*5;this.velocity=c,this.rotationAxis=Ut.clone(l),e=It.setAxisAngle(It.create(),l,c)}else this.velocity*=this.velocity>.0075?.99:1,e=It.setAxisAngle(It.create(),this.rotationAxis,this.velocity);It.multiply(this.rotationQuat,e,this.rotationQuat),It.normalize(this.rotationQuat,this.rotationQuat),this.prevFollowPos=Ut.clone(this.followPos),this.updateCallback()}}]),t}();function Li(t){var e=this.canvas.clientWidth,n=this.canvas.clientHeight,i=Math.max(e,n)-1,r=(2*t[0]-e-1)/i,a=(2*t[1]-n-1)/i,o=0,s=r*r+a*a;return o=s<=.5?Math.sqrt(1-s):.5/Math.sqrt(s),Ut.fromValues(-r,a,o)}var Ti=new WeakMap,Ai=new WeakMap,Si=new WeakMap,Ri=new WeakMap,Di=new WeakMap,zi=new WeakMap,Bi=new WeakMap,Ii=new WeakMap,Ui=new WeakMap,Ni=new WeakSet,ji=new WeakSet,Fi=new WeakSet,Oi=function t(){"use strict";var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:13,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1.5;l(this,t),f(this,Ni),f(this,ji),f(this,Fi),M(this,"height",50),M(this,"radius",20),M(this,"bevelRadius",13),M(this,"radiusSegments",32),M(this,"bevelSegments",8),p(this,Ti,{writable:!0,value:void 0}),p(this,Ai,{writable:!0,value:void 0}),p(this,Si,{writable:!0,value:void 0}),p(this,Ri,{writable:!0,value:void 0}),p(this,Di,{writable:!0,value:void 0}),p(this,zi,{writable:!0,value:void 0}),p(this,Bi,{writable:!0,value:[]}),p(this,Ii,{writable:!0,value:[]}),p(this,Ui,{writable:!0,value:[]}),this.height=e,this.radius=n,this.bevelRadius=i,history.radiusSegments=r,this.bevelSegments=a,this.normalBendFactor=o,v(this,Ti,this.height/2),v(this,Ai,this.radius-this.bevelRadius),v(this,Si,2*Math.PI/this.radiusSegments),v(this,Ri,.5*Math.PI/(this.bevelSegments+1)),v(this,Di,c(this,Ri)*this.normalBendFactor),v(this,zi,(.5*Math.PI-2*c(this,Di))/(this.bevelSegments+1)),d(this,Ni,Ki).call(this,!0),d(this,ji,qi).call(this,!0),d(this,Ni,Ki).call(this,!1),d(this,ji,qi).call(this,!1),d(this,Fi,Hi).call(this),this.vertices=new Float32Array(c(this,Bi)),this.normals=new Float32Array(c(this,Ui)),this.indices=new Uint16Array(c(this,Ii))};function Ki(){var t,e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=n?c(this,Ti):-c(this,Ti),r=Ut.fromValues(0,Math.sign(i),0),a=Ut.fromValues(0,i,0),o=(t=c(this,Bi)).push.apply(t,D(a))/3-1;(e=c(this,Ui)).push.apply(e,D(r));for(var s=0;s<this.radiusSegments;++s){var l,u,h=s*c(this,Si),p=c(this,Ai)*Math.cos(h),v=c(this,Ai)*Math.sin(h);(l=c(this,Bi)).push.apply(l,D(Ut.fromValues(p,a[1],v)));var d=.5*Math.PI-c(this,Di),f=Math.sin(d),m=Math.cos(d)*Math.cos(h),b=Math.cos(d)*Math.sin(h),_=Ut.fromValues(m,n?f:-f,b),g=Ut.normalize(Ut.create(),_);(u=c(this,Ui)).push.apply(u,D(g)),n?c(this,Ii).push(o,o+(s+1)%this.radiusSegments+1,o+s+1):c(this,Ii).push(o,o+s+1,o+(s+1)%this.radiusSegments+1)}}function qi(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=c(this,Bi).length/3,n=(this.bevelSegments+2)*this.radiusSegments,i=t?c(this,Ti)-this.bevelRadius:this.bevelRadius-c(this,Ti),r=0,a=0;a<this.radiusSegments;++a)for(var o=a*c(this,Si),s=c(this,Ai)*Math.cos(o),l=c(this,Ai)*Math.sin(o),u=Ut.fromValues(s,i,l),h=0;h<=this.bevelSegments+1;++h){var p,v,d=.5*Math.PI-h*c(this,Ri),f=this.bevelRadius*Math.sin(d),m=this.bevelRadius*Math.cos(d)*Math.cos(o),b=this.bevelRadius*Math.cos(d)*Math.sin(o),_=Ut.fromValues(m,t?f:-f,b),g=Ut.add(Ut.create(),u,_);(p=c(this,Bi)).push.apply(p,D(g));var w=.5*Math.PI-c(this,Di)-h*c(this,zi),y=this.bevelRadius*Math.sin(w),x=this.bevelRadius*Math.cos(w)*Math.cos(o),k=this.bevelRadius*Math.cos(w)*Math.sin(o),E=Ut.fromValues(x,t?y:-y,k),P=Ut.normalize(Ut.create(),E);if((v=c(this,Ui)).push.apply(v,D(P)),h<=this.bevelSegments){var C=(r+(this.bevelSegments+2))%n;t?(c(this,Ii).push(e+r,e+C,e+C+1),c(this,Ii).push(e+r,e+C+1,e+r+1)):(c(this,Ii).push(e+r,e+C+1,e+C),c(this,Ii).push(e+r,e+r+1,e+C+1))}r++}}function Hi(){for(var t=c(this,Bi).length/3,e=0,n=0;n<this.radiusSegments;++n){var i,r,a,o,s=n*c(this,Si),l=this.radius*Math.cos(s),u=this.radius*Math.sin(s),h=Ut.fromValues(l,c(this,Ti)-this.bevelRadius,u),p=Ut.fromValues(l,this.bevelRadius-c(this,Ti),u),v=c(this,Di),d=Math.sin(v),f=Math.cos(v)*Math.cos(s),m=Math.cos(v)*Math.sin(s),b=Ut.fromValues(f,d,m),_=Ut.fromValues(f,-d,m),g=Ut.normalize(Ut.create(),b),w=Ut.normalize(Ut.create(),_);Ut.normalize(Ut.create(),Ut.fromValues(l,0,u));(i=c(this,Bi)).push.apply(i,D(h)),(r=c(this,Bi)).push.apply(r,D(p)),(a=c(this,Ui)).push.apply(a,D(g)),(o=c(this,Ui)).push.apply(o,D(w));var y=(e+2)%(2*this.radiusSegments);c(this,Ii).push(t+e,t+y,t+y+1),c(this,Ii).push(t+e,t+y+1,t+e+1),e+=2}}var Gi=new WeakMap,Wi=new WeakMap,Yi=new WeakMap,Xi=function(){"use strict";function t(e,n,i,r){l(this,t),p(this,Gi,{writable:!0,value:100}),p(this,Wi,{writable:!0,value:0}),p(this,Yi,{writable:!0,value:[]}),this.a0=e,this.c0=n,this.c1=i,this.a1=r;var a=this.pointAt(0);c(this,Yi).push(0);for(var o=1;o<=c(this,Gi);++o){var s=o/c(this,Gi),u=this.pointAt(s);c(this,Yi)[o]=c(this,Yi)[o-1]+Ut.distance(a,u),a=u}v(this,Wi,c(this,Yi)[c(this,Gi)])}return x(t,[{key:"pointAt",value:function(t){var e=t*t,n=e*t,i=3*e-n-3*t+1,r=3*n-6*e+3*t,a=-3*n+3*e,o=n,s=Ut.scale(Ut.create(),this.a0,i),l=Ut.scale(Ut.create(),this.c0,r),u=Ut.scale(Ut.create(),this.c1,a),c=Ut.scale(Ut.create(),this.a1,o),h=Ut.add(Ut.create(),s,l),p=Ut.add(Ut.create(),u,c);return Ut.add(Ut.create(),h,p)}},{key:"velocityAt",value:function(t){var e=t*t,n=-3*e+6*t-3,i=9*e-12*t+3,r=-9*e+6*t,a=3*e,o=Ut.scale(Ut.create(),this.a0,n),s=Ut.scale(Ut.create(),this.c0,i),l=Ut.scale(Ut.create(),this.c1,r),u=Ut.scale(Ut.create(),this.a1,a),c=Ut.add(Ut.create(),o,s),h=Ut.add(Ut.create(),l,u);return Ut.add(Ut.create(),c,h)}},{key:"map",value:function(t){for(var e=t*c(this,Wi),n=c(this,Gi),i=0,r=0;i<n;)r=i+((n-i)/2|0),c(this,Yi)[r]<e?i=r+1:n=r;c(this,Yi)[r]>e&&r--;var a=c(this,Yi)[r];return a===e?r/c(this,Gi):(r+(e-a)/(c(this,Yi)[r+1]-a))/c(this,Gi)}}]),t}(),Zi=(Bi=new WeakMap,Ii=new WeakMap,Ui=new WeakMap,new WeakMap),$i=new WeakMap,Qi=new WeakMap,Ji=new WeakMap,tr=new WeakSet,er=function(){"use strict";function t(){l(this,t),f(this,tr),p(this,Bi,{writable:!0,value:[]}),p(this,Ii,{writable:!0,value:[]}),p(this,Ui,{writable:!0,value:[]}),p(this,Zi,{writable:!0,value:[]}),p(this,$i,{writable:!0,value:10}),p(this,Qi,{writable:!0,value:7.5}),p(this,Ji,{writable:!0,value:20}),M(this,"contourBezierPoints",{a0:[0,0,0],c0:[0,.4,0],a1:[0,1,-1],c1:[0,.4,.1]});for(var e=0;e<=12;++e)for(var n=e/12,i=0;i<=8;++i){var r,a,o=(4-i)/4,s=d(this,tr,nr).call(this,o),u=s.map(n),h=s.pointAt(u),v=Ut.normalize(Ut.create(),s.velocityAt(u)),m=Math.sqrt(2-o*o),b=-h[0],_=h[1],g=h[2]+1.5*(1-n*n*n)*(1-m);(r=c(this,Bi)).push.apply(r,D(Ut.fromValues(b,_,g)));var w=Ut.normalize(Ut.create(),Ut.fromValues(-b,0,-g)),y=v[2]/v[1],x=Ut.rotateX(Ut.create(),w,Ut.fromValues(0,0,0),Math.atan(y));(a=c(this,Ui)).push.apply(a,D(x)),c(this,Zi).push(o,n)}for(var k=0;k<12;++k)for(var E=0;E<8;++E)c(this,Ii).push(9*k+E,9*k+E+1,9*(k+1)+E+1),c(this,Ii).push(9*(k+1)+E+1,9*(k+1)+E,9*k+E);this.vertices=new Float32Array(c(this,Bi)),this.normals=new Float32Array(c(this,Ui)),this.uvs=new Float32Array(c(this,Zi)),this.indices=new Uint16Array(c(this,Ii))}return x(t,[{key:"extent",get:function(){var t=D(this.contourBezierPoints.a1);return t[1]*=c(this,$i),t[2]*=c(this,Ji),t}}]),t}();function nr(t){var e=.02*c(this,Qi),n=D(this.contourBezierPoints.a0),i=D(this.contourBezierPoints.c0),r=D(this.contourBezierPoints.a1),a=D(this.contourBezierPoints.c1);return n[0]=e*t,i[0]=n[0],a[0]=c(this,Qi)*t,i[1]=i[1]*c(this,$i),a[1]=a[1]*c(this,$i),r[1]=r[1]*c(this,$i),r[2]*=c(this,Ji),a[2]*=c(this,Ji),new Xi(n,i,a,r)}var ir,rr=function(){"use strict";function t(n){l(this,t),this.gl=n,this.program=yi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\n\nvoid main() {\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(1., 0., 0., 1.);\n}\n")],null,{a_position:0}),this.locations={a_position:n.getAttribLocation(this.program,"a_position"),u_worldMatrix:n.getUniformLocation(this.program,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.program,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.program,"u_projectionMatrix")}}return x(t,[{key:"render",value:function(t,e,n,i,r){var a=this.gl;a.useProgram(this.program),a.enable(a.CULL_FACE),a.enable(a.DEPTH_TEST),a.uniformMatrix4fv(this.locations.u_worldMatrix,!1,t),a.uniformMatrix4fv(this.locations.u_viewMatrix,!1,e),a.uniformMatrix4fv(this.locations.u_projectionMatrix,!1,n),a.bindVertexArray(i),a.drawArrays(a.LINE_STRIP,0,r)}}]),t}();ir="#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\nin mat4 a_instanceMatrix;\n\nout vec3 v_position;\nout vec3 v_viewPosition;\nout vec3 v_normal;\nout vec3 v_viewNormal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (u_worldInverseTransposeMatrix * a_instanceMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = u_worldMatrix * a_instanceMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n    v_position = a_position.xyz;\n    v_viewPosition = viewPosition.xyz;\n    v_viewNormal = (u_viewMatrix * vec4(v_normal, 0.)).xyz;\n\n    gl_PointSize = 2.;\n}\n";var ar;ar="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform mat4 u_inversProjectionMatrix;\nuniform float u_frames;\nuniform sampler2D u_gradientTexture;\n\nin vec3 v_position;\nin vec3 v_normal;\nin vec3 v_viewNormal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\nin vec3 v_viewPosition;\n\nout vec4 outColor;\n\n#define PI 3.1415926535\n\nvoid main() {\n    vec3 pos = v_position;\n    vec3 N = normalize(v_normal);\n    vec3 VN = normalize(v_viewNormal);\n    vec3 V = normalize(v_surfaceToView);\n    vec3 L = normalize(vec3(0., .5, 4.));\n    float NdL = max(0., dot(N, L));\n\n    // the albedo term from the leaf gradient with some distortion\n    vec2 uv = vec2(v_uv.y, v_uv.x);\n    // apply line texture\n    uv.x += sin(v_uv.x * PI * 5.) * 0.1;\n    vec4 albedo = texture(u_gradientTexture, uv);\n    // darken the edges\n    albedo *= min(1., 1. - pow(uv.y, 2.) * 0.1 + uv.x * 0.1);\n\n    // the diffuse term\n    float diffuse = (NdL * NdL * NdL) * 0.1 + .95;\n\n    outColor = albedo * diffuse;\n}\n";var or={rand_vect:function(){var t=2*Math.random()*Math.PI;return{x:Math.cos(t),y:Math.sin(t)}},dot_prod_grid:function(t,e,n,i){var r,a=t-n,o=e-i;return this.gradients[[n,i]]?r=this.gradients[[n,i]]:(r=this.rand_vect(),this.gradients[[n,i]]=r),a*r.x+o*r.y},smootherstep:function(t){return 6*Math.pow(t,5)-15*Math.pow(t,4)+10*Math.pow(t,3)},interp:function(t,e,n){return e+this.smootherstep(t)*(n-e)},seed:function(){this.gradients={},this.memory={}},get:function(t,e){if(this.memory.hasOwnProperty([t,e]))return this.memory[[t,e]];var n=Math.floor(t),i=Math.floor(e),r=this.dot_prod_grid(t,e,n,i),a=this.dot_prod_grid(t,e,n+1,i),o=this.dot_prod_grid(t,e,n,i+1),s=this.dot_prod_grid(t,e,n+1,i+1),l=this.interp(t-n,r,a),u=this.interp(t-n,o,s),c=this.interp(e-i,l,u);return this.memory[[t,e]]=c,c}};or.seed();var sr=function(t){return--t*t*t+1},lr=new WeakMap,ur=new WeakMap,cr=new WeakMap,hr=new WeakSet,pr=new WeakSet,vr=new WeakSet,dr=new WeakSet,fr=new WeakSet,mr=new WeakSet,br=new WeakSet,_r=function(){"use strict";function t(n,i,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;l(this,t),f(this,hr),f(this,pr),f(this,vr),f(this,dr),f(this,fr),f(this,mr),f(this,br),p(this,lr,{writable:!0,value:18}),p(this,ur,{writable:!0,value:2}),p(this,cr,{writable:!0,value:c(this,lr)*c(this,ur)}),M(this,"leafInstances",void 0),M(this,"onLeafGrow",void 0),M(this,"onLeafWither",void 0),M(this,"onPlantGrow",void 0),this.context=n,this.vesselHeight=i,this.vesselRadius=r,this.vesselBevelRadius=a,this.animationDoneCallback=o,this.modelMatrix=B.translate(B.create(),B.create(),Ut.fromValues(0,-this.vesselHeight/2,0));var s=this.context;this.leafProgram=yi(s,[e(ir),e(ar)],null,{a_position:0,a_normal:1,a_uv:2}),this.leafLocations={a_position:s.getAttribLocation(this.leafProgram,"a_position"),a_normal:s.getAttribLocation(this.leafProgram,"a_normal"),a_uv:s.getAttribLocation(this.leafProgram,"a_uv"),a_instanceMatrix:s.getAttribLocation(this.leafProgram,"a_instanceMatrix"),u_worldMatrix:s.getUniformLocation(this.leafProgram,"u_worldMatrix"),u_viewMatrix:s.getUniformLocation(this.leafProgram,"u_viewMatrix"),u_projectionMatrix:s.getUniformLocation(this.leafProgram,"u_projectionMatrix"),u_inversProjectionMatrix:s.getUniformLocation(this.leafProgram,"u_inversProjectionMatrix"),u_worldInverseTransposeMatrix:s.getUniformLocation(this.leafProgram,"u_worldInverseTransposeMatrix"),u_cameraPosition:s.getUniformLocation(this.leafProgram,"u_cameraPosition"),u_gradientTexture:s.getUniformLocation(this.leafProgram,"u_gradientTexture")},this.leafGeometry=new er,this.leafBuffers={position:ki(s,this.leafGeometry.vertices,s.STATIC_DRAW),normal:ki(s,this.leafGeometry.normals,s.STATIC_DRAW),uv:ki(s,this.leafGeometry.uvs,s.STATIC_DRAW),numElem:this.leafGeometry.indices.length},this.leafVAO=xi(s,[[this.leafBuffers.position,this.leafLocations.a_position,3],[this.leafBuffers.normal,this.leafLocations.a_normal,3],[this.leafBuffers.uv,this.leafLocations.a_uv,2]],this.leafGeometry.indices),this.leafGradientTexture=Ci(s,s.LINEAR,s.LINEAR,s.MIRRORED_REPEAT,s.MIRRORED_REPEAT);var u=new Uint8Array([221,255,185,134,224,69,114,214,80,134,224,69,134,224,69,211,245,144,225,255,174]);s.bindTexture(s.TEXTURE_2D,this.leafGradientTexture),s.texImage2D(s.TEXTURE_2D,0,s.RGB,7,1,0,s.RGB,s.UNSIGNED_BYTE,u),d(this,hr,gr).call(this)}return x(t,[{key:"generate",value:function(t){d(this,pr,wr).call(this),d(this,vr,yr).call(this,t),this.onPlantGrow&&this.onPlantGrow()}},{key:"update",value:function(t){d(this,dr,xr).call(this,t)}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=B.multiply(B.create(),t.worldMatrix,this.modelMatrix);e&&this.geometryHelper.render(n,t.viewMatrix,t.projectionMatrix,this.stemVAO,this.stemBuffers.numElem),d(this,fr,kr).call(this,t,n)}}]),t}();function gr(){var t=this.context;this.leafInstances={matricesArray:new Float32Array(16*c(this,cr)),matrices:[],bindMatrices:[],buffer:t.createBuffer(),animationParams:[]};for(var e=c(this,cr),n=0;n<e;++n){var i=new Float32Array(this.leafInstances.matricesArray.buffer,64*n,16);i.set(B.create()),this.leafInstances.matrices.push(i),this.leafInstances.bindMatrices.push(B.create())}t.bindVertexArray(this.leafVAO),t.bindBuffer(t.ARRAY_BUFFER,this.leafInstances.buffer),t.bufferData(t.ARRAY_BUFFER,this.leafInstances.matricesArray.byteLength,t.DYNAMIC_DRAW);for(var r=0;r<4;++r){var a=this.leafLocations.a_instanceMatrix+r;t.enableVertexAttribArray(a),t.vertexAttribPointer(a,4,t.FLOAT,!1,64,16*r),t.vertexAttribDivisor(a,1)}t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null)}function wr(){var t=this.vesselHeight/2,e=2*Math.random()*Math.PI,n=Math.random()*(this.vesselRadius-this.vesselBevelRadius),i=Ut.fromValues(n*Math.cos(e),0,n*Math.sin(e));e=2*Math.random()*Math.PI;var r=Ut.fromValues(n*Math.cos(e),this.vesselHeight,n*Math.sin(e)),a=.1*this.vesselBevelRadius;e=2*Math.random()*Math.PI;var o=Math.random()*(t-a)+a,s=Math.random()*this.vesselRadius,l=Ut.fromValues(s*Math.cos(e),o,s*Math.sin(e));e=2*Math.random()*Math.PI,o=Math.random()*(t-a)+t;var u=Math.random()*this.vesselRadius,h=Ut.fromValues(u*Math.cos(e),o,u*Math.sin(e)),p=this.context;this.stemVertices=[],this.stemCurve=new Xi(i,l,h,r);for(var v=0;v<=c(this,lr);++v){var d,f=v/c(this,lr);(d=this.stemVertices).push.apply(d,D(this.stemCurve.pointAt(this.stemCurve.map(f))))}this.stemVerticesData=new Float32Array(this.stemVertices),this.stemVAO?(p.bindBuffer(p.ARRAY_BUFFER,this.stemBuffers.position),p.bufferSubData(p.ARRAY_BUFFER,0,this.stemVerticesData),p.bindBuffer(p.ARRAY_BUFFER,null)):(this.stemBuffers={position:ki(p,this.stemVerticesData,p.DYNAMIC_DRAW),numElem:this.stemVertices.length/3},this.geometryHelper=new rr(p),this.stemVAO=xi(p,[[this.stemBuffers.position,this.geometryHelper.locations.a_position,3]]))}function yr(t){this.context;this.averageLeafDuration=300,this.leafStaggerDelay=2.5,this.totalDuration=0;for(var e=B.rotateX(B.create(),B.create(),-Math.PI/2),n=c(this,cr),i=this.vesselHeight/n*.015,r=Ut.fromValues(0,0,1),a=this.leafGeometry.extent,o=Ut.length(a),s=0;s<n;++s){var l=s/(1.2*n)+.03,u=B.create(),h=B.create(),p=Math.random()*i-i/2,v=this.stemCurve.map(l+p),f=this.stemCurve.pointAt(v);B.translate(h,u,f);var m=Ut.normalize(Ut.create(),this.stemCurve.velocityAt(v));Ut.rotateY(r,r,Ut.create(),Math.random()*Math.PI*2-Math.PI);var b=B.targetTo(B.create(),Ut.create(),m,r);B.multiply(b,b,e),B.multiply(h,h,b);for(var _=B.multiply(B.create(),this.modelMatrix,h),g=Ut.transformMat4(Ut.create(),a,_),w=Ut.transformMat4(Ut.create(),Ut.create(),_),y=Ut.normalize(Ut.create(),Ut.subtract(Ut.create(),g,w)),x=Ut.clone(w),k=0;k<4;++k){var E=-d(this,mr,Er).call(this,x);Ut.add(x,x,Ut.scale(Ut.create(),y,E))}var P=Ut.subtract(Ut.create(),x,w),C=Math.min(1.2,Ut.length(P)/o);B.scale(h,h,[C,C,C]),this.leafInstances.bindMatrices[s]=h;var M=Math.max(.75*this.averageLeafDuration,this.averageLeafDuration*C);this.leafInstances.animationParams[s]={duration:M},this.totalDuration=Math.max(this.totalDuration,M+this.leafStaggerDelay*s)}this.startFrame=t,this.leafAnimationStartNdx=-1}function xr(t){for(var e=this.context,n=c(this,cr),i=Math.min(this.totalDuration,t-this.startFrame),r=0;r<n;++r){var a=this.leafInstances.animationParams[r].duration,o=r*this.leafStaggerDelay,s=Math.min(a,Math.max(0,i-o))/a;this.onLeafGrow&&s>0&&r>this.leafAnimationStartNdx&&(this.leafAnimationStartNdx=r,this.onLeafGrow(r));var l=s;s<=.2?l/=.2:l=s>.8?1-(s-.8)/.2:1;var u=.8*(1-(l=sr(l))*l)+.2,h=10*l*l*.5+1,p=.5*or.get(s*h,s*h)*u,v=this.leafInstances.bindMatrices[r],d=B.fromScaling(B.create(),Ut.fromValues(l,l,l));B.rotateX(d,d,p),B.multiply(d,v,d),B.copy(this.leafInstances.matrices[r],d)}e.bindBuffer(e.ARRAY_BUFFER,this.leafInstances.buffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.leafInstances.matricesArray),e.bindBuffer(e.ARRAY_BUFFER,null),i>=this.totalDuration&&this.animationDoneCallback&&this.animationDoneCallback()}function kr(t,e){var n=this.context;n.useProgram(this.leafProgram),n.bindVertexArray(this.leafVAO),n.uniformMatrix4fv(this.leafLocations.u_viewMatrix,!1,t.viewMatrix),n.uniformMatrix4fv(this.leafLocations.u_projectionMatrix,!1,t.projectionMatrix),n.uniformMatrix4fv(this.leafLocations.u_inversProjectionMatrix,!1,t.inversProjectionMatrix),n.uniform3f(this.leafLocations.u_cameraPosition,t.cameraMatrix[12],t.cameraMatrix[14],t.cameraMatrix[14]),n.uniformMatrix4fv(this.leafLocations.u_worldMatrix,!1,e),n.uniformMatrix4fv(this.leafLocations.u_worldInverseTransposeMatrix,!1,t.worldInverseTransposeMatrix),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.leafGradientTexture),n.uniform1i(this.leafProgram.u_gradientTexture,0),n.drawElementsInstanced(n.TRIANGLES,this.leafBuffers.numElem,n.UNSIGNED_SHORT,0,c(this,cr)),n.cullFace(n.FRONT);var i=B.scale(B.create(),t.worldInverseTransposeMatrix,Ut.fromValues(-1,-1,-1));n.uniformMatrix4fv(this.leafLocations.u_worldInverseTransposeMatrix,!1,i),n.drawElementsInstanced(n.TRIANGLES,this.leafBuffers.numElem,n.UNSIGNED_SHORT,0,c(this,cr)),n.cullFace(n.BACK)}function Er(t){var e=.93;return d(this,br,Pr).call(this,t,this.vesselRadius*e,this.vesselBevelRadius*e,this.vesselHeight/2*e)}function Pr(t,e,n,i){var r=Ln.fromValues(Ln.length(Ln.fromValues(t[0],t[2]))-e+n,Math.abs(t[1])-i+n);return Math.min(Math.max(r[0],r[1]),0)+Ln.length(Ln.fromValues(Math.max(r[0],0),Math.max(r[1],0)))-n}var Cr=new WeakMap,Mr=new WeakMap,Vr=new WeakMap,Lr=new WeakMap,Tr=new WeakSet,Ar=new WeakSet,Sr=new WeakSet,Rr=new WeakSet,Dr=new WeakSet,zr=new WeakSet,Br=new WeakSet,Ir=new WeakSet,Ur=new WeakSet,Nr=new WeakSet,jr=new WeakSet,Fr=new WeakSet,Or=new WeakSet,Kr=new WeakSet,qr=function(){"use strict";function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t),f(this,Tr),f(this,Ar),f(this,Sr),f(this,Rr),f(this,Dr),f(this,zr),f(this,Br),f(this,Ir),f(this,Ur),f(this,Nr),f(this,jr),f(this,Fr),f(this,Or),f(this,Kr),M(this,"oninit",void 0),p(this,Cr,{writable:!0,value:0}),p(this,Mr,{writable:!0,value:0}),p(this,Vr,{writable:!0,value:0}),p(this,Lr,{writable:!0,value:!1}),M(this,"camera",{matrix:B.create(),near:60,far:155,distance:100,orbit:It.create(),position:Ut.create(),rotation:Ut.create(),up:Ut.fromValues(0,1,0)}),M(this,"animate",!0),M(this,"plantSettings",{showGuides:!1}),this.canvas=e,this.pane=n,this.oninit=i,d(this,Dr,Xr).call(this)}return x(t,[{key:"resize",value:function(){var t,e,n,i,r=this.gl;(t=r.canvas,e=t.clientWidth,n=t.clientHeight,(i=t.width!==e||t.height!==n)&&(t.width=e,t.height=n),i)&&(r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),d(this,Ir,Jr).call(this,r)),this.blurScale=r.canvas.clientHeight/550,d(this,Fr,ia).call(this,r)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this;this.fpsGraph&&this.fpsGraph.begin(),v(this,Vr,Math.min(32,t-c(this,Cr))),v(this,Cr,t),this.animate&&v(this,Mr,c(this,Mr)+c(this,Vr)/16),c(this,Lr)||(this.control.update(c(this,Vr)),B.fromQuat(this.drawUniforms.worldMatrix,this.control.rotationQuat),B.invert(this.drawUniforms.worldInverseTransposeMatrix,this.drawUniforms.worldMatrix),B.transpose(this.drawUniforms.worldInverseTransposeMatrix,this.drawUniforms.worldInverseTransposeMatrix),B.invert(this.drawUniforms.inversProjectionMatrix,this.drawUniforms.projectionMatrix),this.plant.update(c(this,Mr)),d(this,Tr,Hr).call(this),this.fpsGraph&&this.fpsGraph.end(),requestAnimationFrame((function(t){return e.run(t)})))}},{key:"destroy",value:function(){v(this,Lr,!0)}}]),t}();function Hr(){var t=this.gl;Pi(t,this.plantFBO,this.drawBufferSize[0],this.drawBufferSize[1]),t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.plant.render(this.drawUniforms,this.plantSettings.showGuides),Pi(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Pi(t,this.deltaDepthFBO,this.drawBufferSize[0],this.drawBufferSize[1]),t.useProgram(this.deltaDepthProgram),t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.plantColorTexture),t.uniform1i(this.deltaDepthLocations.u_colorTexture,0),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.plantDepthTexture),t.uniform1i(this.deltaDepthLocations.u_depthTexture,1),t.uniformMatrix4fv(this.deltaDepthLocations.u_viewMatrix,!1,this.drawUniforms.viewMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_projectionMatrix,!1,this.drawUniforms.projectionMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_inversProjectionMatrix,!1,this.drawUniforms.inversProjectionMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_worldMatrix,!1,this.drawUniforms.worldMatrix),t.bindVertexArray(this.vesselVAO),t.drawElements(t.TRIANGLES,this.vesselBuffers.numElem,t.UNSIGNED_SHORT,0),Pi(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Pi(t,this.hBlurFBO,this.drawBufferSize[0],this.drawBufferSize[1]),d(this,Ar,Gr).call(this,this.deltaDepthColorTexture),Pi(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Pi(t,this.vBlurFBO,this.drawBufferSize[0],this.drawBufferSize[1]),d(this,Ar,Gr).call(this,this.hBlurTexture,!0),Pi(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),d(this,Rr,Yr).call(this),d(this,Sr,Wr).call(this,!1)}function Gr(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.gl;n.useProgram(this.blurProgram),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t),n.uniform1i(this.blurLocations.u_colorTexture,0),e?n.uniform2f(this.blurLocations.u_direction,0,1):n.uniform2f(this.blurLocations.u_direction,1,0),n.uniform1f(this.blurLocations.u_scale,this.blurScale),n.bindVertexArray(this.quadVAO),n.drawArrays(n.TRIANGLES,0,this.quadBuffers.numElem)}function Wr(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.gl;n.useProgram(this.vesselProgram),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);var i=this.drawUniforms.worldInverseTransposeMatrix;t&&(n.cullFace(n.FRONT),i=B.scale(B.create(),this.drawUniforms.worldInverseTransposeMatrix,Ut.fromValues(-1,-1,-1))),e||(n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.vBlurTexture),n.uniform1i(this.vesselLocations.u_colorTexture,0)),n.uniformMatrix4fv(this.vesselLocations.u_viewMatrix,!1,this.drawUniforms.viewMatrix),n.uniformMatrix4fv(this.vesselLocations.u_projectionMatrix,!1,this.drawUniforms.projectionMatrix),n.uniform3f(this.vesselLocations.u_cameraPosition,this.camera.position[0],this.camera.position[1],this.camera.position[2]),n.uniformMatrix4fv(this.vesselLocations.u_worldMatrix,!1,this.drawUniforms.worldMatrix),n.uniformMatrix4fv(this.vesselLocations.u_worldInverseTransposeMatrix,!1,i),n.bindVertexArray(this.vesselVAO),n.drawElements(n.TRIANGLES,this.vesselBuffers.numElem,n.UNSIGNED_SHORT,0),n.cullFace(n.BACK)}function Yr(){var t=this.gl;t.useProgram(this.titleProgram),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.titleTexture),t.uniform1i(this.titleLocations.u_titleTexture,0),t.uniformMatrix4fv(this.titleLocations.u_viewMatrix,!1,this.drawUniforms.viewMatrix),t.uniformMatrix4fv(this.titleLocations.u_projectionMatrix,!1,this.drawUniforms.projectionMatrix),t.uniformMatrix4fv(this.titleLocations.u_worldMatrix,!1,B.create()),t.uniform1f(this.titleLocations.u_frames,c(this,Mr)),t.bindVertexArray(this.titleRibbonVAO),t.drawElements(t.TRIANGLES,this.titleRibbonBuffers.numElem,t.UNSIGNED_SHORT,0)}function Xr(){var t=this;this.gl=this.canvas.getContext("webgl2",{antialias:!1,alpha:!1});var n=this.gl;if(!n)throw new Error("No WebGL 2 context!");n.getExtension("EXT_color_buffer_float")||(console.error("FLOAT color buffer not available"),document.body.innerHTML="This example requires EXT_color_buffer_float which is unavailable on this system."),this.deltaDepthProgram=yi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\n\nout vec3 v_position;\n\nvoid main() {\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_position = viewPosition.xyz;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform mat4 u_inversProjectionMatrix;\nuniform sampler2D u_colorTexture;\nuniform sampler2D u_depthTexture;\n\nin vec3 v_position;\n\nout vec4 outColor;\n\n// reconstructs the view space position given the screen space coordinates\n// along with the depth\nvec3 reconstructPosition(vec2 uv, float depth, mat4 inversProjectionMatrix) {\n    float x = uv.x * 2. - 1.;   // = x / w\n    float y = uv.y * 2. - 1.;   // = y / w\n    float z = depth * 2. - 1.;\n    vec4 projectedPosition = vec4(x, y, z, 1.);\n    vec4 pos = inversProjectionMatrix * projectedPosition;\n    return pos.xyz / pos.w;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_colorTexture, 0));\n    float vesselRadius = 20.;\n    float cameraDistance = 100.;\n\n    float plantDepth = texture(u_depthTexture, uv).r;\n    vec3 plantPosition = reconstructPosition(uv, plantDepth, u_inversProjectionMatrix);\n    // get the normalized plant z position\n    float plantNormZ = (cameraDistance + vesselRadius + plantPosition.z) / (2. * vesselRadius);\n    // get the normalized vessel z position\n    float vesselNormZ = (cameraDistance + vesselRadius + v_position.z) / (2. * vesselRadius);\n    float deltaBlur = smoothstep(0.15, 0.4, vesselNormZ - plantNormZ);\n    float deltaFog = smoothstep(0.0, 1.1, vesselNormZ - plantNormZ);\n    vec4 color = mix(texture(u_colorTexture, uv), vec4(1.), deltaFog);\n\n    outColor = vec4(color.rgb, deltaBlur);\n}\n")],null,{a_position:0}),this.blurProgram=yi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_colorTexture;\nuniform float u_scale;\nuniform vec2 u_direction;\n\nout vec4 blurColor;\n\nfloat getRadius(float depth) {\n    return clamp(depth, 0.0, 1.);\n}\n\nvoid blur(\n    in vec2 A,\n    in vec2 direction,\n    in float scale,\n    in sampler2D inTexture,\n    out vec4 outColor\n) {\n    const int KERNEL_SIZE = 6;\n    float gaussian[KERNEL_SIZE];  \n    gaussian[5] = 0.04153263993208;\n    gaussian[4] = 0.06352050813141;\n    gaussian[3] = 0.08822292796029;\n    gaussian[2] = 0.11143948794984;\n    gaussian[1] = 0.12815541114232;\n    gaussian[0] = 0.13425804976814;\n\n    vec4 resultColor = vec4(0.);\n    float weightSum = 0.;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(inTexture, 0));\n    vec4 colorA = texture(inTexture, A);\n    float depthA = colorA.a;\n    float rA = getRadius(depthA);\n\n    // scatter as you gather loop\n    for(int i = -KERNEL_SIZE; i < KERNEL_SIZE; ++i) {\n        vec2 B = A + direction * ((float(i) * scale) * texelSize);\n        vec4 colorB = texture(inTexture, B);\n        float depthB = colorB.a;\n        float rB = getRadius(depthB);\n\n        float blurWeight = gaussian[abs(i)];\n\n        // only consider if B is in front of A\n        float bNearerWeight = clamp(abs(rA) - abs(rB) + 1., 0., .5);\n        float weight = bNearerWeight * blurWeight;\n        weightSum += weight;\n        resultColor.rgb += colorB.rgb * weight;\n    }\n\n    // apply total weights\n    resultColor.rgb /= weightSum;\n    resultColor.a = colorA.a;\n\n    outColor = resultColor;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_colorTexture, 0));\n\n    blur(\n        uv,\n        u_direction,\n        u_scale,\n        u_colorTexture,\n        blurColor\n    );\n\n    //blurColor = vec4(texture(u_colorTexture, uv).a);\n}")],null,{a_position:0}),this.vesselProgram=yi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec3 v_position;\nout vec3 v_viewPosition;\nout vec3 v_normal;\nout vec3 v_viewNormal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (u_worldInverseTransposeMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n    v_position = a_position.xyz;\n    v_viewPosition = viewPosition.xyz;\n    v_viewNormal = (u_viewMatrix * vec4(v_normal, 0.)).xyz;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_colorTexture;\nuniform float u_frames;\n\nin vec3 v_position;\nin vec3 v_normal;\nin vec3 v_viewNormal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\nin vec3 v_viewPosition;\n\nout vec4 outColor;\n\n#define PI 3.1415926535\n\nvoid main() {\n    vec2 texelSize = 1. / vec2(textureSize(u_colorTexture, 0));\n    vec2 uv = gl_FragCoord.xy * texelSize;\n\n    vec3 pos = v_position;\n    vec3 N = normalize(v_normal);\n    vec3 VN = normalize(v_viewNormal);\n    vec3 V = normalize(v_surfaceToView);\n    vec3 L = normalize(vec3(0., .5, 4.));\n    float NdL = max(0., dot(N, L));\n\n    // calculate the half vector\n    vec3 H = normalize(V + N);\n\n    // specular term\n    float specular = pow(max(0., max(0., dot(H, L))), 100.) * .6;\n\n    // diffuse term\n    float diffuse = NdL * .3 + .7;\n\n    // edge darkening term\n    float edge = min(1., pow(min(1., NdL + 0.5), 3.) + 0.6);\n\n    // ambient light color\n    vec4 ambient = vec4(0.9, 0.9, 1., 1.);\n    \n    vec4 innerColor = texture(u_colorTexture, uv);\n\n    vec4 vesselColor = ambient * diffuse + vec4(specular) * 1.5;\n    vesselColor *= edge;\n\n    outColor = innerColor * 0.9 + vesselColor * 0.1 + vec4(N.zyx, 1.) * 0.05;\n}\n")],null,{a_position:0,a_normal:1,a_uv:2}),this.titleProgram=yi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_titleTexture;\nuniform float u_frames;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 uv = vec2(v_uv.x - u_frames * 0.00025, v_uv.y);\n    vec4 color = 1. - texture(u_titleTexture, uv * vec2(-4., 0.99));\n    //color = mix(vec4(248. / 255., 248. / 255., 222. / 255., 1.), vec4(1.), color);\n    color = mix(vec4(228. / 255., 238. / 255., 255. / 255., 1.), vec4(1.), color);\n    //color = mix(vec4(55. / 255., 25. / 255., 22. / 255., 1.), vec4(1.), color);\n\n    color = mix(color, vec4(1.), sin(v_uv.x * 9.5) * 0.5 + 0.5);\n\n    outColor = color;\n}\n")],null,{a_position:0,a_uv:1}),this.deltaDepthLocations={a_position:n.getAttribLocation(this.deltaDepthProgram,"a_position"),u_worldMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_projectionMatrix"),u_inversProjectionMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_inversProjectionMatrix"),u_colorTexture:n.getUniformLocation(this.deltaDepthProgram,"u_colorTexture"),u_depthTexture:n.getUniformLocation(this.deltaDepthProgram,"u_depthTexture")},this.blurLocations={a_position:n.getAttribLocation(this.blurProgram,"a_position"),u_colorTexture:n.getUniformLocation(this.blurProgram,"u_colorTexture"),u_scale:n.getUniformLocation(this.blurProgram,"u_scale"),u_direction:n.getUniformLocation(this.blurProgram,"u_direction")},this.vesselLocations={a_position:n.getAttribLocation(this.vesselProgram,"a_position"),a_normal:n.getAttribLocation(this.vesselProgram,"a_normal"),a_uv:n.getAttribLocation(this.vesselProgram,"a_uv"),u_worldMatrix:n.getUniformLocation(this.vesselProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.vesselProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.vesselProgram,"u_projectionMatrix"),u_worldInverseTransposeMatrix:n.getUniformLocation(this.vesselProgram,"u_worldInverseTransposeMatrix"),u_cameraPosition:n.getUniformLocation(this.vesselProgram,"u_cameraPosition"),u_colorTexture:n.getUniformLocation(this.vesselProgram,"u_colorTexture")},this.titleLocations={a_position:n.getAttribLocation(this.titleProgram,"a_position"),a_uv:n.getAttribLocation(this.titleProgram,"a_uv"),u_worldMatrix:n.getUniformLocation(this.titleProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.titleProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.titleProgram,"u_projectionMatrix"),u_titleTexture:n.getUniformLocation(this.titleProgram,"u_titleTexture"),u_frames:n.getUniformLocation(this.titleProgram,"u_frames")},this.drawUniforms={worldMatrix:B.create(),viewMatrix:B.create(),cameraMatrix:B.create(),projectionMatrix:B.create(),inversProjectionMatrix:B.create(),worldInverseTransposeMatrix:B.create()},this.VESSEL_HEIGHT=50,this.VESSEL_RADIUS=20,this.VESSEL_BEVEL_RADIUS=13,this.vesselGeometry=new Oi(this.VESSEL_HEIGHT,this.VESSEL_RADIUS,this.VESSEL_BEVEL_RADIUS),this.vesselBuffers={position:ki(n,this.vesselGeometry.vertices,n.STATIC_DRAW),normal:ki(n,this.vesselGeometry.normals,n.STATIC_DRAW),numElem:this.vesselGeometry.indices.length},this.vesselVAO=xi(n,[[this.vesselBuffers.position,this.vesselLocations.a_position,3],[this.vesselBuffers.normal,this.vesselLocations.a_normal,3]],this.vesselGeometry.indices);var i=[-1,-1,3,-1,-1,3];this.quadBuffers={position:ki(n,new Float32Array(i),n.STATIC_DRAW),numElem:i.length/2},this.quadVAO=xi(n,[[this.quadBuffers.position,0,2]]),this.plant=new _r(n,this.VESSEL_HEIGHT,this.VESSEL_RADIUS,this.VESSEL_BEVEL_RADIUS,(function(){return t.plant.generate(c(t,Mr))})),this.plant.generate(c(this,Mr)),this.titleRibbonGeometry=d(this,Nr,ea).call(this,50,8,60,1),this.titleRibbonBuffers={position:ki(n,new Float32Array(this.titleRibbonGeometry.vertices),n.STATIC_DRAW),uv:ki(n,new Float32Array(this.titleRibbonGeometry.uvs),n.STATIC_DRAW),numElem:this.titleRibbonGeometry.count},this.titleRibbonVAO=xi(n,[[this.titleRibbonBuffers.position,this.titleLocations.a_position,3],[this.titleRibbonBuffers.uv,this.titleLocations.a_uv,2]],this.titleRibbonGeometry.indices);var r=Ln.fromValues(n.canvas.clientWidth,n.canvas.clientHeight);this.drawBufferSize=Ln.clone(r),this.plantColorTexture=d(this,zr,Zr).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.plantDepthTexture=d(this,zr,Zr).call(this,n,n.DEPTH_COMPONENT32F,r,n.NEAREST,n.NEAREST,n.REPEAT,n.REPEAT),this.plantFBO=Ei(n,[this.plantColorTexture],this.plantDepthTexture),this.deltaDepthColorTexture=d(this,zr,Zr).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.deltaDepthFBO=Ei(n,[this.deltaDepthColorTexture]),this.hBlurTexture=d(this,zr,Zr).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.vBlurTexture=d(this,zr,Zr).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.hBlurFBO=Ei(n,[this.hBlurTexture]),this.vBlurFBO=Ei(n,[this.vBlurTexture]),this.control=new Vi(this.canvas),this.resize(),d(this,Br,Qr).call(this),this.camera.position[2]=this.camera.distance,d(this,jr,na).call(this),d(this,Fr,ia).call(this,n),d(this,Or,ra).call(this),this.oninit&&this.oninit(this)}function Zr(t,e,n,i,r,a,o){var s=Ci(t,i,r,a,o);return t.bindTexture(t.TEXTURE_2D,s),e===t.RGBA?t.texImage2D(t.TEXTURE_2D,0,e,n[0],n[1],0,e,t.UNSIGNED_BYTE,null):e===t.DEPTH_COMPONENT32F?t.texImage2D(t.TEXTURE_2D,0,e,n[0],n[1],0,t.DEPTH_COMPONENT,t.FLOAT,null):e===t.RGBA16F&&t.texStorage2D(t.TEXTURE_2D,1,t.RGBA16F,n[0],n[1]),t.bindTexture(t.TEXTURE_2D,null),s}var $r;function Qr(){var t=this,e=this.gl;this.titleTexture=Ci(e,e.LINEAR,e.LINEAR,e.REPEAT,e.REPEAT),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var n=new Image;n.width=2e3,n.addEventListener("load",(function(){e.bindTexture(e.TEXTURE_2D,t.titleTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null)})),n.src=new URL($r)}function Jr(t){var e=Ln.fromValues(t.canvas.clientWidth,t.canvas.clientHeight);this.drawBufferSize=Ln.clone(e),d(this,Ur,ta).call(this,t,this.plantColorTexture,t.RGBA,e),d(this,Ur,ta).call(this,t,this.plantDepthTexture,t.DEPTH_COMPONENT32F,e),d(this,Ur,ta).call(this,t,this.deltaDepthColorTexture,t.RGBA,e),d(this,Ur,ta).call(this,t,this.hBlurTexture,t.RGBA,e),d(this,Ur,ta).call(this,t,this.vBlurTexture,t.RGBA,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}function ta(t,e,n,i){t.bindTexture(t.TEXTURE_2D,e),n===t.RGBA?t.texImage2D(t.TEXTURE_2D,0,n,i[0],i[1],0,n,t.UNSIGNED_BYTE,null):n===t.DEPTH_COMPONENT32F&&t.texImage2D(t.TEXTURE_2D,0,n,i[0],i[1],0,t.DEPTH_COMPONENT,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,null)}function ea(t,e,n,i){for(var r=2*Math.PI/n,a=e/i,o=n*i*6,s=[],l=[],u=[],c=[],h=n+1,p=-e/2,v=0;v<=i;++v)for(var d=0;d<=n;++d){var f={x:t*Math.sin(r*d),y:p+a*v,z:t*Math.cos(r*d)},m={x:0,y:0,z:1};s.push(f.x,f.y,f.z),l.push(m.x,m.y,m.z),u.push(d/n,v/i)}for(var b=0;b<i;++b)for(var _=0;_<n;++_)c.push(b*h+_,(b+1)*h+_+1,b*h+_+1),c.push((b+1)*h+_+1,b*h+_,(b+1)*h+_);return{vertices:s,normals:l,uvs:u,indices:c,count:o}}function na(){B.targetTo(this.camera.matrix,this.camera.position,[0,0,0],this.camera.up),B.invert(this.drawUniforms.viewMatrix,this.camera.matrix),B.copy(this.drawUniforms.cameraMatrix,this.camera.matrix)}function ia(t){var e=t.canvas.clientWidth/t.canvas.clientHeight;B.perspective(this.drawUniforms.projectionMatrix,Math.PI/4,e,this.camera.near,this.camera.far)}function ra(){if(this.pane){var t=this;this.fpsGraph=this.pane.addBlade({view:"fpsgraph",label:"fps",lineCount:1,maxValue:120,minValue:0}),this.pane.addInput(this,"animate",{label:"animate"});var e=this.pane.addFolder({title:"Camera"});d(this,Kr,aa).call(this,e,this.camera,"near","near",1,200,null,(function(){return d(t,Fr,ia).call(t,t.gl)})),d(this,Kr,aa).call(this,e,this.camera,"far","far",1,200,null,(function(){return d(t,Fr,ia).call(t,t.gl)}))}}function aa(t,e,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7?arguments[7]:void 0,l=t.addBlade({view:"slider",label:i,min:r,max:a,step:o,value:e[n]});l.on("change",(function(t){e[n]=t.value,s&&s()}))}$r=a("aNJCr").getBundleURL("7EiNB")+a("iE7OH").resolve("9VljA");var oa,sa,la=window.location.search,ua=null!==new URLSearchParams(la).get("debug");window.addEventListener("load",(function(){var t,e=document.body.querySelector("#c");ua&&(t=new o.Pane({title:"Settings"})).registerPlugin(z),oa=new qr(e,t,(function(t){t.run()}))})),window.addEventListener("resize",(function(){oa&&(sa&&clearTimeout(sa),sa=setTimeout((function(){sa=null,oa.resize()}),300))}))}();
//# sourceMappingURL=index.dbab0dfd.js.map
