!function(){function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},a=n.parcelRequire3607;null==a&&(a=function(t){if(t in i)return i[t].exports;if(t in r){var e=r[t];delete r[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a},a.register=function(t,e){r[t]=e},n.parcelRequire3607=a),a.register("iE7OH",(function(e,n){var i,r;t(e.exports,"register",(function(){return i}),(function(t){return i=t})),t(e.exports,"resolve",(function(){return r}),(function(t){return r=t}));var a={};i=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)a[e[n]]=t[e[n]]},r=function(t){var e=a[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),a.register("c2tl2",(function(t,e){var n=a("ao67S"),i=a("dnqwG"),r=a("5uoV6"),o=a("3Jt3i");t.exports=function(t,e){return n(t)||i(t,e)||r(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("ao67S",(function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("dnqwG",(function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);o=!0);}catch(t){s=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(s)throw r}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("5uoV6",(function(t,e){var n=a("8SL2m");t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("8SL2m",(function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("3Jt3i",(function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("clMMr",(function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("drNVG",(function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),a.register("aNJCr",(function(e,n){var i;t(e.exports,"getBundleURL",(function(){return i}),(function(t){return i=t}));var r={};function a(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}i=function(t){var e=r[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}(),r[t]=e),e}})),a("iE7OH").register(JSON.parse('{"7EiNB":"index.d685fbb8.js","9VljA":"title.6a70130b.svg"}'));var o={};function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,n,i,r,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function o(t){u(a,i,r,o,s,"next",t)}function s(t){u(a,i,r,o,s,"throw",t)}o(void 0)}))}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function p(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,h(t,e,"get"))}function v(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(t,e,n){v(t,e),e.set(t,n)}function d(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,h(t,e,"set"),n),n}function m(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _(t,e){v(t,e),e.add(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e){return g(t,e)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function w(t,e,n){return(w=b()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&y(r,n.prototype),r}).apply(null,arguments)}function k(t,e,n){return w.apply(null,arguments)}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function C(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),t}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t){return E(t)}function T(t,e){return!e||"object"!=((n=e)&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?s(t):e;var n}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var r=M(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return T(this,n)}}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t,e,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n||t):r.value}})(t,e,n)}function V(t,e,n){return S(t,e,n)}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){A(t,e,n[e])}))}return t}function R(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n,i,r={},a=Object.keys(t);for(i=0;i<a.length;i++)n=a[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function L(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function N(t,e){if(t){if("string"==typeof t)return I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(t,e):void 0}}function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||L(t)||N(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t){return function(t){if(Array.isArray(t))return I(t)}(t)||L(t)||N(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}
/*! Tweakpane 3.0.8 (c) 2016 cocopon, licensed under the MIT license. */!function(t){"use strict";var e=function(){function t(e){c(this,t);var n=F(e.split("-"),2),i=n[0],r=n[1],a=i.split(".");this.major=parseInt(a[0],10),this.minor=parseInt(a[1],10),this.patch=parseInt(a[2],10),this.prerelease=null!=r?r:null}return C(t,[{key:"toString",value:function(){var t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}]),t}(),n=function(){function t(e){c(this,t),this.controller_=e}return C(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"hidden",get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)}},{key:"dispose",value:function(){this.controller_.viewProps.set("disposed",!0)}}]),t}(),i=function t(e){c(this,t),this.target=e},r=function(t){O(n,t);var e=P(n);function n(t,i,r,a){var o;return c(this,n),(o=e.call(this,t)).value=i,o.presetKey=r,o.last=null==a||a,o}return n}(i),a=function(t){O(n,t);var e=P(n);function n(t,i,r){var a;return c(this,n),(a=e.call(this,t)).value=i,a.presetKey=r,a}return n}(i),o=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t)).expanded=i,r}return n}(i);function u(t){return t}function l(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var p={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '".concat(t.name,"'")},nomatchingcontroller:function(t){return"No matching controller for '".concat(t.key,"'")},nomatchingview:function(t){return"No matching view for '".concat(JSON.stringify(t.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '".concat(t.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},v=function(){function t(e){var n;c(this,t),this.message=null!==(n=p[e.type](u(e.context)))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return C(t,null,[{key:"alreadyDisposed",value:function(){return new t({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new t({type:"notbindable"})}},{key:"propertyNotFound",value:function(e){return new t({type:"propertynotfound",context:{name:e}})}},{key:"shouldNeverHappen",value:function(){return new t({type:"shouldneverhappen"})}}]),t}(),f=function(){function t(e,n,i){c(this,t),this.obj_=e,this.key_=n,this.presetKey_=null!=i?i:n}return C(t,[{key:"key",get:function(){return this.key_}},{key:"presetKey",get:function(){return this.presetKey_}},{key:"read",value:function(){return this.obj_[this.key_]}},{key:"write",value:function(t){this.obj_[this.key_]=t}},{key:"writeProperty",value:function(e,n){var i=this.read();if(!t.isBindable(i))throw v.notBindable();if(!(e in i))throw v.propertyNotFound(e);i[e]=n}}],[{key:"isBindable",value:function(t){return null!==t&&"object"==typeof t}}]),t}(),d=function(t){O(n,t);var e=P(n);function n(){return c(this,n),e.apply(this,arguments)}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.valueController.props.set("title",t)}},{key:"on",value:function(t,e){var n=this,r=e.bind(this);return this.controller_.valueController.emitter.on(t,(function(){r(new i(n))})),this}}]),n}(n),m=function(){function t(){c(this,t),this.observers_={}}return C(t,[{key:"on",value:function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}},{key:"off",value:function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this}},{key:"emit",value:function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))}}]),t}(),_="tp";function g(t){return function(e,n){return[_,"-",t,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")}}function y(t,e){return function(n){return e(t(n))}}function b(t){return t.rawValue}function w(t,e){t.emitter.on("change",y(b,e)),e(t.rawValue)}function x(t,e,n){w(t.value(e),n)}function E(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function T(t,e){return function(n){E(t,e,n)}}function S(t,e){w(t,(function(t){e.textContent=null!=t?t:""}))}var D=g("btn"),R=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(D()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("button");i.classList.add(D("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var r=e.createElement("div");r.classList.add(D("t")),S(n.props.value("title"),r),this.buttonElement.appendChild(r)},L=function(){function t(e,n){c(this,t),this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new R(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return C(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),I=function(){function t(e,n){var i;c(this,t),this.constraint_=null==n?void 0:n.constraint,this.equals_=null!==(i=null==n?void 0:n.equals)&&void 0!==i?i:function(t,e){return t===e},this.emitter=new m,this.rawValue_=e}return C(t,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}]),t}(),N=function(){function t(e){c(this,t),this.emitter=new m,this.value_=e}return C(t,[{key:"rawValue",get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}]),t}();function q(t,e){var n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new I(t,e):new N(t)}var j=function(){function t(e){var n=this,i=function(t){var e=n;n.valMap_[t].emitter.on("change",(function(){e.emitter.emit("change",{key:t,sender:e})}))};for(var r in c(this,t),this.emitter=new m,this.valMap_=e,this.valMap_)i(r)}return C(t,[{key:"get",value:function(t){return this.valMap_[t].rawValue}},{key:"set",value:function(t,e){this.valMap_[t].rawValue=e}},{key:"value",value:function(t){return this.valMap_[t]}}],[{key:"createCore",value:function(t){return Object.keys(t).reduce((function(e,n){return Object.assign(e,A({},n,q(t[n])))}),{})}},{key:"fromObject",value:function(e){return new t(this.createCore(e))}}]),t}();function z(t,e){return u(Object.keys(e).reduce((function(n,i){if(void 0!==n){var r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),A({},i,r.value)):void 0}}),{}))}function U(t,e){return t.reduce((function(t,n){if(void 0!==t){var i=e(n);if(i.succeeded&&void 0!==i.value)return B(t).concat([i.value])}}),[])}function W(t){return null!==t&&"object"==typeof t}function G(t){return function(e){return function(n){if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};var i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}}function K(t){return{custom:function(e){return G(e)(t)},boolean:G((function(t){return"boolean"==typeof t?t:void 0}))(t),number:G((function(t){return"number"==typeof t?t:void 0}))(t),string:G((function(t){return"string"==typeof t?t:void 0}))(t),function:G((function(t){return"function"==typeof t?t:void 0}))(t),constant:function(e){return G((function(t){return t===e?e:void 0}))(t)},raw:G((function(t){return t}))(t),object:function(e){return G((function(t){if(W(t))return z(t,e)}))(t)},array:function(e){return G((function(t){if(Array.isArray(t))return U(t,e)}))(t)}}}var H={optional:K(!0),required:K(!1)};function Y(t,e){var n=H.required.object(e)(t);return n.succeeded?n.value:void 0}function X(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function Z(){return["veryfirst","first","last","verylast"]}var Q=g(""),$={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},J=function(){function t(e){var n=this;c(this,t),this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var i=this.view.element;this.blade.value("positions").emitter.on("change",(function(){Z().forEach((function(t){i.classList.remove(Q(void 0,$[t]))})),n.blade.get("positions").forEach((function(t){i.classList.add(Q(void 0,$[t]))}))})),this.viewProps.handleDispose((function(){X(i)}))}return C(t,[{key:"parent",get:function(){return this.parent_}}]),t}(),tt="http://www.w3.org/2000/svg";function et(t){t.offsetHeight}function nt(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function it(t){return void 0!==t.ontouchstart}function rt(){return new Function("return this")()}function at(){return u(rt()).document}function ot(t){var e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}var st={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function ut(t,e){var n=t.createElementNS(tt,"svg");return n.innerHTML=st[e],n}function lt(t,e,n){t.insertBefore(e,t.children[n])}function ct(t){t.parentElement&&t.parentElement.removeChild(t)}function ht(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function pt(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function vt(t){return t.relatedTarget?u(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}var ft=g("lbl");function dt(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,i){i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var mt=function t(e,n){var i=this;c(this,t),this.element=e.createElement("div"),this.element.classList.add(ft()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(ft("l")),x(n.props,"label",(function(t){l(t)?i.element.classList.add(ft(void 0,"nol")):(i.element.classList.remove(ft(void 0,"nol")),pt(r),r.appendChild(dt(e,t)))})),this.element.appendChild(r),this.labelElement=r;var a=e.createElement("div");a.classList.add(ft("v")),this.element.appendChild(a),this.valueElement=a},_t=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{view:new mt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(J),gt={id:"button",type:"blade",accept:function(t){var e=H,n=Y(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new _t(t.document,{blade:t.blade,props:j.fromObject({label:t.params.label}),valueController:new L(t.document,{props:j.fromObject({title:t.params.title}),viewProps:t.viewProps})})},api:function(t){return t.controller instanceof _t&&t.controller.valueController instanceof L?new d(t.controller):null}},yt=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).value=t.value,i}return n}(J);function bt(){return new j({positions:q([],{equals:h})})}var wt=function(t){O(n,t);var e=P(n);function n(t){return c(this,n),e.call(this,t)}return C(n,[{key:"styleExpanded",get:function(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!l(t)?"".concat(t,"px"):"auto"}},{key:"bindExpandedClass",value:function(t,e){var n=this,i=function(){n.styleExpanded?t.classList.add(e):t.classList.remove(e)};x(this,"expanded",i),x(this,"temporaryExpanded",i)}},{key:"cleanUpTransition",value:function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}],[{key:"create",value:function(t){var e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(j.createCore(e))}}]),n}(j);function kt(t,e){var n=0;return nt(e,(function(){t.set("expandedHeight",null),t.set("temporaryExpanded",!0),et(e),n=e.clientHeight,t.set("temporaryExpanded",null),et(e)})),n}function xt(t,e){e.style.height=t.styleHeight}function Ct(t,e){t.value("expanded").emitter.on("beforechange",(function(){t.set("completed",!1),l(t.get("expandedHeight"))&&t.set("expandedHeight",kt(t,e)),t.set("shouldFixHeight",!0),et(e)})),t.emitter.on("change",(function(){xt(t,e)})),xt(t,e),e.addEventListener("transitionend",(function(e){"height"===e.propertyName&&t.cleanUpTransition()}))}var Et=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t)).rackApi_=i,r}return n}(n);function Mt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Tt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Pt(t,e){var n=e||{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function At(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}var St=function(){function t(e){c(this,t),this.emitter=new m,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return C(t,[{key:"items",get:function(){return this.items_}},{key:"allItems",value:function(){return Array.from(this.cache_)}},{key:"find",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,a=this.allItems()[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value;if(t(o))return o}}catch(t){n=!0,i=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"includes",value:function(t){return this.cache_.has(t)}},{key:"add",value:function(t,e){if(this.includes(t))throw v.shouldNeverHappen();var n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);var i=this.extract_(t);if(i){var r=this;i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((function(t){r.cache_.add(t)}))}this.emitter.emit("add",{index:n,item:t,root:this,target:this})}},{key:"remove",value:function(t){var e=this.items_.indexOf(t);if(!(e<0)){this.items_.splice(e,1),this.cache_.delete(t);var n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}}},{key:"onSubListAdd_",value:function(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}},{key:"onSubListRemove_",value:function(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}]),t}(),Vt=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).onBindingChange_=i.onBindingChange_.bind(s(i)),i.emitter_=new m,i.controller_.binding.emitter.on("change",i.onBindingChange_),i}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingChange_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("change",{event:new r(this,u(e),this.controller_.binding.target.presetKey,t.options.last)})}}]),n}(n),Ot=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t,i)).binding=i.binding,r}return n}(_t),Dt=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).onBindingUpdate_=i.onBindingUpdate_.bind(s(i)),i.emitter_=new m,i.controller_.binding.emitter.on("update",i.onBindingUpdate_),i}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingUpdate_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("update",{event:new a(this,u(e),this.controller_.binding.target.presetKey)})}}]),n}(n),Rt=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t,i)).binding=i.binding,r.viewProps.bindDisabled(r.binding.ticker),r.viewProps.handleDispose((function(){r.binding.dispose()})),r}return n}(_t);function Lt(t){return t instanceof Ft?t.apiSet_:t instanceof Et?t.rackApi_.apiSet_:null}function It(t,e){var n=t.find((function(t){return t.controller_===e}));if(!n)throw v.shouldNeverHappen();return n}function Nt(t,e,n){if(!f.isBindable(t))throw v.notBindable();return new f(t,e,n)}var Ft=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n),(r=e.call(this,t)).onRackAdd_=r.onRackAdd_.bind(s(r)),r.onRackRemove_=r.onRackRemove_.bind(s(r)),r.onRackInputChange_=r.onRackInputChange_.bind(s(r)),r.onRackMonitorUpdate_=r.onRackMonitorUpdate_.bind(s(r)),r.emitter_=new m,r.apiSet_=new St(Lt),r.pool_=i;var a=r.controller_.rack;return a.emitter.on("add",r.onRackAdd_),a.emitter.on("remove",r.onRackRemove_),a.emitter.on("inputchange",r.onRackInputChange_),a.emitter.on("monitorupdate",r.onRackMonitorUpdate_),a.children.forEach((function(t){r.setUpApi_(t)})),r}return C(n,[{key:"children",get:function(){var t=this;return this.controller_.rack.children.map((function(e){return It(t.apiSet_,e)}))}},{key:"addInput",value:function(t,e,n){var i=n||{},r=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(r,Nt(t,e,i.presetKey),i),o=new Vt(a);return this.add(o,i.index)}},{key:"addMonitor",value:function(t,e,n){var i=n||{},r=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(r,Nt(t,e),i),o=new Dt(a);return u(this.add(o,i.index))}},{key:"addFolder",value:function(t){return Tt(this,t)}},{key:"addButton",value:function(t){return Mt(this,t)}},{key:"addSeparator",value:function(t){return Pt(this,t)}},{key:"addTab",value:function(t){return At(this,t)}},{key:"add",value:function(t,e){this.controller_.rack.add(t.controller_,e);var n=this.apiSet_.find((function(e){return e.controller_===t.controller_}));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}},{key:"remove",value:function(t){this.controller_.rack.remove(t.controller_)}},{key:"addBlade",value:function(t){var e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpApi_",value:function(t){this.apiSet_.find((function(e){return e.controller_===t}))||this.apiSet_.add(this.pool_.createBladeApi(t))}},{key:"onRackAdd_",value:function(t){this.setUpApi_(t.bladeController)}},{key:"onRackRemove_",value:function(t){if(t.isRoot){var e=It(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}},{key:"onRackInputChange_",value:function(t){var e=t.bladeController;if(e instanceof Ot){var n=It(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new r(n,u(i.target.read()),i.target.presetKey,t.options.last)})}else if(e instanceof yt){var a=It(this.apiSet_,e);this.emitter_.emit("change",{event:new r(a,e.value.rawValue,void 0,t.options.last)})}}},{key:"onRackMonitorUpdate_",value:function(t){if(!(t.bladeController instanceof Rt))throw v.shouldNeverHappen();var e=It(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new a(e,u(n.target.read()),n.target.presetKey)})}}]),n}(n),Bt=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t,new Ft(t.rackController,i))).emitter_=new m,r.controller_.foldable.value("expanded").emitter.on("change",(function(t){r.emitter_.emit("fold",{event:new o(s(r),t.sender.rawValue)})})),r.rackApi_.on("change",(function(t){r.emitter_.emit("change",{event:t})})),r.rackApi_.on("update",(function(t){r.emitter_.emit("update",{event:t})})),r}return C(n,[{key:"expanded",get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)}},{key:"title",get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){return this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(Et),qt=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})).rackController=t.rackController,i}return n}(J),jt=function t(e,n){c(this,t);var i=g(n.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),n.viewProps.bindClassModifiers(this.element)};function zt(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof Ot&&i.binding===e)return i}return null}function Ut(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof Rt&&i.binding===e)return i}return null}function Wt(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i instanceof yt&&i.value===e)return i}return null}function Gt(t){return t instanceof Yt?t.rack:t instanceof qt?t.rackController.rack:null}function Kt(t){var e=Gt(t);return e?e.bcSet_:null}var Ht=function(){function t(e){var n;c(this,t),this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new m,this.blade_=null!=e?e:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new St(Kt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return C(t,[{key:"children",get:function(){return this.bcSet_.items}},{key:"add",value:function(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}},{key:"remove",value:function(t){t.parent_=null,this.bcSet_.remove(t)}},{key:"find",value:function(t){return u(this.bcSet_.allItems().filter((function(e){return e instanceof t})))}},{key:"onSetAdd_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),e){var n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof Ot)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Rt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof yt)n.value.emitter.on("change",this.onChildValueChange_);else{var i=Gt(n);if(i){var r=i.emitter;r.on("layout",this.onDescendantLayout_),r.on("inputchange",this.onDescendantInputChange_),r.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"onSetRemove_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),e){var n=t.item;if(n instanceof Ot)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Rt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof yt)n.value.emitter.off("change",this.onChildValueChange_);else{var i=Gt(n);if(i){var r=i.emitter;r.off("layout",this.onDescendantLayout_),r.off("inputchange",this.onDescendantInputChange_),r.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"updatePositions_",value:function(){var t=this,e=this.bcSet_.items.filter((function(t){return!t.viewProps.get("hidden")})),n=e[0],i=e[e.length-1];this.bcSet_.items.forEach((function(e){var r=[];e===n&&(r.push("first"),t.blade_&&!t.blade_.get("positions").includes("veryfirst")||r.push("veryfirst")),e===i&&(r.push("last"),t.blade_&&!t.blade_.get("positions").includes("verylast")||r.push("verylast")),e.blade.set("positions",r)}))}},{key:"onChildPositionsChange_",value:function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildViewPropsChange_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildDispose_",value:function(){var t=this;this.bcSet_.items.filter((function(t){return t.viewProps.get("disposed")})).forEach((function(e){t.bcSet_.remove(e)}))}},{key:"onChildInputChange_",value:function(t){var e=zt(this.find(Ot),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onChildMonitorUpdate_",value:function(t){var e=Ut(this.find(Rt),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}},{key:"onChildValueChange_",value:function(t){var e=Wt(this.find(yt),t.sender);if(!e)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onDescendantLayout_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onDescendantInputChange_",value:function(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}},{key:"onDescendantMonitorUpdate_",value:function(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}},{key:"onBladePositionsChange_",value:function(){this.updatePositions_()}}]),t}(),Yt=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n),(r=e.call(this,Object.assign(Object.assign({},i),{view:new jt(t,{viewName:"brk",viewProps:i.viewProps})}))).onRackAdd_=r.onRackAdd_.bind(s(r)),r.onRackRemove_=r.onRackRemove_.bind(s(r));var a=new Ht(i.root?void 0:i.blade);return a.emitter.on("add",r.onRackAdd_),a.emitter.on("remove",r.onRackRemove_),r.rack=a,r.viewProps.handleDispose((function(){for(var t=r.rack.children.length-1;t>=0;t--)r.rack.children[t].viewProps.set("disposed",!0)})),r}return C(n,[{key:"onRackAdd_",value:function(t){t.isRoot&&lt(this.view.element,t.bladeController.view.element,t.index)}},{key:"onRackRemove_",value:function(t){t.isRoot&&ct(t.bladeController.view.element)}}]),n}(J),Xt=g("cnt"),Zt=function t(e,n){var i=this;c(this,t),this.className_=g(n.viewName||"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Xt()),n.viewProps.bindClassModifiers(this.element),this.foldable_=n.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),x(this.foldable_,"completed",T(this.element,this.className_(void 0,"cpl")));var r=e.createElement("button");r.classList.add(this.className_("b")),x(n.props,"title",(function(t){l(t)?i.element.classList.add(i.className_(void 0,"not")):i.element.classList.remove(i.className_(void 0,"not"))})),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var a=e.createElement("div");a.classList.add(this.className_("t")),S(n.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;var o=e.createElement("div");o.classList.add(this.className_("m")),this.buttonElement.appendChild(o);var s=n.containerElement;s.classList.add(this.className_("c")),this.element.appendChild(s),this.containerElement=s},Qt=function(t){O(n,t);var e=P(n);function n(t,i){var r,a;c(this,n);var o=wt.create(null===(a=i.expanded)||void 0===a||a),u=new Yt(t,{blade:i.blade,root:i.root,viewProps:i.viewProps});return(r=e.call(this,Object.assign(Object.assign({},i),{rackController:u,view:new Zt(t,{containerElement:u.view.element,foldable:o,props:i.props,viewName:i.root?"rot":void 0,viewProps:i.viewProps})}))).onTitleClick_=r.onTitleClick_.bind(s(r)),r.props=i.props,r.foldable=o,Ct(r.foldable,r.view.containerElement),r.rackController.rack.emitter.on("add",(function(){r.foldable.cleanUpTransition()})),r.rackController.rack.emitter.on("remove",(function(){r.foldable.cleanUpTransition()})),r.view.buttonElement.addEventListener("click",r.onTitleClick_),r}return C(n,[{key:"document",get:function(){return this.view.element.ownerDocument}},{key:"onTitleClick_",value:function(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}]),n}(qt),$t={id:"folder",type:"blade",accept:function(t){var e=H,n=Y(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:function(t){return new Qt(t.document,{blade:t.blade,expanded:t.params.expanded,props:j.fromObject({title:t.params.title}),viewProps:t.viewProps})},api:function(t){return t.controller instanceof Qt?new Bt(t.controller,t.pool):null}},Jt=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{value:i.valueController.value,view:new mt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(yt),te=function(t){O(n,t);var e=P(n);function n(){return c(this,n),e.apply(this,arguments)}return n}(n),ee=g("spr"),ne=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(ee()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("hr");i.classList.add(ee("r")),this.element.appendChild(i)},ie=function(t){O(n,t);var e=P(n);function n(t,i){return c(this,n),e.call(this,Object.assign(Object.assign({},i),{view:new ne(t,{viewProps:i.viewProps})}))}return n}(J),re={id:"separator",type:"blade",accept:function(t){var e=Y(t,{view:H.required.constant("separator")});return e?{params:e}:null},controller:function(t){return new ie(t.document,{blade:t.blade,viewProps:t.viewProps})},api:function(t){return t.controller instanceof ie?new te(t.controller):null}},ae=g("");function oe(t,e){return T(t,ae(void 0,e))}var se=function(t){O(n,t);var e=P(n);function n(t){return c(this,n),e.call(this,t)}return C(n,[{key:"bindClassModifiers",value:function(t){x(this,"disabled",oe(t,"disabled")),x(this,"hidden",oe(t,"hidden"))}},{key:"bindDisabled",value:function(t){x(this,"disabled",(function(e){t.disabled=e}))}},{key:"bindTabIndex",value:function(t){x(this,"disabled",(function(e){t.tabIndex=e?-1:0}))}},{key:"handleDispose",value:function(t){this.value("disposed").emitter.on("change",(function(e){e&&t()}))}}],[{key:"create",value:function(t){var e,i,r=null!=t?t:{},a={disabled:null!==(e=r.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=r.hidden)&&void 0!==i&&i};return new n(j.createCore(a))}}]),n}(j),ue=g("tbi"),le=function t(e,n){var i=this;c(this,t),this.element=e.createElement("div"),this.element.classList.add(ue()),n.viewProps.bindClassModifiers(this.element),x(n.props,"selected",(function(t){t?i.element.classList.add(ue(void 0,"sel")):i.element.classList.remove(ue(void 0,"sel"))}));var r=e.createElement("button");r.classList.add(ue("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var a=e.createElement("div");a.classList.add(ue("t")),S(n.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a},ce=function(){function t(e,n){c(this,t),this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new le(e,{props:n.props,viewProps:n.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return C(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),he=function(){function t(e,n){var i=this;c(this,t),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ce(e,{props:n.itemProps,viewProps:se.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Yt(e,{blade:bt(),viewProps:se.create()}),this.props=n.props,x(this.props,"selected",(function(t){i.itemController.props.set("selected",t),i.contentController.viewProps.set("hidden",!t)}))}return C(t,[{key:"itemController",get:function(){return this.ic_}},{key:"contentController",get:function(){return this.cc_}},{key:"onItemClick_",value:function(){this.props.set("selected",!0)}}]),t}(),pe=function(){function t(e,n){c(this,t),this.controller_=e,this.rackApi_=n}return C(t,[{key:"title",get:function(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.itemController.props.set("title",t)}},{key:"selected",get:function(){return this.controller_.props.get("selected")},set:function(t){this.controller_.props.set("selected",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}}]),t}(),ve=function(t){O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t,new Ft(t.rackController,i))).onPageAdd_=r.onPageAdd_.bind(s(r)),r.onPageRemove_=r.onPageRemove_.bind(s(r)),r.emitter_=new m,r.pageApiMap_=new Map,r.rackApi_.on("change",(function(t){r.emitter_.emit("change",{event:t})})),r.rackApi_.on("update",(function(t){r.emitter_.emit("update",{event:t})})),r.controller_.pageSet.emitter.on("add",r.onPageAdd_),r.controller_.pageSet.emitter.on("remove",r.onPageRemove_),r.controller_.pageSet.items.forEach((function(t){r.setUpPageApi_(t)})),r}return C(n,[{key:"pages",get:function(){var t=this;return this.controller_.pageSet.items.map((function(e){var n=t.pageApiMap_.get(e);if(!n)throw v.shouldNeverHappen();return n}))}},{key:"addPage",value:function(t){var e=this.controller_.view.element.ownerDocument,n=new he(e,{itemProps:j.fromObject({selected:!1,title:t.title}),props:j.fromObject({selected:!1})});this.controller_.add(n,t.index);var i=this.pageApiMap_.get(n);if(!i)throw v.shouldNeverHappen();return i}},{key:"removePage",value:function(t){this.controller_.remove(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpPageApi_",value:function(t){var e=this.rackApi_.apiSet_.find((function(e){return e.controller_===t.contentController}));if(!e)throw v.shouldNeverHappen();var n=new pe(t,e);this.pageApiMap_.set(t,n)}},{key:"onPageAdd_",value:function(t){this.setUpPageApi_(t.item)}},{key:"onPageRemove_",value:function(t){if(!this.pageApiMap_.get(t.item))throw v.shouldNeverHappen();this.pageApiMap_.delete(t.item)}}]),n}(Et),fe=g("tab"),de=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(fe(),Xt()),n.viewProps.bindClassModifiers(this.element),w(n.empty,T(this.element,fe(void 0,"nop")));var i=e.createElement("div");i.classList.add(fe("i")),this.element.appendChild(i),this.itemsElement=i;var r=n.contentsElement;r.classList.add(fe("c")),this.element.appendChild(r),this.contentsElement=r},me=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=new Yt(t,{blade:i.blade,viewProps:i.viewProps}),o=q(!0);return(r=e.call(this,{blade:i.blade,rackController:a,view:new de(t,{contentsElement:a.view.element,empty:o,viewProps:i.viewProps})})).onPageAdd_=r.onPageAdd_.bind(s(r)),r.onPageRemove_=r.onPageRemove_.bind(s(r)),r.onPageSelectedChange_=r.onPageSelectedChange_.bind(s(r)),r.pageSet_=new St((function(){return null})),r.pageSet_.emitter.on("add",r.onPageAdd_),r.pageSet_.emitter.on("remove",r.onPageRemove_),r.empty_=o,r.applyPages_(),r}return C(n,[{key:"pageSet",get:function(){return this.pageSet_}},{key:"add",value:function(t,e){this.pageSet_.add(t,null!=e?e:this.pageSet_.items.length)}},{key:"remove",value:function(t){this.pageSet_.remove(this.pageSet_.items[t])}},{key:"applyPages_",value:function(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}},{key:"onPageAdd_",value:function(t){var e=t.item;lt(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),e.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}},{key:"onPageRemove_",value:function(t){var e=t.item;ct(e.itemController.view.element),this.rackController.rack.remove(e.contentController),e.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}},{key:"keepSelection_",value:function(){if(0!==this.pageSet_.items.length){var t=this.pageSet_.items.findIndex((function(t){return t.props.get("selected")}));t<0?this.pageSet_.items.forEach((function(t,e){t.props.set("selected",0===e)})):this.pageSet_.items.forEach((function(e,n){e.props.set("selected",n===t)}))}}},{key:"onPageSelectedChange_",value:function(t){if(t.rawValue){var e=this.pageSet_.items.findIndex((function(e){return e.props.value("selected")===t.sender}));this.pageSet_.items.forEach((function(t,n){t.props.set("selected",n===e)}))}else this.keepSelection_()}}]),n}(qt),_e={id:"tab",type:"blade",accept:function(t){var e=H,n=Y(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller:function(t){var e=new me(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((function(n){var i=new he(t.document,{itemProps:j.fromObject({selected:!1,title:n.title}),props:j.fromObject({selected:!1})});e.add(i)})),e},api:function(t){return t.controller instanceof me?new ve(t.controller,t.pool):null}};function ge(t,e){var n=t.accept(e.params);if(!n)return null;var i=H.optional.boolean(e.params.disabled).value,r=H.optional.boolean(e.params.hidden).value;return t.controller({blade:bt(),document:e.document,params:u(Object.assign(Object.assign({},n.params),{disabled:i,hidden:r})),viewProps:se.create({disabled:i,hidden:r})})}var ye=function(){function t(){c(this,t),this.disabled=!1,this.emitter=new m}return C(t,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),t}(),be=function(){function t(e,n){c(this,t),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new m,this.interval_=n,this.setTimer_()}return C(t,[{key:"disabled",get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),t}(),we=function(){function t(e){c(this,t),this.constraints=e}return C(t,[{key:"constrain",value:function(t){return this.constraints.reduce((function(t,e){return e.constrain(t)}),t)}}]),t}();function ke(t,e){if(t instanceof e)return t;if(t instanceof we){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var xe=function(){function t(e){c(this,t),this.options=e}return C(t,[{key:"constrain",value:function(t){var e=this.options;return 0===e.length||e.filter((function(e){return e.value===t})).length>0?t:e[0].value}}]),t}(),Ce=function(){function t(e){c(this,t),this.maxValue=e.max,this.minValue=e.min}return C(t,[{key:"constrain",value:function(t){var e=t;return l(this.minValue)||(e=Math.max(e,this.minValue)),l(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}]),t}(),Ee=function(){function t(e){c(this,t),this.step=e}return C(t,[{key:"constrain",value:function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}]),t}(),Me=g("lst"),Te=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.element=e.createElement("div"),this.element.classList.add(Me()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("select");i.classList.add(Me("s")),x(this.props_,"options",(function(t){ht(i),t.forEach((function(t,n){var r=e.createElement("option");r.dataset.index=String(n),r.textContent=t.text,r.value=String(t.value),i.appendChild(r)}))})),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;var r=e.createElement("div");r.classList.add(Me("m")),r.appendChild(ut(e,"dropdown")),this.element.appendChild(r),n.value.emitter.on("change",this.onValueChange_),this.value_=n.value,this.update_()}return C(t,[{key:"update_",value:function(){this.selectElement.value=String(this.value_.rawValue)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Pe=function(){function t(e,n){c(this,t),this.onSelectChange_=this.onSelectChange_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Te(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return C(t,[{key:"onSelectChange_",value:function(t){var e=u(t.currentTarget).selectedOptions.item(0);if(e){var n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}}}]),t}(),Ae=g("pop"),Se=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(Ae()),n.viewProps.bindClassModifiers(this.element),w(n.shows,T(this.element,Ae(void 0,"v")))},Ve=function t(e,n){c(this,t),this.shows=q(!1),this.viewProps=n.viewProps,this.view=new Se(e,{shows:this.shows,viewProps:this.viewProps})},Oe=g("txt"),De=function(){function t(e,n){c(this,t),this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Oe()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var i=e.createElement("input");i.classList.add(Oe("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return C(t,[{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Re=function(){function t(e,n){c(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new De(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return C(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget).value,n=this.parser_(e);l(n)||(this.value.rawValue=n),this.view.refresh()}}]),t}();function Le(t){return String(t)}function Ie(t){return"false"!==t&&!!t}function Ne(t){return Le(t)}var Fe=function(){function t(e){c(this,t),this.text=e}return C(t,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),t}(),Be={"**":function(t,e){return Math.pow(t,e)},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<<":function(t,e){return t<<e},">>":function(t,e){return t>>e},">>>":function(t,e){return t>>>e},"&":function(t,e){return t&e},"^":function(t,e){return t^e},"|":function(t,e){return t|e}},qe=function(){function t(e,n,i){c(this,t),this.left=n,this.operator=e,this.right=i}return C(t,[{key:"evaluate",value:function(){var t=Be[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),t}(),je={"+":function(t){return t},"-":function(t){return-t},"~":function(t){return~t}},ze=function(){function t(e,n){c(this,t),this.operator=e,this.expression=n}return C(t,[{key:"evaluate",value:function(){var t=je[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),t}();function Ue(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i](e,n);if(""!==r)return r}return""}}function We(t,e){var n,i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ge(t,e){var n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Ke(t,e){var n,i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function He(t,e){var n=Ke(t,e);if(""!==n)return n;var i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";var r=Ke(t,e+=1);return""===r?"":i+r}function Ye(t,e){var n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";var i=He(t,e);return""===i?"":n+i}function Xe(t,e){var n=t.substr(e,1);if("0"===n)return n;var i=Ge(t,e);return e+=i.length,""===i?"":i+Ke(t,e)}function Ze(t,e){var n=Xe(t,e);if(e+=n.length,""===n)return"";var i=t.substr(e,1);if(e+=i.length,"."!==i)return"";var r=Ke(t,e);return n+i+r+Ye(t,e+=r.length)}function Qe(t,e){var n=t.substr(e,1);if(e+=n.length,"."!==n)return"";var i=Ke(t,e);return e+=i.length,""===i?"":n+i+Ye(t,e)}function $e(t,e){var n=Xe(t,e);return e+=n.length,""===n?"":n+Ye(t,e)}var Je=Ue([Ze,Qe,$e]);function tn(t,e){var n,i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function en(t,e){var n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";var i=tn(t,e);return""===i?"":n+i}function nn(t,e){var n,i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function rn(t,e){var n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";var i=nn(t,e);return""===i?"":n+i}function an(t,e){var n,i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function on(t,e){var n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";var i=an(t,e);return""===i?"":n+i}var sn=Ue([en,rn,on]),un=Ue([sn,Je]);function ln(t,e){var n=un(t,e);return e+=n.length,""===n?null:{evaluable:new Fe(n),cursor:e}}function cn(t,e){var n=t.substr(e,1);if(e+=n.length,"("!==n)return null;var i=mn(t,e);if(!i)return null;e=i.cursor,e+=We(t,e).length;var r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function hn(t,e){return ln(t,e)||cn(t,e)}function pn(t,e){var n=hn(t,e);if(n)return n;var i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;var r=pn(t,e);return r?{cursor:e=r.cursor,evaluable:new ze(i,r.evaluable)}:null}function vn(t,e,n){n+=We(e,n).length;var i=t.filter((function(t){return e.startsWith(t,n)}))[0];return i?(n+=i.length,{cursor:n+=We(e,n).length,operator:i}):null}function fn(t,e){return function(n,i){var r=t(n,i);if(!r)return null;i=r.cursor;for(var a=r.evaluable;;){var o=vn(e,n,i);if(!o)break;i=o.cursor;var s=t(n,i);if(!s)return null;i=s.cursor,a=new qe(o.operator,a,s.evaluable)}return a?{cursor:i,evaluable:a}:null}}var dn=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(t,e){return fn(t,e)}),pn);function mn(t,e){return e+=We(t,e).length,dn(t,e)}function _n(t){var e=mn(t,0);return e?e.cursor+We(t,e.cursor).length!==t.length?null:e.evaluable:null}function gn(t){var e,n=_n(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function yn(t){if("number"==typeof t)return t;if("string"==typeof t){var e=gn(t);if(!l(e))return e}return 0}function bn(t){return String(t)}function wn(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}var kn=wn(0);function xn(t){return kn(t)+"%"}function Cn(t){return String(t)}function En(t){return t}function Mn(t,e){for(;t.length<e;)t.push(void 0)}function Tn(t){var e=[];return Mn(e,t),q(e)}function Pn(t){var e=t.indexOf(void 0);return u(e<0?t:t.slice(0,e))}function An(t,e){var n=B(Pn(t)).concat([e]);return n.length>t.length?n.splice(0,n.length-t.length):Mn(n,t.length),n}function Sn(t){var e=t.primary,n=t.secondary,i=t.forward,r=t.backward,a=!1;function o(t){a||(a=!0,t(),a=!1)}e.emitter.on("change",(function(t){o((function(){n.setRawValue(i(e,n),t.options)}))})),n.emitter.on("change",(function(t){o((function(){e.setRawValue(r(e,n),t.options)})),o((function(){n.setRawValue(i(e,n),t.options)}))})),o((function(){n.setRawValue(i(e,n),{forceEmit:!1,last:!0})}))}function Vn(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function On(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Dn(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Rn(t){return"ArrowUp"===t||"ArrowDown"===t}function Ln(t){return Rn(t)||"ArrowLeft"===t||"ArrowRight"===t}function In(t,e){var n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}var Nn=function(){function t(e){c(this,t),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new m,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return C(t,[{key:"computePosition_",value:function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}},{key:"onMouseDown_",value:function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(In(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseMove_",value:function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(In(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseUp_",value:function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(In(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onTouchStart_",value:function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchMove_",value:function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchEnd_",value:function(t){var e,n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}]),t}();function Fn(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function Bn(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function qn(t,e,n){return Math.min(Math.max(t,e),n)}function jn(t,e){return(t%e+e)%e}var zn=g("txt"),Un=function(){function t(e,n){c(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(zn(),zn(void 0,"num")),n.arrayPosition&&this.element.classList.add(zn(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(zn("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(zn()),this.inputElement.classList.add(zn("i"));var r=e.createElement("div");r.classList.add(zn("k")),this.element.appendChild(r),this.knobElement=r;var a=e.createElementNS(tt,"svg");a.classList.add(zn("g")),this.knobElement.appendChild(a);var o=e.createElementNS(tt,"path");o.classList.add(zn("gb")),a.appendChild(o),this.guideBodyElem_=o;var s=e.createElementNS(tt,"path");s.classList.add(zn("gh")),a.appendChild(s),this.guideHeadElem_=s;var u=e.createElement("div");u.classList.add(g("tt")()),this.knobElement.appendChild(u),this.tooltipElem_=u,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return C(t,[{key:"onDraggingChange_",value:function(t){if(null!==t.rawValue){this.element.classList.add(zn(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=qn(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+i,",0 L").concat(n,",4 L").concat(n+i,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")}else this.element.classList.remove(zn(void 0,"drg"))}},{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Wn=function(){function t(e,n){c(this,t),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=q(null),this.view=new Un(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new Nn(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return C(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget).value,n=this.parser_(e);l(n)||(this.value.rawValue=n),this.view.refresh()}},{key:"onInputKeyDown_",value:function(t){var e=Vn(this.baseStep_,On(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(t){0!==Vn(this.baseStep_,On(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}},{key:"onPointerMove_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),t}(),Gn=g("sld"),Kn=function(){function t(e,n){c(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Gn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(Gn("t")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;var r=e.createElement("div");r.classList.add(Gn("k")),this.trackElement.appendChild(r),this.knobElement=r,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.update_()}return C(t,[{key:"update_",value:function(){var t=qn(Fn(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width="".concat(t,"%")}},{key:"onChange_",value:function(){this.update_()}}]),t}(),Hn=function(){function t(e,n){c(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.value=n.value,this.viewProps=n.viewProps,this.props=n.props,this.view=new Kn(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Nn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return C(t,[{key:"handlePointerEvent_",value:function(t,e){t.point&&this.value.setRawValue(Fn(qn(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}},{key:"onPointerDownOrMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Vn(this.baseStep_,Dn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){0!==Vn(this.baseStep_,Dn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),Yn=g("sldtxt"),Xn=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(Yn());var i=e.createElement("div");i.classList.add(Yn("s")),this.sliderView_=n.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Yn("t")),this.textView_=n.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)},Zn=function(){function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.sliderC_=new Hn(e,{baseStep:n.baseStep,props:n.sliderProps,value:n.value,viewProps:this.viewProps}),this.textC_=new Wn(e,{baseStep:n.baseStep,parser:n.parser,props:n.textProps,value:n.value,viewProps:n.viewProps}),this.view=new Xn(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return C(t,[{key:"sliderController",get:function(){return this.sliderC_}},{key:"textController",get:function(){return this.textC_}}]),t}();function Qn(t,e){t.write(e)}function $n(t){var e=H;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Jn(t){if("inline"===t||"popup"===t)return t}function ti(t){var e=H;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function ei(t){if(Array.isArray(t))return t;var e=[];return Object.keys(t).forEach((function(n){e.push({text:n,value:t[n]})})),e}function ni(t){return l(t)?null:new xe(ei(u(t)))}function ii(t){var e=t?ke(t,xe):null;return e?e.options:null}function ri(t){var e=t?ke(t,Ee):null;return e?e.step:null}function ai(t,e){var n=t&&ke(t,Ee);return n?Bn(n.step):Math.max(Bn(e),2)}function oi(t){var e=ri(t);return null!=e?e:1}function si(t,e){var n,i=t&&ke(t,Ee),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}var ui=g("ckb"),li=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ui()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("label");i.classList.add(ui("l")),this.element.appendChild(i);var r=e.createElement("input");r.classList.add(ui("i")),r.type="checkbox",i.appendChild(r),this.inputElement=r,n.viewProps.bindDisabled(this.inputElement);var a=e.createElement("div");a.classList.add(ui("w")),i.appendChild(a);var o=ut(e,"check");a.appendChild(o),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return C(t,[{key:"update_",value:function(){this.inputElement.checked=this.value.rawValue}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),ci=function(){function t(e,n){c(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new li(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return C(t,[{key:"onInputChange_",value:function(t){var e=u(t.currentTarget);this.value.rawValue=e.checked}}]),t}();function hi(t){var e=[],n=ni(t.options);return n&&e.push(n),new we(e)}var pi={id:"input-bool",type:"input",accept:function(t,e){if("boolean"!=typeof t)return null;var n=Y(e,{options:H.optional.custom($n)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Ie},constraint:function(t){return hi(t.params)},writer:function(t){return Qn}},controller:function(t){var e,n=t.document,i=t.value,r=t.constraint;return r&&ke(r,xe)?new Pe(n,{props:j.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new ci(n,{value:i,viewProps:t.viewProps})}},vi=g("col"),fi=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(vi()),n.foldable.bindExpandedClass(this.element,vi(void 0,"expanded")),x(n.foldable,"completed",T(this.element,vi(void 0,"cpl")));var i=e.createElement("div");i.classList.add(vi("h")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(vi("s")),i.appendChild(r),this.swatchElement=r;var a=e.createElement("div");if(a.classList.add(vi("t")),i.appendChild(a),this.textElement=a,"inline"===n.pickerLayout){var o=e.createElement("div");o.classList.add(vi("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null};function di(t,e,n){var i=qn(t/255,0,1),r=qn(e/255,0,1),a=qn(n/255,0,1),o=Math.max(i,r,a),s=Math.min(i,r,a),u=o-s,l=0,c=0,h=(s+o)/2;return 0!==u&&(c=u/(1-Math.abs(o+s-1)),l=(l=i===o?(r-a)/u:r===o?2+(a-i)/u:4+(i-r)/u)/6+(l<0?1:0)),[360*l,100*c,100*h]}function mi(t,e,n){var i,r,a,o,s,u,l,c,h,p=(t%360+360)%360,v=qn(e/100,0,1),f=qn(n/100,0,1),d=(1-Math.abs(2*f-1))*v,m=d*(1-Math.abs(p/60%2-1)),_=f-d/2;return p>=0&&p<60?(i=(o=[d,m,0])[0],r=o[1],a=o[2]):p>=60&&p<120?(i=(s=[m,d,0])[0],r=s[1],a=s[2]):p>=120&&p<180?(i=(u=[0,d,m])[0],r=u[1],a=u[2]):p>=180&&p<240?(i=(l=[0,m,d])[0],r=l[1],a=l[2]):p>=240&&p<300?(i=(c=[m,0,d])[0],r=c[1],a=c[2]):(i=(h=[d,0,m])[0],r=h[1],a=h[2]),[255*(i+_),255*(r+_),255*(a+_)]}function _i(t,e,n){var i=qn(t/255,0,1),r=qn(e/255,0,1),a=qn(n/255,0,1),o=Math.max(i,r,a),s=o-Math.min(i,r,a);return[0===s?0:o===i?((r-a)/s%6+6)%6*60:o===r?60*((a-i)/s+2):60*((i-r)/s+4),100*(0===o?0:s/o),100*o]}function gi(t,e,n){var i,r,a,o,s,u,l,c,h,p=jn(t,360),v=qn(e/100,0,1),f=qn(n/100,0,1),d=f*v,m=d*(1-Math.abs(p/60%2-1)),_=f-d;return p>=0&&p<60?(i=(o=[d,m,0])[0],r=o[1],a=o[2]):p>=60&&p<120?(i=(s=[m,d,0])[0],r=s[1],a=s[2]):p>=120&&p<180?(i=(u=[0,d,m])[0],r=u[1],a=u[2]):p>=180&&p<240?(i=(l=[0,m,d])[0],r=l[1],a=l[2]):p>=240&&p<300?(i=(c=[m,0,d])[0],r=c[1],a=c[2]):(i=(h=[d,0,m])[0],r=h[1],a=h[2]),[255*(i+_),255*(r+_),255*(a+_)]}function yi(t,e,n){var i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]}function bi(t,e,n){var i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]}function wi(t){return[t[0],t[1],t[2]]}function ki(t,e){return[t[0],t[1],t[2],e]}var xi={hsl:{hsl:function(t,e,n){return[t,e,n]},hsv:yi,rgb:mi},hsv:{hsl:bi,hsv:function(t,e,n){return[t,e,n]},rgb:gi},rgb:{hsl:di,hsv:_i,rgb:function(t,e,n){return[t,e,n]}}};function Ci(t,e,n){var i;return(i=xi[e])[n].apply(i,B(t))}var Ei={hsl:function(t){var e;return[jn(t[0],360),qn(t[1],0,100),qn(t[2],0,100),qn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:function(t){var e;return[jn(t[0],360),qn(t[1],0,100),qn(t[2],0,100),qn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:function(t){var e;return[qn(t[0],0,255),qn(t[1],0,255),qn(t[2],0,255),qn(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function Mi(t,e){return"object"==typeof t&&!l(t)&&e in t&&"number"==typeof t[e]}var Ti=function(){function t(e,n){c(this,t),this.mode_=n,this.comps_=Ei[n](e)}return C(t,[{key:"mode",get:function(){return this.mode_}},{key:"getComponents",value:function(t){return ki(Ci(wi(this.comps_),this.mode_,t||this.mode_),this.comps_[3])}},{key:"toRgbaObject",value:function(){var t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}],[{key:"black",value:function(){return new t([0,0,0],"rgb")}},{key:"fromObject",value:function(e){return new t("a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b],"rgb")}},{key:"toRgbaObject",value:function(t){return t.toRgbaObject()}},{key:"isRgbColorObject",value:function(t){return Mi(t,"r")&&Mi(t,"g")&&Mi(t,"b")}},{key:"isRgbaColorObject",value:function(t){return this.isRgbColorObject(t)&&Mi(t,"a")}},{key:"isColorObject",value:function(t){return this.isRgbColorObject(t)}},{key:"equals",value:function(t,e){if(t.mode_!==e.mode_)return!1;for(var n=t.comps_,i=e.comps_,r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}}]),t}(),Pi=g("colp"),Ai=function(){function t(e,n){c(this,t),this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Pi());var i=e.createElement("div");i.classList.add(Pi("hsv"));var r=e.createElement("div");r.classList.add(Pi("sv")),this.svPaletteView_=n.svPaletteView,r.appendChild(this.svPaletteView_.element),i.appendChild(r);var a=e.createElement("div");a.classList.add(Pi("h")),this.hPaletteView_=n.hPaletteView,a.appendChild(this.hPaletteView_.element),i.appendChild(a),this.element.appendChild(i);var o=e.createElement("div");if(o.classList.add(Pi("rgb")),this.textView_=n.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),n.alphaViews){this.alphaViews_={palette:n.alphaViews.palette,text:n.alphaViews.text};var s=e.createElement("div");s.classList.add(Pi("a"));var u=e.createElement("div");u.classList.add(Pi("ap")),u.appendChild(this.alphaViews_.palette.element),s.appendChild(u);var l=e.createElement("div");l.classList.add(Pi("at")),l.appendChild(this.alphaViews_.text.element),s.appendChild(l),this.element.appendChild(s)}}return C(t,[{key:"allFocusableElements",get:function(){var t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement].concat(B(this.textView_.textViews.map((function(t){return t.inputElement}))));return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}]),t}();function Si(t){var e=H;return Y(t,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Jn)})}function Vi(t){return t?.1:1}function Oi(t,e){var n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}var Di={deg:function(t){return t},grad:function(t){return 360*t/400},rad:function(t){return 360*t/(2*Math.PI)},turn:function(t){return 360*t}};function Ri(t){var e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);var n=parseFloat(e[1]),i=e[2];return Di[i](n)}var Li={"func.rgb":function(t){var e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Oi(e[1],255),Oi(e[2],255),Oi(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Ti(n,"rgb")},"func.rgba":function(t){var e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Oi(e[1],255),Oi(e[2],255),Oi(e[3],255),Oi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Ti(n,"rgb")},"func.hsl":function(t){var e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Ri(e[1]),Oi(e[2],100),Oi(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new Ti(n,"hsl")},"func.hsla":function(t){var e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Ri(e[1]),Oi(e[2],100),Oi(e[3],100),Oi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new Ti(n,"hsl")},"hex.rgb":function(t){var e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Ti([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");var n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Ti([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":function(t){var e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new Ti([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Fn(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");var n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new Ti([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Fn(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function Ii(t){return Object.keys(Li).reduce((function(e,n){return e||((0,Li[n])(t)?n:null)}),null)}var Ni=function(t){var e=Ii(t);return e?Li[e](t):null};function Fi(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Bi(t){if("string"==typeof t){var e=Ni(t);if(e)return e}return Ti.black()}function qi(t){var e=qn(Math.floor(t),0,255).toString(16);return 1===e.length?"0".concat(e):e}function ji(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=wi(t.getComponents("rgb")).map(qi).join("");return"".concat(e).concat(n)}function zi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=t.getComponents("rgb"),i=[n[0],n[1],n[2],255*n[3]].map(qi).join("");return"".concat(e).concat(i)}function Ui(t){var e=wn(0),n=wi(t.getComponents("rgb")).map((function(t){return e(t)}));return"rgb(".concat(n.join(", "),")")}function Wi(t){var e=wn(2),n=wn(0),i=t.getComponents("rgb").map((function(t,i){return(3===i?e:n)(t)}));return"rgba(".concat(i.join(", "),")")}function Gi(t){var e=[wn(0),xn,xn],n=wi(t.getComponents("hsl")).map((function(t,n){return e[n](t)}));return"hsl(".concat(n.join(", "),")")}function Ki(t){var e=[wn(0),xn,xn,wn(2)],n=t.getComponents("hsl").map((function(t,n){return e[n](t)}));return"hsla(".concat(n.join(", "),")")}var Hi={"func.hsl":Gi,"func.hsla":Ki,"func.rgb":Ui,"func.rgba":Wi,"hex.rgb":ji,"hex.rgba":zi};function Yi(t){return Hi[t]}var Xi=g("apl"),Zi=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Xi()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(Xi("b")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(Xi("c")),i.appendChild(r),this.colorElem_=r;var a=e.createElement("div");a.classList.add(Xi("m")),this.element.appendChild(a),this.markerElem_=a;var o=e.createElement("div");o.classList.add(Xi("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return C(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t.getComponents("rgb"),n=new Ti([e[0],e[1],e[2],0],"rgb"),i=new Ti([e[0],e[1],e[2],255],"rgb"),r=["to right",Wi(n),Wi(i)];this.colorElem_.style.background="linear-gradient(".concat(r.join(","),")"),this.previewElem_.style.backgroundColor=Wi(t);var a=Fn(e[3],0,1,0,100);this.markerElem_.style.left="".concat(a,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Qi=function(){function t(e,n){c(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Zi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Nn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return C(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=t.point.x/t.bounds.width,i=F(this.value.rawValue.getComponents("hsv"),3),r=i[0],a=i[1],o=i[2];this.value.setRawValue(new Ti([r,a,o,n],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Vn(Vi(!0),Dn(t));if(0!==e){var n=F(this.value.rawValue.getComponents("hsv"),4),i=n[0],r=n[1],a=n[2],o=n[3];this.value.setRawValue(new Ti([i,r,a,o+e],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==Vn(Vi(!0),Dn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),$i=g("coltxt");function Ji(t){var e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce((function(e,n){var i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}var tr=function(){function t(e,n){var i=this;c(this,t),this.element=e.createElement("div"),this.element.classList.add($i());var r=e.createElement("div");r.classList.add($i("m")),this.modeElem_=Ji(e),this.modeElem_.classList.add($i("ms")),r.appendChild(this.modeSelectElement);var a=e.createElement("div");a.classList.add($i("mm")),a.appendChild(ut(e,"dropdown")),r.appendChild(a),this.element.appendChild(r);var o=e.createElement("div");o.classList.add($i("w")),this.element.appendChild(o),this.textsElem_=o,this.textViews_=n.textViews,this.applyTextViews_(),w(n.colorMode,(function(t){i.modeElem_.value=t}))}return C(t,[{key:"modeSelectElement",get:function(){return this.modeElem_}},{key:"textViews",get:function(){return this.textViews_},set:function(t){this.textViews_=t,this.applyTextViews_()}},{key:"applyTextViews_",value:function(){var t=this;ht(this.textsElem_);var e=this.element.ownerDocument;this.textViews_.forEach((function(n){var i=e.createElement("div");i.classList.add($i("c")),i.appendChild(n.element),t.textsElem_.appendChild(i)}))}}]),t}(),er=wn(0),nr={rgb:function(){return new Ce({min:0,max:255})},hsl:function(t){return new Ce(0===t?{min:0,max:360}:{min:0,max:100})},hsv:function(t){return new Ce(0===t?{min:0,max:360}:{min:0,max:100})}};function ir(t,e,n){return new Wn(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:Vi(!1),parser:e.parser,props:j.fromObject({draggingScale:1,formatter:er}),value:q(0,{constraint:nr[e.colorMode](n)}),viewProps:e.viewProps})}var rr=function(){function t(e,n){c(this,t),this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=n.parser,this.value=n.value,this.viewProps=n.viewProps,this.colorMode=q(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new tr(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return C(t,[{key:"createComponentControllers_",value:function(t){var e=this,n={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},i=[ir(t,n,0),ir(t,n,1),ir(t,n,2)];return i.forEach((function(t,n){var i=e;Sn({primary:e.value,secondary:t.value,forward:function(t){return t.rawValue.getComponents(i.colorMode.rawValue)[n]},backward:function(t,e){var r=i.colorMode.rawValue,a=t.rawValue.getComponents(r);return a[n]=e.rawValue,new Ti(ki(wi(a),a[3]),r)}})})),i}},{key:"onModeSelectChange_",value:function(t){var e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}]),t}(),ar=g("hpl"),or=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ar()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("div");i.classList.add(ar("c")),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(ar("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return C(t,[{key:"update_",value:function(){var t=F(this.value.rawValue.getComponents("hsv"),1)[0];this.markerElem_.style.backgroundColor=Ui(new Ti([t,100,100],"hsv"));var e=Fn(t,0,360,0,100);this.markerElem_.style.left="".concat(e,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),sr=function(){function t(e,n){c(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new or(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Nn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return C(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Fn(qn(t.point.x,0,t.bounds.width),0,t.bounds.width,0,359),i=F(this.value.rawValue.getComponents("hsv"),4),r=i[1],a=i[2],o=i[3];this.value.setRawValue(new Ti([n,r,a,o],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Vn(Vi(!1),Dn(t));if(0!==e){var n=F(this.value.rawValue.getComponents("hsv"),4),i=n[0],r=n[1],a=n[2],o=n[3];this.value.setRawValue(new Ti([i+e,r,a,o],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==Vn(Vi(!1),Dn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),ur=g("svp"),lr=64,cr=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ur()),n.viewProps.bindTabIndex(this.element);var i=e.createElement("canvas");i.height=lr,i.width=lr,i.classList.add(ur("c")),this.element.appendChild(i),this.canvasElement=i;var r=e.createElement("div");r.classList.add(ur("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return C(t,[{key:"update_",value:function(){var t=ot(this.canvasElement);if(t){for(var e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,r=t.getImageData(0,0,n,i),a=r.data,o=0;o<i;o++)for(var s=0;s<n;s++){var u=Fn(s,0,n,0,100),l=Fn(o,0,i,100,0),c=gi(e[0],u,l),h=4*(o*n+s);a[h]=c[0],a[h+1]=c[1],a[h+2]=c[2],a[h+3]=255}t.putImageData(r,0,0);var p=Fn(e[1],0,100,0,100);this.markerElem_.style.left="".concat(p,"%");var v=Fn(e[2],0,100,100,0);this.markerElem_.style.top="".concat(v,"%")}}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),hr=function(){function t(e,n){c(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new cr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Nn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return C(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Fn(t.point.x,0,t.bounds.width,0,100),i=Fn(t.point.y,0,t.bounds.height,100,0),r=F(this.value.rawValue.getComponents("hsv"),4),a=r[0],o=r[3];this.value.setRawValue(new Ti([a,n,i,o],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){Ln(t.key)&&t.preventDefault();var e=F(this.value.rawValue.getComponents("hsv"),4),n=e[0],i=e[1],r=e[2],a=e[3],o=Vi(!1),s=Vn(o,Dn(t)),u=Vn(o,On(t));0===s&&0===u||this.value.setRawValue(new Ti([n,i+s,r+u,a],"hsv"),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){var e=Vi(!1),n=Vn(e,Dn(t)),i=Vn(e,On(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),pr=function(){function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.hPaletteC_=new sr(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new hr(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=n.supportsAlpha?{palette:new Qi(e,{value:this.value,viewProps:this.viewProps}),text:new Wn(e,{parser:gn,baseStep:.1,props:j.fromObject({draggingScale:.01,formatter:wn(2)}),value:q(0,{constraint:new Ce({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Sn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(t){return t.rawValue.getComponents()[3]},backward:function(t,e){var n=t.rawValue.getComponents();return n[3]=e.rawValue,new Ti(n,t.rawValue.mode)}}),this.textC_=new rr(e,{parser:gn,value:this.value,viewProps:this.viewProps}),this.view=new Ai(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:n.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}return C(t,[{key:"textController",get:function(){return this.textC_}}]),t}(),vr=g("colsw"),fr=function(){function t(e,n){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.element=e.createElement("div"),this.element.classList.add(vr()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(vr("sw")),this.element.appendChild(i),this.swatchElem_=i;var r=e.createElement("button");r.classList.add(vr("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}return C(t,[{key:"update_",value:function(){var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=zi(t)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),dr=function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new fr(e,{value:this.value,viewProps:this.viewProps})},mr=function(){function t(e,n){var i=this;c(this,t),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=wt.create(n.expanded),this.swatchC_=new dr(e,{value:this.value,viewProps:this.viewProps});var r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new Re(e,{parser:n.parser,props:j.fromObject({formatter:n.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new fi(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===n.pickerLayout?new Ve(e,{viewProps:this.viewProps}):null;var a=new pr(e,{supportsAlpha:n.supportsAlpha,value:this.value,viewProps:this.viewProps});a.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",i.onPopupChildBlur_),t.addEventListener("keydown",i.onPopupChildKeydown_)})),this.pickerC_=a,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(a.view.element),Sn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ct(this.foldable_,this.view.pickerElement))}return C(t,[{key:"textController",get:function(){return this.textC_}},{key:"onButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=u(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=vt(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!it(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}]),t}();function _r(t){return Ti.isColorObject(t)?Ti.fromObject(t):Ti.black()}function gr(t){return wi(t.getComponents("rgb")).reduce((function(t,e){return t<<8|255&Math.floor(e)}),0)}function yr(t){return t.getComponents("rgb").reduce((function(t,e,n){return t<<8|255&Math.floor(3===n?255*e:e)}),0)>>>0}function br(t){return new Ti([t>>16&255,t>>8&255,255&t],"rgb")}function wr(t){return new Ti([t>>24&255,t>>16&255,t>>8&255,Fn(255&t,0,255,0,1)],"rgb")}function kr(t){return"number"!=typeof t?Ti.black():br(t)}function xr(t){return"number"!=typeof t?Ti.black():wr(t)}function Cr(t){var e=Yi(t);return function(t,n){Qn(t,e(n))}}function Er(t){var e=t?yr:gr;return function(t,n){Qn(t,e(n))}}function Mr(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function Tr(t,e){var n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function Pr(t){return t?Mr:Tr}function Ar(t){return"alpha"in t&&!0===t.alpha}function Sr(t){return t?function(t){return zi(t,"0x")}:function(t){return ji(t,"0x")}}var Vr={id:"input-color-number",type:"input",accept:function(t,e){if("number"!=typeof t)return null;if(!("view"in e))return null;if("color"!==e.view)return null;var n=Si(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Ar(t.params)?xr:kr},equals:Ti.equals,writer:function(t){return Er(Ar(t.params))}},controller:function(t){var e=Ar(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new mr(t.document,{expanded:null!=n&&n,formatter:Sr(e),parser:Ni,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function Or(t){return Ti.isRgbaColorObject(t)}var Dr={id:"input-color-object",type:"input",accept:function(t,e){if(!Ti.isColorObject(t))return null;var n=Si(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return _r},equals:Ti.equals,writer:function(t){return Pr(Or(t.initialValue))}},controller:function(t){var e=Ti.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,r=e?zi:ji;return new mr(t.document,{expanded:null!=n&&n,formatter:r,parser:Ni,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},Rr={id:"input-color-string",type:"input",accept:function(t,e){if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;if(!Ii(t))return null;var n=Si(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Bi},equals:Ti.equals,writer:function(t){var e=Ii(t.initialValue);if(!e)throw v.shouldNeverHappen();return Cr(e)}},controller:function(t){var e=Ii(t.initialValue);if(!e)throw v.shouldNeverHappen();var n=Yi(e),i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new mr(t.document,{expanded:null!=i&&i,formatter:n,parser:Ni,pickerLayout:null!=r?r:"popup",supportsAlpha:Fi(e),value:t.value,viewProps:t.viewProps})}},Lr=function(){function t(e){c(this,t),this.components=e.components,this.asm_=e.assembly}return C(t,[{key:"constrain",value:function(t){var e=this,n=this.asm_.toComponents(t).map((function(t,n){var i,r;return null!==(r=null===(i=e.components[n])||void 0===i?void 0:i.constrain(t))&&void 0!==r?r:t}));return this.asm_.fromComponents(n)}}]),t}(),Ir=g("pndtxt"),Nr=function t(e,n){var i=this;c(this,t),this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(Ir()),this.textViews.forEach((function(t){var n=e.createElement("div");n.classList.add(Ir("a")),n.appendChild(t.element),i.element.appendChild(n)}))};function Fr(t,e,n){return new Wn(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:q(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}var Br=function t(e,n){var i=this;c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(t,i){return Fr(e,n,i)})),this.acs_.forEach((function(t,e){Sn({primary:i.value,secondary:t.value,forward:function(t){return n.assembly.toComponents(t.rawValue)[e]},backward:function(t,i){var r=n.assembly.toComponents(t.rawValue);return r[e]=i.rawValue,n.assembly.fromComponents(r)}})})),this.view=new Nr(e,{textViews:this.acs_.map((function(t){return t.view}))})};function qr(t){return"step"in t&&!l(t.step)?new Ee(t.step):null}function jr(t){return"max"in t&&!l(t.max)||"min"in t&&!l(t.min)?new Ce({max:t.max,min:t.min}):null}function zr(t){var e=[],n=qr(t);n&&e.push(n);var i=jr(t);i&&e.push(i);var r=ni(t.options);return r&&e.push(r),new we(e)}function Ur(t){var e=t?ke(t,Ce):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Wr(t){var e=F(Ur(t),2),n=e[0],i=e[1];return[null!=n?n:0,null!=i?i:100]}var Gr={id:"input-number",type:"input",accept:function(t,e){if("number"!=typeof t)return null;var n=H,i=Y(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom($n),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return yn},constraint:function(t){return zr(t.params)},writer:function(t){return Qn}},controller:function(t){var e,n,i=t.value,r=t.constraint;if(r&&ke(r,xe))return new Pe(t.document,{props:j.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps});var a=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:wn(ai(r,i.rawValue));if(r&&ke(r,Ce)){var o=F(Wr(r),2),s=o[0],u=o[1];return new Zn(t.document,{baseStep:oi(r),parser:gn,sliderProps:j.fromObject({maxValue:u,minValue:s}),textProps:j.fromObject({draggingScale:si(r,i.rawValue),formatter:a}),value:i,viewProps:t.viewProps})}return new Wn(t.document,{baseStep:oi(r),parser:gn,props:j.fromObject({draggingScale:si(r,i.rawValue),formatter:a}),value:i,viewProps:t.viewProps})}},Kr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c(this,t),this.x=e,this.y=n}return C(t,[{key:"getComponents",value:function(){return[this.x,this.y]}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}],[{key:"isObject",value:function(t){if(l(t))return!1;var e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}}]),t}(),Hr={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return k(Kr,B(t))}},Yr=g("p2d"),Xr=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(Yr()),n.viewProps.bindClassModifiers(this.element),w(n.expanded,T(this.element,Yr(void 0,"expanded")));var i=e.createElement("div");i.classList.add(Yr("h")),this.element.appendChild(i);var r=e.createElement("button");r.classList.add(Yr("b")),r.appendChild(ut(e,"p2dpad")),n.viewProps.bindDisabled(r),i.appendChild(r),this.buttonElement=r;var a=e.createElement("div");if(a.classList.add(Yr("t")),i.appendChild(a),this.textElement=a,"inline"===n.pickerLayout){var o=e.createElement("div");o.classList.add(Yr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null},Zr=g("p2dp"),Qr=function(){function t(e,n){c(this,t),this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=n.invertsY,this.maxValue_=n.maxValue,this.element=e.createElement("div"),this.element.classList.add(Zr()),"popup"===n.layout&&this.element.classList.add(Zr(void 0,"p"));var i=e.createElement("div");i.classList.add(Zr("p")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;var r=e.createElementNS(tt,"svg");r.classList.add(Zr("g")),this.padElement.appendChild(r),this.svgElem_=r;var a=e.createElementNS(tt,"line");a.classList.add(Zr("ax")),a.setAttributeNS(null,"x1","0"),a.setAttributeNS(null,"y1","50%"),a.setAttributeNS(null,"x2","100%"),a.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(a);var o=e.createElementNS(tt,"line");o.classList.add(Zr("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var s=e.createElementNS(tt,"line");s.classList.add(Zr("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;var u=e.createElement("div");u.classList.add(Zr("m")),this.padElement.appendChild(u),this.markerElem_=u,n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return C(t,[{key:"allFocusableElements",get:function(){return[this.padElement]}},{key:"update_",value:function(){var t=F(this.value.rawValue.getComponents(),2),e=t[0],n=t[1],i=this.maxValue_,r=Fn(e,-i,+i,0,100),a=Fn(n,-i,+i,0,100),o=this.invertsY_?100-a:a;this.lineElem_.setAttributeNS(null,"x2","".concat(r,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(o,"%")),this.markerElem_.style.left="".concat(r,"%"),this.markerElem_.style.top="".concat(o,"%")}},{key:"onValueChange_",value:function(){this.update_()}},{key:"onFoldableChange_",value:function(){this.update_()}}]),t}();function $r(t,e,n){return[Vn(e[0],Dn(t)),Vn(e[1],On(t))*(n?1:-1)]}var Jr=function(){function t(e,n){c(this,t),this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.baseSteps_=n.baseSteps,this.maxValue_=n.maxValue,this.invertsY_=n.invertsY,this.view=new Qr(e,{invertsY:this.invertsY_,layout:n.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Nn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return C(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=this.maxValue_,i=Fn(t.point.x,0,t.bounds.width,-n,+n),r=Fn(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new Kr(i,r),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onPadKeyDown_",value:function(t){Ln(t.key)&&t.preventDefault();var e=F($r(t,this.baseSteps_,this.invertsY_),2),n=e[0],i=e[1];0===n&&0===i||this.value.setRawValue(new Kr(this.value.rawValue.x+n,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}},{key:"onPadKeyUp_",value:function(t){var e=F($r(t,this.baseSteps_,this.invertsY_),2),n=e[0],i=e[1];0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),ta=function(){function t(e,n){var i,r,a=this;c(this,t),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=wt.create(n.expanded),this.popC_="popup"===n.pickerLayout?new Ve(e,{viewProps:this.viewProps}):null;var o=new Jr(e,{baseSteps:[n.axes[0].baseStep,n.axes[1].baseStep],invertsY:n.invertsY,layout:n.pickerLayout,maxValue:n.maxValue,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",a.onPopupChildBlur_),t.addEventListener("keydown",a.onPopupChildKeydown_)})),this.pickerC_=o,this.textC_=new Br(e,{assembly:Hr,axes:n.axes,parser:n.parser,value:this.value,viewProps:this.viewProps}),this.view=new Xr(e,{expanded:this.foldable_.value("expanded"),pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Sn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ct(this.foldable_,this.view.pickerElement))}return C(t,[{key:"onPadButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=u(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onPadButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=vt(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!it(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}]),t}();function ea(t){return Kr.isObject(t)?new Kr(t.x,t.y):new Kr}function na(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function ia(t){if(t){var e=[];return l(t.step)||e.push(new Ee(t.step)),l(t.max)&&l(t.min)||e.push(new Ce({max:t.max,min:t.min})),new we(e)}}function ra(t){return new Lr({assembly:Hr,components:[ia("x"in t?t.x:void 0),ia("y"in t?t.y:void 0)]})}function aa(t,e){var n=t&&ke(t,Ce);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));var i=oi(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function oa(t,e){var n=e instanceof Lr?e.components[0]:void 0,i=e instanceof Lr?e.components[1]:void 0,r=aa(n,t.x),a=aa(i,t.y);return Math.max(r,a)}function sa(t,e){return{baseStep:oi(e),constraint:e,textProps:j.fromObject({draggingScale:si(e,t),formatter:wn(ai(e,t))})}}function ua(t){if(!("y"in t))return!1;var e=t.y;return!!e&&"inverted"in e&&!!e.inverted}var la={id:"input-point2d",type:"input",accept:function(t,e){if(!Kr.isObject(t))return null;var n=H,i=Y(e,{expanded:n.optional.boolean,picker:n.optional.custom(Jn),x:n.optional.custom(ti),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return ea},constraint:function(t){return ra(t.params)},equals:Kr.equals,writer:function(t){return na}},controller:function(t){var e=t.document,n=t.value,i=t.constraint;if(!(i instanceof Lr))throw v.shouldNeverHappen();var r="expanded"in t.params?t.params.expanded:void 0,a="picker"in t.params?t.params.picker:void 0;return new ta(e,{axes:[sa(n.rawValue.x,i.components[0]),sa(n.rawValue.y,i.components[1])],expanded:null!=r&&r,invertsY:ua(t.params),maxValue:oa(n.rawValue,i),parser:gn,pickerLayout:null!=a?a:"popup",value:n,viewProps:t.viewProps})}},ca=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;c(this,t),this.x=e,this.y=n,this.z=i}return C(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z}}}],[{key:"isObject",value:function(t){if(l(t))return!1;var e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}}]),t}(),ha={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return k(ca,B(t))}};function pa(t){return ca.isObject(t)?new ca(t.x,t.y,t.z):new ca}function va(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function fa(t){if(t){var e=[];return l(t.step)||e.push(new Ee(t.step)),l(t.max)&&l(t.min)||e.push(new Ce({max:t.max,min:t.min})),new we(e)}}function da(t){return new Lr({assembly:ha,components:[fa("x"in t?t.x:void 0),fa("y"in t?t.y:void 0),fa("z"in t?t.z:void 0)]})}function ma(t,e){return{baseStep:oi(e),constraint:e,textProps:j.fromObject({draggingScale:si(e,t),formatter:wn(ai(e,t))})}}var _a={id:"input-point3d",type:"input",accept:function(t,e){if(!ca.isObject(t))return null;var n=H,i=Y(e,{x:n.optional.custom(ti),y:n.optional.custom(ti),z:n.optional.custom(ti)});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return pa},constraint:function(t){return da(t.params)},equals:ca.equals,writer:function(t){return va}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof Lr))throw v.shouldNeverHappen();return new Br(t.document,{assembly:ha,axes:[ma(e.rawValue.x,n.components[0]),ma(e.rawValue.y,n.components[1]),ma(e.rawValue.z,n.components[2])],parser:gn,value:e,viewProps:t.viewProps})}},ga=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;c(this,t),this.x=e,this.y=n,this.z=i,this.w=r}return C(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}],[{key:"isObject",value:function(t){if(l(t))return!1;var e=t.x,n=t.y,i=t.z,r=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof r}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}}]),t}(),ya={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return k(ga,B(t))}};function ba(t){return ga.isObject(t)?new ga(t.x,t.y,t.z,t.w):new ga}function wa(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function ka(t){if(t){var e=[];return l(t.step)||e.push(new Ee(t.step)),l(t.max)&&l(t.min)||e.push(new Ce({max:t.max,min:t.min})),new we(e)}}function xa(t){return new Lr({assembly:ya,components:[ka("x"in t?t.x:void 0),ka("y"in t?t.y:void 0),ka("z"in t?t.z:void 0),ka("w"in t?t.w:void 0)]})}function Ca(t,e){return{baseStep:oi(e),constraint:e,textProps:j.fromObject({draggingScale:si(e,t),formatter:wn(ai(e,t))})}}var Ea={id:"input-point4d",type:"input",accept:function(t,e){if(!ga.isObject(t))return null;var n=H,i=Y(e,{x:n.optional.custom(ti),y:n.optional.custom(ti),z:n.optional.custom(ti),w:n.optional.custom(ti)});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return ba},constraint:function(t){return xa(t.params)},equals:ga.equals,writer:function(t){return wa}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof Lr))throw v.shouldNeverHappen();return new Br(t.document,{assembly:ya,axes:e.rawValue.getComponents().map((function(t,e){return Ca(t,n.components[e])})),parser:gn,value:e,viewProps:t.viewProps})}};function Ma(t){var e=[],n=ni(t.options);return n&&e.push(n),new we(e)}var Ta={id:"input-string",type:"input",accept:function(t,e){if("string"!=typeof t)return null;var n=Y(e,{options:H.optional.custom($n)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Cn},constraint:function(t){return Ma(t.params)},writer:function(t){return Qn}},controller:function(t){var e,n=t.document,i=t.value,r=t.constraint;return r&&ke(r,xe)?new Pe(n,{props:j.fromObject({options:null!==(e=ii(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new Re(n,{parser:function(t){return t},props:j.fromObject({formatter:En}),value:i,viewProps:t.viewProps})}},Pa={monitor:{defaultInterval:200,defaultLineCount:3}},Aa=g("mll"),Sa=function(){function t(e,n){c(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(Aa()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("textarea");i.classList.add(Aa("i")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),i.readOnly=!0,n.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return C(t,[{key:"update_",value:function(){var t=this,e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach((function(e){void 0!==e&&i.push(t.formatter_(e))})),e.textContent=i.join("\n"),n&&(e.scrollTop=e.scrollHeight)}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),Va=function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new Sa(e,{formatter:n.formatter,lineCount:n.lineCount,value:this.value,viewProps:this.viewProps})},Oa=g("sgl"),Da=function(){function t(e,n){c(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(Oa()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(Oa("i")),i.readOnly=!0,i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return C(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),Ra=function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new Da(e,{formatter:n.formatter,value:this.value,viewProps:this.viewProps})},La={id:"monitor-bool",type:"monitor",accept:function(t,e){if("boolean"!=typeof t)return null;var n=Y(e,{lineCount:H.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Ie}},controller:function(t){var e;return 1===t.value.rawValue.length?new Ra(t.document,{formatter:Ne,value:t.value,viewProps:t.viewProps}):new Va(t.document,{formatter:Ne,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Pa.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},Ia=function(){function t(){c(this,t),this.emitter=new m,this.index_=-1}return C(t,[{key:"index",get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}]),t}(),Na=g("grl"),Fa=function(){function t(e,n){c(this,t),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Na()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.minValue_=n.minValue,this.maxValue_=n.maxValue,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var i=e.createElementNS(tt,"svg");i.classList.add(Na("g")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),this.element.appendChild(i),this.svgElem_=i;var r=e.createElementNS(tt,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var a=e.createElement("div");a.classList.add(Na("t"),g("tt")()),this.element.appendChild(a),this.tooltipElem_=a,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return C(t,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach((function(a,o){if(void 0!==a){var s=Fn(o,0,e,0,t.width),u=Fn(a,n,i,t.height,0);r.push([s,u].join(","))}})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));var a=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0!==o){var s=Fn(this.cursor_.index,0,e,0,t.width),u=Fn(o,n,i,t.height,0);a.style.left="".concat(s,"px"),a.style.top="".concat(u,"px"),a.textContent="".concat(this.formatter_(o)),a.classList.contains(Na("t","a"))||(a.classList.add(Na("t","a"),Na("t","in")),et(a),a.classList.remove(Na("t","in")))}else a.classList.remove(Na("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),t}(),Ba=function(){function t(e,n){if(c(this,t),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.cursor_=new Ia,this.view=new Fa(e,{cursor:this.cursor_,formatter:n.formatter,lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:this.viewProps}),it(e)){var i=new Nn(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return C(t,[{key:"onGraphMouseLeave_",value:function(){this.cursor_.index=-1}},{key:"onGraphMouseMove_",value:function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Fn(t.offsetX,0,e.width,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(t){this.onGraphPointerMove_(t)}},{key:"onGraphPointerMove_",value:function(t){t.data.point?this.cursor_.index=Math.floor(Fn(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.index=-1}}]),t}();function qa(t){return"format"in t&&!l(t.format)?t.format:wn(2)}function ja(t){var e;return 1===t.value.rawValue.length?new Ra(t.document,{formatter:qa(t.params),value:t.value,viewProps:t.viewProps}):new Va(t.document,{formatter:qa(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Pa.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function za(t){var e,n,i;return new Ba(t.document,{formatter:qa(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Pa.monitor.defaultLineCount,maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0,value:t.value,viewProps:t.viewProps})}function Ua(t){return"view"in t&&"graph"===t.view}var Wa={id:"monitor-number",type:"monitor",accept:function(t,e){if("number"!=typeof t)return null;var n=H,i=Y(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:function(t){return Ua(t)?64:1},reader:function(t){return yn}},controller:function(t){return Ua(t.params)?za(t):ja(t)}},Ga={id:"monitor-string",type:"monitor",accept:function(t,e){if("string"!=typeof t)return null;var n=H,i=Y(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return Cn}},controller:function(t){var e,n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Va(t.document,{formatter:En,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Pa.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new Ra(t.document,{formatter:En,value:n,viewProps:t.viewProps})}},Ka=function(){function t(e){c(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new m,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return C(t,[{key:"read",value:function(){var t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}},{key:"write_",value:function(t){this.writer(this.target,t)}},{key:"onValueChange_",value:function(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}]),t}();function Ha(t,e){var n=t.accept(e.target.read(),e.params);if(l(n))return null;var i=H,r={target:e.target,initialValue:n.initialValue,params:n.params},a=t.binding.reader(r),o=t.binding.constraint?t.binding.constraint(r):void 0,s=q(a(n.initialValue),{constraint:o,equals:t.binding.equals}),u=new Ka({reader:a,target:e.target,value:s,writer:t.binding.writer(r)}),c=i.optional.boolean(e.params.disabled).value,h=i.optional.boolean(e.params.hidden).value,p=t.controller({constraint:o,document:e.document,initialValue:n.initialValue,params:n.params,value:u.value,viewProps:se.create({disabled:c,hidden:h})}),v=i.optional.string(e.params.label).value;return new Ot(e.document,{binding:u,blade:bt(),props:j.fromObject({label:v||e.target.key}),valueController:p})}var Ya=function(){function t(e){c(this,t),this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new m,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return C(t,[{key:"dispose",value:function(){this.ticker.dispose()}},{key:"read",value:function(){var t=this.target.read();if(void 0!==t){var e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=An(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}}},{key:"onTick_",value:function(t){this.read()}}]),t}();function Xa(t,e){return 0===e?new ye:new be(t,null!=e?e:Pa.monitor.defaultInterval)}function Za(t,e){var n,i,r,a=H,o=t.accept(e.target.read(),e.params);if(l(o))return null;var s={target:e.target,initialValue:o.initialValue,params:o.params},u=t.binding.reader(s),c=null!==(i=null!==(n=a.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(o.params))&&void 0!==i?i:1,h=a.optional.number(e.params.interval).value,p=new Ya({reader:u,target:e.target,ticker:Xa(e.document,h),value:Tn(c)}),v=a.optional.boolean(e.params.disabled).value,f=a.optional.boolean(e.params.hidden).value,d=t.controller({document:e.document,params:o.params,value:p.value,viewProps:se.create({disabled:v,hidden:f})}),m=null!==(r=a.optional.string(e.params.label).value)&&void 0!==r?r:e.target.key;return new Rt(e.document,{binding:p,blade:bt(),props:j.fromObject({label:m}),valueController:d})}var Qa=function(){function t(){c(this,t),this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return C(t,[{key:"getAll",value:function(){return B(this.pluginsMap_.blades).concat(B(this.pluginsMap_.inputs),B(this.pluginsMap_.monitors))}},{key:"register",value:function(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}},{key:"createInput",value:function(t,e,n){if(l(e.read()))throw new v({context:{key:e.key},type:"nomatchingcontroller"});var i=this.pluginsMap_.inputs.reduce((function(i,r){return i||Ha(r,{document:t,target:e,params:n})}),null);if(i)return i;throw new v({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createMonitor",value:function(t,e,n){var i=this.pluginsMap_.monitors.reduce((function(i,r){return i||Za(r,{document:t,params:n,target:e})}),null);if(i)return i;throw new v({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createBlade",value:function(t,e){var n=this.pluginsMap_.blades.reduce((function(n,i){return n||ge(i,{document:t,params:e})}),null);if(!n)throw new v({type:"nomatchingview",context:{params:e}});return n}},{key:"createBladeApi",value:function(t){var e=this;if(t instanceof Ot)return new Vt(t);if(t instanceof Rt)return new Dt(t);if(t instanceof Yt)return new Ft(t,this);var n=this.pluginsMap_.blades.reduce((function(n,i){return n||i.api({controller:t,pool:e})}),null);if(!n)throw v.shouldNeverHappen();return n}}]),t}();function $a(){var t=new Qa;return[la,_a,Ea,Ta,Gr,Rr,Dr,Vr,pi,La,Ga,Wa,gt,$t,re,_e].forEach((function(e){t.register(e)})),t}var Ja=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"options",get:function(){return this.controller_.valueController.props.get("options")},set:function(t){this.controller_.valueController.props.set("options",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),to=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"maxValue",get:function(){return this.controller_.valueController.sliderController.props.get("maxValue")},set:function(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}},{key:"minValue",get:function(){return this.controller_.valueController.sliderController.props.get("minValue")},set:function(t){this.controller_.valueController.sliderController.props.set("minValue",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),eo=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).emitter_=new m,i.controller_.valueController.value.emitter.on("change",(function(t){i.emitter_.emit("change",{event:new r(s(i),t.rawValue)})})),i}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"formatter",get:function(){return this.controller_.valueController.props.get("formatter")},set:function(t){this.controller_.valueController.props.set("formatter",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),no={id:"list",type:"blade",accept:function(t){var e=H,n=Y(t,{options:e.required.custom($n),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller:function(t){var e=new Pe(t.document,{props:j.fromObject({options:ei(t.params.options)}),value:q(t.params.value),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:j.fromObject({label:t.params.label}),valueController:e})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof Pe?new Ja(t.controller):null}};function io(t){return t.reduce((function(t,e){return Object.assign(t,A({},e.presetKey,e.read()))}),{})}function ro(t,e){t.forEach((function(t){var n=e[t.presetKey];void 0!==n&&t.write(n)}))}var ao=function(t){O(n,t);var e=P(n);function n(t,i){return c(this,n),e.call(this,t,i)}return C(n,[{key:"element",get:function(){return this.controller_.view.element}},{key:"importPreset",value:function(t){ro(this.controller_.rackController.rack.find(Ot).map((function(t){return t.binding.target})),t),this.refresh()}},{key:"exportPreset",value:function(){return io(this.controller_.rackController.rack.find(Ot).map((function(t){return t.binding.target})))}},{key:"refresh",value:function(){this.controller_.rackController.rack.find(Ot).forEach((function(t){t.binding.read()})),this.controller_.rackController.rack.find(Rt).forEach((function(t){t.binding.read()}))}}]),n}(Bt),oo=function(t){O(n,t);var e=P(n);function n(t,i){return c(this,n),e.call(this,t,{expanded:i.expanded,blade:i.blade,props:i.props,root:!0,viewProps:i.viewProps})}return n}(Qt),so={id:"slider",type:"blade",accept:function(t){var e=H,n=Y(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller:function(t){var e,n,i=null!==(e=t.params.value)&&void 0!==e?e:0,r=new Zn(t.document,{baseStep:1,parser:gn,sliderProps:j.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:j.fromObject({draggingScale:si(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:bn}),value:q(i),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:j.fromObject({label:t.params.label}),valueController:r})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof Zn?new to(t.controller):null}},uo={id:"text",type:"blade",accept:function(t){var e=H,n=Y(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller:function(t){var e,n=new Re(t.document,{parser:t.params.parse,props:j.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:function(t){return String(t)}}),value:q(t.params.value),viewProps:t.viewProps});return new Jt(t.document,{blade:t.blade,props:j.fromObject({label:t.params.label}),valueController:n})},api:function(t){return t.controller instanceof Jt&&t.controller.valueController instanceof Re?new eo(t.controller):null}};function lo(t){var e=t.createElement("div");return e.classList.add(g("dfw")()),t.body&&t.body.appendChild(e),e}function co(t,e,n){if(!t.querySelector("style[data-tp-style=".concat(e,"]"))){var i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}}var ho=function(t){O(n,t);var e=P(n);function n(t){var i,r;c(this,n);var a=t||{},o=null!==(r=a.document)&&void 0!==r?r:at(),s=$a(),u=new oo(o,{expanded:a.expanded,blade:bt(),props:j.fromObject({title:a.title}),viewProps:se.create()});return(i=e.call(this,u,s)).pool_=s,i.containerElem_=a.container||lo(o),i.containerElem_.appendChild(i.element),i.doc_=o,i.usesDefaultWrapper_=!a.container,i.setUpDefaultPlugins_(),i}return C(n,[{key:"document",get:function(){if(!this.doc_)throw v.alreadyDisposed();return this.doc_}},{key:"dispose",value:function(){var t=this.containerElem_;if(!t)throw v.alreadyDisposed();if(this.usesDefaultWrapper_){var e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,V(M(n.prototype),"dispose",this).call(this)}},{key:"registerPlugin",value:function(t){var e=this;("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((function(t){e.pool_.register(t),e.embedPluginStyle_(t)}))}},{key:"embedPluginStyle_",value:function(t){t.css&&co(this.document,"plugin-".concat(t.id),t.css)}},{key:"setUpDefaultPlugins_",value:function(){var t=this;co(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((function(e){t.embedPluginStyle_(e)})),this.registerPlugin({plugins:[so,no,_e,uo]})}}]),n}(ao),po=new e("3.0.8");t.BladeApi=n,t.ButtonApi=d,t.FolderApi=Bt,t.InputBindingApi=Vt,t.ListApi=Ja,t.MonitorBindingApi=Dt,t.Pane=ho,t.SeparatorApi=te,t.SliderApi=to,t.TabApi=ve,t.TabPageApi=pe,t.TextApi=eo,t.TpChangeEvent=r,t.VERSION=po,Object.defineProperty(t,"__esModule",{value:!0})}(o);var q={};!function(t){"use strict";var e=function(){function t(e){c(this,t),this.controller_=e}return C(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"hidden",get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)}},{key:"dispose",value:function(){this.controller_.viewProps.set("disposed",!0)}}]),t}(),n=function t(e){c(this,t),this.target=e},i=function(t){O(n,t);var e=P(n);function n(t,i,r,a){var o;return c(this,n),(o=e.call(this,t)).value=i,o.presetKey=r,o.last=null==a||a,o}return n}(n);function r(t){return t}function a(t){return null==t}var o={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '".concat(t.name,"'")},nomatchingcontroller:function(t){return"No matching controller for '".concat(t.key,"'")},nomatchingview:function(t){return"No matching view for '".concat(JSON.stringify(t.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '".concat(t.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},u=function(){function t(e){var n;c(this,t),this.message=null!==(n=o[e.type](r(e.context)))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return C(t,null,[{key:"alreadyDisposed",value:function(){return new t({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new t({type:"notbindable"})}},{key:"propertyNotFound",value:function(e){return new t({type:"propertynotfound",context:{name:e}})}},{key:"shouldNeverHappen",value:function(){return new t({type:"shouldneverhappen"})}}]),t}(),l=function(){function t(){c(this,t),this.observers_={}}return C(t,[{key:"on",value:function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}},{key:"off",value:function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this}},{key:"emit",value:function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))}}]),t}(),h="tp";function p(t){return function(e,n){return[h,"-",t,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")}}function v(t,e){return function(n){return e(t(n))}}function f(t){return t.rawValue}function d(t,e){t.emitter.on("change",v(f,e)),e(t.rawValue)}function m(t,e,n){d(t.value(e),n)}function _(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function g(t,e){return function(n){_(t,e,n)}}function y(t,e){d(t,(function(t){e.textContent=null!=t?t:""}))}var b=p("btn"),w=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(b()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("button");i.classList.add(b("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var r=e.createElement("div");r.classList.add(b("t")),y(n.props.value("title"),r),this.buttonElement.appendChild(r)},x=function(){function t(e,n){c(this,t),this.emitter=new l,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new w(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return C(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),E=function(){function t(e,n){var i;c(this,t),this.constraint_=null==n?void 0:n.constraint,this.equals_=null!==(i=null==n?void 0:n.equals)&&void 0!==i?i:function(t,e){return t===e},this.emitter=new l,this.rawValue_=e}return C(t,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}]),t}(),M=function(){function t(e){c(this,t),this.emitter=new l,this.value_=e}return C(t,[{key:"rawValue",get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}]),t}();function T(t,e){var n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new E(t,e):new M(t)}var S=function(){function t(e){var n=this,i=function(t){var e=n;n.valMap_[t].emitter.on("change",(function(){e.emitter.emit("change",{key:t,sender:e})}))};for(var r in c(this,t),this.emitter=new l,this.valMap_=e,this.valMap_)i(r)}return C(t,[{key:"get",value:function(t){return this.valMap_[t].rawValue}},{key:"set",value:function(t,e){this.valMap_[t].rawValue=e}},{key:"value",value:function(t){return this.valMap_[t]}}],[{key:"createCore",value:function(t){return Object.keys(t).reduce((function(e,n){return Object.assign(e,A({},n,T(t[n])))}),{})}},{key:"fromObject",value:function(e){return new t(this.createCore(e))}}]),t}();function V(t,e){return r(Object.keys(e).reduce((function(n,i){if(void 0!==n){var r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),A({},i,r.value)):void 0}}),{}))}function D(t,e){return t.reduce((function(t,n){if(void 0!==t){var i=e(n);if(i.succeeded&&void 0!==i.value)return B(t).concat([i.value])}}),[])}function R(t){return null!==t&&"object"==typeof t}function L(t){return function(e){return function(n){if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};var i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}}function I(t){return{custom:function(e){return L(e)(t)},boolean:L((function(t){return"boolean"==typeof t?t:void 0}))(t),number:L((function(t){return"number"==typeof t?t:void 0}))(t),string:L((function(t){return"string"==typeof t?t:void 0}))(t),function:L((function(t){return"function"==typeof t?t:void 0}))(t),constant:function(e){return L((function(t){return t===e?e:void 0}))(t)},raw:L((function(t){return t}))(t),object:function(e){return L((function(t){if(R(t))return V(t,e)}))(t)},array:function(e){return L((function(t){if(Array.isArray(t))return D(t,e)}))(t)}}}var N={optional:I(!0),required:I(!1)};function q(t,e){var n=N.required.object(e)(t);return n.succeeded?n.value:void 0}function j(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function z(){return["veryfirst","first","last","verylast"]}var U=p(""),W={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},G=function(){function t(e){var n=this;c(this,t),this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var i=this.view.element;this.blade.value("positions").emitter.on("change",(function(){z().forEach((function(t){i.classList.remove(U(void 0,W[t]))})),n.blade.get("positions").forEach((function(t){i.classList.add(U(void 0,W[t]))}))})),this.viewProps.handleDispose((function(){j(i)}))}return C(t,[{key:"parent",get:function(){return this.parent_}}]),t}(),K="http://www.w3.org/2000/svg";function H(t){t.offsetHeight}function Y(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function X(t){return void 0!==t.ontouchstart}function Z(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function Q(t){return t.relatedTarget?r(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}var $=p("lbl");function J(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,i){i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var tt=function t(e,n){var i=this;c(this,t),this.element=e.createElement("div"),this.element.classList.add($()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add($("l")),m(n.props,"label",(function(t){a(t)?i.element.classList.add($(void 0,"nol")):(i.element.classList.remove($(void 0,"nol")),Z(r),r.appendChild(J(e,t)))})),this.element.appendChild(r),this.labelElement=r;var o=e.createElement("div");o.classList.add($("v")),this.element.appendChild(o),this.valueElement=o},et=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{view:new tt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(G),nt=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).value=t.value,i}return n}(G),it=function(t){O(n,t);var e=P(n);function n(t){return c(this,n),e.call(this,t)}return C(n,[{key:"styleExpanded",get:function(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!a(t)?"".concat(t,"px"):"auto"}},{key:"bindExpandedClass",value:function(t,e){var n=this;m(this,"expanded",(function(){n.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}}],[{key:"create",value:function(t){var e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(S.createCore(e))}}]),n}(S);function rt(t){return it.create(t)}function at(t,e){var n=0;return Y(e,(function(){t.set("expandedHeight",null),t.set("temporaryExpanded",!0),H(e),n=e.clientHeight,t.set("temporaryExpanded",null),H(e)})),n}function ot(t,e){e.style.height=t.styleHeight}function st(t,e){t.value("expanded").emitter.on("beforechange",(function(){t.set("completed",!1),a(t.get("expandedHeight"))&&t.set("expandedHeight",at(t,e)),t.set("shouldFixHeight",!0),H(e)})),t.emitter.on("change",(function(){ot(t,e)})),ot(t,e),e.addEventListener("transitionend",(function(e){"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}var ut=function t(e,n){c(this,t);var i=p(n.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),n.viewProps.bindClassModifiers(this.element)},lt=function(t){O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=i.valueController.viewProps;return(r=e.call(this,Object.assign(Object.assign({},i),{value:i.valueController.value,view:new tt(t,{props:i.props,viewProps:a}),viewProps:a}))).props=i.props,r.valueController=i.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return n}(nt),ct=p("");function ht(t,e){return g(t,ct(void 0,e))}var pt=function(t){O(n,t);var e=P(n);function n(t){return c(this,n),e.call(this,t)}return C(n,[{key:"bindClassModifiers",value:function(t){m(this,"disabled",ht(t,"disabled")),m(this,"hidden",ht(t,"hidden"))}},{key:"bindDisabled",value:function(t){m(this,"disabled",(function(e){t.disabled=e}))}},{key:"bindTabIndex",value:function(t){m(this,"disabled",(function(e){t.tabIndex=e?-1:0}))}},{key:"handleDispose",value:function(t){this.value("disposed").emitter.on("change",(function(e){e&&t()}))}}],[{key:"create",value:function(t){var e,i,r=null!=t?t:{},a={disabled:null!==(e=r.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(i=r.hidden)&&void 0!==i&&i};return new n(S.createCore(a))}}]),n}(S),vt=function(){function t(){c(this,t),this.disabled=!1,this.emitter=new l}return C(t,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),t}(),ft=function(){function t(e,n){c(this,t),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new l,this.interval_=n,this.setTimer_()}return C(t,[{key:"disabled",get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),t}(),dt=function(){function t(e){c(this,t),this.constraints=e}return C(t,[{key:"constrain",value:function(t){return this.constraints.reduce((function(t,e){return e.constrain(t)}),t)}}]),t}();function mt(t,e){if(t instanceof e)return t;if(t instanceof dt){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var _t=function(){function t(e){c(this,t),this.maxValue=e.max,this.minValue=e.min}return C(t,[{key:"constrain",value:function(t){var e=t;return a(this.minValue)||(e=Math.max(e,this.minValue)),a(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}]),t}(),gt=function(){function t(e){c(this,t),this.step=e}return C(t,[{key:"constrain",value:function(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}}]),t}(),yt=p("pop"),bt=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(yt()),n.viewProps.bindClassModifiers(this.element),d(n.shows,g(this.element,yt(void 0,"v")))},wt=function t(e,n){c(this,t),this.shows=T(!1),this.viewProps=n.viewProps,this.view=new bt(e,{shows:this.shows,viewProps:this.viewProps})},kt=p("txt"),xt=function(){function t(e,n){c(this,t),this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(kt()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var i=e.createElement("input");i.classList.add(kt("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return C(t,[{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Ct=function(){function t(e,n){c(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new xt(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return C(t,[{key:"onInputChange_",value:function(t){var e=r(t.currentTarget).value,n=this.parser_(e);a(n)||(this.value.rawValue=n),this.view.refresh()}}]),t}(),Et=function(){function t(e){c(this,t),this.text=e}return C(t,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),t}(),Mt={"**":function(t,e){return Math.pow(t,e)},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<<":function(t,e){return t<<e},">>":function(t,e){return t>>e},">>>":function(t,e){return t>>>e},"&":function(t,e){return t&e},"^":function(t,e){return t^e},"|":function(t,e){return t|e}},Tt=function(){function t(e,n,i){c(this,t),this.left=n,this.operator=e,this.right=i}return C(t,[{key:"evaluate",value:function(){var t=Mt[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),t}(),Pt={"+":function(t){return t},"-":function(t){return-t},"~":function(t){return~t}},At=function(){function t(e,n){c(this,t),this.operator=e,this.expression=n}return C(t,[{key:"evaluate",value:function(){var t=Pt[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),t}();function St(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i](e,n);if(""!==r)return r}return""}}function Vt(t,e){var n,i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ot(t,e){var n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Dt(t,e){var n,i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Rt(t,e){var n=Dt(t,e);if(""!==n)return n;var i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";var r=Dt(t,e+=1);return""===r?"":i+r}function Lt(t,e){var n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";var i=Rt(t,e);return""===i?"":n+i}function It(t,e){var n=t.substr(e,1);if("0"===n)return n;var i=Ot(t,e);return e+=i.length,""===i?"":i+Dt(t,e)}function Nt(t,e){var n=It(t,e);if(e+=n.length,""===n)return"";var i=t.substr(e,1);if(e+=i.length,"."!==i)return"";var r=Dt(t,e);return n+i+r+Lt(t,e+=r.length)}function Ft(t,e){var n=t.substr(e,1);if(e+=n.length,"."!==n)return"";var i=Dt(t,e);return e+=i.length,""===i?"":n+i+Lt(t,e)}function Bt(t,e){var n=It(t,e);return e+=n.length,""===n?"":n+Lt(t,e)}var qt=St([Nt,Ft,Bt]);function jt(t,e){var n,i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function zt(t,e){var n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";var i=jt(t,e);return""===i?"":n+i}function Ut(t,e){var n,i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Wt(t,e){var n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";var i=Ut(t,e);return""===i?"":n+i}function Gt(t,e){var n,i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Kt(t,e){var n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";var i=Gt(t,e);return""===i?"":n+i}var Ht=St([zt,Wt,Kt]),Yt=St([Ht,qt]);function Xt(t,e){var n=Yt(t,e);return e+=n.length,""===n?null:{evaluable:new Et(n),cursor:e}}function Zt(t,e){var n=t.substr(e,1);if(e+=n.length,"("!==n)return null;var i=ne(t,e);if(!i)return null;e=i.cursor,e+=Vt(t,e).length;var r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function Qt(t,e){return Xt(t,e)||Zt(t,e)}function $t(t,e){var n=Qt(t,e);if(n)return n;var i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;var r=$t(t,e);return r?{cursor:e=r.cursor,evaluable:new At(i,r.evaluable)}:null}function Jt(t,e,n){n+=Vt(e,n).length;var i=t.filter((function(t){return e.startsWith(t,n)}))[0];return i?(n+=i.length,{cursor:n+=Vt(e,n).length,operator:i}):null}function te(t,e){return function(n,i){var r=t(n,i);if(!r)return null;i=r.cursor;for(var a=r.evaluable;;){var o=Jt(e,n,i);if(!o)break;i=o.cursor;var s=t(n,i);if(!s)return null;i=s.cursor,a=new Tt(o.operator,a,s.evaluable)}return a?{cursor:i,evaluable:a}:null}}var ee=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(t,e){return te(t,e)}),$t);function ne(t,e){return e+=Vt(t,e).length,ee(t,e)}function ie(t){var e=ne(t,0);return e?e.cursor+Vt(t,e.cursor).length!==t.length?null:e.evaluable:null}function re(t){var e,n=ie(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function ae(t){if("number"==typeof t)return t;if("string"==typeof t){var e=re(t);if(!a(e))return e}return 0}function oe(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}function se(t,e){for(;t.length<e;)t.push(void 0)}function ue(t){var e=[];return se(e,t),T(e)}function le(t){var e=t.indexOf(void 0);return r(e<0?t:t.slice(0,e))}function ce(t,e){var n=B(le(t)).concat([e]);return n.length>t.length?n.splice(0,n.length-t.length):se(n,t.length),n}function he(t){var e=t.primary,n=t.secondary,i=t.forward,r=t.backward,a=!1;function o(t){a||(a=!0,t(),a=!1)}e.emitter.on("change",(function(t){o((function(){n.setRawValue(i(e,n),t.options)}))})),n.emitter.on("change",(function(t){o((function(){e.setRawValue(r(e,n),t.options)})),o((function(){n.setRawValue(i(e,n),t.options)}))})),o((function(){n.setRawValue(i(e,n),{forceEmit:!1,last:!0})}))}function pe(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function ve(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function fe(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function de(t){return"ArrowUp"===t||"ArrowDown"===t}function me(t){return de(t)||"ArrowLeft"===t||"ArrowRight"===t}function _e(t,e){var n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}var ge=function(){function t(e){c(this,t),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new l,e.addEventListener("touchstart",this.onTouchStart_),e.addEventListener("touchmove",this.onTouchMove_),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return C(t,[{key:"computePosition_",value:function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}},{key:"onMouseDown_",value:function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(_e(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseMove_",value:function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(_e(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseUp_",value:function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(_e(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onTouchStart_",value:function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchMove_",value:function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchEnd_",value:function(t){var e,n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}]),t}();function ye(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function be(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function we(t,e,n){return Math.min(Math.max(t,e),n)}var ke=p("txt"),xe=function(){function t(e,n){c(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(ke(),ke(void 0,"num")),n.arrayPosition&&this.element.classList.add(ke(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("input");i.classList.add(ke("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ke()),this.inputElement.classList.add(ke("i"));var r=e.createElement("div");r.classList.add(ke("k")),this.element.appendChild(r),this.knobElement=r;var a=e.createElementNS(K,"svg");a.classList.add(ke("g")),this.knobElement.appendChild(a);var o=e.createElementNS(K,"path");o.classList.add(ke("gb")),a.appendChild(o),this.guideBodyElem_=o;var s=e.createElementNS(K,"path");s.classList.add(ke("gh")),a.appendChild(s),this.guideHeadElem_=s;var u=e.createElement("div");u.classList.add(p("tt")()),this.knobElement.appendChild(u),this.tooltipElem_=u,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return C(t,[{key:"onDraggingChange_",value:function(t){if(null!==t.rawValue){this.element.classList.add(ke(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=we(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+i,",0 L").concat(n,",4 L").concat(n+i,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")}else this.element.classList.remove(ke(void 0,"drg"))}},{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),Ce=function(){function t(e,n){c(this,t),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=T(null),this.view=new xe(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new ge(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return C(t,[{key:"onInputChange_",value:function(t){var e=r(t.currentTarget).value,n=this.parser_(e);a(n)||(this.value.rawValue=n),this.view.refresh()}},{key:"onInputKeyDown_",value:function(t){var e=pe(this.baseStep_,ve(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(t){0!==pe(this.baseStep_,ve(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}},{key:"onPointerMove_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),t}();function Ee(t,e){t.write(e)}function Me(t){var e=t?mt(t,gt):null;return e?e.step:null}function Te(t,e){var n=t&&mt(t,gt);return n?be(n.step):Math.max(be(e),2)}function Pe(t){var e=Me(t);return null!=e?e:1}function Ae(t,e){var n,i=t&&mt(t,gt),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}var Se=function(){function t(e){c(this,t),this.components=e.components,this.asm_=e.assembly}return C(t,[{key:"constrain",value:function(t){var e=this,n=this.asm_.toComponents(t).map((function(t,n){var i,r;return null!==(r=null===(i=e.components[n])||void 0===i?void 0:i.constrain(t))&&void 0!==r?r:t}));return this.asm_.fromComponents(n)}}]),t}(),Ve=p("pndtxt"),Oe=function t(e,n){var i=this;c(this,t),this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(Ve()),this.textViews.forEach((function(t){var n=e.createElement("div");n.classList.add(Ve("a")),n.appendChild(t.element),i.element.appendChild(n)}))};function De(t,e,n){return new Ce(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:T(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}var Re=function t(e,n){var i=this;c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(t,i){return De(e,n,i)})),this.acs_.forEach((function(t,e){he({primary:i.value,secondary:t.value,forward:function(t){return n.assembly.toComponents(t.rawValue)[e]},backward:function(t,i){var r=n.assembly.toComponents(t.rawValue);return r[e]=i.rawValue,n.assembly.fromComponents(r)}})})),this.view=new Oe(e,{textViews:this.acs_.map((function(t){return t.view}))})};function Le(t){return"step"in t&&!a(t.step)?new gt(t.step):null}function Ie(t){return"max"in t&&!a(t.max)||"min"in t&&!a(t.min)?new _t({max:t.max,min:t.min}):null}var Ne={monitor:{defaultInterval:200,defaultLineCount:3}},Fe=function(){function t(){c(this,t),this.emitter=new l,this.index_=-1}return C(t,[{key:"index",get:function(){return this.index_},set:function(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}}]),t}(),Be=p("grl"),qe=function(){function t(e,n){c(this,t),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Be()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.minValue_=n.minValue,this.maxValue_=n.maxValue,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var i=e.createElementNS(K,"svg");i.classList.add(Be("g")),i.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),this.element.appendChild(i),this.svgElem_=i;var r=e.createElementNS(K,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var a=e.createElement("div");a.classList.add(Be("t"),p("tt")()),this.element.appendChild(a),this.tooltipElem_=a,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return C(t,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach((function(a,o){if(void 0!==a){var s=ye(o,0,e,0,t.width),u=ye(a,n,i,t.height,0);r.push([s,u].join(","))}})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));var a=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0!==o){var s=ye(this.cursor_.index,0,e,0,t.width),u=ye(o,n,i,t.height,0);a.style.left="".concat(s,"px"),a.style.top="".concat(u,"px"),a.textContent="".concat(this.formatter_(o)),a.classList.contains(Be("t","a"))||(a.classList.add(Be("t","a"),Be("t","in")),H(a),a.classList.remove(Be("t","in")))}else a.classList.remove(Be("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),t}(),je=function(){function t(e,n){if(c(this,t),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.cursor_=new Fe,this.view=new qe(e,{cursor:this.cursor_,formatter:n.formatter,lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:this.viewProps}),X(e)){var i=new ge(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return C(t,[{key:"onGraphMouseLeave_",value:function(){this.cursor_.index=-1}},{key:"onGraphMouseMove_",value:function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(ye(t.offsetX,0,e.width,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(t){this.onGraphPointerMove_(t)}},{key:"onGraphPointerMove_",value:function(t){t.data.point?this.cursor_.index=Math.floor(ye(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.index=-1}}]),t}(),ze=function(){function t(e){c(this,t),this.controller_=e}return C(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.props.set("title",t)}},{key:"on",value:function(t,e){var i=this,r=e.bind(this);return this.controller_.emitter.on(t,(function(){r(new n(i))})),this}}]),t}(),Ue=function(t){O(n,t);var e=P(n);function n(t,i,r){var a;return c(this,n),(a=e.call(this,t)).cell=i,a.index=r,a}return n}(n),We=function(t){O(n,t);var e=P(n);function n(t){var i;c(this,n),(i=e.call(this,t)).cellToApiMap_=new Map,i.emitter_=new l;var r=i.controller_.valueController;return r.cellControllers.forEach((function(t,e){var n=new ze(t);i.cellToApiMap_.set(t,n),t.emitter.on("click",(function(){var t=e%r.size[0],a=Math.floor(e/r.size[0]);i.emitter_.emit("click",{event:new Ue(s(i),n,[t,a])})}))})),i}return C(n,[{key:"cell",value:function(t,e){var n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(e),Ge=function(){function t(e,n){var i=this;c(this,t),this.size=n.size;for(var r=F(this.size,2),a=r[0],o=r[1],s=[],u=0;u<o;u++)for(var l=0;l<a;l++){var h=new x(e,{props:S.fromObject(Object.assign({},n.cellConfig(l,u))),viewProps:pt.create()});s.push(h)}this.cellCs_=s,this.viewProps=pt.create(),this.viewProps.handleDispose((function(){i.cellCs_.forEach((function(t){t.viewProps.set("disposed",!0)}))})),this.view=new ut(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns="repeat(".concat(a,", 1fr)"),this.cellCs_.forEach((function(t){i.view.element.appendChild(t.view.element)}))}return C(t,[{key:"cellControllers",get:function(){return this.cellCs_}}]),t}(),Ke={id:"buttongrid",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t){var e=N,n=q(t,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new et(t.document,{blade:t.blade,props:S.fromObject({label:t.params.label}),valueController:new Ge(t.document,{cellConfig:t.params.cells,size:t.params.size})})},api:function(t){return t.controller instanceof et&&t.controller.valueController instanceof Ge?new We(t.controller):null}},He=function(t){O(n,t);var e=P(n);function n(){return c(this,n),e.apply(this,arguments)}return C(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=this,r=e.bind(this);return this.controller_.valueController.value.emitter.on(t,(function(t){r(new i(n,t.rawValue,void 0,t.options.last))})),this}}]),n}(e);function Ye(t,e,n){return t*(1-n)+e*n}var Xe=20,Ze=.001,Qe=100;function $e(t,e){for(var n=.25,i=.5,r=-1,a=0;a<Xe;a++){var o=F(t.curve(i),2),s=o[0];if(i+=n*(s<e?1:-1),r=o[1],n*=.5,Math.abs(e-s)<Ze)break}return r}var Je=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;c(this,t),this.cache_=[],this.comps_=[e,n,i,r]}return C(t,[{key:"x1",get:function(){return this.comps_[0]}},{key:"y1",get:function(){return this.comps_[1]}},{key:"x2",get:function(){return this.comps_[2]}},{key:"y2",get:function(){return this.comps_[3]}},{key:"curve",value:function(t){var e=Ye(0,this.x1,t),n=Ye(0,this.y1,t),i=Ye(this.x1,this.x2,t),r=Ye(this.y1,this.y2,t),a=Ye(this.x2,1,t),o=Ye(this.y2,1,t),s=Ye(e,i,t),u=Ye(n,r,t),l=Ye(i,a,t),c=Ye(r,o,t);return[Ye(s,l,t),Ye(u,c,t)]}},{key:"y",value:function(t){if(0===this.cache_.length){for(var e=[],n=0;n<Qe;n++)e.push($e(this,ye(n,0,Qe-1,0,1)));this.cache_=e}return this.cache_[Math.round(ye(we(t,0,1),0,1,0,Qe-1))]}},{key:"toObject",value:function(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}],[{key:"isObject",value:function(t){return!a(t)&&!!Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}},{key:"equals",value:function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}}]),t}(),tn={toComponents:function(t){return t.toObject()},fromComponents:function(t){return k(Je,B(t))}};function en(t){var e=oe(2),n=t.toObject().map((function(t){return e(t)}));return"cubic-bezier(".concat(n.join(", "),")")}var nn=[0,.5,.5,1];function rn(t){var e=t.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return k(Je,B(nn));var n=[e[1],e[2],e[3],e[4]].reduce((function(t,e){if(!t)return null;var n=Number(e);return isNaN(n)?null:B(t).concat([n])}),[]);return k(Je,B(null!=n?n:nn))}var an=p("cbz"),on=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(an()),n.viewProps.bindClassModifiers(this.element),n.foldable.bindExpandedClass(this.element,an(void 0,"expanded")),m(n.foldable,"completed",g(this.element,an(void 0,"cpl")));var i=e.createElement("div");i.classList.add(an("h")),this.element.appendChild(i);var r=e.createElement("button");r.classList.add(an("b")),n.viewProps.bindDisabled(r);var a=e.createElementNS(K,"svg");a.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',r.appendChild(a),i.appendChild(r),this.buttonElement=r;var o=e.createElement("div");if(o.classList.add(an("t")),i.appendChild(o),this.textElement=o,"inline"===n.pickerLayout){var s=e.createElement("div");s.classList.add(an("p")),this.element.appendChild(s),this.pickerElement=s}else this.pickerElement=null},sn=p("cbzp"),un=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(sn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(sn("g")),this.element.appendChild(i),this.graphElement=i;var r=e.createElement("div");r.classList.add(sn("t")),this.element.appendChild(r),this.textElement=r};function ln(t,e){var n=new MutationObserver((function(t){var i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var u=o.value;"childList"===u.type&&u.addedNodes.forEach((function(t){t.contains(t)&&(e(),n.disconnect())}))}}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}})),i=t.ownerDocument;n.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}var cn=p("cbzg");function hn(t,e){return function(n){return e(t(n))}}var pn=function(){function t(e,n){var i=this;c(this,t),this.element=e.createElement("div"),this.element.classList.add(cn()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(cn("p")),this.element.appendChild(r),this.previewElement=r;var a=e.createElementNS(K,"svg");a.classList.add(cn("g")),this.element.appendChild(a),this.svgElem_=a;var o=e.createElementNS(K,"path");o.classList.add(cn("u")),this.svgElem_.appendChild(o),this.guideElem_=o;var s=e.createElementNS(K,"polyline");s.classList.add(cn("l")),this.svgElem_.appendChild(s),this.lineElem_=s,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach((function(t){t.classList.add(cn("h")),i.element.appendChild(t)})),this.vectorElems_=[e.createElementNS(K,"line"),e.createElementNS(K,"line")],this.vectorElems_.forEach((function(t){t.classList.add(cn("v")),i.svgElem_.appendChild(t)})),this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=n.selection,this.handleElems_.forEach((function(t,e){d(i.sel_,hn((function(t){return t===e}),g(t,cn("h","sel"))))})),ln(this.element,(function(){i.refresh()}))}return C(t,[{key:"getVertMargin_",value:function(t){return.25*t}},{key:"valueToPosition",value:function(t,e){var n=this.element.getBoundingClientRect(),i=n.width,r=n.height,a=this.getVertMargin_(r);return{x:ye(t,0,1,0,i),y:ye(e,0,1,r-a,a)}}},{key:"positionToValue",value:function(t,e){var n=this.element.getBoundingClientRect(),i=n.width,r=n.height,a=this.getVertMargin_(r);return{x:we(ye(t,0,i,0,1),0,1),y:ye(e,r-a,a,0,1)}}},{key:"refresh",value:function(){var t=this;this.guideElem_.setAttributeNS(null,"d",[0,1].map((function(e){var n=t.valueToPosition(0,e),i=t.valueToPosition(1,e);return["M ".concat(n.x,",").concat(n.y),"L ".concat(i.x,",").concat(i.y)].join(" ")})).join(" "));for(var e=this.value_.rawValue,n=[],i=0;;){var r=this.valueToPosition.apply(this,B(e.curve(i)));if(n.push([r.x,r.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",n.join(" "));var a=e.toObject();[0,1].forEach((function(e){var n=t.valueToPosition(e,e),i=t.valueToPosition(a[2*e],a[2*e+1]),r=t.vectorElems_[e];r.setAttributeNS(null,"x1",String(n.x)),r.setAttributeNS(null,"y1",String(n.y)),r.setAttributeNS(null,"x2",String(i.x)),r.setAttributeNS(null,"y2",String(i.y));var o=t.handleElems_[e];o.style.left="".concat(i.x,"px"),o.style.top="".concat(i.y,"px")}))}},{key:"onValueChange_",value:function(){this.refresh()}}]),t}(),vn=24,fn=400,dn=1e3,mn=p("cbzprv"),_n=function(){function t(e,n){var i=this;c(this,t),this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(mn()),n.viewProps.bindClassModifiers(this.element);var r=e.createElementNS(K,"svg");r.classList.add(mn("g")),this.element.appendChild(r),this.svgElem_=r;var a=e.createElementNS(K,"path");a.classList.add(mn("t")),this.svgElem_.appendChild(a),this.ticksElem_=a;var o=e.createElement("div");o.classList.add(mn("m")),this.element.appendChild(o),this.markerElem_=o,this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_),n.viewProps.handleDispose(this.onDispose_),ln(this.element,(function(){i.refresh()}))}return C(t,[{key:"play",value:function(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(mn("m","a")),this.startTime_=(new Date).getTime()+fn,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}},{key:"stop",value:function(){this.stopped_=!0,this.markerElem_.classList.remove(mn("m","a"))}},{key:"onDispose_",value:function(){this.stop()}},{key:"updateMarker_",value:function(t){var e=this.value_.rawValue.y(we(t,0,1));this.markerElem_.style.left="".concat(100*e,"%")}},{key:"refresh",value:function(){for(var t=this.svgElem_.getBoundingClientRect(),e=t.width,n=t.height,i=[],r=this.value_.rawValue,a=0;a<vn;a++){var o=ye(a,0,vn-1,0,1),s=ye(r.y(o),0,1,0,e);i.push("M ".concat(s,",0 v").concat(n))}this.ticksElem_.setAttributeNS(null,"d",i.join(" "))}},{key:"onTimer_",value:function(){if(null!==this.startTime_){var t=(new Date).getTime()-this.startTime_,e=t/dn;this.updateMarker_(e),t>dn+fn&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}}},{key:"onValueChange_",value:function(){this.refresh(),this.play()}}]),t}();function gn(t,e,n,i){var r=n-t,a=i-e;return Math.sqrt(r*r+a*a)}function yn(t,e,n,i){var r=gn(t,e,n,i),a=Math.atan2(i-e,n-t),o=Math.round(a/(Math.PI/4))*Math.PI/4;return{x:t+Math.cos(o)*r,y:e+Math.sin(o)*r}}var bn=function(){function t(e,n){var i=this;c(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.value=n.value,this.sel_=T(0),this.viewProps=n.viewProps,this.view=new pn(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new _n(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",(function(t){t.stopImmediatePropagation(),t.preventDefault(),i.prevView_.play()})),this.view.previewElement.appendChild(this.prevView_.element);var r=new ge(this.view.element);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}return C(t,[{key:"refresh",value:function(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}},{key:"updateValue_",value:function(t,e,n){var i=this.sel_.rawValue,r=this.value.rawValue.toObject(),a=this.view.positionToValue(t.x,t.y),o=e?yn(i,i,a.x,a.y):a;r[2*i]=o.x,r[2*i+1]=o.y,this.value.setRawValue(k(Je,B(r)),n)}},{key:"onPointerDown_",value:function(t){var e=t.data;if(e.point){var n=this.value.rawValue,i=this.view.valueToPosition(n.x1,n.y1),r=gn(e.point.x,e.point.y,i.x,i.y),a=this.view.valueToPosition(n.x2,n.y2),o=gn(e.point.x,e.point.y,a.x,a.y);this.sel_.rawValue=r<=o?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}}},{key:"onPointerMove_",value:function(t){var e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){var e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){me(t.key)&&t.preventDefault();var e=this.sel_.rawValue,n=this.value.rawValue.toObject();n[2*e]+=pe(this.baseStep_,fe(t)),n[2*e+1]+=pe(this.baseStep_,ve(t)),this.value.setRawValue(k(Je,B(n)),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){me(t.key)&&t.preventDefault();var e=pe(this.baseStep_,fe(t)),n=pe(this.baseStep_,ve(t));0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),wn=function(){function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new un(e,{viewProps:this.viewProps}),this.gc_=new bn(e,{baseStep:n.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);var i=Object.assign(Object.assign({},n.axis),{constraint:new _t({max:1,min:0})}),r=Object.assign(Object.assign({},n.axis),{constraint:void 0});this.tc_=new Re(e,{assembly:tn,axes:[i,r,i,r],parser:re,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}return C(t,[{key:"allFocusableElements",get:function(){return[this.gc_.view.element].concat(B(this.tc_.view.textViews.map((function(t){return t.inputElement}))))}},{key:"refresh",value:function(){this.gc_.refresh()}}]),t}(),kn=function(){function t(e,n){var i=this;c(this,t),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=rt(n.expanded),this.view=new on(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Ct(e,{parser:rn,props:S.fromObject({formatter:en}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_="popup"===n.pickerLayout?new wt(e,{viewProps:this.viewProps}):null;var r=new wn(e,{axis:n.axis,value:this.value,viewProps:this.viewProps});r.allFocusableElements.forEach((function(t){t.addEventListener("blur",i.onPopupChildBlur_),t.addEventListener("keydown",i.onPopupChildKeydown_)})),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),d(this.popC_.shows,(function(t){t&&r.refresh()})),he({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),st(this.foldable_,this.view.pickerElement))}return C(t,[{key:"onButtonBlur_",value:function(t){if(this.popC_){var e=r(t.relatedTarget);e&&this.popC_.view.element.contains(e)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=Q(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!X(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_&&"Escape"===t.key&&(this.popC_.shows.rawValue=!1)}}]),t}();function xn(){return new Se({assembly:tn,components:[0,1,2,3].map((function(t){return t%2==0?new _t({min:0,max:1}):void 0}))})}var Cn={id:"cubic-bezier",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t){var e=N,n=q(t,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom((function(t){return"inline"===t||"popup"===t?t:void 0}))});return n?{params:n}:null},controller:function(t){var e,n,i=T(k(Je,B(t.params.value)),{constraint:xn(),equals:Je.equals}),r=new kn(t.document,{axis:{baseStep:.1,textProps:S.fromObject({draggingScale:.01,formatter:oe(2)})},expanded:null!==(e=t.params.expanded)&&void 0!==e&&e,pickerLayout:null!==(n=t.params.picker)&&void 0!==n?n:"popup",value:i,viewProps:t.viewProps});return new lt(t.document,{blade:t.blade,props:S.fromObject({label:t.params.label}),valueController:r})},api:function(t){return t.controller instanceof lt&&t.controller.valueController instanceof kn?new He(t.controller):null}},En=function(t){O(n,t);var e=P(n);function n(){return c(this,n),e.apply(this,arguments)}return C(n,[{key:"begin",value:function(){this.controller_.valueController.begin()}},{key:"end",value:function(){this.controller_.valueController.end()}}]),n}(e),Mn=20,Tn=function(){function t(){c(this,t),this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}return C(t,[{key:"duration",get:function(){return this.duration_}},{key:"fps",get:function(){return this.fps_}},{key:"begin",value:function(t){this.start_=t.getTime()}},{key:"calculateFps_",value:function(t){if(0===this.timestamps_.length)return null;var e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}},{key:"compactTimestamps_",value:function(){if(!(this.timestamps_.length<=Mn)){var t=this.timestamps_.length-Mn;this.timestamps_.splice(0,t);var e=this.timestamps_[0].frameCount;this.timestamps_.forEach((function(t){t.frameCount-=e})),this.frameCount_-=e}}},{key:"end",value:function(t){if(null!==this.start_){var e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}}]),t}(),Pn=p("fps"),An=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(Pn()),n.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(Pn("g")),this.element.appendChild(this.graphElement);var i=e.createElement("div");i.classList.add(Pn("l")),this.element.appendChild(i);var r=e.createElement("span");r.classList.add(Pn("v")),r.textContent="--",i.appendChild(r),this.valueElement=r;var a=e.createElement("span");a.classList.add(Pn("u")),a.textContent="FPS",i.appendChild(a)},Sn=function(){function t(e,n){var i=this;c(this,t),this.stopwatch_=new Tn,this.onTick_=this.onTick_.bind(this),this.ticker_=n.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=n.value,this.viewProps=n.viewProps,this.view=new An(e,{viewProps:this.viewProps}),this.graphC_=new je(e,{formatter:oe(0),lineCount:n.lineCount,maxValue:n.maxValue,minValue:n.minValue,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose((function(){i.graphC_.viewProps.set("disposed",!0),i.ticker_.dispose()}))}return C(t,[{key:"begin",value:function(){this.stopwatch_.begin(new Date)}},{key:"end",value:function(){this.stopwatch_.end(new Date)}},{key:"onTick_",value:function(){var t=this.stopwatch_.fps;if(null!==t){var e=this.value_.rawValue;this.value_.rawValue=ce(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}]),t}();function Vn(t,e){return 0===e?new vt:new ft(t,null!=e?e:Ne.monitor.defaultInterval)}var On={id:"fpsgraph",type:"blade",accept:function(t){var e=N,n=q(t,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return n?{params:n}:null},controller:function(t){var e,n,i,r,a=null!==(e=t.params.interval)&&void 0!==e?e:500;return new et(t.document,{blade:t.blade,props:S.fromObject({label:t.params.label}),valueController:new Sn(t.document,{lineCount:null!==(n=t.params.lineCount)&&void 0!==n?n:2,maxValue:null!==(i=t.params.max)&&void 0!==i?i:90,minValue:null!==(r=t.params.min)&&void 0!==r?r:0,ticker:Vn(t.document,a),value:ue(80),viewProps:t.viewProps})})},api:function(t){return t.controller instanceof et&&t.controller.valueController instanceof Sn?new En(t.controller):null}},Dn=function(){function t(e,n){c(this,t),this.min=e,this.max=n}return C(t,[{key:"length",get:function(){return this.max-this.min}},{key:"toObject",value:function(){return{min:this.min,max:this.max}}}],[{key:"isObject",value:function(t){if("object"!=typeof t||null===t)return!1;var e=t.min,n=t.max;return"number"==typeof e&&"number"==typeof n}},{key:"equals",value:function(t,e){return t.min===e.min&&t.max===e.max}}]),t}(),Rn={fromComponents:function(t){return new Dn(t[0],t[1])},toComponents:function(t){return[t.min,t.max]}},Ln=function(){function t(e){c(this,t),this.edge=e}return C(t,[{key:"constrain",value:function(t){var e,n,i,r,a,o,s,u;if(t.min<=t.max)return new Dn(null!==(n=null===(e=this.edge)||void 0===e?void 0:e.constrain(t.min))&&void 0!==n?n:t.min,null!==(r=null===(i=this.edge)||void 0===i?void 0:i.constrain(t.max))&&void 0!==r?r:t.max);var l=(t.min+t.max)/2;return new Dn(null!==(o=null===(a=this.edge)||void 0===a?void 0:a.constrain(l))&&void 0!==o?o:l,null!==(u=null===(s=this.edge)||void 0===s?void 0:s.constrain(l))&&void 0!==u?u:l)}}]),t}(),In=p("rsltxt"),Nn=function t(e,n){c(this,t),this.sliderView_=n.sliderView,this.textView_=n.textView,this.element=e.createElement("div"),this.element.classList.add(In());var i=e.createElement("div");i.classList.add(In("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);var r=e.createElement("div");r.classList.add(In("t")),r.appendChild(this.textView_.element),this.element.appendChild(r)},Fn=p("rsl"),Bn=function(){function t(e,n){c(this,t),this.maxValue_=n.maxValue,this.minValue_=n.minValue,this.element=e.createElement("div"),this.element.classList.add(Fn()),n.viewProps.bindClassModifiers(this.element),this.value_=n.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));var i=e.createElement("div");i.classList.add(Fn("t")),this.element.appendChild(i),this.trackElement=i;var r=e.createElement("div");r.classList.add(Fn("b")),i.appendChild(r),this.barElement=r;var a=["min","max"].map((function(t){var n=e.createElement("div");return n.classList.add(Fn("k"),Fn("k",t)),i.appendChild(n),n}));this.knobElements=[a[0],a[1]],this.update()}return C(t,[{key:"valueToX_",value:function(t){return 100*we(ye(t,this.minValue_,this.maxValue_,0,1),0,1)}},{key:"update",value:function(){var t=this.value_.rawValue;0===t.length?this.element.classList.add(Fn(void 0,"zero")):this.element.classList.remove(Fn(void 0,"zero"));var e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left="".concat(e[0],"%"),this.barElement.style.right="".concat(100-e[1],"%"),this.knobElements.forEach((function(t,n){t.style.left="".concat(e[n],"%")}))}},{key:"onValueChange_",value:function(){this.update()}}]),t}(),qn=function(){function t(e,n){c(this,t),this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=n.maxValue,this.minValue_=n.minValue,this.viewProps=n.viewProps,this.value=n.value,this.view=new Bn(e,{maxValue:n.maxValue,minValue:n.minValue,value:this.value,viewProps:n.viewProps});var i=new ge(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return C(t,[{key:"ofs_",value:function(){return"min"===this.grabbing_?this.view.knobElements[0].getBoundingClientRect().width/2:"max"===this.grabbing_?-this.view.knobElements[1].getBoundingClientRect().width/2:0}},{key:"valueFromData_",value:function(t){return t.point?ye((t.point.x+this.ofs_())/t.bounds.width,0,1,this.minValue_,this.maxValue_):null}},{key:"onPointerDown_",value:function(t){if(t.data.point){var e=t.data.point.x/t.data.bounds.width,n=this.value.rawValue,i=ye(n.min,this.minValue_,this.maxValue_,0,1),r=ye(n.max,this.minValue_,this.maxValue_,0,1);Math.abs(r-e)<=.025?this.grabbing_="max":Math.abs(i-e)<=.025?this.grabbing_="min":e>=i&&e<=r?(this.grabbing_="length",this.grabOffset_=ye(e-i,0,1,0,this.maxValue_-this.minValue_)):e<i?(this.grabbing_="min",this.onPointerMove_(t)):e>r&&(this.grabbing_="max",this.onPointerMove_(t))}}},{key:"applyPointToValue_",value:function(t,e){var n=this.valueFromData_(t);if(null!==n)if("min"===this.grabbing_)this.value.setRawValue(new Dn(n,this.value.rawValue.max),e);else if("max"===this.grabbing_)this.value.setRawValue(new Dn(this.value.rawValue.min,n),e);else if("length"===this.grabbing_){var i=this.value.rawValue.length,r=n-this.grabOffset_,a=r+i;r<this.minValue_?(r=this.minValue_,a=this.minValue_+i):a>this.maxValue_&&(r=this.maxValue_-i,a=this.maxValue_),this.value.setRawValue(new Dn(r,a),e)}}},{key:"onPointerMove_",value:function(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}]),t}(),jn=function(){function t(e,n){c(this,t),this.value=n.value,this.viewProps=n.viewProps,this.sc_=new qn(e,n);var i={baseStep:n.baseStep,constraint:n.constraint,textProps:S.fromObject({draggingScale:n.draggingScale,formatter:n.formatter})};this.tc_=new Re(e,{assembly:Rn,axes:[i,i],parser:n.parser,value:this.value,viewProps:n.viewProps}),this.view=new Nn(e,{sliderView:this.sc_.view,textView:this.tc_.view})}return C(t,[{key:"textController",get:function(){return this.tc_}}]),t}();function zn(t){return Dn.isObject(t)?new Dn(t.min,t.max):new Dn(0,0)}function Un(t,e){t.writeProperty("max",e.max),t.writeProperty("min",e.min)}function Wn(t){var e=[],n=Ie(t);n&&e.push(n);var i=Le(t);return i&&e.push(i),new Ln(new dt(e))}var Gn={id:"input-interval",type:"input",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:function(t,e){if(!Dn.isObject(t))return null;var n=N,i=q(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,step:n.optional.number});return i?{initialValue:new Dn(t.min,t.max),params:i}:null},binding:{reader:function(t){return zn},constraint:function(t){return Wn(t.params)},equals:Dn.equals,writer:function(t){return Un}},controller:function(t){var e,n=t.value,i=t.constraint;if(!(i instanceof Ln))throw u.shouldNeverHappen();var r=(n.rawValue.min+n.rawValue.max)/2,a=null!==(e=t.params.format)&&void 0!==e?e:oe(Te(i.edge,r)),o=i.edge&&mt(i.edge,_t);if(void 0!==(null==o?void 0:o.minValue)&&void 0!==(null==o?void 0:o.maxValue))return new jn(t.document,{baseStep:Pe(i.edge),constraint:i.edge,draggingScale:Ae(o,r),formatter:a,maxValue:o.maxValue,minValue:o.minValue,parser:re,value:n,viewProps:t.viewProps});var s={baseStep:Pe(i.edge),constraint:i.edge,textProps:S.fromObject({draggingScale:r,formatter:a})};return new Re(t.document,{assembly:Rn,axes:[s,s],parser:re,value:n,viewProps:t.viewProps})}},Kn=function(){function t(e){c(this,t),this.controller_=e}return C(t,[{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.props.set("title",t)}}]),t}(),Hn=function(t){O(n,t);var e=P(n);function n(t,i,r,a,o){var s;return c(this,n),(s=e.call(this,t,a,o)).cell=i,s.index=r,s}return n}(i),Yn=function(t){O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).cellToApiMap_=new Map,i.controller_.valueController.cellControllers.forEach((function(t){var e=new Kn(t);i.cellToApiMap_.set(t,e)})),i}return C(n,[{key:"value",get:function(){return this.controller_.value}},{key:"cell",value:function(t,e){var n=this.controller_.valueController,i=n.cellControllers[e*n.size[0]+t];return this.cellToApiMap_.get(i)}},{key:"on",value:function(t,e){var n=this,i=e.bind(this);this.controller_.value.emitter.on(t,(function(t){var e=n.controller_.valueController,r=e.findCellByValue(t.rawValue);if(r){var a=n.cellToApiMap_.get(r);if(a){var o=e.cellControllers.indexOf(r);i(new Hn(n,a,[o%e.size[0],Math.floor(o/e.size[0])],t.rawValue,void 0))}}}))}}]),n}(e),Xn=p("rad"),Zn=function t(e,n){c(this,t),this.element=e.createElement("div"),this.element.classList.add(Xn()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("label");i.classList.add(Xn("l")),this.element.appendChild(i);var r=e.createElement("input");r.classList.add(Xn("i")),r.name=n.name,r.type="radio",n.viewProps.bindDisabled(r),i.appendChild(r),this.inputElement=r;var a=e.createElement("div");a.classList.add(Xn("b")),i.appendChild(a);var o=e.createElement("div");o.classList.add(Xn("t")),a.appendChild(o),m(n.props,"title",(function(t){o.textContent=t}))},Qn=function t(e,n){c(this,t),this.props=n.props,this.viewProps=n.viewProps,this.view=new Zn(e,{name:n.name,props:this.props,viewProps:this.viewProps})},$n=function(){function t(e,n){var i=this;c(this,t),this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=n.size;for(var r=F(this.size,2),a=r[0],o=r[1],s=0;s<o;s++)for(var u=0;u<a;u++){var l=new Qn(e,{name:n.groupName,props:S.fromObject(Object.assign({},n.cellConfig(u,s))),viewProps:pt.create()});this.cellCs_.push(l),this.cellValues_.push(n.cellConfig(u,s).value)}this.value=n.value,d(this.value,(function(t){var e=i.findCellByValue(t);e&&(e.view.inputElement.checked=!0)})),this.viewProps=pt.create(),this.view=new ut(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns="repeat(".concat(a,", 1fr)"),this.cellCs_.forEach((function(t){t.view.inputElement.addEventListener("change",i.onCellInputChange_),i.view.element.appendChild(t.view.element)}))}return C(t,[{key:"cellControllers",get:function(){return this.cellCs_}},{key:"findCellByValue",value:function(t){var e=this.cellValues_.findIndex((function(e){return e===t}));return e<0?null:this.cellCs_[e]}},{key:"onCellInputChange_",value:function(t){var e=t.currentTarget,n=this.cellCs_.findIndex((function(t){return t.view.inputElement===e}));n<0||(this.value.rawValue=this.cellValues_[n])}}]),t}(),Jn={id:"radiogrid",type:"blade",accept:function(t){var e=N,n=q(t,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new lt(t.document,{blade:t.blade,props:S.fromObject({label:t.params.label}),valueController:new $n(t.document,{groupName:t.params.groupName,cellConfig:t.params.cells,size:t.params.size,value:T(t.params.value)})})},api:function(t){return t.controller instanceof lt&&t.controller.valueController instanceof $n?new Yn(t.controller):null}},ti=[Ke,Cn,On,Gn,Jn,{id:"input-radiogrid",type:"input",accept:function(t,e){if("number"!=typeof t)return null;var n=N,i=q(e,{cells:n.required.function,groupName:n.required.string,size:n.required.array(n.required.number),view:n.required.constant("radiogrid")});return i?{initialValue:t,params:i}:null},binding:{reader:function(t){return ae},writer:function(t){return Ee}},controller:function(t){return new $n(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})}}];t.CubicBezier=Je,t.plugins=ti,Object.defineProperty(t,"__esModule",{value:!0})}(q);var j={};t(j,"create",(function(){return G})),t(j,"clone",(function(){return K})),t(j,"copy",(function(){return H})),t(j,"fromValues",(function(){return Y})),t(j,"set",(function(){return X})),t(j,"identity",(function(){return Z})),t(j,"transpose",(function(){return Q})),t(j,"invert",(function(){return $})),t(j,"adjoint",(function(){return J})),t(j,"determinant",(function(){return tt})),t(j,"multiply",(function(){return et})),t(j,"translate",(function(){return nt})),t(j,"scale",(function(){return it})),t(j,"rotate",(function(){return rt})),t(j,"rotateX",(function(){return at})),t(j,"rotateY",(function(){return ot})),t(j,"rotateZ",(function(){return st})),t(j,"fromTranslation",(function(){return ut})),t(j,"fromScaling",(function(){return lt})),t(j,"fromRotation",(function(){return ct})),t(j,"fromXRotation",(function(){return ht})),t(j,"fromYRotation",(function(){return pt})),t(j,"fromZRotation",(function(){return vt})),t(j,"fromRotationTranslation",(function(){return ft})),t(j,"fromQuat2",(function(){return dt})),t(j,"getTranslation",(function(){return mt})),t(j,"getScaling",(function(){return _t})),t(j,"getRotation",(function(){return gt})),t(j,"fromRotationTranslationScale",(function(){return yt})),t(j,"fromRotationTranslationScaleOrigin",(function(){return bt})),t(j,"fromQuat",(function(){return wt})),t(j,"frustum",(function(){return kt})),t(j,"perspectiveNO",(function(){return xt})),t(j,"perspective",(function(){return Ct})),t(j,"perspectiveZO",(function(){return Et})),t(j,"perspectiveFromFieldOfView",(function(){return Mt})),t(j,"orthoNO",(function(){return Tt})),t(j,"ortho",(function(){return Pt})),t(j,"orthoZO",(function(){return At})),t(j,"lookAt",(function(){return St})),t(j,"targetTo",(function(){return Vt})),t(j,"str",(function(){return Ot})),t(j,"frob",(function(){return Dt})),t(j,"add",(function(){return Rt})),t(j,"subtract",(function(){return Lt})),t(j,"multiplyScalar",(function(){return It})),t(j,"multiplyScalarAndAdd",(function(){return Nt})),t(j,"exactEquals",(function(){return Ft})),t(j,"equals",(function(){return Bt})),t(j,"mul",(function(){return qt})),t(j,"sub",(function(){return jt}));var z=1e-6,U="undefined"!=typeof Float32Array?Float32Array:Array,W=Math.random;Math.PI;function G(){var t=new U(16);return U!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function K(t){var e=new U(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function H(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Y(t,e,n,i,r,a,o,s,u,l,c,h,p,v,f,d){var m=new U(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=r,m[5]=a,m[6]=o,m[7]=s,m[8]=u,m[9]=l,m[10]=c,m[11]=h,m[12]=p,m[13]=v,m[14]=f,m[15]=d,m}function X(t,e,n,i,r,a,o,s,u,l,c,h,p,v,f,d,m){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=p,t[12]=v,t[13]=f,t[14]=d,t[15]=m,t}function Z(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Q(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=r,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function $(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],p=e[10],v=e[11],f=e[12],d=e[13],m=e[14],_=e[15],g=n*s-i*o,y=n*u-r*o,b=n*l-a*o,w=i*u-r*s,k=i*l-a*s,x=r*l-a*u,C=c*d-h*f,E=c*m-p*f,M=c*_-v*f,T=h*m-p*d,P=h*_-v*d,A=p*_-v*m,S=g*A-y*P+b*T+w*M-k*E+x*C;return S?(S=1/S,t[0]=(s*A-u*P+l*T)*S,t[1]=(r*P-i*A-a*T)*S,t[2]=(d*x-m*k+_*w)*S,t[3]=(p*k-h*x-v*w)*S,t[4]=(u*M-o*A-l*E)*S,t[5]=(n*A-r*M+a*E)*S,t[6]=(m*b-f*x-_*y)*S,t[7]=(c*x-p*b+v*y)*S,t[8]=(o*P-s*M+l*C)*S,t[9]=(i*M-n*P-a*C)*S,t[10]=(f*k-d*b+_*g)*S,t[11]=(h*b-c*k-v*g)*S,t[12]=(s*E-o*T-u*C)*S,t[13]=(n*T-i*E+r*C)*S,t[14]=(d*y-f*w-m*g)*S,t[15]=(c*w-h*y+p*g)*S,t):null}function J(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],p=e[10],v=e[11],f=e[12],d=e[13],m=e[14],_=e[15];return t[0]=s*(p*_-v*m)-h*(u*_-l*m)+d*(u*v-l*p),t[1]=-(i*(p*_-v*m)-h*(r*_-a*m)+d*(r*v-a*p)),t[2]=i*(u*_-l*m)-s*(r*_-a*m)+d*(r*l-a*u),t[3]=-(i*(u*v-l*p)-s*(r*v-a*p)+h*(r*l-a*u)),t[4]=-(o*(p*_-v*m)-c*(u*_-l*m)+f*(u*v-l*p)),t[5]=n*(p*_-v*m)-c*(r*_-a*m)+f*(r*v-a*p),t[6]=-(n*(u*_-l*m)-o*(r*_-a*m)+f*(r*l-a*u)),t[7]=n*(u*v-l*p)-o*(r*v-a*p)+c*(r*l-a*u),t[8]=o*(h*_-v*d)-c*(s*_-l*d)+f*(s*v-l*h),t[9]=-(n*(h*_-v*d)-c*(i*_-a*d)+f*(i*v-a*h)),t[10]=n*(s*_-l*d)-o*(i*_-a*d)+f*(i*l-a*s),t[11]=-(n*(s*v-l*h)-o*(i*v-a*h)+c*(i*l-a*s)),t[12]=-(o*(h*m-p*d)-c*(s*m-u*d)+f*(s*p-u*h)),t[13]=n*(h*m-p*d)-c*(i*m-r*d)+f*(i*p-r*h),t[14]=-(n*(s*m-u*d)-o*(i*m-r*d)+f*(i*u-r*s)),t[15]=n*(s*p-u*h)-o*(i*p-r*h)+c*(i*u-r*s),t}function tt(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],p=t[11],v=t[12],f=t[13],d=t[14],m=t[15];return(e*o-n*a)*(h*m-p*d)-(e*s-i*a)*(c*m-p*f)+(e*u-r*a)*(c*d-h*f)+(n*s-i*o)*(l*m-p*v)-(n*u-r*o)*(l*d-h*v)+(i*u-r*s)*(l*f-c*v)}function et(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],p=e[9],v=e[10],f=e[11],d=e[12],m=e[13],_=e[14],g=e[15],y=n[0],b=n[1],w=n[2],k=n[3];return t[0]=y*i+b*s+w*h+k*d,t[1]=y*r+b*u+w*p+k*m,t[2]=y*a+b*l+w*v+k*_,t[3]=y*o+b*c+w*f+k*g,y=n[4],b=n[5],w=n[6],k=n[7],t[4]=y*i+b*s+w*h+k*d,t[5]=y*r+b*u+w*p+k*m,t[6]=y*a+b*l+w*v+k*_,t[7]=y*o+b*c+w*f+k*g,y=n[8],b=n[9],w=n[10],k=n[11],t[8]=y*i+b*s+w*h+k*d,t[9]=y*r+b*u+w*p+k*m,t[10]=y*a+b*l+w*v+k*_,t[11]=y*o+b*c+w*f+k*g,y=n[12],b=n[13],w=n[14],k=n[15],t[12]=y*i+b*s+w*h+k*d,t[13]=y*r+b*u+w*p+k*m,t[14]=y*a+b*l+w*v+k*_,t[15]=y*o+b*c+w*f+k*g,t}function nt(t,e,n){var i,r,a,o,s,u,l,c,h,p,v,f,d=n[0],m=n[1],_=n[2];return e===t?(t[12]=e[0]*d+e[4]*m+e[8]*_+e[12],t[13]=e[1]*d+e[5]*m+e[9]*_+e[13],t[14]=e[2]*d+e[6]*m+e[10]*_+e[14],t[15]=e[3]*d+e[7]*m+e[11]*_+e[15]):(i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],p=e[9],v=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=p,t[10]=v,t[11]=f,t[12]=i*d+s*m+h*_+e[12],t[13]=r*d+u*m+p*_+e[13],t[14]=a*d+l*m+v*_+e[14],t[15]=o*d+c*m+f*_+e[15]),t}function it(t,e,n){var i=n[0],r=n[1],a=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function rt(t,e,n,i){var r,a,o,s,u,l,c,h,p,v,f,d,m,_,g,y,b,w,k,x,C,E,M,T,P=i[0],A=i[1],S=i[2],V=Math.hypot(P,A,S);return V<z?null:(P*=V=1/V,A*=V,S*=V,r=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],u=e[1],l=e[2],c=e[3],h=e[4],p=e[5],v=e[6],f=e[7],d=e[8],m=e[9],_=e[10],g=e[11],y=P*P*o+a,b=A*P*o+S*r,w=S*P*o-A*r,k=P*A*o-S*r,x=A*A*o+a,C=S*A*o+P*r,E=P*S*o+A*r,M=A*S*o-P*r,T=S*S*o+a,t[0]=s*y+h*b+d*w,t[1]=u*y+p*b+m*w,t[2]=l*y+v*b+_*w,t[3]=c*y+f*b+g*w,t[4]=s*k+h*x+d*C,t[5]=u*k+p*x+m*C,t[6]=l*k+v*x+_*C,t[7]=c*k+f*x+g*C,t[8]=s*E+h*M+d*T,t[9]=u*E+p*M+m*T,t[10]=l*E+v*M+_*T,t[11]=c*E+f*M+g*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function at(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+l*i,t[5]=o*r+c*i,t[6]=s*r+h*i,t[7]=u*r+p*i,t[8]=l*r-a*i,t[9]=c*r-o*i,t[10]=h*r-s*i,t[11]=p*r-u*i,t}function ot(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-l*i,t[1]=o*r-c*i,t[2]=s*r-h*i,t[3]=u*r-p*i,t[8]=a*i+l*r,t[9]=o*i+c*r,t[10]=s*i+h*r,t[11]=u*i+p*r,t}function st(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+l*i,t[1]=o*r+c*i,t[2]=s*r+h*i,t[3]=u*r+p*i,t[4]=l*r-a*i,t[5]=c*r-o*i,t[6]=h*r-s*i,t[7]=p*r-u*i,t}function ut(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function lt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(t,e,n){var i,r,a,o=n[0],s=n[1],u=n[2],l=Math.hypot(o,s,u);return l<z?null:(o*=l=1/l,s*=l,u*=l,i=Math.sin(e),a=1-(r=Math.cos(e)),t[0]=o*o*a+r,t[1]=s*o*a+u*i,t[2]=u*o*a-s*i,t[3]=0,t[4]=o*s*a-u*i,t[5]=s*s*a+r,t[6]=u*s*a+o*i,t[7]=0,t[8]=o*u*a+s*i,t[9]=s*u*a-o*i,t[10]=u*u*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function ht(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ft(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=i+i,u=r+r,l=a+a,c=i*s,h=i*u,p=i*l,v=r*u,f=r*l,d=a*l,m=o*s,_=o*u,g=o*l;return t[0]=1-(v+d),t[1]=h+g,t[2]=p-_,t[3]=0,t[4]=h-g,t[5]=1-(c+d),t[6]=f+m,t[7]=0,t[8]=p+_,t[9]=f-m,t[10]=1-(c+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function dt(t,e){var n=new U(3),i=-e[0],r=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=i*i+r*r+a*a+o*o;return h>0?(n[0]=2*(s*o+c*i+u*a-l*r)/h,n[1]=2*(u*o+c*r+l*i-s*a)/h,n[2]=2*(l*o+c*a+s*r-u*i)/h):(n[0]=2*(s*o+c*i+u*a-l*r),n[1]=2*(u*o+c*r+l*i-s*a),n[2]=2*(l*o+c*a+s*r-u*i)),ft(t,e,n),t}function mt(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function _t(t,e){var n=e[0],i=e[1],r=e[2],a=e[4],o=e[5],s=e[6],u=e[8],l=e[9],c=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,l,c),t}function gt(t,e){var n=new U(3);_t(n,e);var i=1/n[0],r=1/n[1],a=1/n[2],o=e[0]*i,s=e[1]*r,u=e[2]*a,l=e[4]*i,c=e[5]*r,h=e[6]*a,p=e[8]*i,v=e[9]*r,f=e[10]*a,d=o+c+f,m=0;return d>0?(m=2*Math.sqrt(d+1),t[3]=.25*m,t[0]=(h-v)/m,t[1]=(p-u)/m,t[2]=(s-l)/m):o>c&&o>f?(m=2*Math.sqrt(1+o-c-f),t[3]=(h-v)/m,t[0]=.25*m,t[1]=(s+l)/m,t[2]=(p+u)/m):c>f?(m=2*Math.sqrt(1+c-o-f),t[3]=(p-u)/m,t[0]=(s+l)/m,t[1]=.25*m,t[2]=(h+v)/m):(m=2*Math.sqrt(1+f-o-c),t[3]=(s-l)/m,t[0]=(p+u)/m,t[1]=(h+v)/m,t[2]=.25*m),t}function yt(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=e[3],u=r+r,l=a+a,c=o+o,h=r*u,p=r*l,v=r*c,f=a*l,d=a*c,m=o*c,_=s*u,g=s*l,y=s*c,b=i[0],w=i[1],k=i[2];return t[0]=(1-(f+m))*b,t[1]=(p+y)*b,t[2]=(v-g)*b,t[3]=0,t[4]=(p-y)*w,t[5]=(1-(h+m))*w,t[6]=(d+_)*w,t[7]=0,t[8]=(v+g)*k,t[9]=(d-_)*k,t[10]=(1-(h+f))*k,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function bt(t,e,n,i,r){var a=e[0],o=e[1],s=e[2],u=e[3],l=a+a,c=o+o,h=s+s,p=a*l,v=a*c,f=a*h,d=o*c,m=o*h,_=s*h,g=u*l,y=u*c,b=u*h,w=i[0],k=i[1],x=i[2],C=r[0],E=r[1],M=r[2],T=(1-(d+_))*w,P=(v+b)*w,A=(f-y)*w,S=(v-b)*k,V=(1-(p+_))*k,O=(m+g)*k,D=(f+y)*x,R=(m-g)*x,L=(1-(p+d))*x;return t[0]=T,t[1]=P,t[2]=A,t[3]=0,t[4]=S,t[5]=V,t[6]=O,t[7]=0,t[8]=D,t[9]=R,t[10]=L,t[11]=0,t[12]=n[0]+C-(T*C+S*E+D*M),t[13]=n[1]+E-(P*C+V*E+R*M),t[14]=n[2]+M-(A*C+O*E+L*M),t[15]=1,t}function wt(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n+n,s=i+i,u=r+r,l=n*o,c=i*o,h=i*s,p=r*o,v=r*s,f=r*u,d=a*o,m=a*s,_=a*u;return t[0]=1-h-f,t[1]=c+_,t[2]=p-m,t[3]=0,t[4]=c-_,t[5]=1-l-f,t[6]=v+d,t[7]=0,t[8]=p+m,t[9]=v-d,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function kt(t,e,n,i,r,a,o){var s=1/(n-e),u=1/(r-i),l=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*u,t[10]=(o+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*l,t[15]=0,t}function xt(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=(r+i)*a,t[14]=2*r*i*a):(t[10]=-1,t[14]=-2*i),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ct=xt;function Et(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(a=1/(i-r),t[10]=r*a,t[14]=r*i*a):(t[10]=-1,t[14]=-i),t}function Mt(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(r+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(r-a)*l*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function Tt(t,e,n,i,r,a,o){var s=1/(e-n),u=1/(i-r),l=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(o+a)*l,t[15]=1,t}var Pt=Tt;function At(t,e,n,i,r,a,o){var s=1/(e-n),u=1/(i-r),l=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=a*l,t[15]=1,t}function St(t,e,n,i){var r,a,o,s,u,l,c,h,p,v,f=e[0],d=e[1],m=e[2],_=i[0],g=i[1],y=i[2],b=n[0],w=n[1],k=n[2];return Math.abs(f-b)<z&&Math.abs(d-w)<z&&Math.abs(m-k)<z?Z(t):(c=f-b,h=d-w,p=m-k,r=g*(p*=v=1/Math.hypot(c,h,p))-y*(h*=v),a=y*(c*=v)-_*p,o=_*h-g*c,(v=Math.hypot(r,a,o))?(r*=v=1/v,a*=v,o*=v):(r=0,a=0,o=0),s=h*o-p*a,u=p*r-c*o,l=c*a-h*r,(v=Math.hypot(s,u,l))?(s*=v=1/v,u*=v,l*=v):(s=0,u=0,l=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=u,t[6]=h,t[7]=0,t[8]=o,t[9]=l,t[10]=p,t[11]=0,t[12]=-(r*f+a*d+o*m),t[13]=-(s*f+u*d+l*m),t[14]=-(c*f+h*d+p*m),t[15]=1,t)}function Vt(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=i[0],u=i[1],l=i[2],c=r-n[0],h=a-n[1],p=o-n[2],v=c*c+h*h+p*p;v>0&&(c*=v=1/Math.sqrt(v),h*=v,p*=v);var f=u*p-l*h,d=l*c-s*p,m=s*h-u*c;return(v=f*f+d*d+m*m)>0&&(f*=v=1/Math.sqrt(v),d*=v,m*=v),t[0]=f,t[1]=d,t[2]=m,t[3]=0,t[4]=h*m-p*d,t[5]=p*f-c*m,t[6]=c*d-h*f,t[7]=0,t[8]=c,t[9]=h,t[10]=p,t[11]=0,t[12]=r,t[13]=a,t[14]=o,t[15]=1,t}function Ot(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Dt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Rt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function It(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Nt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function Ft(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Bt(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],p=t[10],v=t[11],f=t[12],d=t[13],m=t[14],_=t[15],g=e[0],y=e[1],b=e[2],w=e[3],k=e[4],x=e[5],C=e[6],E=e[7],M=e[8],T=e[9],P=e[10],A=e[11],S=e[12],V=e[13],O=e[14],D=e[15];return Math.abs(n-g)<=z*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-y)<=z*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(r-b)<=z*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(a-w)<=z*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-k)<=z*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(s-x)<=z*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(u-C)<=z*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(l-E)<=z*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-M)<=z*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(h-T)<=z*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(p-P)<=z*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(v-A)<=z*Math.max(1,Math.abs(v),Math.abs(A))&&Math.abs(f-S)<=z*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(d-V)<=z*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(m-O)<=z*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(_-D)<=z*Math.max(1,Math.abs(_),Math.abs(D))}var qt=et,jt=Lt,zt={};t(zt,"create",(function(){return je})),t(zt,"identity",(function(){return ze})),t(zt,"setAxisAngle",(function(){return Ue})),t(zt,"getAxisAngle",(function(){return We})),t(zt,"getAngle",(function(){return Ge})),t(zt,"dot",(function(){return kn})),t(zt,"multiply",(function(){return Ke})),t(zt,"rotateX",(function(){return He})),t(zt,"rotateY",(function(){return Ye})),t(zt,"rotateZ",(function(){return Xe})),t(zt,"calculateW",(function(){return Ze})),t(zt,"exp",(function(){return Qe})),t(zt,"ln",(function(){return $e})),t(zt,"pow",(function(){return Je})),t(zt,"scale",(function(){return wn})),t(zt,"slerp",(function(){return tn})),t(zt,"random",(function(){return en})),t(zt,"invert",(function(){return nn})),t(zt,"conjugate",(function(){return rn})),t(zt,"fromMat3",(function(){return an})),t(zt,"fromEuler",(function(){return on})),t(zt,"str",(function(){return sn})),t(zt,"clone",(function(){return dn})),t(zt,"fromValues",(function(){return mn})),t(zt,"copy",(function(){return _n})),t(zt,"set",(function(){return gn})),t(zt,"add",(function(){return yn})),t(zt,"mul",(function(){return bn})),t(zt,"lerp",(function(){return xn})),t(zt,"length",(function(){return Cn})),t(zt,"len",(function(){return En})),t(zt,"squaredLength",(function(){return Mn})),t(zt,"sqrLen",(function(){return Tn})),t(zt,"normalize",(function(){return Pn})),t(zt,"exactEquals",(function(){return An})),t(zt,"equals",(function(){return Sn})),t(zt,"rotationTo",(function(){return Vn})),t(zt,"sqlerp",(function(){return On})),t(zt,"setAxes",(function(){return Dn}));var Ut={};function Wt(){var t=new U(3);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Gt(t){var e=new U(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Kt(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function Ht(t,e,n){var i=new U(3);return i[0]=t,i[1]=e,i[2]=n,i}function Yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Xt(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Zt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Qt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function $t(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Jt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function te(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function ee(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function ne(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function ie(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function re(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function ae(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function oe(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function se(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function ue(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function le(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function ce(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function he(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function pe(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function ve(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function fe(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[0],s=n[1],u=n[2];return t[0]=r*u-a*s,t[1]=a*o-i*u,t[2]=i*s-r*o,t}function de(t,e,n,i){var r=e[0],a=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=o+i*(n[2]-o),t}function me(t,e,n,i,r,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return t[0]=e[0]*s+n[0]*u+i[0]*l+r[0]*c,t[1]=e[1]*s+n[1]*u+i[1]*l+r[1]*c,t[2]=e[2]*s+n[2]*u+i[2]*l+r[2]*c,t}function _e(t,e,n,i,r,a){var o=1-a,s=o*o,u=a*a,l=s*o,c=3*a*s,h=3*u*o,p=u*a;return t[0]=e[0]*l+n[0]*c+i[0]*h+r[0]*p,t[1]=e[1]*l+n[1]*c+i[1]*h+r[1]*p,t[2]=e[2]*l+n[2]*c+i[2]*h+r[2]*p,t}function ge(t,e){e=e||1;var n=2*W()*Math.PI,i=2*W()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function ye(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[3]*i+n[7]*r+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/o,t}function be(t,e,n){var i=e[0],r=e[1],a=e[2];return t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8],t}function we(t,e,n){var i=n[0],r=n[1],a=n[2],o=n[3],s=e[0],u=e[1],l=e[2],c=r*l-a*u,h=a*s-i*l,p=i*u-r*s,v=r*p-a*h,f=a*c-i*p,d=i*h-r*c,m=2*o;return c*=m,h*=m,p*=m,v*=2,f*=2,d*=2,t[0]=s+c+v,t[1]=u+h+f,t[2]=l+p+d,t}function ke(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0],a[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),a[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function xe(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),a[1]=r[1],a[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Ce(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),a[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),a[2]=r[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Ee(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(a*a+o*o+s*s),l=u&&ve(t,e)/u;return Math.acos(Math.min(Math.max(l,-1),1))}function Me(t){return t[0]=0,t[1]=0,t[2]=0,t}function Te(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Pe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Ae(t,e){var n=t[0],i=t[1],r=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=z*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=z*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-s)<=z*Math.max(1,Math.abs(r),Math.abs(s))}t(Ut,"create",(function(){return Wt})),t(Ut,"clone",(function(){return Gt})),t(Ut,"length",(function(){return Kt})),t(Ut,"fromValues",(function(){return Ht})),t(Ut,"copy",(function(){return Yt})),t(Ut,"set",(function(){return Xt})),t(Ut,"add",(function(){return Zt})),t(Ut,"subtract",(function(){return Qt})),t(Ut,"multiply",(function(){return $t})),t(Ut,"divide",(function(){return Jt})),t(Ut,"ceil",(function(){return te})),t(Ut,"floor",(function(){return ee})),t(Ut,"min",(function(){return ne})),t(Ut,"max",(function(){return ie})),t(Ut,"round",(function(){return re})),t(Ut,"scale",(function(){return ae})),t(Ut,"scaleAndAdd",(function(){return oe})),t(Ut,"distance",(function(){return se})),t(Ut,"squaredDistance",(function(){return ue})),t(Ut,"squaredLength",(function(){return le})),t(Ut,"negate",(function(){return ce})),t(Ut,"inverse",(function(){return he})),t(Ut,"normalize",(function(){return pe})),t(Ut,"len",(function(){return Ie})),t(Ut,"dot",(function(){return ve})),t(Ut,"cross",(function(){return fe})),t(Ut,"lerp",(function(){return de})),t(Ut,"hermite",(function(){return me})),t(Ut,"bezier",(function(){return _e})),t(Ut,"random",(function(){return ge})),t(Ut,"transformMat4",(function(){return ye})),t(Ut,"transformMat3",(function(){return be})),t(Ut,"transformQuat",(function(){return we})),t(Ut,"rotateX",(function(){return ke})),t(Ut,"rotateY",(function(){return xe})),t(Ut,"rotateZ",(function(){return Ce})),t(Ut,"angle",(function(){return Ee})),t(Ut,"zero",(function(){return Me})),t(Ut,"str",(function(){return Te})),t(Ut,"exactEquals",(function(){return Pe})),t(Ut,"equals",(function(){return Ae})),t(Ut,"sub",(function(){return Ve})),t(Ut,"mul",(function(){return Oe})),t(Ut,"div",(function(){return De})),t(Ut,"dist",(function(){return Re})),t(Ut,"sqrDist",(function(){return Le})),t(Ut,"sqrLen",(function(){return Ne})),t(Ut,"forEach",(function(){return Fe}));var Se,Ve=Qt,Oe=$t,De=Jt,Re=se,Le=ue,Ie=Kt,Ne=le,Fe=(Se=Wt(),function(t,e,n,i,r,a){var o,s;for(e||(e=3),n||(n=0),s=i?Math.min(i*e+n,t.length):t.length,o=n;o<s;o+=e)Se[0]=t[o],Se[1]=t[o+1],Se[2]=t[o+2],r(Se,Se,a),t[o]=Se[0],t[o+1]=Se[1],t[o+2]=Se[2];return t});function Be(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function qe(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}!function(){var t,e=(t=new U(4),U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function je(){var t=new U(4);return U!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ze(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ue(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function We(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>z?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function Ge(t,e){var n=kn(t,e);return Math.acos(2*n*n-1)}function Ke(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=i*c+o*s+r*l-a*u,t[1]=r*c+o*u+a*s-i*l,t[2]=a*c+o*l+i*u-r*s,t[3]=o*c-i*s-r*u-a*l,t}function He(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+o*s,t[1]=r*u+a*s,t[2]=a*u-r*s,t[3]=o*u-i*s,t}function Ye(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u-a*s,t[1]=r*u+o*s,t[2]=a*u+i*s,t[3]=o*u-r*s,t}function Xe(t,e,n){n*=.5;var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*s,t[1]=r*u-i*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function Ze(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Qe(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=Math.sqrt(n*n+i*i+r*r),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return t[0]=n*u,t[1]=i*u,t[2]=r*u,t[3]=s*Math.cos(o),t}function $e(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=Math.sqrt(n*n+i*i+r*r),s=o>0?Math.atan2(o,a)/o:0;return t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=.5*Math.log(n*n+i*i+r*r+a*a),t}function Je(t,e,n){return $e(t,e),wn(t,t,n),Qe(t,t),t}function tn(t,e,n,i){var r,a,o,s,u,l=e[0],c=e[1],h=e[2],p=e[3],v=n[0],f=n[1],d=n[2],m=n[3];return(a=l*v+c*f+h*d+p*m)<0&&(a=-a,v=-v,f=-f,d=-d,m=-m),1-a>z?(r=Math.acos(a),o=Math.sin(r),s=Math.sin((1-i)*r)/o,u=Math.sin(i*r)/o):(s=1-i,u=i),t[0]=s*l+u*v,t[1]=s*c+u*f,t[2]=s*h+u*d,t[3]=s*p+u*m,t}function en(t){var e=W(),n=W(),i=W(),r=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*i),t[3]=a*Math.cos(2*Math.PI*i),t}function nn(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=a*s,t}function rn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function an(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var a=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*a+a]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+r]+e[3*r+a])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t}function on(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),u=Math.cos(n),l=Math.sin(i),c=Math.cos(i);return t[0]=a*u*c-o*s*l,t[1]=o*s*c+a*u*l,t[2]=o*u*l-a*s*c,t[3]=o*u*c+a*s*l,t}function sn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var un,ln,cn,hn,pn,vn,fn,dn=function(t){var e=new U(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},mn=function(t,e,n,i){var r=new U(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},_n=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},gn=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},yn=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},bn=Ke,wn=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},kn=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},xn=function(t,e,n,i){var r=e[0],a=e[1],o=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t[2]=o+i*(n[2]-o),t[3]=s+i*(n[3]-s),t},Cn=Be,En=Cn,Mn=qe,Tn=Mn,Pn=function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=a*o,t},An=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Sn=function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=e[0],s=e[1],u=e[2],l=e[3];return Math.abs(n-o)<=z*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=z*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-u)<=z*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-l)<=z*Math.max(1,Math.abs(a),Math.abs(l))},Vn=(un=Wt(),ln=Ht(1,0,0),cn=Ht(0,1,0),function(t,e,n){var i=ve(e,n);return i<-.999999?(fe(un,ln,e),Ie(un)<1e-6&&fe(un,cn,e),pe(un,un),Ue(t,un,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(fe(un,e,n),t[0]=un[0],t[1]=un[1],t[2]=un[2],t[3]=1+i,Pn(t,t))}),On=(hn=je(),pn=je(),function(t,e,n,i,r,a){return tn(hn,e,r,a),tn(pn,n,i,a),tn(t,hn,pn,2*a*(1-a)),t}),Dn=(vn=new U(9),U!=Float32Array&&(vn[1]=0,vn[2]=0,vn[3]=0,vn[5]=0,vn[6]=0,vn[7]=0),vn[0]=1,vn[4]=1,vn[8]=1,fn=vn,function(t,e,n,i){return fn[0]=n[0],fn[3]=n[1],fn[6]=n[2],fn[1]=i[0],fn[4]=i[1],fn[7]=i[2],fn[2]=-e[0],fn[5]=-e[1],fn[8]=-e[2],Pn(t,an(t,fn))}),Rn={};function Ln(){var t=new U(2);return U!=Float32Array&&(t[0]=0,t[1]=0),t}function In(t){var e=new U(2);return e[0]=t[0],e[1]=t[1],e}function Nn(t,e){var n=new U(2);return n[0]=t,n[1]=e,n}function Fn(t,e){return t[0]=e[0],t[1]=e[1],t}function Bn(t,e,n){return t[0]=e,t[1]=n,t}function qn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function jn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function zn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Un(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Wn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Gn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Kn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Hn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function Yn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Xn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Zn(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function Qn(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}function $n(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function Jn(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function ti(t){var e=t[0],n=t[1];return e*e+n*n}function ei(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ni(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ii(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}function ri(t,e){return t[0]*e[0]+t[1]*e[1]}function ai(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t}function oi(t,e,n,i){var r=e[0],a=e[1];return t[0]=r+i*(n[0]-r),t[1]=a+i*(n[1]-a),t}function si(t,e){e=e||1;var n=2*W()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function ui(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function li(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function ci(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function hi(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}function pi(t,e,n,i){var r=e[0]-n[0],a=e[1]-n[1],o=Math.sin(i),s=Math.cos(i);return t[0]=r*s-a*o+n[0],t[1]=r*o+a*s+n[1],t}function vi(t,e){var n=t[0],i=t[1],r=e[0],a=e[1],o=Math.sqrt(n*n+i*i)*Math.sqrt(r*r+a*a),s=o&&(n*r+i*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function fi(t){return t[0]=0,t[1]=0,t}function di(t){return"vec2("+t[0]+", "+t[1]+")"}function mi(t,e){return t[0]===e[0]&&t[1]===e[1]}function _i(t,e){var n=t[0],i=t[1],r=e[0],a=e[1];return Math.abs(n-r)<=z*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-a)<=z*Math.max(1,Math.abs(i),Math.abs(a))}t(Rn,"create",(function(){return Ln})),t(Rn,"clone",(function(){return In})),t(Rn,"fromValues",(function(){return Nn})),t(Rn,"copy",(function(){return Fn})),t(Rn,"set",(function(){return Bn})),t(Rn,"add",(function(){return qn})),t(Rn,"subtract",(function(){return jn})),t(Rn,"multiply",(function(){return zn})),t(Rn,"divide",(function(){return Un})),t(Rn,"ceil",(function(){return Wn})),t(Rn,"floor",(function(){return Gn})),t(Rn,"min",(function(){return Kn})),t(Rn,"max",(function(){return Hn})),t(Rn,"round",(function(){return Yn})),t(Rn,"scale",(function(){return Xn})),t(Rn,"scaleAndAdd",(function(){return Zn})),t(Rn,"distance",(function(){return Qn})),t(Rn,"squaredDistance",(function(){return $n})),t(Rn,"length",(function(){return Jn})),t(Rn,"squaredLength",(function(){return ti})),t(Rn,"negate",(function(){return ei})),t(Rn,"inverse",(function(){return ni})),t(Rn,"normalize",(function(){return ii})),t(Rn,"len",(function(){return gi})),t(Rn,"dot",(function(){return ri})),t(Rn,"cross",(function(){return ai})),t(Rn,"lerp",(function(){return oi})),t(Rn,"random",(function(){return si})),t(Rn,"transformMat2",(function(){return ui})),t(Rn,"transformMat2d",(function(){return li})),t(Rn,"transformMat3",(function(){return ci})),t(Rn,"transformMat4",(function(){return hi})),t(Rn,"rotate",(function(){return pi})),t(Rn,"angle",(function(){return vi})),t(Rn,"zero",(function(){return fi})),t(Rn,"str",(function(){return di})),t(Rn,"exactEquals",(function(){return mi})),t(Rn,"equals",(function(){return _i})),t(Rn,"sub",(function(){return yi})),t(Rn,"mul",(function(){return bi})),t(Rn,"div",(function(){return wi})),t(Rn,"dist",(function(){return ki})),t(Rn,"sqrDist",(function(){return xi})),t(Rn,"sqrLen",(function(){return Ci})),t(Rn,"forEach",(function(){return Ei}));var gi=Jn,yi=jn,bi=zn,wi=Un,ki=Qn,xi=$n,Ci=ti,Ei=function(){var t=Ln();return function(e,n,i,r,a,o){var s,u;for(n||(n=2),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}();function Mi(t,e,n,i){var r=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach((function(n,i){var a=function(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.error(t.getShaderInfoLog(i)),t.deleteShader(i)}(t,n,e[i]);t.attachShader(r,a)})),n&&t.transformFeedbackVaryings(r,n,t.SEPARATE_ATTRIBS),i)for(var a in i)t.bindAttribLocation(r,i[a],a);if(t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS))return r;console.error(t.getProgramInfoLog(r)),t.deleteProgram(r)}function Ti(t,e,n){var i=t.createVertexArray();t.bindVertexArray(i);var r=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=F(s.value,3),c=l[0],h=l[1],p=l[2];-1!=h&&(t.bindBuffer(t.ARRAY_BUFFER,c),t.enableVertexAttribArray(h),t.vertexAttribPointer(h,p,t.FLOAT,!1,0,0))}}catch(t){a=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}if(n){var v=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,v),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),t.STATIC_DRAW)}return t.bindVertexArray(null),i}function Pi(t,e,n){var i=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,n),t.bindBuffer(t.ARRAY_BUFFER,null),i}function Ai(t,e,n){var i=t.createFramebuffer(),r=[];return t.bindFramebuffer(t.FRAMEBUFFER,i),e.forEach((function(e,n){var i=t["COLOR_ATTACHMENT".concat(n)];t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,e,0),r.push(i)})),n&&t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,n,0),t.drawBuffers(r),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup",t.checkFramebufferStatus(t.FRAMEBUFFER)),t.bindFramebuffer(t.FRAMEBUFFER,null),i}function Si(t,e,n,i){t.bindFramebuffer(t.FRAMEBUFFER,e),t.viewport(0,0,n,i)}function Vi(t,e,n,i,r){var a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),a}var Oi=new WeakSet,Di=function(){"use strict";function t(e,n){var i=this;c(this,t),_(this,Oi),A(this,"rotationQuat",zt.create()),this.canvas=e,this.updateCallback=n||function(){return null},this.pointerDown=!1,this.pointerDownPos=Rn.create(),this.pointerPos=Rn.create(),this.followPos=Ut.create(),this.prevFollowPos=Ut.create(),this.autoRotationSpeed=0,this.velocity=.0025,this.rotationAxis=Ut.fromValues(0,1,0),e.style.touchAction="none",e.addEventListener("pointerdown",(function(t){i.pointerDownPos=Rn.fromValues(t.clientX,t.clientY),i.followPos=Ut.fromValues(t.clientX,t.clientY,0),i.pointerPos=Rn.fromValues(t.clientX,t.clientY),i.prevFollowPos=Ut.fromValues(t.clientX,t.clientY,0),i.pointerDown=!0,i.autoRotationSpeed=0})),e.addEventListener("pointerup",(function(t){i.pointerDown=!1})),e.addEventListener("pointerleave",(function(t){i.pointerDown=!1})),e.addEventListener("pointermove",(function(t){i.pointerDown&&(i.pointerPos[0]=t.clientX,i.pointerPos[1]=t.clientY)}))}return C(t,[{key:"update",value:function(t){var e,n=16/(t+.01),i=10*n;if(this.followPos[0]+=(this.pointerPos[0]-this.followPos[0])/i,this.followPos[1]+=(this.pointerPos[1]-this.followPos[1])/i,this.pointerDown){var r=m(this,Oi,Ri).call(this,this.followPos),a=m(this,Oi,Ri).call(this,this.prevFollowPos),o=Ut.normalize(Ut.create(),r),s=Ut.normalize(Ut.create(),a),u=Ut.cross(Ut.create(),r,a);Ut.normalize(u,u);var l=Math.max(-1,Math.min(1,Ut.dot(o,s))),c=Math.acos(l)*n*5;this.velocity=c,this.rotationAxis=Ut.clone(u),e=zt.setAxisAngle(zt.create(),u,c)}else this.velocity*=this.velocity>.0075?.99:1,e=zt.setAxisAngle(zt.create(),this.rotationAxis,this.velocity);zt.multiply(this.rotationQuat,e,this.rotationQuat),zt.normalize(this.rotationQuat,this.rotationQuat),this.prevFollowPos=Ut.clone(this.followPos),this.updateCallback()}}]),t}();function Ri(t){var e=this.canvas.clientWidth,n=this.canvas.clientHeight,i=Math.max(e,n)-1,r=(2*t[0]-e-1)/i,a=(2*t[1]-n-1)/i,o=0,s=r*r+a*a;return o=s<=.5?Math.sqrt(1-s):.5/Math.sqrt(s),Ut.fromValues(-r,a,o)}var Li=new WeakMap,Ii=new WeakMap,Ni=new WeakMap,Fi=new WeakMap,Bi=new WeakMap,qi=new WeakMap,ji=new WeakMap,zi=new WeakMap,Ui=new WeakMap,Wi=new WeakSet,Gi=new WeakSet,Ki=new WeakSet,Hi=function t(){"use strict";var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:13,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1.5;c(this,t),_(this,Wi),_(this,Gi),_(this,Ki),A(this,"height",50),A(this,"radius",20),A(this,"bevelRadius",13),A(this,"radiusSegments",32),A(this,"bevelSegments",8),f(this,Li,{writable:!0,value:void 0}),f(this,Ii,{writable:!0,value:void 0}),f(this,Ni,{writable:!0,value:void 0}),f(this,Fi,{writable:!0,value:void 0}),f(this,Bi,{writable:!0,value:void 0}),f(this,qi,{writable:!0,value:void 0}),f(this,ji,{writable:!0,value:[]}),f(this,zi,{writable:!0,value:[]}),f(this,Ui,{writable:!0,value:[]}),this.height=e,this.radius=n,this.bevelRadius=i,history.radiusSegments=r,this.bevelSegments=a,this.normalBendFactor=o,d(this,Li,this.height/2),d(this,Ii,this.radius-this.bevelRadius),d(this,Ni,2*Math.PI/this.radiusSegments),d(this,Fi,.5*Math.PI/(this.bevelSegments+1)),d(this,Bi,p(this,Fi)*this.normalBendFactor),d(this,qi,(.5*Math.PI-2*p(this,Bi))/(this.bevelSegments+1)),m(this,Wi,Yi).call(this,!0),m(this,Gi,Xi).call(this,!0),m(this,Wi,Yi).call(this,!1),m(this,Gi,Xi).call(this,!1),m(this,Ki,Zi).call(this),this.vertices=new Float32Array(p(this,ji)),this.normals=new Float32Array(p(this,Ui)),this.indices=new Uint16Array(p(this,zi))};function Yi(){var t,e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=n?p(this,Li):-p(this,Li),r=Ut.fromValues(0,Math.sign(i),0),a=Ut.fromValues(0,i,0),o=(t=p(this,ji)).push.apply(t,B(a))/3-1;(e=p(this,Ui)).push.apply(e,B(r));for(var s=0;s<this.radiusSegments;++s){var u,l,c=s*p(this,Ni),h=p(this,Ii)*Math.cos(c),v=p(this,Ii)*Math.sin(c);(u=p(this,ji)).push.apply(u,B(Ut.fromValues(h,a[1],v)));var f=.5*Math.PI-p(this,Bi),d=Math.sin(f),m=Math.cos(f)*Math.cos(c),_=Math.cos(f)*Math.sin(c),g=Ut.fromValues(m,n?d:-d,_),y=Ut.normalize(Ut.create(),g);(l=p(this,Ui)).push.apply(l,B(y)),n?p(this,zi).push(o,o+(s+1)%this.radiusSegments+1,o+s+1):p(this,zi).push(o,o+s+1,o+(s+1)%this.radiusSegments+1)}}function Xi(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=p(this,ji).length/3,n=(this.bevelSegments+2)*this.radiusSegments,i=t?p(this,Li)-this.bevelRadius:this.bevelRadius-p(this,Li),r=0,a=0;a<this.radiusSegments;++a)for(var o=a*p(this,Ni),s=p(this,Ii)*Math.cos(o),u=p(this,Ii)*Math.sin(o),l=Ut.fromValues(s,i,u),c=0;c<=this.bevelSegments+1;++c){var h,v,f=.5*Math.PI-c*p(this,Fi),d=this.bevelRadius*Math.sin(f),m=this.bevelRadius*Math.cos(f)*Math.cos(o),_=this.bevelRadius*Math.cos(f)*Math.sin(o),g=Ut.fromValues(m,t?d:-d,_),y=Ut.add(Ut.create(),l,g);(h=p(this,ji)).push.apply(h,B(y));var b=.5*Math.PI-p(this,Bi)-c*p(this,qi),w=this.bevelRadius*Math.sin(b),k=this.bevelRadius*Math.cos(b)*Math.cos(o),x=this.bevelRadius*Math.cos(b)*Math.sin(o),C=Ut.fromValues(k,t?w:-w,x),E=Ut.normalize(Ut.create(),C);if((v=p(this,Ui)).push.apply(v,B(E)),c<=this.bevelSegments){var M=(r+(this.bevelSegments+2))%n;t?(p(this,zi).push(e+r,e+M,e+M+1),p(this,zi).push(e+r,e+M+1,e+r+1)):(p(this,zi).push(e+r,e+M+1,e+M),p(this,zi).push(e+r,e+r+1,e+M+1))}r++}}function Zi(){for(var t=p(this,ji).length/3,e=0,n=0;n<this.radiusSegments;++n){var i,r,a,o,s=n*p(this,Ni),u=this.radius*Math.cos(s),l=this.radius*Math.sin(s),c=Ut.fromValues(u,p(this,Li)-this.bevelRadius,l),h=Ut.fromValues(u,this.bevelRadius-p(this,Li),l),v=p(this,Bi),f=Math.sin(v),d=Math.cos(v)*Math.cos(s),m=Math.cos(v)*Math.sin(s),_=Ut.fromValues(d,f,m),g=Ut.fromValues(d,-f,m),y=Ut.normalize(Ut.create(),_),b=Ut.normalize(Ut.create(),g);Ut.normalize(Ut.create(),Ut.fromValues(u,0,l));(i=p(this,ji)).push.apply(i,B(c)),(r=p(this,ji)).push.apply(r,B(h)),(a=p(this,Ui)).push.apply(a,B(y)),(o=p(this,Ui)).push.apply(o,B(b));var w=(e+2)%(2*this.radiusSegments);p(this,zi).push(t+e,t+w,t+w+1),p(this,zi).push(t+e,t+w+1,t+e+1),e+=2}}var Qi=new WeakMap,$i=new WeakMap,Ji=new WeakMap,tr=function(){"use strict";function t(e,n,i,r){c(this,t),f(this,Qi,{writable:!0,value:100}),f(this,$i,{writable:!0,value:0}),f(this,Ji,{writable:!0,value:[]}),this.a0=e,this.c0=n,this.c1=i,this.a1=r;var a=this.pointAt(0);p(this,Ji).push(0);for(var o=1;o<=p(this,Qi);++o){var s=o/p(this,Qi),u=this.pointAt(s);p(this,Ji)[o]=p(this,Ji)[o-1]+Ut.distance(a,u),a=u}d(this,$i,p(this,Ji)[p(this,Qi)])}return C(t,[{key:"pointAt",value:function(t){var e=t*t,n=e*t,i=3*e-n-3*t+1,r=3*n-6*e+3*t,a=-3*n+3*e,o=n,s=Ut.scale(Ut.create(),this.a0,i),u=Ut.scale(Ut.create(),this.c0,r),l=Ut.scale(Ut.create(),this.c1,a),c=Ut.scale(Ut.create(),this.a1,o),h=Ut.add(Ut.create(),s,u),p=Ut.add(Ut.create(),l,c);return Ut.add(Ut.create(),h,p)}},{key:"velocityAt",value:function(t){var e=t*t,n=-3*e+6*t-3,i=9*e-12*t+3,r=-9*e+6*t,a=3*e,o=Ut.scale(Ut.create(),this.a0,n),s=Ut.scale(Ut.create(),this.c0,i),u=Ut.scale(Ut.create(),this.c1,r),l=Ut.scale(Ut.create(),this.a1,a),c=Ut.add(Ut.create(),o,s),h=Ut.add(Ut.create(),u,l);return Ut.add(Ut.create(),c,h)}},{key:"map",value:function(t){for(var e=t*p(this,$i),n=p(this,Qi),i=0,r=0;i<n;)r=i+((n-i)/2|0),p(this,Ji)[r]<e?i=r+1:n=r;p(this,Ji)[r]>e&&r--;var a=p(this,Ji)[r];return a===e?r/p(this,Qi):(r+(e-a)/(p(this,Ji)[r+1]-a))/p(this,Qi)}}]),t}(),er=(ji=new WeakMap,zi=new WeakMap,Ui=new WeakMap,new WeakMap),nr=new WeakMap,ir=new WeakMap,rr=new WeakMap,ar=new WeakSet,or=function(){"use strict";function t(){c(this,t),_(this,ar),f(this,ji,{writable:!0,value:[]}),f(this,zi,{writable:!0,value:[]}),f(this,Ui,{writable:!0,value:[]}),f(this,er,{writable:!0,value:[]}),f(this,nr,{writable:!0,value:10}),f(this,ir,{writable:!0,value:7.5}),f(this,rr,{writable:!0,value:20}),A(this,"contourBezierPoints",{a0:[0,0,0],c0:[0,.4,0],a1:[0,1,-1],c1:[0,.4,.1]});for(var e=0;e<=12;++e)for(var n=e/12,i=0;i<=8;++i){var r,a,o=(4-i)/4,s=m(this,ar,sr).call(this,o),u=s.map(n),l=s.pointAt(u),h=Ut.normalize(Ut.create(),s.velocityAt(u)),v=Math.sqrt(2-o*o),d=-l[0],g=l[1],y=l[2]+1.5*(1-n*n*n)*(1-v);(r=p(this,ji)).push.apply(r,B(Ut.fromValues(d,g,y)));var b=Ut.normalize(Ut.create(),Ut.fromValues(-d,0,-y)),w=h[2]/h[1],k=Ut.rotateX(Ut.create(),b,Ut.fromValues(0,0,0),Math.atan(w));(a=p(this,Ui)).push.apply(a,B(k)),p(this,er).push(o,n)}for(var x=0;x<12;++x)for(var C=0;C<8;++C)p(this,zi).push(9*x+C,9*x+C+1,9*(x+1)+C+1),p(this,zi).push(9*(x+1)+C+1,9*(x+1)+C,9*x+C);this.vertices=new Float32Array(p(this,ji)),this.normals=new Float32Array(p(this,Ui)),this.uvs=new Float32Array(p(this,er)),this.indices=new Uint16Array(p(this,zi))}return C(t,[{key:"extent",get:function(){var t=B(this.contourBezierPoints.a1);return t[1]*=p(this,nr),t[2]*=p(this,rr),t}}]),t}();function sr(t){var e=.02*p(this,ir),n=B(this.contourBezierPoints.a0),i=B(this.contourBezierPoints.c0),r=B(this.contourBezierPoints.a1),a=B(this.contourBezierPoints.c1);return n[0]=e*t,i[0]=n[0],a[0]=p(this,ir)*t,i[1]=i[1]*p(this,nr),a[1]=a[1]*p(this,nr),r[1]=r[1]*p(this,nr),r[2]*=p(this,rr),a[2]*=p(this,rr),new tr(n,i,a,r)}var ur,lr=function(){"use strict";function t(n){c(this,t),this.gl=n,this.program=Mi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\n\nvoid main() {\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nout vec4 outColor;\n\nvoid main() {\n    outColor = vec4(1., 0., 0., 1.);\n}\n")],null,{a_position:0}),this.locations={a_position:n.getAttribLocation(this.program,"a_position"),u_worldMatrix:n.getUniformLocation(this.program,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.program,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.program,"u_projectionMatrix")}}return C(t,[{key:"render",value:function(t,e,n,i,r){var a=this.gl;a.useProgram(this.program),a.enable(a.CULL_FACE),a.enable(a.DEPTH_TEST),a.uniformMatrix4fv(this.locations.u_worldMatrix,!1,t),a.uniformMatrix4fv(this.locations.u_viewMatrix,!1,e),a.uniformMatrix4fv(this.locations.u_projectionMatrix,!1,n),a.bindVertexArray(i),a.drawArrays(a.LINE_STRIP,0,r)}}]),t}();ur="#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\nin mat4 a_instanceMatrix;\n\nout vec3 v_position;\nout vec3 v_viewPosition;\nout vec3 v_normal;\nout vec3 v_viewNormal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (u_worldInverseTransposeMatrix * a_instanceMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = u_worldMatrix * a_instanceMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n    v_position = a_position.xyz;\n    v_viewPosition = viewPosition.xyz;\n    v_viewNormal = (u_viewMatrix * vec4(v_normal, 0.)).xyz;\n\n    gl_PointSize = 2.;\n}\n";var cr;cr="#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform mat4 u_inversProjectionMatrix;\nuniform float u_frames;\nuniform sampler2D u_gradientTexture;\n\nin vec3 v_position;\nin vec3 v_normal;\nin vec3 v_viewNormal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\nin vec3 v_viewPosition;\n\nout vec4 outColor;\n\n#define PI 3.1415926535\n\nvoid main() {\n    vec3 pos = v_position;\n    vec3 N = normalize(v_normal);\n    vec3 VN = normalize(v_viewNormal);\n    vec3 V = normalize(v_surfaceToView);\n    vec3 L = normalize(vec3(0., .5, 4.));\n    float NdL = max(0., dot(N, L));\n\n    // the albedo term from the leaf gradient with some distortion\n    vec2 uv = vec2(v_uv.y, v_uv.x);\n    // apply line texture\n    uv.x += sin(v_uv.x * PI * 5.) * 0.1;\n    vec4 albedo = texture(u_gradientTexture, uv);\n    // darken the edges\n    albedo *= min(1., 1. - pow(uv.y, 2.) * 0.1 + uv.x * 0.1);\n\n    // the diffuse term\n    float diffuse = (NdL * NdL * NdL) * 0.1 + .95;\n\n    outColor = albedo * diffuse;\n}\n";var hr={rand_vect:function(){var t=2*Math.random()*Math.PI;return{x:Math.cos(t),y:Math.sin(t)}},dot_prod_grid:function(t,e,n,i){var r,a=t-n,o=e-i;return this.gradients[[n,i]]?r=this.gradients[[n,i]]:(r=this.rand_vect(),this.gradients[[n,i]]=r),a*r.x+o*r.y},smootherstep:function(t){return 6*Math.pow(t,5)-15*Math.pow(t,4)+10*Math.pow(t,3)},interp:function(t,e,n){return e+this.smootherstep(t)*(n-e)},seed:function(){this.gradients={},this.memory={}},get:function(t,e){if(this.memory.hasOwnProperty([t,e]))return this.memory[[t,e]];var n=Math.floor(t),i=Math.floor(e),r=this.dot_prod_grid(t,e,n,i),a=this.dot_prod_grid(t,e,n+1,i),o=this.dot_prod_grid(t,e,n,i+1),s=this.dot_prod_grid(t,e,n+1,i+1),u=this.interp(t-n,r,a),l=this.interp(t-n,o,s),c=this.interp(e-i,u,l);return this.memory[[t,e]]=c,c}};hr.seed();var pr=function(t){return--t*t*t+1},vr=new WeakMap,fr=new WeakMap,dr=new WeakMap,mr=new WeakSet,_r=new WeakSet,gr=new WeakSet,yr=new WeakSet,br=new WeakSet,wr=new WeakSet,kr=new WeakSet,xr=function(){"use strict";function t(n,i,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;c(this,t),_(this,mr),_(this,_r),_(this,gr),_(this,yr),_(this,br),_(this,wr),_(this,kr),f(this,vr,{writable:!0,value:18}),f(this,fr,{writable:!0,value:2}),f(this,dr,{writable:!0,value:p(this,vr)*p(this,fr)}),A(this,"leafInstances",void 0),A(this,"onLeafGrow",void 0),A(this,"onLeafWither",void 0),A(this,"onPlantGrow",void 0),this.context=n,this.vesselHeight=i,this.vesselRadius=r,this.vesselBevelRadius=a,this.animationDoneCallback=o,this.modelMatrix=j.translate(j.create(),j.create(),Ut.fromValues(0,-this.vesselHeight/2,0));var s=this.context;this.leafProgram=Mi(s,[e(ur),e(cr)],null,{a_position:0,a_normal:1,a_uv:2}),this.leafLocations={a_position:s.getAttribLocation(this.leafProgram,"a_position"),a_normal:s.getAttribLocation(this.leafProgram,"a_normal"),a_uv:s.getAttribLocation(this.leafProgram,"a_uv"),a_instanceMatrix:s.getAttribLocation(this.leafProgram,"a_instanceMatrix"),u_worldMatrix:s.getUniformLocation(this.leafProgram,"u_worldMatrix"),u_viewMatrix:s.getUniformLocation(this.leafProgram,"u_viewMatrix"),u_projectionMatrix:s.getUniformLocation(this.leafProgram,"u_projectionMatrix"),u_inversProjectionMatrix:s.getUniformLocation(this.leafProgram,"u_inversProjectionMatrix"),u_worldInverseTransposeMatrix:s.getUniformLocation(this.leafProgram,"u_worldInverseTransposeMatrix"),u_cameraPosition:s.getUniformLocation(this.leafProgram,"u_cameraPosition"),u_gradientTexture:s.getUniformLocation(this.leafProgram,"u_gradientTexture")},this.leafGeometry=new or,this.leafBuffers={position:Pi(s,this.leafGeometry.vertices,s.STATIC_DRAW),normal:Pi(s,this.leafGeometry.normals,s.STATIC_DRAW),uv:Pi(s,this.leafGeometry.uvs,s.STATIC_DRAW),numElem:this.leafGeometry.indices.length},this.leafVAO=Ti(s,[[this.leafBuffers.position,this.leafLocations.a_position,3],[this.leafBuffers.normal,this.leafLocations.a_normal,3],[this.leafBuffers.uv,this.leafLocations.a_uv,2]],this.leafGeometry.indices),this.leafGradientTexture=Vi(s,s.LINEAR,s.LINEAR,s.MIRRORED_REPEAT,s.MIRRORED_REPEAT);var u=new Uint8Array([221,255,185,134,224,69,114,214,80,134,224,69,134,224,69,211,245,144,225,255,174]);s.bindTexture(s.TEXTURE_2D,this.leafGradientTexture),s.texImage2D(s.TEXTURE_2D,0,s.RGB,7,1,0,s.RGB,s.UNSIGNED_BYTE,u),m(this,mr,Cr).call(this)}return C(t,[{key:"generate",value:function(t){m(this,_r,Er).call(this),m(this,gr,Mr).call(this,t),this.onPlantGrow&&this.onPlantGrow()}},{key:"update",value:function(t){m(this,yr,Tr).call(this,t)}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=j.multiply(j.create(),t.worldMatrix,this.modelMatrix);e&&this.geometryHelper.render(n,t.viewMatrix,t.projectionMatrix,this.stemVAO,this.stemBuffers.numElem),m(this,br,Pr).call(this,t,n)}}]),t}();function Cr(){var t=this.context;this.leafInstances={matricesArray:new Float32Array(16*p(this,dr)),matrices:[],bindMatrices:[],buffer:t.createBuffer(),animationParams:[]};for(var e=p(this,dr),n=0;n<e;++n){var i=new Float32Array(this.leafInstances.matricesArray.buffer,64*n,16);i.set(j.create()),this.leafInstances.matrices.push(i),this.leafInstances.bindMatrices.push(j.create())}t.bindVertexArray(this.leafVAO),t.bindBuffer(t.ARRAY_BUFFER,this.leafInstances.buffer),t.bufferData(t.ARRAY_BUFFER,this.leafInstances.matricesArray.byteLength,t.DYNAMIC_DRAW);for(var r=0;r<4;++r){var a=this.leafLocations.a_instanceMatrix+r;t.enableVertexAttribArray(a),t.vertexAttribPointer(a,4,t.FLOAT,!1,64,16*r),t.vertexAttribDivisor(a,1)}t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null)}function Er(){var t=this.vesselHeight/2,e=2*Math.random()*Math.PI,n=Math.random()*(this.vesselRadius-this.vesselBevelRadius),i=Ut.fromValues(n*Math.cos(e),0,n*Math.sin(e));e=2*Math.random()*Math.PI;var r=Ut.fromValues(n*Math.cos(e),this.vesselHeight,n*Math.sin(e)),a=.1*this.vesselBevelRadius;e=2*Math.random()*Math.PI;var o=Math.random()*(t-a)+a,s=Math.random()*this.vesselRadius,u=Ut.fromValues(s*Math.cos(e),o,s*Math.sin(e));e=2*Math.random()*Math.PI,o=Math.random()*(t-a)+t;var l=Math.random()*this.vesselRadius,c=Ut.fromValues(l*Math.cos(e),o,l*Math.sin(e)),h=this.context;this.stemVertices=[],this.stemCurve=new tr(i,u,c,r);for(var v=0;v<=p(this,vr);++v){var f,d=v/p(this,vr);(f=this.stemVertices).push.apply(f,B(this.stemCurve.pointAt(this.stemCurve.map(d))))}this.stemVerticesData=new Float32Array(this.stemVertices),this.stemVAO?(h.bindBuffer(h.ARRAY_BUFFER,this.stemBuffers.position),h.bufferSubData(h.ARRAY_BUFFER,0,this.stemVerticesData),h.bindBuffer(h.ARRAY_BUFFER,null)):(this.stemBuffers={position:Pi(h,this.stemVerticesData,h.DYNAMIC_DRAW),numElem:this.stemVertices.length/3},this.geometryHelper=new lr(h),this.stemVAO=Ti(h,[[this.stemBuffers.position,this.geometryHelper.locations.a_position,3]]))}function Mr(t){this.context;this.averageLeafDuration=300,this.leafStaggerDelay=2.5,this.totalDuration=0;for(var e=j.rotateX(j.create(),j.create(),-Math.PI/2),n=p(this,dr),i=this.vesselHeight/n*.015,r=Ut.fromValues(0,0,1),a=this.leafGeometry.extent,o=Ut.length(a),s=0;s<n;++s){var u=s/(1.2*n)+.03,l=j.create(),c=j.create(),h=Math.random()*i-i/2,v=this.stemCurve.map(u+h),f=this.stemCurve.pointAt(v);j.translate(c,l,f);var d=Ut.normalize(Ut.create(),this.stemCurve.velocityAt(v));Ut.rotateY(r,r,Ut.create(),Math.random()*Math.PI*2-Math.PI);var _=j.targetTo(j.create(),Ut.create(),d,r);j.multiply(_,_,e),j.multiply(c,c,_);for(var g=j.multiply(j.create(),this.modelMatrix,c),y=Ut.transformMat4(Ut.create(),a,g),b=Ut.transformMat4(Ut.create(),Ut.create(),g),w=Ut.normalize(Ut.create(),Ut.subtract(Ut.create(),y,b)),k=Ut.clone(b),x=0;x<4;++x){var C=-m(this,wr,Ar).call(this,k);Ut.add(k,k,Ut.scale(Ut.create(),w,C))}var E=Ut.subtract(Ut.create(),k,b),M=Math.min(1.2,Ut.length(E)/o);j.scale(c,c,[M,M,M]),this.leafInstances.bindMatrices[s]=c;var T=Math.max(.75*this.averageLeafDuration,this.averageLeafDuration*M);this.leafInstances.animationParams[s]={duration:T},this.totalDuration=Math.max(this.totalDuration,T+this.leafStaggerDelay*s)}this.startFrame=t,this.leafAnimationStartNdx=-1}function Tr(t){for(var e=this.context,n=p(this,dr),i=Math.min(this.totalDuration,t-this.startFrame),r=0;r<n;++r){var a=this.leafInstances.animationParams[r].duration,o=r*this.leafStaggerDelay,s=Math.min(a,Math.max(0,i-o))/a;this.onLeafGrow&&s>0&&r>this.leafAnimationStartNdx&&(this.leafAnimationStartNdx=r,this.onLeafGrow(r));var u=s;s<=.2?u/=.2:u=s>.8?1-(s-.8)/.2:1;var l=.8*(1-(u=pr(u))*u)+.2,c=10*u*u*.5+1,h=.5*hr.get(s*c,s*c)*l,v=this.leafInstances.bindMatrices[r],f=j.fromScaling(j.create(),Ut.fromValues(u,u,u));j.rotateX(f,f,h),j.multiply(f,v,f),j.copy(this.leafInstances.matrices[r],f)}e.bindBuffer(e.ARRAY_BUFFER,this.leafInstances.buffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.leafInstances.matricesArray),e.bindBuffer(e.ARRAY_BUFFER,null),i>=this.totalDuration&&this.animationDoneCallback&&this.animationDoneCallback()}function Pr(t,e){var n=this.context;n.useProgram(this.leafProgram),n.bindVertexArray(this.leafVAO),n.uniformMatrix4fv(this.leafLocations.u_viewMatrix,!1,t.viewMatrix),n.uniformMatrix4fv(this.leafLocations.u_projectionMatrix,!1,t.projectionMatrix),n.uniformMatrix4fv(this.leafLocations.u_inversProjectionMatrix,!1,t.inversProjectionMatrix),n.uniform3f(this.leafLocations.u_cameraPosition,t.cameraMatrix[12],t.cameraMatrix[14],t.cameraMatrix[14]),n.uniformMatrix4fv(this.leafLocations.u_worldMatrix,!1,e),n.uniformMatrix4fv(this.leafLocations.u_worldInverseTransposeMatrix,!1,t.worldInverseTransposeMatrix),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.leafGradientTexture),n.uniform1i(this.leafProgram.u_gradientTexture,0),n.drawElementsInstanced(n.TRIANGLES,this.leafBuffers.numElem,n.UNSIGNED_SHORT,0,p(this,dr)),n.cullFace(n.FRONT);var i=j.scale(j.create(),t.worldInverseTransposeMatrix,Ut.fromValues(-1,-1,-1));n.uniformMatrix4fv(this.leafLocations.u_worldInverseTransposeMatrix,!1,i),n.drawElementsInstanced(n.TRIANGLES,this.leafBuffers.numElem,n.UNSIGNED_SHORT,0,p(this,dr)),n.cullFace(n.BACK)}function Ar(t){var e=.93;return m(this,kr,Sr).call(this,t,this.vesselRadius*e,this.vesselBevelRadius*e,this.vesselHeight/2*e)}function Sr(t,e,n,i){var r=Rn.fromValues(Rn.length(Rn.fromValues(t[0],t[2]))-e+n,Math.abs(t[1])-i+n);return Math.min(Math.max(r[0],r[1]),0)+Rn.length(Rn.fromValues(Math.max(r[0],0),Math.max(r[1],0)))-n}var Vr="14.7.77",Or={};!function(t,e,n,i){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=r(e),o=r(n),s=r(i),u=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},l=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},c=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var i=n.startTime,r=n.target,a=n.timeConstant;return r+(e-r)*Math.exp((i-t)/a)},v=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},d=function(t){return v(t)||f(t)},m=function(t){return"setValue"===t.type},_=function(t){return"setValueCurve"===t.type},g=function t(e,n,i,r){var a=e[n];return void 0===a?r:d(a)||m(a)?a.value:_(a)?a.values[a.values.length-1]:p(i,t(e,n-1,a.startTime,r),a)},y=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:d(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:_(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,g(t,e-1,n.startTime,r)]},b=function(t){return"cancelAndHold"===t.type},w=function(t){return"cancelScheduledValues"===t.type},k=function(t){return b(t)||w(t)?t.cancelTime:v(t)||f(t)?t.endTime:t.startTime},x=function(t,e,n,i){var r=i.endTime,a=i.value;return n===a?a:0<n&&0<a||n<0&&a<0?n*Math.pow(a/n,(t-e)/(r-e)):0},C=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},E=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},M=function(t,e){var n=e.duration,i=e.startTime,r=e.values,a=(t-i)/n*(r.length-1);return E(r,a)},T=function(t){return"setTarget"===t.type},P=function(t){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return s.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=k(t);if(b(t)||w(t)){var n=this._automationEvents.findIndex((function(n){return w(t)&&_(n)?n.startTime+n.duration>=e:k(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&d(i)){if(T(r))throw new Error("The internal list is malformed.");var a=_(r)?r.startTime+r.duration:k(r),o=_(r)?r.values[r.values.length-1]:r.value,s=v(i)?x(e,a,o,i):C(e,a,o,i),p=v(i)?u(s,e,this._currenTime):l(s,e,this._currenTime);this._automationEvents.push(p)}void 0!==r&&T(r)&&this._automationEvents.push(c(this.getValue(e),e)),void 0!==r&&_(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),r.startTime,e-r.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return k(t)>e})),g=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==g&&_(g)&&k(g)+g.duration>e)return!1;var y=v(t)?u(t.value,t.endTime,this._currenTime):f(t)?l(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(_(t)&&e+t.duration>k(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return k(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];T(i)&&n.unshift(c(g(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return k(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&T(r)&&(void 0===n||!d(n)||n.insertTime>t))return p(t,g(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&m(r)&&(void 0===n||!d(n)))return r.value;if(void 0!==r&&_(r)&&(void 0===n||!d(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?M(t,r):r.values[r.values.length-1];if(void 0!==r&&d(r)&&(void 0===n||!d(n)))return r.value;if(void 0!==n&&v(n)){var o=y(this._automationEvents,i,r,n,this._defaultValue),s=a.default(o,2),u=s[0],l=s[1];return x(t,u,l,n)}if(void 0!==n&&f(n)){var c=y(this._automationEvents,i,r,n,this._defaultValue),h=a.default(c,2),b=h[0],w=h[1];return C(t,b,w,n)}return this._defaultValue}}]),e}(Symbol.iterator),A=function(t){return{cancelTime:t,type:"cancelAndHold"}},S=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},V=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},O=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},D=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=P,t.createCancelAndHoldAutomationEvent=A,t.createCancelScheduledValuesAutomationEvent=S,t.createExponentialRampToValueAutomationEvent=V,t.createLinearRampToValueAutomationEvent=O,t.createSetTargetAutomationEvent=D,t.createSetValueAutomationEvent=c,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(Or,a("c2tl2"),a("clMMr"),a("drNVG"));var Dr=new WeakSet,Rr=new WeakMap,Lr=new WeakMap,Ir=new WeakMap,Nr=new WeakMap,Fr=new WeakMap,Br=new WeakMap,qr=new WeakMap,jr=new WeakMap,zr=new WeakMap,Ur={construct:function(){return Ur}},Wr=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Gr=function(t,e){for(var n=[],i=t.replace(/^[\s]+/,""),r=i.match(Wr);null!==r;){var a=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(a,new URL(a,e).toString());n.push(o),r=(i=i.slice(r[0].length).replace(/^[\s]+/,"")).match(Wr)}return[n.join(";"),i]},Kr=function(t){if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Hr=function(t){if(!function(t){try{new new Proxy(t,Ur)}catch(t){return!1}return!0}(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},Yr=function(t,e){var n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Xr=function(t,e){var n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var i=F(n,1)[0];return t.delete(i),i},Zr=function(t,e,n,i){var r=Yr(t,e),a=Xr(r,(function(t){return t[0]===n&&t[1]===i}));return 0===r.size&&t.delete(e),a},Qr=function(t){return Yr(Br,t)},$r=function(t){if(Dr.has(t))throw new Error("The AudioNode is already stored.");Dr.add(t),Qr(t).forEach((function(t){return t(!0)}))},Jr=function(t){return"port"in t},ta=function(t){if(!Dr.has(t))throw new Error("The AudioNode is not stored.");Dr.delete(t),Qr(t).forEach((function(t){return t(!1)}))},ea=function(t,e){!Jr(t)&&e.every((function(t){return 0===t.size}))&&ta(t)},na={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},ia={},ra=function(t){var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),o=new P(i||[]);return a._invoke=function(t,e,n){var i=h;return function(r,a){if(i===v)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw a;return S()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=v;var u=c(t,e,n);if("normal"===u.type){if(i=n.done?f:p,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=f,n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",v="executing",f="completed",d={};function m(){}function _(){}function g(){}var y={};u(y,a,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(A([])));w&&w!==n&&i.call(w,a)&&(y=w);var k=g.prototype=m.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,a,o,s){var u=c(t[r],t,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return n("throw",t,o,s)}))}s(u.arg)}var r;this._invoke=function(t,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}}function E(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=c(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,d;var a=r.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function A(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:S}}function S(){return{value:e,done:!0}}return _.prototype=g,u(k,"constructor",g),u(g,"constructor",_),_.displayName=u(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,o,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new C(l(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(k),u(k,s,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=A,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:A(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),d}},t}(ia);try{regeneratorRuntime=ra}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=ra:Function("r","regeneratorRuntime = r")(ra)}var aa=function(t,e){return t.context===e},oa=function(t){try{t.copyToChannel(new Float32Array(1),0,-1)}catch(t){return!1}return!0},sa=function(){return new DOMException("","IndexSizeError")},ua=function(t){var e;t.getChannelData=(e=t.getChannelData,function(n){try{return e.call(t,n)}catch(t){if(12===t.code)throw sa();throw t}})},la={numberOfChannels:1},ca=-34028234663852886e22,ha=34028234663852886e22,pa=function(t){return Dr.has(t)},va={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},fa=function(t){return Yr(Rr,t)},da=function(t){return Yr(Ir,t)},ma=function(t,e){fa(t).activeInputs.forEach((function(n){return n.forEach((function(n){var i=F(n,1)[0];e.includes(t)||ma(i,B(e).concat([t]))}))}));var n=function(t){return"playbackRate"in t}(t)?[t.playbackRate]:Jr(t)?Array.from(t.parameters.values()):function(t){return"frequency"in t&&"gain"in t}(t)?[t.Q,t.detune,t.frequency,t.gain]:function(t){return"offset"in t}(t)?[t.offset]:function(t){return!("frequency"in t)&&"gain"in t}(t)?[t.gain]:function(t){return"detune"in t&&"frequency"in t}(t)?[t.detune,t.frequency]:function(t){return"pan"in t}(t)?[t.pan]:[],i=!0,r=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var u=o.value,l=da(u);void 0!==l&&l.activeInputs.forEach((function(t){var n=F(t,1)[0];return ma(n,e)}))}}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}pa(t)&&ta(t)},_a=function(t){ma(t.destination,[])},ga=function(t){return void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t)},ya=function(t){return"context"in t},ba=function(t){return ya(t[0])},wa=function(t,e,n,i){var r=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){if(n(s.value)){if(i)return!1;throw Error("The set contains at least one similar element.")}}}catch(t){a=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return t.add(e),!0},ka=function(t,e,n,i){var r=F(n,2),a=r[0],o=r[1];wa(t,[e,a,o],(function(t){return t[0]===e&&t[1]===a}),i)},xa=function(t,e,n){var i=F(e,3),r=i[0],a=i[1],o=i[2],s=t.get(r);void 0===s?t.set(r,new Set([[a,o]])):wa(s,[a,o],(function(t){return t[0]===a}),n)},Ca=function(t){return"inputs"in t},Ea=function(t,e,n,i){if(Ca(e)){var r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},Ma=function(t,e,n){var i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var u=o.value;if(u[0]===e&&u[1]===n)return t.delete(u),u}}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return null},Ta=function(t,e){if(!Qr(t).delete(e))throw new Error("Missing the expected event listener.")},Pa=function(t,e,n){var i=Yr(t,e),r=Xr(i,(function(t){return t[0]===n}));return 0===i.size&&t.delete(e),r},Aa=function(t,e,n,i){Ca(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Sa=function(t){return Yr(Lr,t)},Va=function(t){return Yr(Nr,t)},Oa=function(t){return qr.has(t)},Da=function(t){return!Dr.has(t)},Ra=function(t,e){return new Promise((function(n){if(null!==e)n(!0);else{var i=t.createScriptProcessor(256,1,1),r=t.createGain(),a=t.createBuffer(1,2,44100),o=a.getChannelData(0);o[0]=1,o[1]=1;var s=t.createBufferSource();s.buffer=a,s.loop=!0,s.connect(i).connect(t.destination),s.connect(r),s.disconnect(r),i.onaudioprocess=function(e){var r=e.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(function(t){return 1===t}))?n(!0):n(!1),s.stop(),i.onaudioprocess=null,s.disconnect(i),i.disconnect(t.destination)},s.start()}}))},La=function(t,e){var n=new Map,i=!0,r=!1,a=void 0,o=!0,s=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=l.value;try{for(var p,v=h[Symbol.iterator]();!(i=(p=v.next()).done);i=!0){var f=p.value,d=n.get(f);n.set(f,void 0===d?1:d+1)}}catch(t){r=!0,a=t}finally{try{i||null==v.return||v.return()}finally{if(r)throw a}}}}catch(t){s=!0,u=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw u}}n.forEach((function(t,n){return e(n,t)}))},Ia=function(t){return"context"in t},Na=function(t,e,n,i){var r=da(e),a=r.activeInputs,o=r.passiveInputs,s=fa(t).outputs,u=Qr(t),l=function(r){var s=Sa(t),u=Va(e);if(r){var l=Pa(o,t,n);ka(a,t,l,!1),i||Oa(t)||s.connect(u,n)}else{var c=function(t,e,n){return Xr(t,(function(t){return t[0]===e&&t[1]===n}))}(a,t,n);xa(o,c,!1),i||Oa(t)||s.disconnect(u,n)}};return!!wa(s,[e,n],(function(t){return t[0]===e&&t[1]===n}),!0)&&(u.add(l),pa(t)?ka(a,t,[n,l],!0):xa(o,[t,n,l],!0),!0)},Fa=function(t,e,n,i,r){var a=F(function(t,e,n,i){var r=fa(e),a=r.activeInputs,o=r.passiveInputs,s=Ma(a[i],t,n);return null===s?[Zr(o,t,n,i)[2],!1]:[s[2],!0]}(t,n,i,r),2),o=a[0],s=a[1];if(null!==o&&(Ta(t,o),!s||e||Oa(t)||Aa(Sa(t),Sa(n),i,r)),pa(n)){var u=fa(n).activeInputs;ea(n,u)}},Ba=function(t,e,n,i){var r=F(function(t,e,n){var i=da(e),r=i.activeInputs,a=i.passiveInputs,o=Ma(r,t,n);return null===o?[Pa(a,t,n)[1],!1]:[o[2],!0]}(t,n,i),2),a=r[0],o=r[1];null!==a&&(Ta(t,a),!o||e||Oa(t)||Sa(t).disconnect(Va(n),i))},qa=function(){"use strict";function t(e){c(this,t),this._map=new Map(e)}return C(t,[{key:"size",get:function(){return this._map.size}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;return this._map.forEach((function(i,r){return t.call(e,i,r,n)}))}},{key:"get",value:function(t){return this._map.get(t)}},{key:"has",value:function(t){return this._map.has(t)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}}]),t}(),ja={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function za(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{var a=t.getChannelData(i);if(0===e[n].byteLength)e[n]=a.slice(r,r+128);else{var o=new Float32Array(a.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}var Ua,Wa=function(t,e,n,i,r){"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},Ga=function(t,e){for(var n=[],i=0;i<t;i+=1){for(var r=[],a="number"==typeof e?e:e[i],o=0;o<a;o+=1)r.push(new Float32Array(128));n.push(r)}return n},Ka=function(t,e){var n=Yr(zr,t),i=Sa(e);return Yr(n,i)},Ha=(Ua=l(e(ia).mark((function t(n,i,r,a,o,s,u){var l,c,h,p,v,f,d,m,_,g,y,b,w,k,x,C,E,M,T;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=null===i?128*Math.ceil(n.context.length/128):i.length,c=a.channelCount*a.numberOfInputs,h=o.reduce((function(t,e){return t+e}),0),p=0===h?null:r.createBuffer(h,l,r.sampleRate),void 0!==s){t.next=6;break}throw new Error("Missing the processor constructor.");case 6:return v=fa(n),t.next=9,Ka(r,n);case 9:f=t.sent,d=Ga(a.numberOfInputs,a.channelCount),m=Ga(a.numberOfOutputs,o),_=Array.from(n.parameters.keys()).reduce((function(t,e){return D({},t,A({},e,new Float32Array(128)))}),{}),g=0;case 14:if(!(g<l)){t.next=33;break}if(a.numberOfInputs>0&&null!==i)for(y=0;y<a.numberOfInputs;y+=1)for(b=0;b<a.channelCount;b+=1)za(i,d[y],b,b,g);for(void 0!==s.parameterDescriptors&&null!==i&&s.parameterDescriptors.forEach((function(t,e){var n=t.name;za(i,_,n,c+e,g)})),w=0;w<a.numberOfInputs;w+=1)for(k=0;k<o[w];k+=1)0===m[w][k].byteLength&&(m[w][k]=new Float32Array(128));if(t.prev=18,x=d.map((function(t,e){return 0===v.activeInputs[e].size?[]:t})),C=u(g/r.sampleRate,r.sampleRate,(function(){return f.process(x,m,_)})),null!==p)for(E=0,M=0;E<a.numberOfOutputs;E+=1){for(T=0;T<o[E];T+=1)Wa(p,m[E],T,M+T,g);M+=o[E]}if(C){t.next=24;break}return t.abrupt("break",33);case 24:t.next=30;break;case 26:return t.prev=26,t.t0=t.catch(18),n.dispatchEvent(new ErrorEvent("processorerror",{colno:t.t0.colno,filename:t.t0.filename,lineno:t.t0.lineno,message:t.t0.message})),t.abrupt("break",33);case 30:g+=128,t.next=14;break;case 33:return t.abrupt("return",p);case 34:case"end":return t.stop()}}),t,null,[[18,26]])}))),function(t,e,n,i,r,a,o){return Ua.apply(this,arguments)}),Ya={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Xa={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Za={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Qa={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},$a={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ja=function(t){var e=new MessageChannel,n=e.port1,i=e.port2;return new Promise((function(e){var r=function(){i.onmessage=null,n.close(),i.close(),e()};i.onmessage=function(){return r()};try{n.postMessage(t,[t])}finally{r()}}))},to={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},eo=function(t,e,n){var i=e[n];if(void 0===i)throw t();return i},no={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},io={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},ro=function(){return new DOMException("","InvalidStateError")},ao=function(){return new DOMException("","InvalidAccessError")},oo={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},so=function(t,e,n,i,r,a,o,s,u,l,c){for(var h=l.length,p=s,v=0;v<h;v+=1){for(var f=n[0]*l[v],d=1;d<r;d+=1){var m=p-d&u-1;f+=n[d]*a[m],f-=t[d]*o[m]}for(var _=r;_<i;_+=1)f+=n[_]*a[p-_&u-1];for(var g=r;g<e;g+=1)f-=t[g]*o[p-g&u-1];a[p]=l[v],o[p]=f,p=p+1&u-1,c[v]=f}return p},uo=function(t,e,n,i){var r=n instanceof Float64Array?n:new Float64Array(n),a=i instanceof Float64Array?i:new Float64Array(i),o=r.length,s=a.length,u=Math.min(o,s);if(1!==r[0]){for(var l=0;l<o;l+=1)a[l]/=r[0];for(var c=1;c<s;c+=1)r[c]/=r[0]}for(var h=new Float32Array(32),p=new Float32Array(32),v=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels,d=0;d<f;d+=1){var m=t.getChannelData(d),_=v.getChannelData(d);h.fill(0),p.fill(0),so(r,o,a,s,u,h,p,0,32,m,_)}return v},lo=(function(){var t=l(e(ia).mark((function t(n,i,r,a,o,s,u,l,c,h,p,v,f,d,m,_){var g;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n(i,i)&&n(r,r)&&n(o,o)&&n(s,s)&&n(l,l)&&n(c,c)&&n(h,h)&&n(p,p)&&n(v,v)&&n(f,f)&&n(d,d))){t.next=5;break}return t.next=3,Promise.all([n(a,a),n(u,u),n(m,m),n(_,_)]);case 3:return g=t.sent,t.abrupt("return",g.every((function(t){return t})));case 5:return t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t)})))}(),{channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"}),co=function(t){var e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=t.decodeAudioData(e.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(t){}return!1},ho={numberOfChannels:1},po=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},vo=function(t,e){po(t,e,"channelCount"),po(t,e,"channelCountMode"),po(t,e,"channelInterpretation")},fo=function(t){return"function"==typeof t.getFloatTimeDomainData},mo=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},_o=function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})},go=function(t){var e;t.stop=(e=t.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},yo=function(t,e){return null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e)))))},bo=function(t){return new Promise((function(e,n){var i=new MessageChannel,r=i.port1,a=i.port2;r.onmessage=function(t){var n=t.data;r.close(),a.close(),e(n)},r.onmessageerror=function(t){var e=t.data;r.close(),a.close(),n(e)},a.postMessage(t)}))},wo=function(){var t=l(e(ia).mark((function t(n,i){var r;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bo(i);case 2:return r=t.sent,t.abrupt("return",new n(r));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ko=function(t,e){var n=t.createBiquadFilter();return vo(n,e),mo(n,e,"Q"),mo(n,e,"detune"),mo(n,e,"frequency"),mo(n,e,"gain"),po(n,e,"type"),n},xo=function(t,e){var n,i,r=t.createChannelSplitter(e.numberOfOutputs);return vo(r,e),i=(n=r).numberOfOutputs,Object.defineProperty(n,"channelCount",{get:function(){return i},set:function(t){if(t!==i)throw ro()}}),Object.defineProperty(n,"channelCountMode",{get:function(){return"explicit"},set:function(t){if("explicit"!==t)throw ro()}}),Object.defineProperty(n,"channelInterpretation",{get:function(){return"discrete"},set:function(t){if("discrete"!==t)throw ro()}}),r},Co=function(t,e){return t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t},Eo=function(t,e){var n=t.createDelay(e.maxDelayTime);return vo(n,e),mo(n,e,"delayTime"),n},Mo=function(t,e){var n=t.createGain();return vo(n,e),mo(n,e,"gain"),n};function To(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Po(t,e){for(var n,i,r=[0,0],a=t.length-1;a>=0;a-=1)i=e,(r=[(n=r)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]])[0]+=t[a];return r}var Ao,So,Vo,Oo,Do,Ro,Lo,Io,No,Fo,Bo,qo,jo,zo,Uo,Wo,Go,Ko,Ho,Yo,Xo,Zo,Qo,$o,Jo,ts,es,ns,is,rs,as,os,ss,us,ls,cs,hs,ps,vs,fs,ds,ms,_s,gs,ys,bs,ws,ks,xs,Cs,Es,Ms,Ts,Ps,As,Ss,Vs,Os,Ds,Rs,Ls,Is,Ns,Fs,Bs,qs,js,zs,Us,Ws=function(t,e,n,i){return t.createScriptProcessor(e,n,i)},Gs=function(){return new DOMException("","NotSupportedError")},Ks={numberOfChannels:1},Hs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Ys={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Xs={disableNormalization:!1},Zs={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Qs=function(){return new DOMException("","UnknownError")},$s={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Js=function(t,e,n){return void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0])},tu=function(t){if(null===t)return!1;var e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},eu=function(t,e,n,i){for(var r=t;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);var a=Object.getOwnPropertyDescriptor(r,e),o=a.get,s=a.set;Object.defineProperty(t,e,{get:n(o),set:i(s)})},nu=function(t,e,n){try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;nu(t,e,n+1e-7)}},iu=function(t){var e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ru=function(t){var e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch(t){return!1}},au=function(t){var e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ou=function(t,e){var n=e.createGain();t.connect(n);var i,r,a,o=(i=t.disconnect,function(){i.call(t,n),t.removeEventListener("ended",o)});t.addEventListener("ended",o),Co(t,n),t.stop=(r=t.stop,a=!1,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(a)try{r.call(t,e)}catch(t){n.gain.setValueAtTime(0,e)}else r.call(t,e),a=!0})},su=function(t,e){return function(n){var i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)}},uu=(Ao=wa,function(t,e,n,i){var r=F(n,3),a=r[0],o=r[1],s=r[2];Ao(t[o],[e,a,s],(function(t){return t[0]===e&&t[1]===a}),i)}),lu=function(t){return function(e,n,i,r){var a=F(i,3),o=a[0],s=a[1],u=a[2],l=e.get(o);void 0===l?e.set(o,new Set([[s,n,u]])):t(l,[s,n,u],(function(t){return t[0]===s&&t[1]===n}),r)}}(wa),cu=(So=Xr,function(t,e,n,i){return So(t[i],(function(t){return t[0]===e&&t[1]===n}))}),hu=new WeakMap,pu=(Vo=hu,function(t){var e;return null!==(e=Vo.get(t))&&void 0!==e?e:0}),vu=(Oo=new Map,Do=new WeakMap,function(t,e){var n=Do.get(t);if(void 0!==n)return n;var i=Oo.get(t);if(void 0!==i)return i;try{var r=e();return r instanceof Promise?(Oo.set(t,r),r.catch((function(){return!1})).then((function(e){return Oo.delete(t),Do.set(t,e),e}))):(Do.set(t,r),r)}catch(e){return Do.set(t,!1),!1}}),fu="undefined"==typeof window?null:window,du=(Ro=vu,Lo=sa,function(t,e){var n=t.createAnalyser();if(vo(n,e),!(e.maxDecibels>e.minDecibels))throw Lo();return po(n,e,"fftSize"),po(n,e,"maxDecibels"),po(n,e,"minDecibels"),po(n,e,"smoothingTimeConstant"),Ro(fo,(function(){return fo(n)}))||function(t){t.getFloatTimeDomainData=function(e){var n=new Uint8Array(e.length);t.getByteTimeDomainData(n);for(var i=Math.max(n.length,t.fftSize),r=0;r<i;r+=1)e[r]=.0078125*(n[r]-128);return e}}(n),n}),mu=(Io=fa,function(t){var e=Io(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer}),_u=function(t,n,i){return r=l(e(ia).mark((function r(a,o,s){var u;return e(ia).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=t(a),r.next=3,Promise.all(u.activeInputs.map((function(t,r){return Array.from(t).map(function(){var t=l(e(ia).mark((function t(u){var l,c,h,p,v,f;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=F(u,2),c=l[0],h=l[1],p=n(c),t.next=4,p.render(c,o);case 4:v=t.sent,f=a.context.destination,i(c)||a===f&&i(a)||v.connect(s,h,r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).reduce((function(t,e){return B(t).concat(B(e))}),[]));case 3:case"end":return r.stop()}}),r)}))),function(t,e,n){return r.apply(this,arguments)};var r}(fa,mu,Oa),gu=(No=du,Fo=Sa,Bo=_u,function(){var t,n=new WeakMap,i=(t=l(e(ia).mark((function t(i,r){var a,o;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Fo(i),aa(a,r)||(o={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant},a=No(r,o)),n.set(r,a),t.next=6,Bo(i,r,a);case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)});return{render:function(t,e){var r=n.get(e);return void 0!==r?Promise.resolve(r):i(t,e)}}}),yu=(qo=Fr,function(t){var e=qo.get(t);if(void 0===e)throw ro();return e}),bu=function(t){return null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null}(fu),wu=(jo=bu,function(t){return null!==jo&&t instanceof jo}),ku=new WeakMap,xu=(zo=su,function(){"use strict";function t(e){c(this,t),this._nativeEventTarget=e,this._listeners=new WeakMap}return C(t,[{key:"addEventListener",value:function(t,e,n){if(null!==e){var i=this._listeners.get(e);void 0===i&&(i=zo(this,e),"function"==typeof e&&this._listeners.set(e,i)),this._nativeEventTarget.addEventListener(t,i,n)}}},{key:"dispatchEvent",value:function(t){return this._nativeEventTarget.dispatchEvent(t)}},{key:"removeEventListener",value:function(t,e,n){var i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}}]),t}()),Cu=function(t){return null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null}(fu),Eu=(Uo=Cu,function(t){return null!==Uo&&t instanceof Uo}),Mu=function(t){return function(e){return null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode}}(fu),Tu=function(t){return function(e){return null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam}}(fu),Pu=function(t){return null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null}(fu),Au=function(t,e,n,i,r,a,o,u,l,h,p,v,f,d,m,_){return function(h){"use strict";O(y,h);var g=P(y);function y(e,i,r,a){var o;c(this,y),(o=g.call(this,r))._context=e,o._nativeAudioNode=r;var u=p(e);return v(u)&&!0!==n(Ra,(function(){return Ra(u,_)}))&&function(t){var e,n,i=new Map;t.connect=(e=t.connect.bind(t),function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Ia(t)?e(t,n,r):e(t,n),o=i.get(t);return void 0===o?i.set(t,[{input:r,output:n}]):o.every((function(t){return t.input!==r||t.output!==n}))&&o.push({input:r,output:n}),a}),t.disconnect=(n=t.disconnect,function(e,r,a){n.apply(t);var o=!0,s=!1,u=void 0;if(void 0===e)i.clear();else if("number"==typeof e)try{for(var l,c=i[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=F(l.value,2),p=h[0],v=h[1].filter((function(t){return t.output!==e}));0===v.length?i.delete(p):i.set(p,v)}}catch(t){s=!0,u=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw u}}else if(i.has(e))if(void 0===r)i.delete(e);else{var f=i.get(e);if(void 0!==f){var d=f.filter((function(t){return t.output!==r&&(t.input!==a||void 0===a)}));0===d.length?i.delete(e):i.set(e,d)}}var m=!0,_=!1,g=void 0;try{for(var y,b=function(e,n){var i=F(n.value,2),r=i[0];i[1].forEach((function(e){Ia(r)?t.connect(r,e.output,e.input):t.connect(r,e.output)}))},w=i[Symbol.iterator]();!(m=(y=w.next()).done);m=!0)b(0,y)}catch(t){_=!0,g=t}finally{try{m||null==w.return||w.return()}finally{if(_)throw g}}})}(r),Lr.set(s(o),r),Br.set(s(o),new Set),"closed"!==e.state&&i&&$r(s(o)),t(s(o),a,r),o}return C(y,[{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(t){this._nativeAudioNode.channelCount=t}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(t){this._nativeAudioNode.channelCountMode=t}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(t){this._nativeAudioNode.channelInterpretation=t}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}},{key:"connect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();var u=p(this._context),c=m(u);if(f(t)||d(t))throw a();if(ya(t)){var h=Sa(t);try{var v,_=Ea(this._nativeAudioNode,h,n,s),g=Da(this);(c||g)&&(v=this._nativeAudioNode).disconnect.apply(v,B(_)),"closed"!==this.context.state&&!g&&Da(t)&&$r(t)}catch(t){if(12===t.code)throw a();throw t}var y=e(this,t,n,s,c);if(y){var b=l([this],t);La(b,i(c))}return t}var w=Va(t);if("playbackRate"===w.name&&1024===w.maxValue)throw o();try{this._nativeAudioNode.connect(w,n),(c||Da(this))&&this._nativeAudioNode.disconnect(w,n)}catch(t){if(12===t.code)throw a();throw t}var k=Na(this,t,n,c);if(k){var x=l([this],t);La(x,i(c))}}},{key:"disconnect",value:function(t,e,n){var i,o=p(this._context),s=m(o);if(void 0===t)i=function(t,e){var n=fa(t),i=[],r=!0,a=!1,o=void 0;try{for(var s,u=n.outputs[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;ba(l)?Fa.apply(void 0,[t,e].concat(B(l))):Ba.apply(void 0,[t,e].concat(B(l))),i.push(l[0])}}catch(t){a=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n.outputs.clear(),i}(this,s);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=function(t,e,n){var i=fa(t),r=[],a=!0,o=!1,s=void 0;try{for(var u,l=i.outputs[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;c[1]===n&&(ba(c)?Fa.apply(void 0,[t,e].concat(B(c))):Ba.apply(void 0,[t,e].concat(B(c))),r.push(c[0]),i.outputs.delete(c))}}catch(t){o=!0,s=t}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}return r}(this,s,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(ya(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(i=function(t,e,n,i,r){var a=fa(t);return Array.from(a.outputs).filter((function(t){return!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r)})).map((function(n){return ba(n)?Fa.apply(void 0,[t,e].concat(B(n))):Ba.apply(void 0,[t,e].concat(B(n))),a.outputs.delete(n),n[0]}))}(this,s,t,e,n),0===i.length)throw a()}var c=!0,h=!1,v=void 0;try{for(var f,d=i[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var _=f.value,g=l([this],_);La(g,u)}}catch(t){h=!0,v=t}finally{try{c||null==d.return||d.return()}finally{if(h)throw v}}}}]),y}(h)}((Wo=Rr,function(t,e,n){for(var i=[],r=0;r<n.numberOfInputs;r+=1)i.push(new Set);Wo.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),function(t,e,n,i,r,a,o,s,u,l,c,h,p){var v=new WeakMap;return function(f,d,m,_,g){var y=a(d),b=y.activeInputs,w=y.passiveInputs,k=a(f).outputs,x=s(f),C=function(a){var s=u(d),l=u(f);if(a){var y=Zr(w,f,m,_);t(b,f,y,!1),g||h(f)||n(l,s,m,_),p(d)&&$r(d)}else{var k=i(b,f,m,_);e(w,_,k,!1),g||h(f)||r(l,s,m,_);var x=o(d);if(0===x)c(d)&&ea(d,b);else{var C=v.get(d);void 0!==C&&clearTimeout(C),v.set(d,setTimeout((function(){c(d)&&ea(d,b)}),1e3*x))}}};return!!l(k,[d,m,_],(function(t){return t[0]===d&&t[1]===m&&t[2]===_}),!0)&&(x.add(C),c(f)?t(b,f,[m,_,C],!0):e(w,_,[f,m,C],!0),!0)}}(uu,lu,Ea,cu,Aa,fa,pu,Qr,Sa,wa,pa,Oa,Da),vu,function(t,e,n,i,r,a){return function(o){return function(s,u){var l=t.get(s);if(void 0===l){if(!o&&a(s)){var c=i(s),h=n(s).outputs,p=!0,v=!1,f=void 0;try{for(var d,m=h[Symbol.iterator]();!(p=(d=m.next()).done);p=!0){var _=d.value;if(ba(_)){var g=i(_[0]);e(c,g,_[1],_[2])}else{var y=r(_[0]);c.disconnect(y,_[1])}}}catch(t){v=!0,f=t}finally{try{p||null==m.return||m.return()}finally{if(v)throw f}}}t.set(s,u)}else t.set(s,l+u)}}}(qr,Aa,fa,Sa,Va,pa),sa,ao,Gs,function(t,e,n,i,r,a,o,s){return function(u,l){var c=e.get(u);if(void 0===c)throw new Error("Missing the expected cycle count.");var h=a(u.context),p=s(h);if(c===l){if(e.delete(u),!p&&o(u)){var v=i(u),f=n(u).outputs,d=!0,m=!1,_=void 0;try{for(var g,y=f[Symbol.iterator]();!(d=(g=y.next()).done);d=!0){var b=g.value;if(ba(b)){var w=i(b[0]);t(v,w,b[1],b[2])}else{var k=r(b[0]);v.connect(k,b[1])}}}catch(t){m=!0,_=t}finally{try{d||null==y.return||y.return()}finally{if(m)throw _}}}}else e.set(u,c-l)}}(Ea,qr,fa,Sa,Va,yu,pa,wu),function(t,e,n){return function i(r,a){var o=ya(a)?a:n(t,a);if(function(t){return"delayTime"in t}(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];var s=e(o).outputs;return Array.from(s).map((function(t){return i(B(r).concat([o]),t[0])})).reduce((function(t,e){return t.concat(e)}),[])}}(ku,fa,Yr),xu,yu,Eu,Mu,Tu,wu,Pu),Su=function(t,e,n,i,r,a){return function(t){"use strict";O(s,t);var o=P(s);function s(t,n){var u;c(this,s);var l=r(t),h=D({},na,n),p=i(l,h),v=a(l)?e():null;return(u=o.call(this,t,!1,p,v))._nativeAnalyserNode=p,u}return C(s,[{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(t){this._nativeAnalyserNode.fftSize=t}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(t){var e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(t){var e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(t){this._nativeAnalyserNode.smoothingTimeConstant=t}},{key:"getByteFrequencyData",value:function(t){this._nativeAnalyserNode.getByteFrequencyData(t)}},{key:"getByteTimeDomainData",value:function(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}},{key:"getFloatFrequencyData",value:function(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}},{key:"getFloatTimeDomainData",value:function(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}}]),s}(t)}(Au,gu,sa,du,yu,wu),Vu=new WeakSet,Ou=function(t){return null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null}(fu),Du=(Go=new Uint32Array(1),function(t){return Go[0]=t,Go[0]}),Ru=function(t,e){return function(n){n.copyFromChannel=function(i,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(a),s=t(r);if(s>=n.numberOfChannels)throw e();for(var u=n.length,l=n.getChannelData(s),c=i.length,h=o<0?-o:0;h+o<u&&h<c;h+=1)i[h]=l[h+o]},n.copyToChannel=function(i,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t(a),s=t(r);if(s>=n.numberOfChannels)throw e();for(var u=n.length,l=n.getChannelData(s),c=i.length,h=o<0?-o:0;h+o<u&&h<c;h+=1)l[h+o]=i[h]}}}(Du,sa),Lu=(Ko=Du,function(t){var e,n;t.copyFromChannel=(e=t.copyFromChannel,function(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Ko(r),o=Ko(i);if(a<t.length)return e.call(t,n,o,a)}),t.copyToChannel=(n=t.copyToChannel,function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Ko(r),o=Ko(i);if(a<t.length)return n.call(t,e,o,a)})}),Iu=function(t,e,n,i,r,a,o,s){var u,l=null;return u=Symbol.hasInstance,function(){"use strict";function h(u){if(c(this,h),null===r)throw new Error("Missing the native OfflineAudioContext constructor.");var p=D({},la,u),v=p.length,f=p.numberOfChannels,d=p.sampleRate;null===l&&(l=new r(1,1,44100));var m=null!==i&&e(a,a)?new i({length:v,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,v,d);if(0===m.numberOfChannels)throw n();return"function"!=typeof m.copyFromChannel?(o(m),ua(m)):e(oa,(function(){return oa(m)}))||s(m),t.add(m),m}return C(h,null,[{key:u,value:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}]),h}()}(Vu,vu,Gs,Ou,bu,(Ho=Ou,function(){if(null===Ho)return!1;try{new Ho({length:1,sampleRate:44100})}catch(t){return!1}return!0}),Ru,Lu),Nu=(Yo=Mo,function(t,e){var n=Yo(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);var i=function(){e.removeEventListener("ended",i),e.disconnect(n),n.disconnect()};e.addEventListener("ended",i)}),Fu=(Xo=mu,Zo=da,Qo=Oa,$o=l(e(ia).mark((function t(n,i,r){var a;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Zo(n),t.next=3,Promise.all(Array.from(a.activeInputs).map(function(){var t=l(e(ia).mark((function t(n){var a,o,s,u,l;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=F(n,2),o=a[0],s=a[1],u=Xo(o),t.next=4,u.render(o,i);case 4:l=t.sent,Qo(o)||l.connect(r,s);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return t.stop()}}),t)}))),function(t,e,n){return $o.apply(this,arguments)}),Bu=(Jo=Fu,function(t,e,n){return Jo(e,t,n)}),qu=function(t,e,n,i,r,a,o,s,u,l,c){return function(h,p){var v=h.createBufferSource();return vo(v,p),mo(v,p,"playbackRate"),po(v,p,"buffer"),po(v,p,"loop"),po(v,p,"loopEnd"),po(v,p,"loopStart"),e(n,(function(){return n(h)}))||function(t){var e,n;t.start=(e=t.start,n=!1,function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if(n)throw ro();e.call(t,i,r,a),n=!0})}(v),e(i,(function(){return i(h)}))||u(v),e(r,(function(){return r(h)}))||l(v,h),e(a,(function(){return a(h)}))||_o(v),e(o,(function(){return o(h)}))||c(v,h),e(s,(function(){return s(h)}))||go(v),t(h,v),v}}(Nu,vu,(function(t){var e=t.createBufferSource();e.start();try{e.start()}catch(t){return!0}return!1}),(function(t){var e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch(t){return!1}return!0}),(function(t){var e=t.createBufferSource();e.start();try{e.stop()}catch(t){return!1}return!0}),iu,ru,au,(function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=t.buffer,o=null===a?i:Math.min(a.duration,i);null!==a&&o>a.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})}),(ts=eu,function(t,e){var n=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),ts(t,"buffer",(function(e){return function(){var i=e.call(t);return i===n?null:i}}),(function(e){return function(i){return e.call(t,null===i?n:i)}}))}),ou),ju=function(t,e){return function(n,i,r){return t(i).replay(r),e(i,n,r)}}(function(t){return function(e){var n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(da),Fu),zu=function(t,n,i,r,a){return function(){var o,s=new WeakMap,u=null,c=null,h=(o=l(e(ia).mark((function o(l,h){var p,v,f,d;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=i(l),(v=aa(p,h))||(d={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value},p=n(h,d),null!==u&&(f=p).start.apply(f,B(u)),null!==c&&p.stop(c)),s.set(h,p),v){e.next=9;break}return e.next=7,r(h,l.playbackRate,p.playbackRate);case 7:e.next=11;break;case 9:return e.next=11,t(h,l.playbackRate,p.playbackRate);case 11:return e.next=13,a(l,h,p);case 13:return e.abrupt("return",p);case 14:case"end":return e.stop()}}),o)}))),function(t,e){return o.apply(this,arguments)});return{set start(t){u=t},set stop(t){c=t},render:function(t,e){var n=s.get(e);return void 0!==n?Promise.resolve(n):h(t,e)}}}}(Bu,qu,Sa,ju,_u),Uu=function(t,e,n,i,r,a,o,s,u,l,c,h,p){return function(v,f,d){var m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,g=new Or.AutomationEventList(d.defaultValue),y=f?i(g):null,b={get defaultValue(){return d.defaultValue},get maxValue(){return null===m?d.maxValue:m},get minValue(){return null===_?d.minValue:_},get value(){return d.value},set value(t){d.value=t,b.setValueAtTime(t,v.context.currentTime)},cancelAndHoldAtTime:function(t){if("function"==typeof d.cancelAndHoldAtTime)null===y&&g.flush(v.context.currentTime),g.add(r(t)),d.cancelAndHoldAtTime(t);else{var e=Array.from(g).pop();null===y&&g.flush(v.context.currentTime),g.add(r(t));var n=Array.from(g).pop();d.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?d.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?d.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?d.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&d.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:function(t){return null===y&&g.flush(v.context.currentTime),g.add(a(t)),d.cancelScheduledValues(t),b},exponentialRampToValueAtTime:function(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&g.flush(v.context.currentTime),g.add(o(t,e)),d.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:function(t,e){return null===y&&g.flush(v.context.currentTime),g.add(s(t,e)),d.linearRampToValueAtTime(t,e),b},setTargetAtTime:function(t,e,n){return null===y&&g.flush(v.context.currentTime),g.add(u(t,e,n)),d.setTargetAtTime(t,e,n),b},setValueAtTime:function(t,e){return null===y&&g.flush(v.context.currentTime),g.add(l(t,e)),d.setValueAtTime(t,e),b},setValueCurveAtTime:function(t,e,n){var i=t instanceof Float32Array?t:new Float32Array(t);if(null!==h&&"webkitAudioContext"===h.name){for(var r=e+n,a=v.context.sampleRate,o=Math.ceil(e*a),s=Math.floor(r*a),u=s-o,l=new Float32Array(u),f=0;f<u;f+=1){var m=(i.length-1)/n*((o+f)/a-e),_=Math.floor(m),w=Math.ceil(m);l[f]=_===w?i[_]:(1-(m-_))*i[_]+(1-(w-m))*i[w]}null===y&&g.flush(v.context.currentTime),g.add(c(l,e,n)),d.setValueCurveAtTime(l,e,n);var k=s/a;k<r&&p(b,l[l.length-1],k),p(b,i[i.length-1],r)}else null===y&&g.flush(v.context.currentTime),g.add(c(i,e,n)),d.setValueCurveAtTime(i,e,n);return b}};return n.set(b,d),e.set(b,v),t(b,y),b}}((es=Ir,function(t,e){es.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),ku,Nr,(function(t){return{replay:function(e){var n=!0,i=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if("exponentialRampToValue"===s.type){var u=s.endTime,l=s.value;e.exponentialRampToValueAtTime(l,u)}else if("linearRampToValue"===s.type){var c=s.endTime,h=s.value;e.linearRampToValueAtTime(h,c)}else if("setTarget"===s.type){var p=s.startTime,v=s.target,f=s.timeConstant;e.setTargetAtTime(v,p,f)}else if("setValue"===s.type){var d=s.startTime,m=s.value;e.setValueAtTime(m,d)}else{if("setValueCurve"!==s.type)throw new Error("Can't apply an unknown automation.");var _=s.duration,g=s.startTime,y=s.values;e.setValueCurveAtTime(y,g,_)}}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}}}}),Or.createCancelAndHoldAutomationEvent,Or.createCancelScheduledValuesAutomationEvent,Or.createExponentialRampToValueAutomationEvent,Or.createLinearRampToValueAutomationEvent,Or.createSetTargetAutomationEvent,Or.createSetValueAutomationEvent,Or.createSetValueCurveAutomationEvent,Cu,nu),Wu=function(t,e,n,i,r,a,o,u){return function(t){"use strict";O(h,t);var l=P(h);function h(t,i){var u;c(this,h);var p=a(t),v=D({},va,i),f=r(p,v),d=o(p),m=d?e():null;return(u=l.call(this,t,!1,f,m))._audioBufferSourceNodeRenderer=m,u._isBufferNullified=!1,u._isBufferSet=null!==v.buffer,u._nativeAudioBufferSourceNode=f,u._onended=null,u._playbackRate=n(s(u),d,f.playbackRate,ha,ca),u}return C(h,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer},set:function(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}},{key:"loop",get:function(){return this._nativeAudioBufferSourceNode.loop},set:function(t){this._nativeAudioBufferSourceNode.loop=t}},{key:"loopEnd",get:function(){return this._nativeAudioBufferSourceNode.loopEnd},set:function(t){this._nativeAudioBufferSourceNode.loopEnd=t}},{key:"loopStart",get:function(){return this._nativeAudioBufferSourceNode.loopStart},set:function(t){this._nativeAudioBufferSourceNode.loopStart=t}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?u(this,t):null;this._nativeAudioBufferSourceNode.onended=e;var n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){var i=this;$r(this);var r=function(){i._nativeAudioBufferSourceNode.removeEventListener("ended",r),pa(i)&&ta(i)};this._nativeAudioBufferSourceNode.addEventListener("ended",r)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}}]),h}(t)}(Au,zu,Uu,ro,qu,yu,wu,su),Gu=function(t,e,n,i,r,a,o,s){return function(t){"use strict";O(l,t);var u=P(l);function l(t,n){var i;c(this,l);var h=a(t),p=o(h),v=r(h,n,p),f=p?e(s):null;return(i=u.call(this,t,!1,v,f))._isNodeOfNativeOfflineAudioContext=p,i._nativeAudioDestinationNode=v,i}return C(l,[{key:"channelCount",get:function(){return this._nativeAudioDestinationNode.channelCount},set:function(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}},{key:"channelCountMode",get:function(){return this._nativeAudioDestinationNode.channelCountMode},set:function(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}},{key:"maxChannelCount",get:function(){return this._nativeAudioDestinationNode.maxChannelCount}}]),l}(t)}(Au,(function(t){var n,i=new WeakMap,r=(n=l(e(ia).mark((function n(r,a){var o;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.destination,i.set(a,o),e.next=4,t(r,a,o);case 4:return e.abrupt("return",o);case 5:case"end":return e.stop()}}),n)}))),function(t,e){return n.apply(this,arguments)});return{render:function(t,e){var n=i.get(e);return void 0!==n?Promise.resolve(n):r(t,e)}}}),sa,ro,function(t,e){return function(n,i,r){var a=n.destination;if(a.channelCount!==i)try{a.channelCount=i}catch(t){}r&&"explicit"!==a.channelCountMode&&(a.channelCountMode="explicit"),0===a.maxChannelCount&&Object.defineProperty(a,"maxChannelCount",{value:i});var o=t(n,{channelCount:i,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return e(o,"channelCount",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e);try{a.channelCount=e}catch(t){if(e>a.maxChannelCount)throw t}}})),e(o,"channelCountMode",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e),a.channelCountMode=e}})),e(o,"channelInterpretation",(function(t){return function(){return t.call(o)}}),(function(t){return function(e){t.call(o,e),a.channelInterpretation=e}})),Object.defineProperty(o,"maxChannelCount",{get:function(){return a.maxChannelCount}}),o.connect(a),o}}(Mo,eu),yu,wu,_u),Ku=function(t,n,i,r,a){return function(){var o=new WeakMap,s=function(){var s=l(e(ia).mark((function s(u,l){var c,h,p;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i(u),(h=aa(c,l))||(p={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type},c=n(l,p)),o.set(l,c),h){e.next=15;break}return e.next=7,r(l,u.Q,c.Q);case 7:return e.next=9,r(l,u.detune,c.detune);case 9:return e.next=11,r(l,u.frequency,c.frequency);case 11:return e.next=13,r(l,u.gain,c.gain);case 13:e.next=23;break;case 15:return e.next=17,t(l,u.Q,c.Q);case 17:return e.next=19,t(l,u.detune,c.detune);case 19:return e.next=21,t(l,u.frequency,c.frequency);case 21:return e.next=23,t(l,u.gain,c.gain);case 23:return e.next=25,a(u,l,c);case 25:return e.abrupt("return",c);case 26:case"end":return e.stop()}}),s)})));return function(t,e){return s.apply(this,arguments)}}();return{render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):s(t,e)}}}}(Bu,ko,Sa,ju,_u),Hu=function(t){return function(e,n){return t.set(e,n)}}(hu),Yu=(ns=Uu,is=Ku,rs=ao,as=ko,os=yu,ss=wu,us=Hu,function(t){"use strict";O(n,t);var e=P(n);function n(t,i){var r;c(this,n);var a=os(t),o=D({},Ya,i),u=as(a,o),l=ss(a),h=l?is():null;return(r=e.call(this,t,!1,u,h))._Q=ns(s(r),l,u.Q,ha,ca),r._detune=ns(s(r),l,u.detune,1200*Math.log2(ha),-1200*Math.log2(ha)),r._frequency=ns(s(r),l,u.frequency,t.sampleRate/2,0),r._gain=ns(s(r),l,u.gain,40*Math.log10(ha),ca),r._nativeBiquadFilterNode=u,us(s(r),1),r}return C(n,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"gain",get:function(){return this._gain}},{key:"Q",get:function(){return this._Q}},{key:"type",get:function(){return this._nativeBiquadFilterNode.type},set:function(t){this._nativeBiquadFilterNode.type=t}},{key:"getFrequencyResponse",value:function(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw rs();throw t}if(t.length!==e.length||e.length!==n.length)throw rs()}}]),n}(Au)),Xu=function(t,e){return function(n,i,r){var a,o,s=new Set;return n.connect=(a=n.connect,function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=0===s.size;if(e(r))return a.call(n,r,o,u),t(s,[r,o,u],(function(t){return t[0]===r&&t[1]===o&&t[2]===u}),!0),l&&i(),r;a.call(n,r,o),t(s,[r,o],(function(t){return t[0]===r&&t[1]===o}),!0),l&&i()}),n.disconnect=(o=n.disconnect,function(t,i,a){var u=s.size>0;if(void 0===t)o.apply(n),s.clear();else if("number"==typeof t){o.call(n,t);var l=!0,c=!1,h=void 0;try{for(var p,v=s[Symbol.iterator]();!(l=(p=v.next()).done);l=!0){var f=p.value;f[1]===t&&s.delete(f)}}catch(t){c=!0,h=t}finally{try{l||null==v.return||v.return()}finally{if(c)throw h}}}else{e(t)?o.call(n,t,i,a):o.call(n,t,i);var d=!0,m=!1,_=void 0;try{for(var g,y=s[Symbol.iterator]();!(d=(g=y.next()).done);d=!0){var b=g.value;b[0]!==t||void 0!==i&&b[1]!==i||void 0!==a&&b[2]!==a||s.delete(b)}}catch(t){m=!0,_=t}finally{try{d||null==y.return||y.return()}finally{if(m)throw _}}}var w=0===s.size;u&&w&&r()}),n}}(wa,Mu),Zu=(ls=ro,cs=Xu,function(t,e){e.channelCount=1,e.channelCountMode="explicit",Object.defineProperty(e,"channelCount",{get:function(){return 1},set:function(){throw ls()}}),Object.defineProperty(e,"channelCountMode",{get:function(){return"explicit"},set:function(){throw ls()}});var n=t.createBufferSource();cs(e,(function(){for(var t=e.numberOfInputs,i=0;i<t;i+=1)n.connect(e,0,i)}),(function(){return n.disconnect(e)}))}),Qu=function(t,e){return function(n,i){var r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),vo(r,i),r}}(Cu,Zu),$u=function(t,n,i){return function(){var r=new WeakMap,a=function(){var a=l(e(ia).mark((function a(o,s){var u,l;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n(o),aa(u,s)||(l={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs},u=t(s,l)),r.set(s,u),e.next=6,i(o,s,u);case 6:return e.abrupt("return",u);case 7:case"end":return e.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}();return{render:function(t,e){var n=r.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}}}(Qu,Sa,_u),Ju=function(t,e,n,i,r){return function(t){"use strict";O(o,t);var a=P(o);function o(t,s){c(this,o);var u=i(t),l=D({},Xa,s),h=n(u,l),p=r(u)?e():null;return a.call(this,t,!1,h,p)}return o}(t)}(Au,$u,Qu,yu,wu),tl=function(t,n,i){return function(){var r=new WeakMap,a=function(){var a=l(e(ia).mark((function a(o,s){var u,l;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n(o),aa(u,s)||(l={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs},u=t(s,l)),r.set(s,u),e.next=6,i(o,s,u);case 6:return e.abrupt("return",u);case 7:case"end":return e.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}();return{render:function(t,e){var n=r.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}}}(xo,Sa,_u),el=function(t,e,n,i,r,a){return function(t){"use strict";O(s,t);var o=P(s);function s(t,u){c(this,s);var l=i(t),h=a(D({},Za,u)),p=n(l,h),v=r(l)?e():null;return o.call(this,t,!1,p,v)}return s}(t)}(Au,tl,xo,yu,wu,(function(t){return D({},t,{channelCount:t.numberOfOutputs})})),nl=function(t,e,n,i){return function(r,a){var o=a.offset,s=R(a,["offset"]),u=r.createBuffer(1,2,44100),l=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(r,D({},s,{gain:o})),h=u.getChannelData(0);h[0]=1,h[1]=1,l.buffer=u,l.loop=!0;var p={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){c.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){c.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(t){l.onended=t},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.removeEventListener(e[0],e[1],e[2])},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.start.call(l,t)},stop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.stop.call(l,t)}};return t(r,l),i(Co(p,c),(function(){return l.connect(c)}),(function(){return l.disconnect(c)}))}}(Nu,qu,Mo,Xu),il=function(t,e,n,i,r){return function(a,o){if(void 0===a.createConstantSource)return n(a,o);var s=a.createConstantSource();return vo(s,o),mo(s,o,"offset"),e(i,(function(){return i(a)}))||_o(s),e(r,(function(){return r(a)}))||go(s),t(a,s),s}}(Nu,vu,nl,iu,au),rl=function(t,n,i,r,a){return function(){var o=new WeakMap,s=null,u=null,c=function(){var c=l(e(ia).mark((function l(c,h){var p,v,f;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=i(c),(v=aa(p,h))||(f={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value},p=n(h,f),null!==s&&p.start(s),null!==u&&p.stop(u)),o.set(h,p),v){e.next=9;break}return e.next=7,r(h,c.offset,p.offset);case 7:e.next=11;break;case 9:return e.next=11,t(h,c.offset,p.offset);case 11:return e.next=13,a(c,h,p);case 13:return e.abrupt("return",p);case 14:case"end":return e.stop()}}),l)})));return function(t,e){return c.apply(this,arguments)}}();return{set start(t){s=t},set stop(t){u=t},render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):c(t,e)}}}}(Bu,il,Sa,ju,_u),al=function(t,e,n,i,r,a,o){return function(t){"use strict";O(l,t);var u=P(l);function l(t,o){var h;c(this,l);var p=r(t),v=D({},Qa,o),f=i(p,v),d=a(p),m=d?n():null;return(h=u.call(this,t,!1,f,m))._constantSourceNodeRenderer=m,h._nativeConstantSourceNode=f,h._offset=e(s(h),d,f.offset,ha,ca),h._onended=null,h}return C(l,[{key:"offset",get:function(){return this._offset}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;var n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){var e=this;$r(this);var n=function(){e._nativeConstantSourceNode.removeEventListener("ended",n),pa(e)&&ta(e)};this._nativeConstantSourceNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}}]),l}(t)}(Au,Uu,rl,il,yu,wu,su),ol=function(t,e){return function(n,i){var r=n.createConvolver();if(vo(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),po(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(function(t){return function(){return t.call(r)}}),(function(e){return function(n){if(n>2)throw t();return e.call(r,n)}})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(function(t){return function(){return t.call(r)}}),(function(e){return function(n){if("max"===n)throw t();return e.call(r,n)}})),r}}(Gs,eu),sl=function(t,n,i){return function(){var r=new WeakMap,a=function(){var a=l(e(ia).mark((function a(o,s){var u,l;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n(o),aa(u,s)||(l={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,disableNormalization:!u.normalize},u=t(s,l)),r.set(s,u),!Ca(u)){e.next=9;break}return e.next=7,i(o,s,u.inputs[0]);case 7:e.next=11;break;case 9:return e.next=11,i(o,s,u);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}();return{render:function(t,e){var n=r.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}}}(ol,Sa,_u),ul=function(t,e,n,i,r,a){return function(t){"use strict";O(u,t);var o=P(u);function u(t,l){var h;c(this,u);var p=i(t),v=D({},$a,l),f=n(p,v),d=r(p)?e():null;return(h=o.call(this,t,!1,f,d))._isBufferNullified=!1,h._nativeConvolverNode=f,null!==v.buffer&&a(s(h),v.buffer.duration),h}return C(u,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer},set:function(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){var e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,44100),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}},{key:"normalize",get:function(){return this._nativeConvolverNode.normalize},set:function(t){this._nativeConvolverNode.normalize=t}}]),u}(t)}(Au,sl,ol,yu,wu,Hu),ll=function(t,n,i,r,a){return function(o){var s=new WeakMap,u=function(){var u=l(e(ia).mark((function u(l,c){var h,p,v;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=i(l),(p=aa(h,c))||(v={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o},h=n(c,v)),s.set(c,h),p){e.next=9;break}return e.next=7,r(c,l.delayTime,h.delayTime);case 7:e.next=11;break;case 9:return e.next=11,t(c,l.delayTime,h.delayTime);case 11:return e.next=13,a(l,c,h);case 13:return e.abrupt("return",h);case 14:case"end":return e.stop()}}),u)})));return function(t,e){return u.apply(this,arguments)}}();return{render:function(t,e){var n=s.get(e);return void 0!==n?Promise.resolve(n):u(t,e)}}}}(Bu,Eo,Sa,ju,_u),cl=function(t,e,n,i,r,a,o){return function(t){"use strict";O(l,t);var u=P(l);function l(t,h){var p;c(this,l);var v=r(t),f=D({},to,h),d=i(v,f),m=a(v),_=m?n(f.maxDelayTime):null;return(p=u.call(this,t,!1,d,_))._delayTime=e(s(p),m,d.delayTime),o(s(p),f.maxDelayTime),p}return C(l,[{key:"delayTime",get:function(){return this._delayTime}}]),l}(t)}(Au,Uu,ll,Eo,yu,wu,Hu),hl=(hs=Gs,function(t,e){var n=t.createDynamicsCompressor();if(vo(n,e),e.channelCount>2)throw hs();if("max"===e.channelCountMode)throw hs();return mo(n,e,"attack"),mo(n,e,"knee"),mo(n,e,"ratio"),mo(n,e,"release"),mo(n,e,"threshold"),n}),pl=function(t,n,i,r,a){return function(){var o=new WeakMap,s=function(){var s=l(e(ia).mark((function s(u,l){var c,h,p;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i(u),(h=aa(c,l))||(p={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value},c=n(l,p)),o.set(l,c),h){e.next=17;break}return e.next=7,r(l,u.attack,c.attack);case 7:return e.next=9,r(l,u.knee,c.knee);case 9:return e.next=11,r(l,u.ratio,c.ratio);case 11:return e.next=13,r(l,u.release,c.release);case 13:return e.next=15,r(l,u.threshold,c.threshold);case 15:e.next=27;break;case 17:return e.next=19,t(l,u.attack,c.attack);case 19:return e.next=21,t(l,u.knee,c.knee);case 21:return e.next=23,t(l,u.ratio,c.ratio);case 23:return e.next=25,t(l,u.release,c.release);case 25:return e.next=27,t(l,u.threshold,c.threshold);case 27:return e.next=29,a(u,l,c);case 29:return e.abrupt("return",c);case 30:case"end":return e.stop()}}),s)})));return function(t,e){return s.apply(this,arguments)}}();return{render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):s(t,e)}}}}(Bu,hl,Sa,ju,_u),vl=function(t,e,n,i,r,a,o,u){return function(t){"use strict";O(h,t);var l=P(h);function h(t,r){var p;c(this,h);var v=a(t),f=D({},no,r),d=i(v,f),m=o(v),_=m?n():null;return(p=l.call(this,t,!1,d,_))._attack=e(s(p),m,d.attack),p._knee=e(s(p),m,d.knee),p._nativeDynamicsCompressorNode=d,p._ratio=e(s(p),m,d.ratio),p._release=e(s(p),m,d.release),p._threshold=e(s(p),m,d.threshold),u(s(p),.006),p}return C(h,[{key:"attack",get:function(){return this._attack}},{key:"channelCount",get:function(){return this._nativeDynamicsCompressorNode.channelCount},set:function(t){var e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}},{key:"channelCountMode",get:function(){return this._nativeDynamicsCompressorNode.channelCountMode},set:function(t){var e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}},{key:"knee",get:function(){return this._knee}},{key:"ratio",get:function(){return this._ratio}},{key:"reduction",get:function(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}},{key:"release",get:function(){return this._release}},{key:"threshold",get:function(){return this._threshold}}]),h}(t)}(Au,Uu,pl,hl,Gs,yu,wu,Hu),fl=function(t,n,i,r,a){return function(){var o=new WeakMap,s=function(){var s=l(e(ia).mark((function s(u,l){var c,h,p;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i(u),(h=aa(c,l))||(p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value},c=n(l,p)),o.set(l,c),h){e.next=9;break}return e.next=7,r(l,u.gain,c.gain);case 7:e.next=11;break;case 9:return e.next=11,t(l,u.gain,c.gain);case 11:return e.next=13,a(u,l,c);case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),s)})));return function(t,e){return s.apply(this,arguments)}}();return{render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):s(t,e)}}}}(Bu,Mo,Sa,ju,_u),dl=function(t,e,n,i,r,a){return function(t){"use strict";O(u,t);var o=P(u);function u(t,l){var h;c(this,u);var p=r(t),v=D({},io,l),f=i(p,v),d=a(p),m=d?n():null;return(h=o.call(this,t,!1,f,m))._gain=e(s(h),d,f.gain,ha,ca),h}return C(u,[{key:"gain",get:function(){return this._gain}}]),u}(t)}(Au,Uu,fl,Mo,yu,wu),ml=function(t,e,n,i){return function(r,a,o){var s=o.channelCount,u=o.channelCountMode,l=o.channelInterpretation,c=o.feedback,h=o.feedforward,p=yo(a,r.sampleRate),v=c instanceof Float64Array?c:new Float64Array(c),f=h instanceof Float64Array?h:new Float64Array(h),d=v.length,m=f.length,_=Math.min(d,m);if(0===d||d>20)throw i();if(0===v[0])throw e();if(0===m||m>20)throw i();if(0===f[0])throw e();if(1!==v[0]){for(var g=0;g<m;g+=1)f[g]/=v[0];for(var y=1;y<d;y+=1)v[y]/=v[0]}var b=n(r,p,s,s);b.channelCount=s,b.channelCountMode=u,b.channelInterpretation=l;for(var w=[],k=[],x=[],C=0;C<s;C+=1){w.push(0);var E=new Float32Array(32),M=new Float32Array(32);E.fill(0),M.fill(0),k.push(E),x.push(M)}b.onaudioprocess=function(t){for(var e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels,r=0;r<i;r+=1){var a=e.getChannelData(r),o=n.getChannelData(r);w[r]=so(v,d,f,m,_,k[r],x[r],w[r],32,a,o)}};var T=r.sampleRate/2,P={get bufferSize(){return p},get channelCount(){return b.channelCount},set channelCount(t){b.channelCount=t},get channelCountMode(){return b.channelCountMode},set channelCountMode(t){b.channelCountMode=t},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(t){b.channelInterpretation=t},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return b.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return b.dispatchEvent(e[0])},getFrequencyResponse:function(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();for(var r=e.length,a=0;a<r;a+=1){var o=-Math.PI*(e[a]/T),s=[Math.cos(o),Math.sin(o)],u=To(Po(f,s),Po(v,s));n[a]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),i[a]=Math.atan2(u[1],u[0])}},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return b.removeEventListener(e[0],e[1],e[2])}};return Co(P,b)}}(ao,ro,Ws,Gs),_l=function(t,e,n,i){return function(r){return t(co,(function(){return co(r)}))?Promise.resolve(t(i,i)).then((function(t){if(!t){var e=n(r,512,0,1);r.oncomplete=function(){e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=function(){return r.currentTime},e.connect(r.destination)}return r.startRendering()})):new Promise((function(t){var n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=function(e){n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()}))}}(vu,Mo,Ws,function(t,e){return function(){if(null===e)return Promise.resolve(!1);var n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((function(t){n.oncomplete=function(){i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))}}(Mo,bu)),gl=function(t,n,i,r,a){return function(o,s){var u=new WeakMap,c=null,h=function(){var h=l(e(ia).mark((function h(p,v){var f,d,m,_,g;return e(ia).wrap((function(h){for(;;)switch(h.prev=h.next){case 0:if(f=null,d=n(p),m=aa(d,v),void 0===v.createIIRFilter?f=t(v,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=v.createIIRFilter(s,o)),u.set(v,null===f?d:f),null===f){h.next=17;break}if(null!==c){h.next=11;break}if(null!==i){h.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:_=new i(p.context.destination.channelCount,p.context.length,v.sampleRate),c=l(e(ia).mark((function t(){var n;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(p,_,_.destination);case 2:return t.next=4,a(_);case 4:return n=t.sent,t.abrupt("return",uo(n,v,o,s));case 6:case"end":return t.stop()}}),t)})))();case 11:return h.next=13,c;case 13:return g=h.sent,f.buffer=g,f.start(0),h.abrupt("return",f);case 17:return h.next=19,r(p,v,d);case 19:return h.abrupt("return",d);case 20:case"end":return h.stop()}}),h)})));return function(t,e){return h.apply(this,arguments)}}();return{render:function(t,e){var n=u.get(e);return void 0!==n?Promise.resolve(n):h(t,e)}}}}(qu,Sa,bu,_u,_l),yl=function(t,e,n,i,r,a){return function(t){"use strict";O(u,t);var o=P(u);function u(t,l){var h;c(this,u);var p=i(t),v=r(p),f=D({},oo,l),d=e(p,v?null:t.baseLatency,f),m=v?n(f.feedback,f.feedforward):null;return h=o.call(this,t,!1,d,m),function(t){var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,function(n,i,r){if(n.length!==i.length||i.length!==r.length)throw ao();return e.call(t,n,i,r)})}(d),h._nativeIIRFilterNode=d,a(s(h),1),h}return C(u,[{key:"getFrequencyResponse",value:function(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}}]),u}(t)}(Au,(ps=ml,function(t,e,n){if(void 0===t.createIIRFilter)return ps(t,e,n);var i=t.createIIRFilter(n.feedforward,n.feedback);return vo(i,n),i}),gl,yu,wu,Hu),bl=function(t,e,n,i,r,a,o,s){return function(u,l){var c,h,p,v,f,d,m,_,g,y,b=l.listener,w=void 0===b.forwardX?(c=new Float32Array(1),h=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(l),v=!1,f=[0,0,-1,0,1,0],d=[0,0,0],m=function(){if(!v){v=!0;var t=i(l,256,9,0);t.onaudioprocess=function(t){var e,n=t.inputBuffer,i=[a(n,c,0),a(n,c,1),a(n,c,2),a(n,c,3),a(n,c,4),a(n,c,5)];i.some((function(t,e){return t!==f[e]}))&&((e=b).setOrientation.apply(e,B(i)),f=i);var r,o=[a(n,c,6),a(n,c,7),a(n,c,8)];o.some((function(t,e){return t!==d[e]}))&&((r=b).setPosition.apply(r,B(o)),d=o)},h.connect(t)}},g=function(t){return function(e){var n;e!==d[t]&&(d[t]=e,(n=b).setPosition.apply(n,B(d)))}},y=function(e,i,a){var o=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(h,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:function(){return i}});var c,v,f,d,_,g,y,b=t({context:u},p,o.offset,ha,ca);return s(b,"value",(function(t){return function(){return t.call(b)}}),(function(t){return function(e){try{t.call(b,e)}catch(t){if(9!==t.code)throw t}m(),p&&a(e)}})),b.cancelAndHoldAtTime=(c=b.cancelAndHoldAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=c.apply(b,e);return m(),i}),b.cancelScheduledValues=(v=b.cancelScheduledValues,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=v.apply(b,e);return m(),i}),b.exponentialRampToValueAtTime=(f=b.exponentialRampToValueAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=f.apply(b,e);return m(),i}),b.linearRampToValueAtTime=(d=b.linearRampToValueAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=d.apply(b,e);return m(),i}),b.setTargetAtTime=(_=b.setTargetAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=_.apply(b,e);return m(),i}),b.setValueAtTime=(g=b.setValueAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=g.apply(b,e);return m(),i}),b.setValueCurveAtTime=(y=b.setValueCurveAtTime,p?function(){throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=y.apply(b,e);return m(),i}),b},{forwardX:y(0,0,(_=function(t){return function(e){var n;e!==f[t]&&(f[t]=e,(n=b).setOrientation.apply(n,B(f)))}})(0)),forwardY:y(1,0,_(1)),forwardZ:y(2,-1,_(2)),positionX:y(6,0,g(0)),positionY:y(7,0,g(1)),positionZ:y(8,0,g(2)),upX:y(3,0,_(3)),upY:y(4,1,_(4)),upZ:y(5,0,_(5))}):b,k=w.forwardX,x=w.forwardY,C=w.forwardZ,E=w.positionX,M=w.positionY,T=w.positionZ,P=w.upX,A=w.upY,S=w.upZ;return{get forwardX(){return k},get forwardY(){return x},get forwardZ(){return C},get positionX(){return E},get positionY(){return M},get positionZ(){return T},get upX(){return P},get upY(){return A},get upZ(){return S}}}}(Uu,Qu,il,Ws,Gs,Js,wu,eu),wl=new WeakMap,kl=function(t,e,n,i,r,a){return function(n){"use strict";O(u,n);var o=P(u);function u(n,a){var l;return c(this,u),(l=o.call(this,n))._nativeContext=n,Fr.set(s(l),n),i(n)&&r.set(n,new Set),l._destination=new t(s(l),a),l._listener=e(s(l),n),l._onstatechange=null,l}return C(u,[{key:"currentTime",get:function(){return this._nativeContext.currentTime}},{key:"destination",get:function(){return this._destination}},{key:"listener",get:function(){return this._listener}},{key:"onstatechange",get:function(){return this._onstatechange},set:function(t){var e="function"==typeof t?a(this,t):null;this._nativeContext.onstatechange=e;var n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}},{key:"sampleRate",get:function(){return this._nativeContext.sampleRate}},{key:"state",get:function(){return this._nativeContext.state}}]),u}(n)}(Gu,bl,xu,wu,wl,su),xl=function(t,e,n,i,r,a){return function(o,s){var u=o.createOscillator();return vo(u,s),mo(u,s,"detune"),mo(u,s,"frequency"),void 0!==s.periodicWave?u.setPeriodicWave(s.periodicWave):po(u,s,"type"),e(n,(function(){return n(o)}))||_o(u),e(i,(function(){return i(o)}))||a(u,o),e(r,(function(){return r(o)}))||go(u),t(o,u),u}}(Nu,vu,iu,ru,au,ou),Cl=function(t,n,i,r,a){return function(){var o=new WeakMap,s=null,u=null,c=null,h=function(){var h=l(e(ia).mark((function l(h,p){var v,f,d;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=i(h),(f=aa(v,p))||(d={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,detune:v.detune.value,frequency:v.frequency.value,periodicWave:null===s?void 0:s,type:v.type},v=n(p,d),null!==u&&v.start(u),null!==c&&v.stop(c)),o.set(p,v),f){e.next=11;break}return e.next=7,r(p,h.detune,v.detune);case 7:return e.next=9,r(p,h.frequency,v.frequency);case 9:e.next=15;break;case 11:return e.next=13,t(p,h.detune,v.detune);case 13:return e.next=15,t(p,h.frequency,v.frequency);case 15:return e.next=17,a(h,p,v);case 17:return e.abrupt("return",v);case 18:case"end":return e.stop()}}),l)})));return function(t,e){return h.apply(this,arguments)}}();return{set periodicWave(t){s=t},set start(t){u=t},set stop(t){c=t},render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):h(t,e)}}}}(Bu,xl,Sa,ju,_u),El=function(t,e,n,i,r,a,o){return function(t){"use strict";O(l,t);var u=P(l);function l(t,o){var h;c(this,l);var p=r(t),v=D({},Hs,o),f=n(p,v),d=a(p),m=d?i():null,_=t.sampleRate/2;return(h=u.call(this,t,!1,f,m))._detune=e(s(h),d,f.detune,153600,-153600),h._frequency=e(s(h),d,f.frequency,_,-_),h._nativeOscillatorNode=f,h._onended=null,h._oscillatorNodeRenderer=m,null!==h._oscillatorNodeRenderer&&void 0!==v.periodicWave&&(h._oscillatorNodeRenderer.periodicWave=v.periodicWave),h}return C(l,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"onended",get:function(){return this._onended},set:function(t){var e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;var n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}},{key:"type",get:function(){return this._nativeOscillatorNode.type},set:function(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}},{key:"setPeriodicWave",value:function(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){var e=this;$r(this);var n=function(){e._nativeOscillatorNode.removeEventListener("ended",n),pa(e)&&ta(e)};this._nativeOscillatorNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}}]),l}(t)}(Au,Uu,xl,Cl,yu,wu,su),Ml=(vs=qu,function(t,e){var n=vs(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(e),n.start(),function(){n.stop(),n.disconnect(e)}}),Tl=function(t,e,n,i,r){return function(a,o){var s=o.curve,u=o.oversample,l=R(o,["curve","oversample"]),c=a.createWaveShaper(),h=a.createWaveShaper();vo(c,l),vo(h,l);var p=n(a,D({},l,{gain:1})),v=n(a,D({},l,{gain:-1})),f=n(a,D({},l,{gain:1})),d=n(a,D({},l,{gain:-1})),m=null,_=!1,g=null,y={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){p.channelCount=t,v.channelCount=t,c.channelCount=t,f.channelCount=t,h.channelCount=t,d.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){p.channelCountMode=t,v.channelCountMode=t,c.channelCountMode=t,f.channelCountMode=t,h.channelCountMode=t,d.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){p.channelInterpretation=t,v.channelInterpretation=t,c.channelInterpretation=t,f.channelInterpretation=t,h.channelInterpretation=t,d.channelInterpretation=t},get context(){return c.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)c.curve=n,h.curve=n;else{var r=n.length,o=new Float32Array(r+2-r%2),s=new Float32Array(r+2-r%2);o[0]=n[0],s[0]=-n[r-1];for(var u=Math.ceil((r+1)/2),l=(r+1)/2-1,v=1;v<u;v+=1){var f=v/u*l,d=Math.floor(f),y=Math.ceil(f);o[v]=d===y?n[d]:(1-(f-d))*n[d]+(1-(y-f))*n[y],s[v]=d===y?-n[r-1-d]:-(1-(f-d))*n[r-1-d]-(1-(y-f))*n[r-1-y]}o[u]=r%2==1?n[u-1]:(n[u-2]+n[u-1])/2,c.curve=o,h.curve=s}g=n,_&&(i(g)&&null===m?m=t(a,p):null!==m&&(m(),m=null))},get inputs(){return[p]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(t){c.oversample=t,h.oversample=t},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.removeEventListener(e[0],e[1],e[2])}};null!==s&&(y.curve=s instanceof Float32Array?s:new Float32Array(s)),u!==y.oversample&&(y.oversample=u);return r(Co(y,f),(function(){p.connect(c).connect(f),p.connect(v).connect(h).connect(d).connect(f),_=!0,i(g)&&(m=t(a,p))}),(function(){p.disconnect(c),c.disconnect(f),p.disconnect(v),v.disconnect(h),h.disconnect(d),d.disconnect(f),_=!1,null!==m&&(m(),m=null)}))}}(Ml,ro,Mo,tu,Xu),Pl=function(t,e,n,i,r,a,o){return function(s,u){var l=s.createWaveShaper();if(null!==a&&"webkitAudioContext"===a.name&&void 0===s.createGain().gain.automationRate)return n(s,u);vo(l,u);var c=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==c&&c.length<2)throw e();po(l,{curve:c},"curve"),po(l,u,"oversample");var h=null,p=!1;o(l,"curve",(function(t){return function(){return t.call(l)}}),(function(e){return function(n){return e.call(l,n),p&&(i(n)&&null===h?h=t(s,l):i(n)||null===h||(h(),h=null)),n}}));return r(l,(function(){p=!0,i(l.curve)&&(h=t(s,l))}),(function(){p=!1,null!==h&&(h(),h=null)}))}}(Ml,ro,Tl,tu,Xu,Cu,eu),Al=function(t,e,n,i,r,a,o,s,u,l){return function(c,h){var p,v,f=h.coneInnerAngle,d=h.coneOuterAngle,m=h.coneOuterGain,_=h.distanceModel,g=h.maxDistance,y=h.orientationX,b=h.orientationY,w=h.orientationZ,k=h.panningModel,x=h.positionX,C=h.positionY,E=h.positionZ,M=h.refDistance,T=h.rolloffFactor,P=R(h,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]),A=c.createPanner();if(P.channelCount>2)throw o();if("max"===P.channelCountMode)throw o();vo(A,P);var S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},V=n(c,D({},S,{channelInterpretation:"speakers",numberOfInputs:6})),O=i(c,D({},P,{gain:1})),L=i(c,D({},S,{gain:1})),I=i(c,D({},S,{gain:0})),N=i(c,D({},S,{gain:0})),F=i(c,D({},S,{gain:0})),q=i(c,D({},S,{gain:0})),j=i(c,D({},S,{gain:0})),z=r(c,256,6,1),U=a(c,D({},S,{curve:new Float32Array([1,1]),oversample:"none"})),W=[y,b,w],G=[x,C,E],K=new Float32Array(1);z.onaudioprocess=function(t){var e,n=t.inputBuffer,i=[u(n,K,0),u(n,K,1),u(n,K,2)];i.some((function(t,e){return t!==W[e]}))&&((e=A).setOrientation.apply(e,B(i)),W=i);var r,a=[u(n,K,3),u(n,K,4),u(n,K,5)];a.some((function(t,e){return t!==G[e]}))&&((r=A).setPosition.apply(r,B(a)),G=a)},Object.defineProperty(I.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(N.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(F.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(q.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(j.gain,"defaultValue",{get:function(){return 0}});var H={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,A.channelCount=t},get channelCountMode(){return A.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,A.channelCountMode=t},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,A.channelInterpretation=t},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(t){A.coneInnerAngle=t},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(t){A.coneOuterAngle=t},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();A.coneOuterGain=t},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(t){A.distanceModel=t},get inputs(){return[O]},get maxDistance(){return A.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;A.maxDistance=t},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return L.gain},get orientationY(){return I.gain},get orientationZ(){return N.gain},get panningModel(){return A.panningModel},set panningModel(t){A.panningModel=t},get positionX(){return F.gain},get positionY(){return q.gain},get positionZ(){return j.gain},get refDistance(){return A.refDistance},set refDistance(t){if(t<0)throw new RangeError;A.refDistance=t},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;A.rolloffFactor=t},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return O.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return O.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return O.removeEventListener(e[0],e[1],e[2])}};f!==H.coneInnerAngle&&(H.coneInnerAngle=f),d!==H.coneOuterAngle&&(H.coneOuterAngle=d),m!==H.coneOuterGain&&(H.coneOuterGain=m),_!==H.distanceModel&&(H.distanceModel=_),g!==H.maxDistance&&(H.maxDistance=g),y!==H.orientationX.value&&(H.orientationX.value=y),b!==H.orientationY.value&&(H.orientationY.value=b),w!==H.orientationZ.value&&(H.orientationZ.value=w),k!==H.panningModel&&(H.panningModel=k),x!==H.positionX.value&&(H.positionX.value=x),C!==H.positionY.value&&(H.positionY.value=C),E!==H.positionZ.value&&(H.positionZ.value=E),M!==H.refDistance&&(H.refDistance=M),T!==H.rolloffFactor&&(H.rolloffFactor=T),1===W[0]&&0===W[1]&&0===W[2]||(p=A).setOrientation.apply(p,B(W)),0===G[0]&&0===G[1]&&0===G[2]||(v=A).setPosition.apply(v,B(G));return l(Co(H,A),(function(){O.connect(A),t(O,U,0,0),U.connect(L).connect(V,0,0),U.connect(I).connect(V,0,1),U.connect(N).connect(V,0,2),U.connect(F).connect(V,0,3),U.connect(q).connect(V,0,4),U.connect(j).connect(V,0,5),V.connect(z).connect(c.destination)}),(function(){O.disconnect(A),s(O,U,0,0),U.disconnect(L),L.disconnect(V),U.disconnect(I),I.disconnect(V),U.disconnect(N),N.disconnect(V),U.disconnect(F),F.disconnect(V),U.disconnect(q),q.disconnect(V),U.disconnect(j),j.disconnect(V),V.disconnect(z),z.disconnect(c.destination)}))}}(Ea,ro,Qu,Mo,Ws,Pl,Gs,Aa,Js,Xu),Sl=(fs=Al,function(t,e){var n=t.createPanner();return void 0===n.orientationX?fs(t,e):(vo(n,e),mo(n,e,"orientationX"),mo(n,e,"orientationY"),mo(n,e,"orientationZ"),mo(n,e,"positionX"),mo(n,e,"positionY"),mo(n,e,"positionZ"),po(n,e,"coneInnerAngle"),po(n,e,"coneOuterAngle"),po(n,e,"coneOuterGain"),po(n,e,"distanceModel"),po(n,e,"maxDistance"),po(n,e,"panningModel"),po(n,e,"refDistance"),po(n,e,"rolloffFactor"),n)}),Vl=function(t,n,i,r,a,o,s,u,c,h){return function(){var p,v=new WeakMap,f=null,d=(p=l(e(ia).mark((function p(d,m){var _,g,y,b,w,k,x,C,E,M,T,P,A,S,V,O,R,L,I,N;return e(ia).wrap((function(p){for(;;)switch(p.prev=p.next){case 0:if(_=null,g=o(d),y={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},b=D({},y,{coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor}),w=aa(g,m),"bufferSize"in g?_=r(m,D({},y,{gain:1})):w||(k=D({},b,{orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value}),g=a(m,k)),v.set(m,null===_?g:_),null===_){p.next=31;break}if(null!==f){p.next=15;break}if(null!==s){p.next=11;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 11:x=new s(6,d.context.length,m.sampleRate),(C=n(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(x.destination),f=l(e(ia).mark((function t(){var n,r;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(function(){var t=l(e(ia).mark((function t(n,r){var a;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0}),t.next=3,u(x,n,a.offset);case 3:return t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:for(n=t.sent,r=0;r<6;r+=1)n[r].connect(C,0,r),n[r].start(0);return t.abrupt("return",h(x));case 5:case"end":return t.stop()}}),t)})))();case 15:return p.next=17,f;case 17:return E=p.sent,M=r(m,D({},y,{gain:1})),p.next=21,c(d,m,M);case 21:for(T=[],P=0;P<E.numberOfChannels;P+=1)T.push(E.getChannelData(P));for(A=[T[0][0],T[1][0],T[2][0]],S=[T[3][0],T[4][0],T[5][0]],V=r(m,D({},y,{gain:1})),O=a(m,D({},b,{orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:S[0],positionY:S[1],positionZ:S[2]})),M.connect(V).connect(O.inputs[0]),O.connect(_),R=128;R<E.length;R+=128)L=[T[0][R],T[1][R],T[2][R]],I=[T[3][R],T[4][R],T[5][R]],(L.some((function(t,e){return t!==A[e]}))||I.some((function(t,e){return t!==S[e]})))&&(A=L,S=I,N=R/m.sampleRate,V.gain.setValueAtTime(0,N),V=r(m,D({},y,{gain:0})),O=a(m,D({},b,{orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:S[0],positionY:S[1],positionZ:S[2]})),V.gain.setValueAtTime(1,N),M.connect(V).connect(O.inputs[0]),O.connect(_));return p.abrupt("return",_);case 31:if(w){p.next=46;break}return p.next=34,u(m,d.orientationX,g.orientationX);case 34:return p.next=36,u(m,d.orientationY,g.orientationY);case 36:return p.next=38,u(m,d.orientationZ,g.orientationZ);case 38:return p.next=40,u(m,d.positionX,g.positionX);case 40:return p.next=42,u(m,d.positionY,g.positionY);case 42:return p.next=44,u(m,d.positionZ,g.positionZ);case 44:p.next=58;break;case 46:return p.next=48,t(m,d.orientationX,g.orientationX);case 48:return p.next=50,t(m,d.orientationY,g.orientationY);case 50:return p.next=52,t(m,d.orientationZ,g.orientationZ);case 52:return p.next=54,t(m,d.positionX,g.positionX);case 54:return p.next=56,t(m,d.positionY,g.positionY);case 56:return p.next=58,t(m,d.positionZ,g.positionZ);case 58:if(!Ca(g)){p.next=63;break}return p.next=61,c(d,m,g.inputs[0]);case 61:p.next=65;break;case 63:return p.next=65,c(d,m,g);case 65:return p.abrupt("return",g);case 66:case"end":return p.stop()}}),p)}))),function(t,e){return p.apply(this,arguments)});return{render:function(t,e){var n=v.get(e);return void 0!==n?Promise.resolve(n):d(t,e)}}}}(Bu,Qu,il,Mo,Sl,Sa,bu,ju,_u,_l),Ol=function(t,e,n,i,r,a,o){return function(t){"use strict";O(l,t);var u=P(l);function l(t,h){var p;c(this,l);var v=r(t),f=D({},Ys,h),d=n(v,f),m=a(v),_=m?i():null;return(p=u.call(this,t,!1,d,_))._nativePannerNode=d,p._orientationX=e(s(p),m,d.orientationX,ha,ca),p._orientationY=e(s(p),m,d.orientationY,ha,ca),p._orientationZ=e(s(p),m,d.orientationZ,ha,ca),p._positionX=e(s(p),m,d.positionX,ha,ca),p._positionY=e(s(p),m,d.positionY,ha,ca),p._positionZ=e(s(p),m,d.positionZ,ha,ca),o(s(p),1),p}return C(l,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(t){this._nativePannerNode.coneInnerAngle=t}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(t){this._nativePannerNode.coneOuterAngle=t}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(t){this._nativePannerNode.coneOuterGain=t}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(t){this._nativePannerNode.distanceModel=t}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(t){this._nativePannerNode.maxDistance=t}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(t){this._nativePannerNode.panningModel=t}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(t){this._nativePannerNode.refDistance=t}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(t){this._nativePannerNode.rolloffFactor=t}}]),l}(t)}(Au,Uu,Sl,Vl,yu,wu,Hu),Dl=function(t){return function(e,n){var i=n.disableNormalization,r=n.imag,a=n.real,o=r instanceof Float32Array?r:new Float32Array(r),s=a instanceof Float32Array?a:new Float32Array(a),u=e.createPeriodicWave(s,o,{disableNormalization:i});if(Array.from(r).length<2)throw t();return u}}(sa),Rl=function(t,e,n,i){var r;return r=Symbol.hasInstance,function(){"use strict";function a(r,o){c(this,a);var s=e(r),u=i(D({},Xs,o)),l=t(s,u);return n.add(l),l}return C(a,null,[{key:r,value:function(t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===a.prototype||n.has(t)}}]),a}()}(Dl,yu,new WeakSet,(function(t){var e=t.imag,n=t.real;return D({},t,void 0===e?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:e,real:Array.from(e,(function(){return 0}))}:{imag:e,real:n})})),Ll=function(t,e,n,i,r,a){var o=16385,s=new Float32Array([1,1]),u=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c=D({},l,{oversample:"none"}),h=function(t,a,h,p,v){if(1===a)return function(t,e,r,a){for(var h=new Float32Array(o),p=new Float32Array(o),v=0;v<o;v+=1){var f=v/16384*u;h[v]=Math.cos(f),p[v]=Math.sin(f)}var d=n(t,D({},l,{gain:0})),m=i(t,D({},c,{curve:h})),_=i(t,D({},c,{curve:s})),g=n(t,D({},l,{gain:0})),y=i(t,D({},c,{curve:p}));return{connectGraph:function(){e.connect(d),e.connect(void 0===_.inputs?_:_.inputs[0]),e.connect(g),_.connect(r),r.connect(void 0===m.inputs?m:m.inputs[0]),r.connect(void 0===y.inputs?y:y.inputs[0]),m.connect(d.gain),y.connect(g.gain),d.connect(a,0,0),g.connect(a,0,1)},disconnectGraph:function(){e.disconnect(d),e.disconnect(void 0===_.inputs?_:_.inputs[0]),e.disconnect(g),_.disconnect(r),r.disconnect(void 0===m.inputs?m:m.inputs[0]),r.disconnect(void 0===y.inputs?y:y.inputs[0]),m.disconnect(d.gain),y.disconnect(g.gain),d.disconnect(a,0,0),g.disconnect(a,0,1)}}}(t,h,p,v);if(2===a)return function(t,r,a,h){for(var p=new Float32Array(o),v=new Float32Array(o),f=new Float32Array(o),d=new Float32Array(o),m=Math.floor(8192.5),_=0;_<o;_+=1)if(_>m){var g=(_-m)/(16384-m)*u;p[_]=Math.cos(g),v[_]=Math.sin(g),f[_]=0,d[_]=1}else{var y=_/(16384-m)*u;p[_]=1,v[_]=0,f[_]=Math.cos(y),d[_]=Math.sin(y)}var b=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),w=n(t,D({},l,{gain:0})),k=i(t,D({},c,{curve:p})),x=n(t,D({},l,{gain:0})),C=i(t,D({},c,{curve:v})),E=i(t,D({},c,{curve:s})),M=n(t,D({},l,{gain:0})),T=i(t,D({},c,{curve:f})),P=n(t,D({},l,{gain:0})),A=i(t,D({},c,{curve:d}));return{connectGraph:function(){r.connect(b),r.connect(void 0===E.inputs?E:E.inputs[0]),b.connect(w,0),b.connect(x,0),b.connect(M,1),b.connect(P,1),E.connect(a),a.connect(void 0===k.inputs?k:k.inputs[0]),a.connect(void 0===C.inputs?C:C.inputs[0]),a.connect(void 0===T.inputs?T:T.inputs[0]),a.connect(void 0===A.inputs?A:A.inputs[0]),k.connect(w.gain),C.connect(x.gain),T.connect(M.gain),A.connect(P.gain),w.connect(h,0,0),M.connect(h,0,0),x.connect(h,0,1),P.connect(h,0,1)},disconnectGraph:function(){r.disconnect(b),r.disconnect(void 0===E.inputs?E:E.inputs[0]),b.disconnect(w,0),b.disconnect(x,0),b.disconnect(M,1),b.disconnect(P,1),E.disconnect(a),a.disconnect(void 0===k.inputs?k:k.inputs[0]),a.disconnect(void 0===C.inputs?C:C.inputs[0]),a.disconnect(void 0===T.inputs?T:T.inputs[0]),a.disconnect(void 0===A.inputs?A:A.inputs[0]),k.disconnect(w.gain),C.disconnect(x.gain),T.disconnect(M.gain),A.disconnect(P.gain),w.disconnect(h,0,0),M.disconnect(h,0,0),x.disconnect(h,0,1),P.disconnect(h,0,1)}}}(t,h,p,v);throw r()};return function(e,i){var o=i.channelCount,s=i.channelCountMode,u=i.pan,l=R(i,["channelCount","channelCountMode","pan"]);if("max"===s)throw r();var c=t(e,D({},l,{channelCount:1,channelCountMode:s,numberOfInputs:2})),p=n(e,D({},l,{channelCount:o,channelCountMode:s,gain:1})),v=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),f=h(e,o,p,v,c),d=f.connectGraph,m=f.disconnectGraph;Object.defineProperty(v.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(v.gain,"maxValue",{get:function(){return 1}}),Object.defineProperty(v.gain,"minValue",{get:function(){return-1}});var _={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(t){var n;p.channelCount!==t&&(g&&m(),n=h(e,t,p,v,c),d=n.connectGraph,m=n.disconnectGraph,g&&d());p.channelCount=t},get channelCountMode(){return p.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();p.channelCountMode=t},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(t){p.channelInterpretation=t},get context(){return p.context},get inputs(){return[p]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get pan(){return v.gain},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p.removeEventListener(e[0],e[1],e[2])}},g=!1;return a(Co(_,c),(function(){d(),g=!0}),(function(){m(),g=!1}))}}(Qu,xo,Mo,Pl,Gs,Xu),Il=function(t,e){return function(n,i){var r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);var a=n.createStereoPanner();return vo(a,i),mo(a,i,"pan"),Object.defineProperty(a,"channelCountMode",{get:function(){return r},set:function(t){if(t!==r)throw e()}}),a}}(Ll,Gs),Nl=function(t,n,i,r,a){return function(){var o=new WeakMap,s=function(){var s=l(e(ia).mark((function s(u,l){var c,h,p;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i(u),(h=aa(c,l))||(p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value},c=n(l,p)),o.set(l,c),h){e.next=9;break}return e.next=7,r(l,u.pan,c.pan);case 7:e.next=11;break;case 9:return e.next=11,t(l,u.pan,c.pan);case 11:if(!Ca(c)){e.next=16;break}return e.next=14,a(u,l,c.inputs[0]);case 14:e.next=18;break;case 16:return e.next=18,a(u,l,c);case 18:return e.abrupt("return",c);case 19:case"end":return e.stop()}}),s)})));return function(t,e){return s.apply(this,arguments)}}();return{render:function(t,e){var n=o.get(e);return void 0!==n?Promise.resolve(n):s(t,e)}}}}(Bu,Il,Sa,ju,_u),Fl=function(t,e,n,i,r,a){return function(t){"use strict";O(u,t);var o=P(u);function u(t,l){var h;c(this,u);var p=r(t),v=D({},Zs,l),f=n(p,v),d=a(p),m=d?i():null;return(h=o.call(this,t,!1,f,m))._pan=e(s(h),d,f.pan),h}return C(u,[{key:"pan",get:function(){return this._pan}}]),u}(t)}(Au,Uu,Il,Nl,yu,wu),Bl=function(t,n,i){return function(){var r=new WeakMap,a=function(){var a=l(e(ia).mark((function a(o,s){var u,l;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n(o),aa(u,s)||(l={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample},u=t(s,l)),r.set(s,u),!Ca(u)){e.next=9;break}return e.next=7,i(o,s,u.inputs[0]);case 7:e.next=11;break;case 9:return e.next=11,i(o,s,u);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}();return{render:function(t,e){var n=r.get(e);return void 0!==n?Promise.resolve(n):a(t,e)}}}}(Pl,Sa,_u),ql=function(t,e,n,i,r,a,o){return function(t){"use strict";O(l,t);var u=P(l);function l(t,e){var h;c(this,l);var p=r(t),v=D({},$s,e),f=n(p,v),d=a(p)?i():null;return(h=u.call(this,t,!0,f,d))._isCurveNullified=!1,h._nativeWaveShaperNode=f,o(s(h),1),h}return C(l,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(t){this._nativeWaveShaperNode.oversample=t}}]),l}(t)}(Au,ro,Pl,Bl,yu,wu,Hu),jl=function(t){return null!==t&&t.isSecureContext}(fu),zl=function(t){return function(e,n,i){Object.defineProperties(t,{currentFrame:{configurable:!0,get:function(){return Math.round(e*n)}},currentTime:{configurable:!0,get:function(){return e}}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}}}(fu),Ul=new WeakMap,Wl=function(t,e){return function(n){var i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i}}(Ul,bu),Gl=jl?function(t,e,n,i,r,a,o,s,u,l,h,p,v){var f=0;return function(d,m){var _=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},g=h.get(d);if(void 0!==g&&g.has(m))return Promise.resolve();var y=l.get(d);if(void 0!==y){var b=y.get(m);if(void 0!==b)return b}var w=a(d),k=void 0===w.audioWorklet?r(m).then((function(t){var e=F(t,2),i=e[0],r=e[1],a=F(Gr(i,r),2),o=a[0],s=a[1],u="".concat(o,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(s,"\n})})(window,'_AWGS')");return n(u)})).then((function(){var t=v._AWGS.pop();if(void 0===t)throw new SyntaxError;i(w.currentTime,w.sampleRate,(function(){return t((function t(){"use strict";c(this,t)}),void 0,(function(t,n){if(""===t.trim())throw e();var i=jr.get(w);if(void 0!==i){if(i.has(t))throw e();Hr(n),Kr(n.parameterDescriptors),i.set(t,n)}else Hr(n),Kr(n.parameterDescriptors),jr.set(w,new Map([[t,n]]))}),w.sampleRate,void 0,void 0)}))})):Promise.all([r(m),Promise.resolve(t(p,p))]).then((function(t){var e=F(t,2),n=F(e[0],2),i=n[0],r=n[1],a=e[1],l=f+1;f=l;var c=F(Gr(i,r),2),h=c[0],p=c[1],v=a?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",d=a?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));",m=a?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));",g="".concat(h,";((AudioWorkletProcessor,registerProcessor)=>{").concat(p,"\n})(").concat(v,",(n,p)=>registerProcessor(n,class extends p{").concat(d,"process(i,o,p){").concat(m,"return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(l,"',class extends AudioWorkletProcessor{process(){return !1}})"),y=new Blob([g],{type:"application/javascript; charset=utf-8"}),b=URL.createObjectURL(y);return w.audioWorklet.addModule(b,_).then((function(){if(s(w))return w;var t=o(w);return t.audioWorklet.addModule(b,_).then((function(){return t}))})).then((function(t){if(null===u)throw new SyntaxError;try{new u(t,"__sac".concat(l))}catch(t){throw new SyntaxError}})).finally((function(){return URL.revokeObjectURL(b)}))}));return void 0===y?l.set(d,new Map([[m,k]])):y.set(m,k),k.then((function(){var t=h.get(d);void 0===t?h.set(d,new Set([m])):t.add(m)})).finally((function(){var t=l.get(d);void 0!==t&&t.delete(m)})),k}}(vu,Gs,function(t){return function(e){return new Promise((function(n,i){if(null!==t){var r=t.document.head;if(null===r)i(new SyntaxError);else{var a=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),s=URL.createObjectURL(o),u=t.onerror,l=function(){t.onerror=u,URL.revokeObjectURL(s)};t.onerror=function(e,n,r,a,o){return n===s||n===t.location.href&&1===r&&1===a?(l(),i(o),!1):null!==u?u(e,n,r,a,o):void 0},a.onerror=function(){l(),i(new SyntaxError)},a.onload=function(){l(),n()},a.src=s,a.type="module",r.appendChild(a)}}else i(new SyntaxError)}))}}(fu),zl,(ds=function(){return new DOMException("","AbortError")},function(){var t=l(e(ia).mark((function t(n){var i;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n);case 3:if(!(i=t.sent).ok){t.next=10;break}return t.next=7,i.text();case 7:return t.t0=t.sent,t.t1=i.url,t.abrupt("return",[t.t0,t.t1]);case 10:t.next=14;break;case 12:t.prev=12,t.t2=t.catch(0);case 14:throw ds();case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()),yu,Wl,wu,Pu,new WeakMap,new WeakMap,function(t,n){return l(e(ia).mark((function i(){var r,a,o,s,u,l,c;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=2;break}return e.abrupt("return",!0);case 2:if(null!==n){e.next=4;break}return e.abrupt("return",!1);case 4:return r=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),a=new n(1,128,44100),o=URL.createObjectURL(r),s=!1,u=!1,e.prev=9,e.next=12,a.audioWorklet.addModule(o);case 12:return l=new t(a,"a",{numberOfOutputs:0}),c=a.createOscillator(),l.port.onmessage=function(){return s=!0},l.onprocessorerror=function(){return u=!0},c.connect(l),c.start(0),e.next=20,a.startRendering();case 20:e.next=24;break;case 22:e.prev=22,e.t0=e.catch(9);case 24:return e.prev=24,URL.revokeObjectURL(o),e.finish(24);case 27:return e.abrupt("return",s&&!u);case 28:case"end":return e.stop()}}),i,null,[[9,22,24,27]])})))}(Pu,bu),fu):void 0,Kl=function(t,e){return function(n){return t(n)||e(n)}}(Eu,wu),Hl=function(t,n,i,r,a,o,s,u,c,h,p){return function(v,f){var d=s(v)?v:o(v);if(a.has(f)){var m=i();return Promise.reject(m)}try{a.add(f)}catch(t){}return n(c,(function(){return c(d)}))?d.decodeAudioData(f).then((function(e){return Ja(f).catch((function(){})),n(u,(function(){return u(e)}))||p(e),t.add(e),e})):new Promise((function(n,i){var a=function(){var t=l(e(ia).mark((function t(){return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ja(f);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),o=function(t){i(t),a()};try{d.decodeAudioData(f,(function(e){"function"!=typeof e.copyFromChannel&&(h(e),ua(e)),t.add(e),a().then((function(){return n(e)}))}),(function(t){o(null===t?r():t)}))}catch(t){o(t)}}))}}(Vu,vu,(function(){return new DOMException("","DataCloneError")}),(function(){return new DOMException("","EncodingError")}),new WeakSet,yu,Kl,oa,co,Ru,Lu),Yl=(ms=Gl,_s=Su,gs=Iu,ys=Wu,bs=Yu,ws=Ju,ks=el,xs=al,Cs=ul,Es=Hl,Ms=cl,Ts=vl,Ps=dl,As=yl,Ss=El,Vs=Ol,Os=Rl,Ds=Fl,Rs=ql,function(t){"use strict";O(n,t);var e=P(n);function n(t,i){var r;return c(this,n),(r=e.call(this,t,i))._nativeContext=t,r._audioWorklet=void 0===ms?void 0:{addModule:function(t,e){return ms(s(r),t,e)}},r}return C(n,[{key:"audioWorklet",get:function(){return this._audioWorklet}},{key:"createAnalyser",value:function(){return new _s(this)}},{key:"createBiquadFilter",value:function(){return new bs(this)}},{key:"createBuffer",value:function(t,e,n){return new gs({length:e,numberOfChannels:t,sampleRate:n})}},{key:"createBufferSource",value:function(){return new ys(this)}},{key:"createChannelMerger",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new ws(this,{numberOfInputs:t})}},{key:"createChannelSplitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new ks(this,{numberOfOutputs:t})}},{key:"createConstantSource",value:function(){return new xs(this)}},{key:"createConvolver",value:function(){return new Cs(this)}},{key:"createDelay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Ms(this,{maxDelayTime:t})}},{key:"createDynamicsCompressor",value:function(){return new Ts(this)}},{key:"createGain",value:function(){return new Ps(this)}},{key:"createIIRFilter",value:function(t,e){return new As(this,{feedback:e,feedforward:t})}},{key:"createOscillator",value:function(){return new Ss(this)}},{key:"createPanner",value:function(){return new Vs(this)}},{key:"createPeriodicWave",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1};return new Os(this,D({},n,{imag:e,real:t}))}},{key:"createStereoPanner",value:function(){return new Ds(this)}},{key:"createWaveShaper",value:function(){return new Rs(this)}},{key:"decodeAudioData",value:function(t,e,n){return Es(this._nativeContext,t).then((function(t){return"function"==typeof e&&e(t),t}),(function(t){throw"function"==typeof n&&n(t),t}))}}]),n}(kl)),Xl=function(t,e,n,i){return function(t){"use strict";O(a,t);var r=P(a);function a(t,o){var s;c(this,a);var u=n(t),l=e(u,o);if(i(u))throw TypeError();return(s=r.call(this,t,!0,l,null))._nativeMediaElementAudioSourceNode=l,s}return C(a,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}]),a}(t)}(Au,(function(t,e){return t.createMediaElementSource(e.mediaElement)}),yu,wu),Zl=function(t,e,n,i){return function(t){"use strict";O(a,t);var r=P(a);function a(t,o){var s;c(this,a);var u=n(t);if(i(u))throw new TypeError;var l=D({},lo,o),h=e(u,l);return(s=r.call(this,t,!1,h,null))._nativeMediaStreamAudioDestinationNode=h,s}return C(a,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}]),a}(t)}(Au,(function(t,e){var n=t.createMediaStreamDestination();return vo(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}),yu,wu),Ql=function(t,e,n,i){return function(t){"use strict";O(a,t);var r=P(a);function a(t,o){var s;c(this,a);var u=n(t),l=e(u,o);if(i(u))throw new TypeError;return(s=r.call(this,t,!0,l,null))._nativeMediaStreamAudioSourceNode=l,s}return C(a,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}]),a}(t)}(Au,(function(t,e){var n=e.mediaStream,i=n.getAudioTracks();i.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}));var r=i.slice(0,1),a=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(a,"mediaStream",{value:n}),a}),yu,wu),$l=function(t,e){return function(n,i){var r=i.mediaStreamTrack;if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);var a=new MediaStream([r]),o=n.createMediaStreamSource(a);if("audio"!==r.kind)throw t();if(e(n))throw new TypeError;return o}}(ro,wu),Jl=function(t,e,n){return function(t){"use strict";O(r,t);var i=P(r);function r(t,a){c(this,r);var o=n(t),s=e(o,a);return i.call(this,t,!0,s,null)}return r}(t)}(Au,$l,yu),tc=function(t,e,n,i,r,a,o,s,u){return function(t){"use strict";O(h,t);var l=P(h);function h(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(c(this,h),null===u)throw new Error("Missing the native AudioContext constructor.");try{e=new u(r)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!ga(r.latencyHint))throw new TypeError("The provided value '".concat(r.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==r.sampleRate&&e.sampleRate!==r.sampleRate)throw n();t=l.call(this,e,2);var a=r.latencyHint,o=e.sampleRate;if(t._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===a?512/o:"interactive"===a||void 0===a?256/o:"playback"===a?1024/o:128*Math.max(2,Math.min(128,Math.round(a*o/128)))/o,t._nativeAudioContext=e,"webkitAudioContext"===u.name?(t._nativeGainNode=e.createGain(),t._nativeOscillatorNode=e.createOscillator(),t._nativeGainNode.gain.value=1e-37,t._nativeOscillatorNode.connect(t._nativeGainNode).connect(e.destination),t._nativeOscillatorNode.start()):(t._nativeGainNode=null,t._nativeOscillatorNode=null),t._state=null,"running"===e.state){t._state="suspended";var s=function(){"suspended"===t._state&&(t._state=null),e.removeEventListener("statechange",s)};e.addEventListener("statechange",s)}return t}return C(h,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var t=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==t._nativeGainNode&&null!==t._nativeOscillatorNode&&(t._nativeOscillatorNode.stop(),t._nativeGainNode.disconnect(),t._nativeOscillatorNode.disconnect()),_a(t)})))}},{key:"createMediaElementSource",value:function(t){return new r(this,{mediaElement:t})}},{key:"createMediaStreamDestination",value:function(){return new a(this)}},{key:"createMediaStreamSource",value:function(t){return new o(this,{mediaStream:t})}},{key:"createMediaStreamTrackSource",value:function(t){return new s(this,{mediaStreamTrack:t})}},{key:"resume",value:function(){var t=this;return"suspended"===this._state?new Promise((function(e,n){var i=t,r=function(){i._nativeAudioContext.removeEventListener("statechange",r),"running"===i._nativeAudioContext.state?e():i.resume().then(e,n)};t._nativeAudioContext.addEventListener("statechange",r)})):this._nativeAudioContext.resume().catch((function(t){if(void 0===t||15===t.code)throw e();throw t}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(t){if(void 0===t)throw e();throw t}))}}]),h}(t)}(Yl,ro,Gs,Qs,Xl,Zl,Ql,Jl,Cu),ec=(Ls=wl,function(t){var e=Ls.get(t);if(void 0===e)throw new Error("The context has no set of AudioWorkletNodes.");return e}),nc=(Is=ec,function(t,e){Is(t).add(e)}),ic=function(t){return function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e[i];if(void 0===a)throw t();return Ia(n)?a.connect(n,0,r):a.connect(n,0)}}(sa),rc=function(t){return function(e,n){t(e).delete(n)}}(ec),ac=function(t){return function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?e.forEach((function(t){return t.disconnect()})):"number"==typeof n?eo(t,e,n).disconnect():Ia(n)?void 0===i?e.forEach((function(t){return t.disconnect(n)})):void 0===r?eo(t,e,i).disconnect(n,0):eo(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((function(t){return t.disconnect(n)})):eo(t,e,i).disconnect(n,0)}}(sa),oc=new WeakMap,sc=(Ns=oc,Fs=Yr,function(t){return Fs(Ns,t)}),uc=function(t,e,n,i,r,a,o,s,u,l,c,h,p){return function(v,f,d,m){if(0===m.numberOfInputs&&0===m.numberOfOutputs)throw u();var _=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(_.some((function(t){return t<1})))throw u();if(_.length!==m.numberOfOutputs)throw e();if("explicit"!==m.channelCountMode)throw u();var g=m.channelCount*m.numberOfInputs,y=_.reduce((function(t,e){return t+e}),0),b=void 0===d.parameterDescriptors?0:d.parameterDescriptors.length;if(g+b>6||y>6)throw u();for(var w=new MessageChannel,k=[],x=[],C=0;C<m.numberOfInputs;C+=1)k.push(o(v,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),x.push(r(v,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));var E=[],M=!0,T=!1,P=void 0;if(void 0!==d.parameterDescriptors)try{for(var S,V=function(t,e){var n=e.value,i=n.defaultValue,r=n.maxValue,o=n.minValue,s=n.name,u=a(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==m.parameterData[s]?m.parameterData[s]:void 0===i?0:i});Object.defineProperties(u.offset,{defaultValue:{get:function(){return void 0===i?0:i}},maxValue:{get:function(){return void 0===r?ha:r}},minValue:{get:function(){return void 0===o?ca:o}}}),E.push(u)},O=d.parameterDescriptors[Symbol.iterator]();!(M=(S=O.next()).done);M=!0)V(0,S)}catch(t){T=!0,P=t}finally{try{M||null==O.return||O.return()}finally{if(T)throw P}}for(var R=i(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,g+b)}),L=yo(f,v.sampleRate),I=s(v,L,g+b,Math.max(1,y)),N=r(v,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),F=[],B=0;B<m.numberOfOutputs;B+=1)F.push(i(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[B]}));for(var q=0;q<m.numberOfInputs;q+=1){k[q].connect(x[q]);for(var j=0;j<m.channelCount;j+=1)x[q].connect(R,j,q*m.channelCount+j)}var z=new qa(void 0===d.parameterDescriptors?[]:d.parameterDescriptors.map((function(t,e){var n=t.name,i=E[e];return i.connect(R,0,g+e),i.start(0),[n,i.offset]})));R.connect(I);var U,W,G=m.channelInterpretation,K=null,H=0===m.numberOfOutputs?[I]:F,Y={get bufferSize(){return L},get channelCount(){return m.channelCount},set channelCount(t){throw n()},get channelCountMode(){return m.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return G},set channelInterpretation(t){var e=!0,n=!1,i=void 0;try{for(var r,a=k[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.channelInterpretation=t}}catch(t){n=!0,i=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}G=t},get context(){return I.context},get inputs(){return k},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return K},set onprocessorerror(t){"function"==typeof K&&Y.removeEventListener("processorerror",K),"function"==typeof(K="function"==typeof t?t:null)&&Y.addEventListener("processorerror",K)},get parameters(){return z},get port(){return w.port2},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return I.addEventListener(e[0],e[1],e[2])},connect:t.bind(null,H),disconnect:l.bind(null,H),dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return I.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return I.removeEventListener(e[0],e[1],e[2])}},X=new Map;w.port1.addEventListener=(U=w.port1.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==i){var r=X.get(e[1]);void 0!==r?e[1]=r:(e[1]=function(t){c(v.currentTime,v.sampleRate,(function(){return i(t)}))},X.set(i,e[1]))}}return U.call(w.port1,e[0],e[1],e[2])}),w.port1.removeEventListener=(W=w.port1.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i=X.get(e[1]);void 0!==i&&(X.delete(e[1]),e[1]=i)}return W.call(w.port1,e[0],e[1],e[2])});var Z=null;Object.defineProperty(w.port1,"onmessage",{get:function(){return Z},set:function(t){"function"==typeof Z&&w.port1.removeEventListener("message",Z),"function"==typeof(Z="function"==typeof t?t:null)&&(w.port1.addEventListener("message",Z),w.port1.start())}}),d.prototype.port=w.port1;var Q=null,$=function(t,e,n,i){var r=zr.get(t);void 0===r&&(r=new WeakMap,zr.set(t,r));var a=wo(n,i);return r.set(e,a),a}(v,Y,d,m);$.then((function(t){return Q=t}));var J=Ga(m.numberOfInputs,m.channelCount),tt=Ga(m.numberOfOutputs,_),et=void 0===d.parameterDescriptors?[]:d.parameterDescriptors.reduce((function(t,e){return D({},t,A({},e.name,new Float32Array(128)))}),{}),nt=!0,it=function(){m.numberOfOutputs>0&&I.disconnect(N);for(var t=0,e=0;t<m.numberOfOutputs;t+=1){for(var n=F[t],i=0;i<_[t];i+=1)N.disconnect(n,e+i,i);e+=_[t]}},rt=new Map;I.onaudioprocess=function(t){var e=t.inputBuffer,n=t.outputBuffer;if(null!==Q)for(var i=function(t){for(var i=0;i<m.numberOfInputs;i+=1)for(var a=0;a<m.channelCount;a+=1)za(e,J[i],a,a,t);void 0!==d.parameterDescriptors&&d.parameterDescriptors.forEach((function(n,i){var r=n.name;za(e,et,r,g+i,t)}));for(var o=0;o<m.numberOfInputs;o+=1)for(var s=0;s<_[o];s+=1)0===tt[o][s].byteLength&&(tt[o][s]=new Float32Array(128));try{var u=J.map((function(t,e){if(r[e].size>0)return rt.set(e,L/128),t;var n=rt.get(e);return void 0===n?[]:(t.every((function(t){return t.every((function(t){return 0===t}))}))&&(1===n?rt.delete(e):rt.set(e,n-1)),t)})),l=c(v.currentTime+t/v.sampleRate,v.sampleRate,(function(){return Q.process(u,tt,et)}));nt=l;for(var h=0,p=0;h<m.numberOfOutputs;h+=1){for(var f=0;f<_[h];f+=1)Wa(n,tt[h],f,p+f,t);p+=_[h]}}catch(t){nt=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!nt){for(var y=0;y<m.numberOfInputs;y+=1){k[y].disconnect(x[y]);for(var b=0;b<m.channelCount;b+=1)x[t].disconnect(R,b,y*m.channelCount+b)}if(void 0!==d.parameterDescriptors)for(var w=d.parameterDescriptors.length,C=0;C<w;C+=1){var M=E[C];M.disconnect(R,0,g+C),M.stop()}return R.disconnect(I),I.onaudioprocess=null,at?it():ut(),"break"}},r=h(Y),a=0;a<L;a+=128){if("break"===i(a))break}};var at=!1,ot=o(v,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),st=function(){return I.connect(ot).connect(v.destination)},ut=function(){I.disconnect(ot),ot.disconnect()};return st(),p(Y,(function(){if(nt){ut(),m.numberOfOutputs>0&&I.connect(N);for(var t=0,e=0;t<m.numberOfOutputs;t+=1){for(var n=F[t],i=0;i<_[t];i+=1)N.connect(n,e+i,i);e+=_[t]}}at=!0}),(function(){nt&&(st(),it()),at=!1}))}}(ic,sa,ro,Qu,xo,il,Mo,Ws,Gs,ac,zl,sc,Xu),lc=function(t,e,n,i,r){return function(a,o,s,u,l,c){if(null!==s)try{var h=new s(a,u,c),p=new Map,v=null;if(Object.defineProperties(h,{channelCount:{get:function(){return c.channelCount},set:function(){throw t()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw t()}},onprocessorerror:{get:function(){return v},set:function(t){"function"==typeof v&&h.removeEventListener("processorerror",v),"function"==typeof(v="function"==typeof t?t:null)&&h.addEventListener("processorerror",v)}}}),h.addEventListener=(m=h.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;if("processorerror"===e[0]){var r="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==r){var a=p.get(e[1]);void 0!==a?e[1]=a:(e[1]=function(t){"error"===t.type?(Object.defineProperties(t,{type:{value:"processorerror"}}),r(t)):r(new ErrorEvent(e[0],D({},t)))},p.set(r,e[1]))}}return m.call(h,"error",e[1],e[2]),(i=m).call.apply(i,[h].concat(B(e)))}),h.removeEventListener=(d=h.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("processorerror"===e[0]){var i=p.get(e[1]);void 0!==i&&(p.delete(e[1]),e[1]=i)}return d.call(h,"error",e[1],e[2]),d.call(h,e[0],e[1],e[2])}),0!==c.numberOfOutputs){var f=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});h.connect(f).connect(a.destination);return r(h,(function(){return f.disconnect()}),(function(){return f.connect(a.destination)}))}return h}catch(t){if(11===t.code)throw i();throw t}var d,m;if(void 0===l)throw i();return function(t){var e=(new MessageChannel).port1;try{e.postMessage(t)}finally{e.close()}}(c),e(a,o,l,c)}}(ro,uc,Mo,Gs,Xu),cc=function(t,n,i,r,a,o,s,u,c,h,p,v,f,d,m,_){return function(g,y,b){var w,k=new WeakMap,x=null,C=(w=l(e(ia).mark((function u(w,C){var E,M,T,P,A,S,V,O,D,R,L,I,N,B,q,j,z,U,W,G,K,H,Y,X,Z,Q,$,J,tt,et,nt,it,rt,at,ot,st,ut,lt,ct;return e(ia).wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(E=p(w),M=null,T=aa(E,C),P=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount),null===v){for(A=P.reduce((function(t,e){return t+e}),0),S=a(C,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),V=[],O=0;O<w.numberOfOutputs;O+=1)V.push(r(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[O]}));(D=s(C,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})).connect=n.bind(null,V),D.disconnect=c.bind(null,V),M=[S,V,D]}else T||(E=new v(C,g));if(k.set(C,null===M?E:M[2]),null===M){u.next=41;break}if(null!==x){u.next=32;break}if(void 0!==b){u.next=10;break}throw new Error("Missing the processor constructor.");case 10:if(null!==f){u.next=12;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 12:if(R=w.channelCount*w.numberOfInputs,L=void 0===b.parameterDescriptors?0:b.parameterDescriptors.length,I=R+L,N=function(){var t=l(e(ia).mark((function t(){var n,i,u,c,h,p,v,g,b,k,x,E,M,T,P,A;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=new f(I,128*Math.ceil(w.context.length/128),C.sampleRate),i=[],u=[],c=0;c<y.numberOfInputs;c+=1)i.push(s(n,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),u.push(a(n,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));return t.next=6,Promise.all(Array.from(w.parameters.values()).map(function(){var t=l(e(ia).mark((function t(i){var r;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i.value}),t.next=3,d(n,i,r.offset);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:for(h=t.sent,p=r(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,R+L)}),v=0;v<y.numberOfInputs;v+=1)for(i[v].connect(u[v]),g=0;g<y.channelCount;g+=1)u[v].connect(p,g,v*y.channelCount+g);for(b=!0,k=!1,x=void 0,t.prev=10,E=h.entries()[Symbol.iterator]();!(b=(M=E.next()).done);b=!0)T=F(M.value,2),P=T[0],(A=T[1]).connect(p,0,R+P),A.start(0);t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),k=!0,x=t.t0;case 18:t.prev=18,t.prev=19,b||null==E.return||E.return();case 21:if(t.prev=21,!k){t.next=24;break}throw x;case 24:return t.finish(21);case 25:return t.finish(18);case 26:return p.connect(n.destination),t.next=29,Promise.all(i.map((function(t){return m(w,n,t)})));case 29:return t.abrupt("return",_(n));case 30:case"end":return t.stop()}}),t,null,[[10,14,18,26],[19,,21,25]])})));return function(){return t.apply(this,arguments)}}(),u.t0=Ha,u.t1=w,0!==I){u.next=22;break}u.t2=null,u.next=25;break;case 22:return u.next=24,N();case 24:u.t2=u.sent;case 25:u.t3=u.t2,u.t4=C,u.t5=y,u.t6=P,u.t7=b,u.t8=h,x=(0,u.t0)(u.t1,u.t3,u.t4,u.t5,u.t6,u.t7,u.t8);case 32:return u.next=34,x;case 34:for(B=u.sent,q=i(C,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),j=F(M,3),z=j[0],U=j[1],W=j[2],null!==B&&(q.buffer=B,q.start(0)),q.connect(z),G=0,K=0;G<w.numberOfOutputs;G+=1){for(H=U[G],Y=0;Y<P[G];Y+=1)z.connect(H,K+Y,Y);K+=P[G]}return u.abrupt("return",W);case 41:if(X=!0,Z=!1,Q=void 0,$=!0,J=!1,tt=void 0,T){u.next=68;break}u.prev=43,et=w.parameters.entries()[Symbol.iterator]();case 45:if(X=(nt=et.next()).done){u.next=52;break}return it=F(nt.value,2),rt=it[0],at=it[1],u.next=49,d(C,at,E.parameters.get(rt));case 49:X=!0,u.next=45;break;case 52:u.next=58;break;case 54:u.prev=54,u.t9=u.catch(43),Z=!0,Q=u.t9;case 58:u.prev=58,u.prev=59,X||null==et.return||et.return();case 61:if(u.prev=61,!Z){u.next=64;break}throw Q;case 64:return u.finish(61);case 65:return u.finish(58);case 66:u.next=91;break;case 68:u.prev=68,ot=w.parameters.entries()[Symbol.iterator]();case 70:if($=(st=ot.next()).done){u.next=77;break}return ut=F(st.value,2),lt=ut[0],ct=ut[1],u.next=74,t(C,ct,E.parameters.get(lt));case 74:$=!0,u.next=70;break;case 77:u.next=83;break;case 79:u.prev=79,u.t10=u.catch(68),J=!0,tt=u.t10;case 83:u.prev=83,u.prev=84,$||null==ot.return||ot.return();case 86:if(u.prev=86,!J){u.next=89;break}throw tt;case 89:return u.finish(86);case 90:return u.finish(83);case 91:return u.next=93,m(w,C,E);case 93:return u.abrupt("return",E);case 94:case"end":return u.stop()}}),u,null,[[43,54,58,66],[59,,61,65],[68,79,83,91],[84,,86,90]])}))),function(t,e){return w.apply(this,arguments)});return{render:function(t,e){u(e,t);var n=k.get(e);return void 0!==n?Promise.resolve(n):C(t,e)}}}}(Bu,ic,qu,Qu,xo,il,Mo,rc,ac,zl,Sa,Pu,bu,ju,_u,_l),hc=(Bs=Ul,function(t){return Bs.get(t)}),pc=function(t){return function(e,n){t.set(e,n)}}(oc),vc=jl?function(t,e,n,i,r,a,o,u,l,h,p,v,f,d){return function(e){"use strict";O(_,e);var m=P(_);function _(e,d,g){var y,b;c(this,_);var w=u(e),k=l(w),x=p(D({},ja,g));f(x);var C=jr.get(w),E=null==C?void 0:C.get(d),M=k||"closed"!==w.state?w:null!==(b=o(w))&&void 0!==b?b:w,T=r(M,k?null:e.baseLatency,h,d,E,x),P=k?i(d,x,E):null;y=m.call(this,e,!0,T,P);var A=[];T.parameters.forEach((function(t,e){var i=n(s(y),k,t);A.push([e,i])})),y._nativeAudioWorkletNode=T,y._onprocessorerror=null,y._parameters=new qa(A),k&&t(w,s(y));var S=a(s(y)).activeInputs;return v(T,S),y}return C(_,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(t){var e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}]),_}(e)}(nc,Au,Uu,cc,lc,fa,hc,yu,wu,Pu,(function(t){return D({},t,{outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(function(){return 1}))})}),pc,(function(t){var e=new MessageChannel,n=e.port1,i=e.port2;try{n.postMessage(t)}finally{n.close(),i.close()}}),su):void 0,fc=(function(t,e,n,i,r){}(ro,Gs,Qs,kl,Cu),function(t,e){return function(n,i,r){if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}}}(Gs,bu)),dc=function(t,e,n,i,r,a,o,s){return function(u,l){return n(u).render(u,l).then((function(){return Promise.all(Array.from(i(l)).map((function(t){return n(t).render(t,l)})))})).then((function(){return r(l)})).then((function(n){return"function"!=typeof n.copyFromChannel?(o(n),ua(n)):e(a,(function(){return a(n)}))||s(n),t.add(n),n}))}}(Vu,vu,mu,ec,_l,oa,Ru,Lu),mc=(function(t,e,n,i,r){}(vu,ro,fc,kl,dc),function(t,e,n,i,r){return function(t){"use strict";O(o,t);var a=P(o);function o(t,n,r){var s,u;if(c(this,o),"number"==typeof t&&void 0!==n&&void 0!==r)u={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");u=t}var l,h,p=D({},Ks,u),v=p.length,f=p.numberOfChannels,d=p.sampleRate,m=i(f,v,d);return e(co,(function(){return co(m)}))||m.addEventListener("statechange",(l=0,h=function(t){"running"===s._state&&(l>0?(m.removeEventListener("statechange",h),t.stopImmediatePropagation(),s._waitForThePromiseToSettle(t)):l+=1)})),(s=a.call(this,m,f))._length=v,s._nativeOfflineAudioContext=m,s._state=null,s}return C(o,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var t=this;return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){t._state=null,_a(t)})))}},{key:"_waitForThePromiseToSettle",value:function(t){var e=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((function(){return e._waitForThePromiseToSettle(t)}))}}]),o}(t)}(Yl,vu,ro,fc,dc)),_c=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(Fr,Eu),gc=(qs=Lr,js=Mu,function(t){return qs.has(t)||js(t)}),yc=(zs=Nr,Us=Tu,function(t){return zs.has(t)||Us(t)}),bc=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(Fr,wu);function wc(t,e){if(!t)throw new Error(e)}function kc(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(e<=t&&t<=n))throw new RangeError("Value must be within [".concat(e,", ").concat(n,"], got: ").concat(t))}function xc(t){t.isOffline||"running"===t.state||Mc('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var Cc=console;function Ec(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=Cc).log.apply(i,B(e))}function Mc(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=Cc).warn.apply(i,B(e))}function Tc(t){return void 0===t}function Pc(t){return!Tc(t)}function Ac(t){return"function"==typeof t}function Sc(t){return"number"==typeof t}function Vc(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Oc(t){return"boolean"==typeof t}function Dc(t){return Array.isArray(t)}function Rc(t){return"string"==typeof t}function Lc(t){return Rc(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ic(t){return new tc(t)}function Nc(t,e,n){return new mc(t,e,n)}var Fc="object"==typeof self?self:null,Bc=Fc&&(Fc.hasOwnProperty("AudioContext")||Fc.hasOwnProperty("webkitAudioContext"));function qc(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function jc(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}Object.create;Object.create;var zc=function(){"use strict";function t(e,n,i){c(this,t),this._callback=e,this._type=n,this._updateInterval=i,this._createClock()}return C(t,[{key:"_createWorker",value:function(){var t=new Blob(["\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t")],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}},{key:"_createTimeout",value:function(){var t=this;this._timeout=setTimeout((function(){t._createTimeout(),t._callback()}),1e3*this._updateInterval)}},{key:"_createClock",value:function(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}},{key:"_disposeClock",value:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}},{key:"updateInterval",get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}},{key:"type",get:function(){return this._type},set:function(t){this._disposeClock(),this._type=t,this._createClock()}},{key:"dispose",value:function(){this._disposeClock()}}]),t}();function Uc(t){return yc(t)}function Wc(t){return gc(t)}function Gc(t){return bc(t)}function Kc(t){return _c(t)}function Hc(t){return t instanceof AudioBuffer}function Yc(t,e){return"value"===t||Uc(e)||Wc(e)||Hc(e)}function Xc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(!n.length)return t;var r=n.shift();if(Vc(t)&&Vc(r))for(var a in r)Yc(a,r[a])?t[a]=r[a]:Vc(r[a])?(t[a]||Object.assign(t,A({},a,{})),Xc(t[a],r[a])):Object.assign(t,A({},a,r[a]));return Xc.apply(void 0,[t].concat(B(n)))}function Zc(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r={},a=Array.from(e);if(Vc(a[0])&&i&&!Reflect.has(a[0],i)){var o=Object.keys(a[0]).some((function(e){return Reflect.has(t,e)}));o||(Xc(r,A({},i,a[0])),n.splice(n.indexOf(i),1),a.shift())}if(1===a.length&&Vc(a[0]))Xc(r,a[0]);else for(var s=0;s<n.length;s++)Pc(a[s])&&(r[n[s]]=a[s]);return Xc(t,r)}function Qc(t,e){return Tc(t)?e:t}function $c(t,e){return e.forEach((function(e){Reflect.has(t,e)&&delete t[e]})),t}var Jc=function(){"use strict";function t(){c(this,t),this.debug=!1,this._wasDisposed=!1}return C(t,[{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];(this.debug||Fc&&this.toString()===Fc.TONE_DEBUG_CLASS)&&Ec.apply(void 0,[this].concat(B(e)))}},{key:"dispose",value:function(){return this._wasDisposed=!0,this}},{key:"disposed",get:function(){return this._wasDisposed}},{key:"toString",value:function(){return this.name}}],[{key:"getDefaults",value:function(){return{}}}]),t}();Jc.version=Vr;var th=1e-6;function eh(t,e){return t>e+th}function nh(t,e){return eh(t,e)||rh(t,e)}function ih(t,e){return t+th<e}function rh(t,e){return Math.abs(t-e)<th}function ah(t,e,n){return Math.max(Math.min(t,n),e)}var oh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this)).name="Timeline",t._timeline=[];var i=Zc(n.getDefaults(),arguments,["memory"]);return t.memory=i.memory,t.increasing=i.increasing,t}return C(n,[{key:"length",get:function(){return this._timeline.length}},{key:"add",value:function(t){if(wc(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){var e=this._timeline[this.length-1];wc(nh(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{var n=this._search(t.time);this._timeline.splice(n+1,0,t)}if(this.length>this.memory){var i=this.length-this.memory;this._timeline.splice(0,i)}return this}},{key:"remove",value:function(t){var e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(t,e);return-1!==n?this._timeline[n]:null}},{key:"peek",value:function(){return this._timeline[0]}},{key:"shift",value:function(){return this._timeline.shift()}},{key:"getAfter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}},{key:"getBefore",value:function(t){var e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];var n=this._search(t);return n-1>=0?this._timeline[n-1]:null}},{key:"cancel",value:function(t){if(this._timeline.length>1){var e=this._search(t);if(e>=0)if(rh(this._timeline[e].time,t)){for(var n=e;n>=0&&rh(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&nh(this._timeline[0].time,t)&&(this._timeline=[]);return this}},{key:"cancelBefore",value:function(t){var e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}},{key:"previousEvent",value:function(t){var e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}},{key:"_search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;var n=0,i=this._timeline.length,r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){var a=Math.floor(n+(r-n)/2),o=this._timeline[a],s=this._timeline[a+1];if(rh(o[e],t)){for(var u=a;u<this._timeline.length;u++){var l=this._timeline[u];if(!rh(l[e],t))break;a=u}return a}if(ih(o[e],t)&&eh(s[e],t))return a;eh(o[e],t)?r=a:n=a+1}return-1}},{key:"_iterate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(e,n+1).forEach(t)}},{key:"forEach",value:function(t){return this._iterate(t),this}},{key:"forEachBefore",value:function(t,e){var n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}},{key:"forEachAfter",value:function(t,e){var n=this._search(t);return this._iterate(e,n+1),this}},{key:"forEachBetween",value:function(t,e,n){var i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}},{key:"forEachFrom",value:function(t,e){for(var n=this._search(t);n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}},{key:"forEachAtTime",value:function(t,e){var n=this._search(t);if(-1!==n&&rh(this._timeline[n].time,t)){for(var i=n,r=n;r>=0&&rh(this._timeline[r].time,t);r--)i=r;this._iterate((function(t){e(t)}),i,n)}return this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._timeline=[],this}}],[{key:"getDefaults",value:function(){return{memory:1/0,increasing:!1}}}]),n}(Jc),sh=[];function uh(t){sh.push(t)}var lh=[];function ch(t){lh.push(t)}function hh(t){lh.forEach((function(e){return e(t)}))}var ph=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Emitter",t}return C(n,[{key:"on",value:function(t,e){var n=this;return t.split(/\W+/).forEach((function(t){Tc(n._events)&&(n._events={}),n._events.hasOwnProperty(t)||(n._events[t]=[]),n._events[t].push(e)})),this}},{key:"once",value:function(t,e){var n=this,i=function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];e.apply(void 0,B(a)),n.off(t,i)};return this.on(t,i),this}},{key:"off",value:function(t,e){var n=this;return t.split(/\W+/).forEach((function(i){if(Tc(n._events)&&(n._events={}),n._events.hasOwnProperty(t))if(Tc(e))n._events[t]=[];else for(var r=n._events[t],a=r.length-1;a>=0;a--)r[a]===e&&r.splice(a,1)})),this}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(this._events&&this._events.hasOwnProperty(t))for(var r=this._events[t].slice(0),a=0,o=r.length;a<o;a++)r[a].apply(this,n);return this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._events=void 0,this}}],[{key:"mixin",value:function(t){["on","once","off","emit"].forEach((function(e){var i=Object.getOwnPropertyDescriptor(n.prototype,e);Object.defineProperty(t.prototype,e,i)}))}}]),n}(Jc),vh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).isOffline=!1,t}return C(n,[{key:"toJSON",value:function(){return{}}}]),n}(ph),fh=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this)).name="Context",t._constants=new Map,t._timeouts=new oh,t._timeoutIds=0,t._initialized=!1,t.isOffline=!1,t._workletModules=new Map;var e=Zc(i.getDefaults(),arguments,["context"]);return e.context?t._context=e.context:t._context=Ic({latencyHint:e.latencyHint}),t._ticker=new zc(t.emit.bind(s(t),"tick"),e.clockSource,e.updateInterval),t.on("tick",t._timeoutLoop.bind(s(t))),t._context.onstatechange=function(){t.emit("statechange",t.state)},t._setLatencyHint(e.latencyHint),t.lookAhead=e.lookAhead,t}return C(i,[{key:"initialize",value:function(){var t;return this._initialized||(t=this,sh.forEach((function(e){return e(t)})),this._initialized=!0),this}},{key:"createAnalyser",value:function(){return this._context.createAnalyser()}},{key:"createOscillator",value:function(){return this._context.createOscillator()}},{key:"createBufferSource",value:function(){return this._context.createBufferSource()}},{key:"createBiquadFilter",value:function(){return this._context.createBiquadFilter()}},{key:"createBuffer",value:function(t,e,n){return this._context.createBuffer(t,e,n)}},{key:"createChannelMerger",value:function(t){return this._context.createChannelMerger(t)}},{key:"createChannelSplitter",value:function(t){return this._context.createChannelSplitter(t)}},{key:"createConstantSource",value:function(){return this._context.createConstantSource()}},{key:"createConvolver",value:function(){return this._context.createConvolver()}},{key:"createDelay",value:function(t){return this._context.createDelay(t)}},{key:"createDynamicsCompressor",value:function(){return this._context.createDynamicsCompressor()}},{key:"createGain",value:function(){return this._context.createGain()}},{key:"createIIRFilter",value:function(t,e){return this._context.createIIRFilter(t,e)}},{key:"createPanner",value:function(){return this._context.createPanner()}},{key:"createPeriodicWave",value:function(t,e,n){return this._context.createPeriodicWave(t,e,n)}},{key:"createStereoPanner",value:function(){return this._context.createStereoPanner()}},{key:"createWaveShaper",value:function(){return this._context.createWaveShaper()}},{key:"createMediaStreamSource",value:function(t){return wc(Kc(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}},{key:"createMediaElementSource",value:function(t){return wc(Kc(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}},{key:"createMediaStreamDestination",value:function(){return wc(Kc(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}},{key:"decodeAudioData",value:function(t){return this._context.decodeAudioData(t)}},{key:"currentTime",get:function(){return this._context.currentTime}},{key:"state",get:function(){return this._context.state}},{key:"sampleRate",get:function(){return this._context.sampleRate}},{key:"listener",get:function(){return this.initialize(),this._listener},set:function(t){wc(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}},{key:"transport",get:function(){return this.initialize(),this._transport},set:function(t){wc(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}},{key:"draw",get:function(){return this.initialize(),this._draw},set:function(t){wc(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}},{key:"destination",get:function(){return this.initialize(),this._destination},set:function(t){wc(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}},{key:"createAudioWorkletNode",value:function(t,e){return function(t,e,n){return wc(Pc(vc),"This node only works in a secure context (https or localhost)"),new vc(t,e,n)}(this.rawContext,t,e)}},{key:"addAudioWorkletModule",value:function(t,n){return jc(this,void 0,void 0,e(ia).mark((function i(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wc(Pc(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(n)||this._workletModules.set(n,this.rawContext.audioWorklet.addModule(t)),e.next=4,this._workletModules.get(n);case 4:case"end":return e.stop()}}),i,this)})))}},{key:"workletsAreReady",value:function(){return jc(this,void 0,void 0,e(ia).mark((function t(){var n;return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],this._workletModules.forEach((function(t){return n.push(t)})),t.next=4,Promise.all(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"updateInterval",get:function(){return this._ticker.updateInterval},set:function(t){this._ticker.updateInterval=t}},{key:"clockSource",get:function(){return this._ticker.type},set:function(t){this._ticker.type=t}},{key:"latencyHint",get:function(){return this._latencyHint}},{key:"_setLatencyHint",value:function(t){var e=0;if(this._latencyHint=t,Rc(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}},{key:"rawContext",get:function(){return this._context}},{key:"now",value:function(){return this._context.currentTime+this.lookAhead}},{key:"immediate",value:function(){return this._context.currentTime}},{key:"resume",value:function(){return Kc(this._context)?this._context.resume():Promise.resolve()}},{key:"close",value:function(){return jc(this,void 0,void 0,e(ia).mark((function t(){return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Kc(this._context)){t.next=3;break}return t.next=3,this._context.close();case 3:this._initialized&&hh(this);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getConstant",value:function(t){if(this._constants.has(t))return this._constants.get(t);for(var e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0),i=0;i<n.length;i++)n[i]=t;var r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=e,r.loop=!0,r.start(0),this._constants.set(t,r),r}},{key:"dispose",value:function(){var t=this;return V(M(i.prototype),"dispose",this).call(this),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((function(e){return t._constants[e].disconnect()})),this}},{key:"_timeoutLoop",value:function(){for(var t=this.now(),e=this._timeouts.peek();this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}},{key:"setTimeout",value:function(t,e){this._timeoutIds++;var n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}},{key:"clearTimeout",value:function(t){var e=this;return this._timeouts.forEach((function(n){n.id===t&&e._timeouts.remove(n)})),this}},{key:"clearInterval",value:function(t){return this.clearTimeout(t)}},{key:"setInterval",value:function(t,e){var n=this,i=++this._timeoutIds,r=function(){var a=n.now();n._timeouts.add({callback:function(){t(),r()},id:i,time:a+e})};return r(),i}}],[{key:"getDefaults",value:function(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}}]),i}(vh),dh=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;return c(this,i),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).lookAhead=0,t.latencyHint=0,t.isOffline=!1,t}return C(i,[{key:"createAnalyser",value:function(){return{}}},{key:"createOscillator",value:function(){return{}}},{key:"createBufferSource",value:function(){return{}}},{key:"createBiquadFilter",value:function(){return{}}},{key:"createBuffer",value:function(t,e,n){return{}}},{key:"createChannelMerger",value:function(t){return{}}},{key:"createChannelSplitter",value:function(t){return{}}},{key:"createConstantSource",value:function(){return{}}},{key:"createConvolver",value:function(){return{}}},{key:"createDelay",value:function(t){return{}}},{key:"createDynamicsCompressor",value:function(){return{}}},{key:"createGain",value:function(){return{}}},{key:"createIIRFilter",value:function(t,e){return{}}},{key:"createPanner",value:function(){return{}}},{key:"createPeriodicWave",value:function(t,e,n){return{}}},{key:"createStereoPanner",value:function(){return{}}},{key:"createWaveShaper",value:function(){return{}}},{key:"createMediaStreamSource",value:function(t){return{}}},{key:"createMediaElementSource",value:function(t){return{}}},{key:"createMediaStreamDestination",value:function(){return{}}},{key:"decodeAudioData",value:function(t){return Promise.resolve({})}},{key:"createAudioWorkletNode",value:function(t,e){return{}}},{key:"rawContext",get:function(){return{}}},{key:"addAudioWorkletModule",value:function(t,n){return jc(this,void 0,void 0,e(ia).mark((function t(){return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}},{key:"resume",value:function(){return Promise.resolve()}},{key:"setTimeout",value:function(t,e){return 0}},{key:"clearTimeout",value:function(t){return this}},{key:"setInterval",value:function(t,e){return 0}},{key:"clearInterval",value:function(t){return this}},{key:"getConstant",value:function(t){return{}}},{key:"currentTime",get:function(){return 0}},{key:"state",get:function(){return{}}},{key:"sampleRate",get:function(){return 0}},{key:"listener",get:function(){return{}}},{key:"transport",get:function(){return{}}},{key:"draw",get:function(){return{}},set:function(t){}},{key:"destination",get:function(){return{}},set:function(t){}},{key:"now",value:function(){return 0}},{key:"immediate",value:function(){return 0}}]),i}(vh);function mh(t,e){Dc(e)?e.forEach((function(e){return mh(t,e)})):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function _h(t,e){Dc(e)?e.forEach((function(e){return _h(t,e)})):Object.defineProperty(t,e,{writable:!0})}var gh=function(){},yh=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this)).name="ToneAudioBuffer",t.onload=gh;var e=Zc(i.getDefaults(),arguments,["url","onload","onerror"]);return t.reverse=e.reverse,t.onload=e.onload,e.url&&Hc(e.url)||e.url instanceof i?t.set(e.url):Rc(e.url)&&t.load(e.url).catch(e.onerror),t}return C(i,[{key:"sampleRate",get:function(){return this._buffer?this._buffer.sampleRate:xh().sampleRate}},{key:"set",value:function(t){if(t instanceof i){var e=this;t.loaded?this._buffer=t.get():t.onload=function(){e.set(t),e.onload(e)}}else this._buffer=t;return this._reversed&&this._reverse(),this}},{key:"get",value:function(){return this._buffer}},{key:"load",value:function(t){return jc(this,void 0,void 0,e(ia).mark((function n(){var r,a,o;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,a=i.load(t).then((function(t){r.set(t),r.onload(r)})),i.downloads.push(a),e.prev=3,e.next=6,a;case 6:return e.prev=6,o=i.downloads.indexOf(a),i.downloads.splice(o,1),e.finish(6);case 10:return e.abrupt("return",this);case 11:case"end":return e.stop()}}),n,this,[[3,,6,10]])})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this._buffer=void 0,this}},{key:"fromArray",value:function(t){for(var e=Dc(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=xh(),a=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t],s=0;s<n;s++)a.copyToChannel(o[s],s);return this._buffer=a,this}},{key:"toMono",value:function(t){if(Sc(t))this.fromArray(this.toArray(t));else{for(var e=new Float32Array(this.length),n=this.numberOfChannels,i=0;i<n;i++)for(var r=this.toArray(i),a=0;a<r.length;a++)e[a]+=r[a];e=e.map((function(t){return t/n})),this.fromArray(e)}return this}},{key:"toArray",value:function(t){if(Sc(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);for(var e=[],n=0;n<this.numberOfChannels;n++)e[n]=this.getChannelData(n);return e}},{key:"getChannelData",value:function(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}},{key:"slice",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration,n=Math.floor(t*this.sampleRate),r=Math.floor(e*this.sampleRate);wc(n<r,"The start time must be less than the end time");for(var a=r-n,o=xh().createBuffer(this.numberOfChannels,a,this.sampleRate),s=0;s<this.numberOfChannels;s++)o.copyToChannel(this.getChannelData(s).subarray(n,r),s);return new i(o)}},{key:"_reverse",value:function(){if(this.loaded)for(var t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}},{key:"loaded",get:function(){return this.length>0}},{key:"duration",get:function(){return this._buffer?this._buffer.duration:0}},{key:"length",get:function(){return this._buffer?this._buffer.length:0}},{key:"numberOfChannels",get:function(){return this._buffer?this._buffer.numberOfChannels:0}},{key:"reverse",get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())}}],[{key:"getDefaults",value:function(){return{onerror:gh,onload:gh,reverse:!1}}},{key:"fromArray",value:function(t){return(new i).fromArray(t)}},{key:"fromUrl",value:function(t){return jc(this,void 0,void 0,e(ia).mark((function n(){var r;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new i,e.next=3,r.load(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),n)})))}},{key:"load",value:function(t){return jc(this,void 0,void 0,e(ia).mark((function n(){var r,a,o,s,u,l,c,h,p,v,f,d,m;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.match(/\[([^\]\[]+\|.+)\]$/))){e.next=30;break}a=r[1].split("|"),o=a[0],s=!0,u=!1,l=void 0,e.prev=5,c=a[Symbol.iterator]();case 7:if(s=(h=c.next()).done){e.next=15;break}if(p=h.value,!i.supportsType(p)){e.next=12;break}return o=p,e.abrupt("break",15);case 12:s=!0,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),u=!0,l=e.t0;case 21:e.prev=21,e.prev=22,s||null==c.return||c.return();case 24:if(e.prev=24,!u){e.next=27;break}throw l;case 27:return e.finish(24);case 28:return e.finish(21);case 29:t=t.replace(r[0],o);case 30:return v=""===i.baseUrl||i.baseUrl.endsWith("/")?i.baseUrl:i.baseUrl+"/",e.next=33,fetch(v+t);case 33:if((f=e.sent).ok){e.next=36;break}throw new Error("could not load url: ".concat(t));case 36:return e.next=38,f.arrayBuffer();case 38:return d=e.sent,e.next=41,xh().decodeAudioData(d);case 41:return m=e.sent,e.abrupt("return",m);case 43:case"end":return e.stop()}}),n,null,[[5,17,21,29],[22,,24,28]])})))}},{key:"supportsType",value:function(t){var e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}},{key:"loaded",value:function(){return jc(this,void 0,void 0,e(ia).mark((function t(){return e(ia).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:if(!i.downloads.length){t.next=7;break}return t.next=5,i.downloads[0];case 5:t.next=2;break;case 7:case"end":return t.stop()}}),t)})))}}]),i}(Jc);yh.baseUrl="",yh.downloads=[];var bh=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;return c(this,i),(t=n.call(this,{clockSource:"offline",context:Gc(arguments[0])?arguments[0]:Nc(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:Gc(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]})).name="OfflineContext",t._currentTime=0,t.isOffline=!0,t._duration=Gc(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1],t}return C(i,[{key:"now",value:function(){return this._currentTime}},{key:"currentTime",get:function(){return this._currentTime}},{key:"_renderClock",value:function(t){return jc(this,void 0,void 0,e(ia).mark((function n(){var i,r;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(this._duration-this._currentTime>=0)){e.next=11;break}if(this.emit("tick"),this._currentTime+=128/this.sampleRate,i++,r=Math.floor(this.sampleRate/128),!t||i%r!=0){e.next=9;break}return e.next=9,new Promise((function(t){return setTimeout(t,1)}));case 9:e.next=1;break;case 11:case"end":return e.stop()}}),n,this)})))}},{key:"render",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return jc(this,void 0,void 0,e(ia).mark((function n(){var i;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workletsAreReady();case 2:return e.next=4,this._renderClock(t);case 4:return e.next=6,this._context.startRendering();case 6:return i=e.sent,e.abrupt("return",new yh(i));case 8:case"end":return e.stop()}}),n,this)})))}},{key:"close",value:function(){return Promise.resolve()}}]),i}(fh),wh=new dh,kh=wh;function xh(){return kh===wh&&Bc&&Ch(new fh),kh}function Ch(t){kh=Kc(t)?new fh(t):Gc(t)?new bh(t):t}if(Fc&&!Fc.TONE_SILENCE_LOGGING){var Eh="v";0;var Mh=" * Tone.js ".concat(Eh).concat(Vr," * ");console.log("%c".concat(Mh),"background: #000; color: #fff")}var Th=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this)).name="ToneAudioBuffers",t._buffers=new Map,t._loadingCount=0;var i=Zc(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");return t.baseUrl=i.baseUrl,Object.keys(i.urls).forEach((function(e){t._loadingCount++;var n=i.urls[e];t.add(e,n,t._bufferLoaded.bind(s(t),i.onload),i.onerror)})),t}return C(n,[{key:"has",value:function(t){return this._buffers.has(t.toString())}},{key:"get",value:function(t){return wc(this.has(t),"ToneAudioBuffers has no buffer named: ".concat(t)),this._buffers.get(t.toString())}},{key:"_bufferLoaded",value:function(t){this._loadingCount--,0===this._loadingCount&&t&&t()}},{key:"loaded",get:function(){return Array.from(this._buffers).every((function(t){var e=F(t,2);e[0];return e[1].loaded}))}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gh,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gh;return Rc(e)?this._buffers.set(t.toString(),new yh(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new yh(e,n,i)),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._buffers.forEach((function(t){return t.dispose()})),this._buffers.clear(),this}}],[{key:"getDefaults",value:function(){return{baseUrl:"",onerror:gh,onload:gh,urls:{}}}}]),n}(Jc);function Ph(t){return Math.pow(10,t/20)}function Ah(t){return Math.log(t)/Math.LN10*20}function Sh(t){return Math.pow(2,t/12)}var Vh=440;function Oh(t){return Math.round(Dh(t))}function Dh(t){return 69+12*Math.log2(t/Vh)}function Rh(t){return Vh*Math.pow(2,(t-69)/12)}var Lh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="TimeClass",t}return C(n,[{key:"_getExpressions",value:function(){var t=this;return Object.assign(V(M(n.prototype),"_getExpressions",this).call(this),{now:{method:function(e){return t._now()+new t.constructor(t.context,e).valueOf()},regexp:/^\+(.+)/},quantize:{method:function(e){var i=new n(t.context,e).valueOf();return t._secondsToUnits(t.context.transport.nextSubdivision(i))},regexp:/^@(.+)/}})}},{key:"quantize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new this.constructor(this.context,t).valueOf(),i=this.valueOf(),r=Math.round(i/n),a=r*n,o=a-i;return i+o*e}},{key:"toNotation",value:function(){for(var t=this,e=this.toSeconds(),i=["1m"],r=1;r<9;r++){var a=Math.pow(2,r);i.push(a+"n."),i.push(a+"n"),i.push(a+"t")}i.push("0");var o=i[0],s=new n(this.context,i[0]).toSeconds();return i.forEach((function(i){var r=new n(t.context,i).toSeconds();Math.abs(r-e)<Math.abs(s-e)&&(o=i,s=r)})),o}},{key:"toBarsBeatsSixteenths",value:function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));var n=Math.floor(e/this._getTimeSignature()),i=e%1*4;e=Math.floor(e)%this._getTimeSignature();var r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[n,e,i].join(":")}},{key:"toTicks",value:function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}},{key:"toSeconds",value:function(){return this.valueOf()}},{key:"toMidi",value:function(){return Oh(this.toFrequency())}},{key:"_now",value:function(){return this.context.now()}}]),n}(function(t){"use strict";O(n,t);var e=P(n);function n(t,i,r){var a;return c(this,n),(a=e.call(this)).defaultUnits="s",a._val=i,a._units=r,a.context=t,a._expressions=a._getExpressions(),a}return C(n,[{key:"_getExpressions",value:function(){var t=this;return{hz:{method:function(e){return t._frequencyToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:function(e){return t._ticksToUnits(parseInt(e,10))},regexp:/^(\d+)i$/i},m:{method:function(e){return t._beatsToUnits(parseInt(e,10)*t._getTimeSignature())},regexp:/^(\d+)m$/i},n:{method:function(e,n){var i=parseInt(e,10),r="."===n?1.5:1;return 1===i?t._beatsToUnits(t._getTimeSignature())*r:t._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:function(e){return t._expressions[t.defaultUnits].method.call(t,e)},regexp:/^(\d+(?:\.\d+)?)$/},s:{method:function(e){return t._secondsToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:function(e){return parseInt(e,10)/t.context.sampleRate},regexp:/^(\d+)samples$/},t:{method:function(e){var n=parseInt(e,10);return t._beatsToUnits(8/(3*Math.floor(n)))},regexp:/^(\d+)t$/i},tr:{method:function(e,n,i){var r=0;return e&&"0"!==e&&(r+=t._beatsToUnits(t._getTimeSignature()*parseFloat(e))),n&&"0"!==n&&(r+=t._beatsToUnits(parseFloat(n))),i&&"0"!==i&&(r+=t._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}},{key:"valueOf",value:function(){if(this._val instanceof n&&this.fromType(this._val),Tc(this._val))return this._noArg();if(Rc(this._val)&&Tc(this._units)){for(var t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Vc(this._val)){var e=0;for(var i in this._val)if(Pc(this._val[i])){var r=this._val[i];e+=new this.constructor(this.context,i).valueOf()*r}return e}if(Pc(this._units)){var a=this._expressions[this._units],o=this._val.toString().trim().match(a.regexp);return o?a.method.apply(this,o.slice(1)):a.method.call(this,this._val)}return Rc(this._val)?parseFloat(this._val):this._val}},{key:"_frequencyToUnits",value:function(t){return 1/t}},{key:"_beatsToUnits",value:function(t){return 60/this._getBpm()*t}},{key:"_secondsToUnits",value:function(t){return t}},{key:"_ticksToUnits",value:function(t){return t*this._beatsToUnits(1)/this._getPPQ()}},{key:"_noArg",value:function(){return this._now()}},{key:"_getBpm",value:function(){return this.context.transport.bpm.value}},{key:"_getTimeSignature",value:function(){return this.context.transport.timeSignature}},{key:"_getPPQ",value:function(){return this.context.transport.PPQ}},{key:"fromType",value:function(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}},{key:"toFrequency",value:function(){return 1/this.toSeconds()}},{key:"toSamples",value:function(){return this.toSeconds()*this.context.sampleRate}},{key:"toMilliseconds",value:function(){return 1e3*this.toSeconds()}}]),n}(Jc));var Ih=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Frequency",t.defaultUnits="hz",t}return C(n,[{key:"_getExpressions",value:function(){return Object.assign({},V(M(n.prototype),"_getExpressions",this).call(this),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return"midi"===this.defaultUnits?t:n.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,e){var i=Nh[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?i:n.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}},{key:"transpose",value:function(t){return new n(this.context,this.valueOf()*Sh(t))}},{key:"harmonize",value:function(t){var e=this;return t.map((function(t){return e.transpose(t)}))}},{key:"toMidi",value:function(){return Oh(this.valueOf())}},{key:"toNote",value:function(){var t=this.toFrequency(),e=Math.log2(t/n.A4),i=Math.round(12*e)+57,r=Math.floor(i/12);return r<0&&(i+=-12*r),Fh[i%12]+r.toString()}},{key:"toSeconds",value:function(){return 1/V(M(n.prototype),"toSeconds",this).call(this)}},{key:"toTicks",value:function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}},{key:"_noArg",value:function(){return 0}},{key:"_frequencyToUnits",value:function(t){return t}},{key:"_ticksToUnits",value:function(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}},{key:"_beatsToUnits",value:function(t){return 1/V(M(n.prototype),"_beatsToUnits",this).call(this,t)}},{key:"_secondsToUnits",value:function(t){return 1/t}}],[{key:"A4",get:function(){return Vh},set:function(t){!function(t){Vh=t}(t)}},{key:"mtof",value:function(t){return Rh(t)}},{key:"ftom",value:function(t){return Oh(t)}}]),n}(Lh),Nh={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Fh=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var Bh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="TransportTime",t}return C(n,[{key:"_now",value:function(){return this.context.transport.seconds}}]),n}(Lh);var qh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),t=e.call(this);var i=Zc(n.getDefaults(),arguments,["context"]);return t.defaultContext?t.context=t.defaultContext:t.context=i.context,t}return C(n,[{key:"now",value:function(){return this.context.currentTime+this.context.lookAhead}},{key:"immediate",value:function(){return this.context.currentTime}},{key:"sampleTime",get:function(){return 1/this.context.sampleRate}},{key:"blockTime",get:function(){return 128/this.context.sampleRate}},{key:"toSeconds",value:function(t){return new Lh(this.context,t).toSeconds()}},{key:"toFrequency",value:function(t){return new Ih(this.context,t).toFrequency()}},{key:"toTicks",value:function(t){return new Bh(this.context,t).toTicks()}},{key:"_getPartialProperties",value:function(t){var e=this.get();return Object.keys(e).forEach((function(n){Tc(t[n])&&delete e[n]})),e}},{key:"get",value:function(){var t=this,e=this.constructor.getDefaults();return Object.keys(e).forEach((function(i){if(Reflect.has(t,i)){var r=t[i];Pc(r)&&Pc(r.value)&&Pc(r.setValueAtTime)?e[i]=r.value:r instanceof n?e[i]=r._getPartialProperties(e[i]):Dc(r)||Sc(r)||Rc(r)||Oc(r)?e[i]=r:delete e[i]}})),e}},{key:"set",value:function(t){var e=this;return Object.keys(t).forEach((function(i){Reflect.has(e,i)&&Pc(e[i])&&(e[i]&&Pc(e[i].value)&&Pc(e[i].setValueAtTime)?e[i].value!==t[i]&&(e[i].value=t[i]):e[i]instanceof n?e[i].set(t[i]):e[i]=t[i])})),this}}],[{key:"getDefaults",value:function(){return{context:xh()}}}]),n}(Jc),jh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["param","units","convert"]))).name="Param",t.overridden=!1,t._minOutput=1e-7;var i=Zc(n.getDefaults(),arguments,["param","units","convert"]);for(wc(Pc(i.param)&&(Uc(i.param)||i.param instanceof n),"param must be an AudioParam");!Uc(i.param);)i.param=i.param._param;return t._swappable=!!Pc(i.swappable)&&i.swappable,t._swappable?(t.input=t.context.createGain(),t._param=i.param,t.input.connect(t._param)):t._param=t.input=i.param,t._events=new oh(1e3),t._initialValue=t._param.defaultValue,t.units=i.units,t.convert=i.convert,t._minValue=i.minValue,t._maxValue=i.maxValue,Pc(i.value)&&i.value!==t._toType(t._initialValue)&&t.setValueAtTime(i.value,0),t}return C(n,[{key:"value",get:function(){var t=this.now();return this.getValueAtTime(t)},set:function(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}},{key:"minValue",get:function(){return Pc(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}},{key:"maxValue",get:function(){return Pc(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}},{key:"_is",value:function(t,e){return this.units===e}},{key:"_assertRange",value:function(t){return Pc(this.maxValue)&&Pc(this.minValue)&&kc(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}},{key:"_fromType",value:function(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?Ph(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}},{key:"_toType",value:function(t){return this.convert&&"decibels"===this.units?Ah(t):t}},{key:"setValueAtTime",value:function(t,e){var n=this.toSeconds(e),i=this._fromType(t);return wc(isFinite(i)&&isFinite(n),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}},{key:"getValueAtTime",value:function(t){var e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e),r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){var a=i.value;if("setTargetAtTime"===i.type){var o=this._events.getBefore(i.time);a=null===o?this._initialValue:o.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,a,n.time,n.value,e):this._exponentialInterpolate(i.time,a,n.time,n.value,e)}else r=i.value;else{var s,u=this._events.getBefore(i.time);s=null===u?this._initialValue:u.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,s,i.value,i.constant,e))}return this._toType(r)}},{key:"setRampPoint",value:function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}},{key:"linearRampToValueAtTime",value:function(t,e){var n=this._fromType(t),i=this.toSeconds(e);return wc(isFinite(n)&&isFinite(i),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){var n=this._fromType(t);n=rh(n,0)?this._minOutput:n,this._assertRange(n);var i=this.toSeconds(e);return wc(isFinite(n)&&isFinite(i),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}},{key:"exponentialRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}},{key:"linearRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}},{key:"targetRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}},{key:"exponentialApproachValueAtTime",value:function(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);var i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}},{key:"setTargetAtTime",value:function(t,e,n){var i=this._fromType(t);wc(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");var r=this.toSeconds(e);return this._assertRange(i),wc(isFinite(i)&&isFinite(r),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}},{key:"setValueCurveAtTime",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),e=this.toSeconds(e);var r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);for(var a=n/(t.length-1),o=1;o<t.length;o++){var s=this._fromType(t[o])*i;this.linearRampToValueAtTime(this._toType(s),e+o*a)}return this}},{key:"cancelScheduledValues",value:function(t){var e=this.toSeconds(t);return wc(isFinite(e),"Invalid argument to cancelScheduledValues: ".concat(JSON.stringify(t))),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}},{key:"cancelAndHoldAtTime",value:function(t){var e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));wc(isFinite(e),"Invalid argument to cancelAndHoldAtTime: ".concat(JSON.stringify(t))),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);var i=this._events.get(e),r=this._events.getAfter(e);return i&&rh(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}},{key:"rampTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}},{key:"apply",value:function(t){var e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);var n=this._events.get(e);if(n&&"setTargetAtTime"===n.type)for(var i=this._events.getAfter(n.time),r=i?i.time:e+2,a=(r-e)/10,o=e;o<r;o+=a)t.linearRampToValueAtTime(this.getValueAtTime(o),o);return this._events.forEachAfter(this.context.currentTime,(function(e){"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}},{key:"setParam",value:function(t){wc(this._swappable,"The Param must be assigned as 'swappable' in the constructor");var e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._events.dispose(),this}},{key:"defaultValue",get:function(){return this._toType(this._param.defaultValue)}},{key:"_exponentialApproach",value:function(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}},{key:"_linearInterpolate",value:function(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}},{key:"_exponentialInterpolate",value:function(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}],[{key:"getDefaults",value:function(){return Object.assign(qh.getDefaults(),{convert:!0,units:"number"})}}]),n}(qh),zh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="ToneAudioNode",t._internalChannels=[],t}return C(n,[{key:"numberOfInputs",get:function(){return Pc(this.input)?Uc(this.input)||this.input instanceof jh?1:this.input.numberOfInputs:0}},{key:"numberOfOutputs",get:function(){return Pc(this.output)?this.output.numberOfOutputs:0}},{key:"_isAudioNode",value:function(t){return Pc(t)&&(t instanceof n||Wc(t))}},{key:"_getInternalNodes",value:function(){var t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}},{key:"_setChannelProperties",value:function(t){this._getInternalNodes().forEach((function(e){e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}},{key:"_getChannelProperties",value:function(){var t=this._getInternalNodes();wc(t.length>0,"ToneAudioNode does not have any internal nodes");var e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}},{key:"channelCount",get:function(){return this._getChannelProperties().channelCount},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}},{key:"channelCountMode",get:function(){return this._getChannelProperties().channelCountMode},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}},{key:"channelInterpretation",get:function(){return this._getChannelProperties().channelInterpretation},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}},{key:"connect",value:function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t(this,e,n,i),this}},{key:"toDestination",value:function(){return this.connect(this.context.destination),this}},{key:"toMaster",value:function(){return Mc("toMaster() has been renamed toDestination()"),this.toDestination()}},{key:"disconnect",value:function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t(this,e,n,i),this}},{key:"chain",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Uh.apply(void 0,[this].concat(B(e))),this}},{key:"fan",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=this;return e.forEach((function(t){return i.connect(t)})),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),Pc(this.input)&&(this.input instanceof n?this.input.dispose():Wc(this.input)&&this.input.disconnect()),Pc(this.output)&&(this.output instanceof n?this.output.dispose():Wc(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}]),n}(qh);function Uh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.shift();e.reduce((function(t,e){return t instanceof zh?t.connect(e):Wc(t)&&Wh(t,e),e}),i)}function Wh(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(wc(Pc(t),"Cannot connect from undefined node"),wc(Pc(e),"Cannot connect to undefined node"),(e instanceof zh||Wc(e))&&wc(e.numberOfInputs>0,"Cannot connect to node with no inputs"),wc(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof zh||e instanceof jh;)Pc(e.input)&&(e=e.input);for(;t instanceof zh;)Pc(t.output)&&(t=t.output);Uc(e)?t.connect(e,n):t.connect(e,n,i)}var Gh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["gain","units"]))).name="Gain",t._gainNode=t.context.createGain(),t.input=t._gainNode,t.output=t._gainNode;var i=Zc(n.getDefaults(),arguments,["gain","units"]);return t.gain=new jh({context:t.context,convert:i.convert,param:t._gainNode.gain,units:i.units,value:i.gain,minValue:i.minValue,maxValue:i.maxValue}),mh(s(t),"gain"),t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._gainNode.disconnect(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{convert:!0,gain:1,units:"gain"})}}]),n}(zh),Kh=function(t){"use strict";O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).onended=gh,i._startTime=-1,i._stopTime=-1,i._timeout=-1,i.output=new Gh({context:i.context,gain:0}),i._gainNode=i.output,i.getStateAtTime=function(t){var e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},i._fadeIn=t.fadeIn,i._fadeOut=t.fadeOut,i._curve=t.curve,i.onended=t.onended,i}return C(n,[{key:"_startGain",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;wc(-1===this._startTime,"Source cannot be started more than once");var n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}},{key:"stop",value:function(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}},{key:"_stopGain",value:function(t){var e=this;wc(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();var n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,n,t):this._gainNode.gain.targetRampTo(0,n,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((function(){var t="exponential"===e._curve?2*n:0;e._stopSource(e.now()+t),e._onended()}),this._stopTime-this.context.currentTime),this}},{key:"_onended",value:function(){if(this.onended!==gh&&(this.onended(this),this.onended=gh,!this.context.isOffline)){var t=this,e=function(){return t.dispose()};void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}},{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"cancelStop",value:function(){return this.log("cancelStop"),wc(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._gainNode.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:gh})}}]),n}(zh),Hh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["url","onload"]))).name="ToneBufferSource",t._source=t.context.createBufferSource(),t._internalChannels=[t._source],t._sourceStarted=!1,t._sourceStopped=!1;var i=Zc(n.getDefaults(),arguments,["url","onload"]);return Wh(t._source,t._gainNode),t._source.onended=function(){return t._stopSource()},t.playbackRate=new jh({context:t.context,param:t._source.playbackRate,units:"positive",value:i.playbackRate}),t.loop=i.loop,t.loopStart=i.loopStart,t.loopEnd=i.loopEnd,t._buffer=new yh(i.url,i.onload,i.onerror),t._internalChannels.push(t._source),t}return C(n,[{key:"fadeIn",get:function(){return this._fadeIn},set:function(t){this._fadeIn=t}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(t){this._fadeOut=t}},{key:"curve",get:function(){return this._curve},set:function(t){this._curve=t}},{key:"start",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;wc(this.buffer.loaded,"buffer is either not set or not loaded");var r=this.toSeconds(t);this._startGain(r,i),e=this.loop?Qc(e,this.loopStart):Qc(e,0);var a=Math.max(this.toSeconds(e),0);if(this.loop){var o=this.toSeconds(this.loopEnd)||this.buffer.duration,s=this.toSeconds(this.loopStart),u=o-s;nh(a,o)&&(a=(a-s)%u+s),rh(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ih(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,a)),Pc(n)){var l=this.toSeconds(n);l=Math.max(l,0),this.stop(r+l)}return this}},{key:"_stopSource",value:function(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}},{key:"loopStart",get:function(){return this._source.loopStart},set:function(t){this._source.loopStart=this.toSeconds(t)}},{key:"loopEnd",get:function(){return this._source.loopEnd},set:function(t){this._source.loopEnd=this.toSeconds(t)}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer.set(t)}},{key:"loop",get:function(){return this._source.loop},set:function(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Kh.getDefaults(),{url:new yh,loop:!1,loopEnd:0,loopStart:0,onload:gh,onerror:gh,playbackRate:1})}}]),n}(Kh),Yh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Draw",t.expiration=.25,t.anticipation=.008,t._events=new oh,t._boundDrawLoop=t._drawLoop.bind(s(t)),t._animationFrame=-1,t}return C(n,[{key:"schedule",value:function(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}},{key:"cancel",value:function(t){return this._events.cancel(this.toSeconds(t)),this}},{key:"_drawLoop",value:function(){for(var t=this.context.currentTime;this._events.length&&this._events.peek().time-this.anticipation<=t;){var e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}]),n}(qh);uh((function(t){t.draw=new Yh({context:t})})),ch((function(t){t.draw.dispose()}));var Xh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";return c(this,n),(t=e.call(this)).name="StateTimeline",t._initial=i,t.setStateAtTime(t._initial,0),t}return C(n,[{key:"getValueAtTime",value:function(t){var e=this.get(t);return null!==e?e.state:this._initial}},{key:"setStateAtTime",value:function(t,e,n){return kc(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}},{key:"getLastState",value:function(t,e){for(var n=this._search(e);n>=0;n--){var i=this._timeline[n];if(i.state===t)return i}}},{key:"getNextState",value:function(t,e){var n=this._search(e);if(-1!==n)for(var i=n;i<this._timeline.length;i++){var r=this._timeline[i];if(r.state===t)return r}}}]),n}(oh),Zh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["offset"]))).name="ToneConstantSource",t._source=t.context.createConstantSource();var i=Zc(n.getDefaults(),arguments,["offset"]);return Wh(t._source,t._gainNode),t.offset=new jh({context:t.context,convert:i.convert,param:t._source.offset,units:i.units,value:i.offset,minValue:i.minValue,maxValue:i.maxValue}),t}return C(n,[{key:"start",value:function(t){var e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}},{key:"_stopSource",value:function(t){this._source.stop(t)}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Kh.getDefaults(),{convert:!0,offset:1,units:"number"})}}]),n}(Kh),Qh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["value","units"]))).name="Signal",t.override=!0;var i=Zc(n.getDefaults(),arguments,["value","units"]);return t.output=t._constantSource=new Zh({context:t.context,convert:i.convert,offset:i.value,units:i.units,minValue:i.minValue,maxValue:i.maxValue}),t._constantSource.start(0),t.input=t._param=t._constantSource.offset,t}return C(n,[{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $h(this,t,e,n),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._param.dispose(),this._constantSource.dispose(),this}},{key:"setValueAtTime",value:function(t,e){return this._param.setValueAtTime(t,e),this}},{key:"getValueAtTime",value:function(t){return this._param.getValueAtTime(t)}},{key:"setRampPoint",value:function(t){return this._param.setRampPoint(t),this}},{key:"linearRampToValueAtTime",value:function(t,e){return this._param.linearRampToValueAtTime(t,e),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}},{key:"exponentialRampTo",value:function(t,e,n){return this._param.exponentialRampTo(t,e,n),this}},{key:"linearRampTo",value:function(t,e,n){return this._param.linearRampTo(t,e,n),this}},{key:"targetRampTo",value:function(t,e,n){return this._param.targetRampTo(t,e,n),this}},{key:"exponentialApproachValueAtTime",value:function(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}},{key:"setTargetAtTime",value:function(t,e,n){return this._param.setTargetAtTime(t,e,n),this}},{key:"setValueCurveAtTime",value:function(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}},{key:"cancelScheduledValues",value:function(t){return this._param.cancelScheduledValues(t),this}},{key:"cancelAndHoldAtTime",value:function(t){return this._param.cancelAndHoldAtTime(t),this}},{key:"rampTo",value:function(t,e,n){return this._param.rampTo(t,e,n),this}},{key:"value",get:function(){return this._param.value},set:function(t){this._param.value=t}},{key:"convert",get:function(){return this._param.convert},set:function(t){this._param.convert=t}},{key:"units",get:function(){return this._param.units}},{key:"overridden",get:function(){return this._param.overridden},set:function(t){this._param.overridden=t}},{key:"maxValue",get:function(){return this._param.maxValue}},{key:"minValue",get:function(){return this._param.minValue}},{key:"apply",value:function(t){return this._param.apply(t),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{convert:!0,units:"number",value:0})}}]),n}(zh);function $h(t,e,n,i){(e instanceof jh||Uc(e)||e instanceof Qh&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Qh&&(e.overridden=!0)),Wh(t,e,n,i)}var Jh=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["value"]))).name="TickParam",t._events=new oh(1/0),t._multiplier=1;var i=Zc(n.getDefaults(),arguments,["value"]);return t._multiplier=i.multiplier,t._events.cancel(0),t._events.add({ticks:0,time:0,type:"setValueAtTime",value:t._fromType(i.value)}),t.setValueAtTime(i.value,0),t}return C(n,[{key:"setTargetAtTime",value:function(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);for(var i=this._fromType(t),r=this._events.get(e),a=Math.round(Math.max(1/n,1)),o=0;o<=a;o++){var s=n*o+e,u=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"setValueAtTime",value:function(t,e){var i=this.toSeconds(e);V(M(n.prototype),"setValueAtTime",this).call(this,t,e);var r=this._events.get(i),a=this._events.previousEvent(r),o=this._getTicksUntilEvent(a,i);return r.ticks=Math.max(o,0),this}},{key:"linearRampToValueAtTime",value:function(t,e){var i=this.toSeconds(e);V(M(n.prototype),"linearRampToValueAtTime",this).call(this,t,e);var r=this._events.get(i),a=this._events.previousEvent(r),o=this._getTicksUntilEvent(a,i);return r.ticks=Math.max(o,0),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){e=this.toSeconds(e);for(var n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),a=(e-i.time)/r,o=0;o<=r;o++){var s=a*o+i.time,u=this._exponentialInterpolate(i.time,i.value,e,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"_getTicksUntilEvent",value:function(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Tc(t.ticks)){var n=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(n,t.time)}var i=this._fromType(this.getValueAtTime(t.time)),r=this._fromType(this.getValueAtTime(e)),a=this._events.get(e);return a&&a.time===e&&"setValueAtTime"===a.type&&(r=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(i+r)+t.ticks}},{key:"getTicksAtTime",value:function(t){var e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}},{key:"getDurationOfTicks",value:function(t,e){var n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}},{key:"getTimeOfTick",value:function(t){var e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){var i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),a=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+a)/r;return(o>0?o:(-i-a)/r)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}},{key:"ticksToTime",value:function(t,e){return this.getDurationOfTicks(t,e)}},{key:"timeToTicks",value:function(t,e){var n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}},{key:"_fromType",value:function(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):V(M(n.prototype),"_fromType",this).call(this,t)}},{key:"_toType",value:function(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:V(M(n.prototype),"_toType",this).call(this,t)}},{key:"multiplier",get:function(){return this._multiplier},set:function(t){var e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}],[{key:"getDefaults",value:function(){return Object.assign(jh.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(jh),tp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["value"]))).name="TickSignal";var i=Zc(n.getDefaults(),arguments,["value"]);return t.input=t._param=new Jh({context:t.context,convert:i.convert,multiplier:i.multiplier,param:t._constantSource.offset,units:i.units,value:i.value}),t}return C(n,[{key:"ticksToTime",value:function(t,e){return this._param.ticksToTime(t,e)}},{key:"timeToTicks",value:function(t,e){return this._param.timeToTicks(t,e)}},{key:"getTimeOfTick",value:function(t){return this._param.getTimeOfTick(t)}},{key:"getDurationOfTicks",value:function(t,e){return this._param.getDurationOfTicks(t,e)}},{key:"getTicksAtTime",value:function(t){return this._param.getTicksAtTime(t)}},{key:"multiplier",get:function(){return this._param.multiplier},set:function(t){this._param.multiplier=t}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._param.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Qh.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(Qh),ep=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["frequency"]))).name="TickSource",t._state=new Xh,t._tickOffset=new oh;var i=Zc(n.getDefaults(),arguments,["frequency"]);return t.frequency=new tp({context:t.context,units:i.units,value:i.frequency}),mh(s(t),"frequency"),t._state.setStateAtTime("stopped",0),t.setTicksAtTime(0,0),t}return C(n,[{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"start",value:function(t,e){var n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Pc(e)&&this.setTicksAtTime(e,n)),this}},{key:"stop",value:function(t){var e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){var n=this._state.get(e);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}},{key:"pause",value:function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}},{key:"cancel",value:function(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}},{key:"getTicksAtTime",value:function(t){var e=this,n=this.toSeconds(t),i=this._state.getLastState("stopped",n),r={state:"paused",time:n};this._state.add(r);var a=i,o=0;return this._state.forEachBetween(i.time,n+this.sampleTime,(function(t){var n=a.time,i=e._tickOffset.get(t.time);i&&i.time>=a.time&&(o=i.ticks,n=i.time),"started"===a.state&&"started"!==t.state&&(o+=e.frequency.getTicksAtTime(t.time)-e.frequency.getTicksAtTime(n)),a=t})),this._state.remove(r),o}},{key:"ticks",get:function(){return this.getTicksAtTime(this.now())},set:function(t){this.setTicksAtTime(t,this.now())}},{key:"seconds",get:function(){return this.getSecondsAtTime(this.now())},set:function(t){var e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}},{key:"getSecondsAtTime",value:function(t){var e=this;t=this.toSeconds(t);var n=this._state.getLastState("stopped",t),i={state:"paused",time:t};this._state.add(i);var r=n,a=0;return this._state.forEachBetween(n.time,t+this.sampleTime,(function(t){var n=r.time,i=e._tickOffset.get(t.time);i&&i.time>=r.time&&(a=i.seconds,n=i.time),"started"===r.state&&"started"!==t.state&&(a+=t.time-n),r=t})),this._state.remove(i),a}},{key:"setTicksAtTime",value:function(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}},{key:"getStateAtTime",value:function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}},{key:"getTimeOfTick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now(),n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),a=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(a)}},{key:"forEachTickBetween",value:function(t,e,n){var i=this,r=this._state.get(t);this._state.forEachBetween(t,e,(function(e){r&&"started"===r.state&&"started"!==e.state&&i.forEachTickBetween(Math.max(r.time,t),e.time-i.sampleTime,n),r=e}));var a=null;if(r&&"started"===r.state){var o=Math.max(r.time,t),s=this.frequency.getTicksAtTime(o),u=s-this.frequency.getTicksAtTime(r.time),l=Math.ceil(u)-u;l=rh(l,1)?0:l;for(var c=this.frequency.getTimeOfTick(s+l);c<e;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(t){a=t;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(a)throw a;return this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign({frequency:1,units:"hertz"},qh.getDefaults())}}]),n}(qh),np=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["callback","frequency"]))).name="Clock",t.callback=gh,t._lastUpdate=0,t._state=new Xh("stopped"),t._boundLoop=t._loop.bind(s(t));var i=Zc(n.getDefaults(),arguments,["callback","frequency"]);return t.callback=i.callback,t._tickSource=new ep({context:t.context,frequency:i.frequency,units:i.units}),t._lastUpdate=0,t.frequency=t._tickSource.frequency,mh(s(t),"frequency"),t._state.setStateAtTime("stopped",0),t.context.on("tick",t._boundLoop),t}return C(n,[{key:"state",get:function(){return this._state.getValueAtTime(this.now())}},{key:"start",value:function(t,e){xc(this.context);var n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}},{key:"stop",value:function(t){var e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}},{key:"pause",value:function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}},{key:"ticks",get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(t){this._tickSource.ticks=t}},{key:"seconds",get:function(){return this._tickSource.seconds},set:function(t){this._tickSource.seconds=t}},{key:"getSecondsAtTime",value:function(t){return this._tickSource.getSecondsAtTime(t)}},{key:"setTicksAtTime",value:function(t,e){return this._tickSource.setTicksAtTime(t,e),this}},{key:"getTimeOfTick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(t,e)}},{key:"getTicksAtTime",value:function(t){return this._tickSource.getTicksAtTime(t)}},{key:"nextTickTime",value:function(t,e){var n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}},{key:"_loop",value:function(){var t=this._lastUpdate,e=this.now();if(this._lastUpdate=e,this.log("loop",t,e),t!==e){var n=this;this._state.forEachBetween(t,e,(function(t){switch(t.state){case"started":var e=n._tickSource.getTicksAtTime(t.time);n.emit("start",t.time,e);break;case"stopped":0!==t.time&&n.emit("stop",t.time);break;case"paused":n.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,(function(t,e){n.callback(t,e)}))}}},{key:"getStateAtTime",value:function(t){var e=this.toSeconds(t);return this._state.getValueAtTime(e)}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qh.getDefaults(),{callback:gh,frequency:1,units:"hertz"})}}]),n}(qh);ph.mixin(np);var ip=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Ticks",t.defaultUnits="i",t}return C(n,[{key:"_now",value:function(){return this.context.transport.ticks}},{key:"_beatsToUnits",value:function(t){return this._getPPQ()*t}},{key:"_secondsToUnits",value:function(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}},{key:"_ticksToUnits",value:function(t){return t}},{key:"toTicks",value:function(){return this.valueOf()}},{key:"toSeconds",value:function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}]),n}(Bh);var rp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="IntervalTimeline",t._root=null,t._length=0,t}return C(n,[{key:"add",value:function(t){wc(Pc(t.time),"Events must have a time property"),wc(Pc(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();var e=new ap(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}},{key:"remove",value:function(t){if(null!==this._root){var e=[];this._root.search(t.time,e);var n=!0,i=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.event===t){this._removeNode(s),this._length--;break}}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}}return this}},{key:"length",get:function(){return this._length}},{key:"cancel",value:function(t){var e=this;return this.forEachFrom(t,(function(t){return e.remove(t)})),this}},{key:"_setRoot",value:function(t){this._root=t,null!==this._root&&(this._root.parent=null)}},{key:"_replaceNodeInParent",value:function(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}},{key:"_removeNode",value:function(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{var e,n=null;if(t.getBalance()>0)if(null===t.left.right)(e=t.left).right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)(e=t.right).left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}},{key:"_rotateLeft",value:function(t){var e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}},{key:"_rotateRight",value:function(t){var e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}},{key:"_rebalance",value:function(t){var e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}},{key:"get",value:function(t){if(null!==this._root){var e=[];if(this._root.search(t,e),e.length>0){for(var n=e[0],i=1;i<e.length;i++)e[i].low>n.low&&(n=e[i]);return n.event}}return null}},{key:"forEach",value:function(t){if(null!==this._root){var e=[];this._root.traverse((function(t){return e.push(t)})),e.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"forEachAtTime",value:function(t,e){if(null!==this._root){var n=[];this._root.search(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"forEachFrom",value:function(t,e){if(null!==this._root){var n=[];this._root.searchAfter(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),null!==this._root&&this._root.traverse((function(t){return t.dispose()})),this._root=null,this}}]),n}(Jc),ap=function(){"use strict";function t(e,n,i){c(this,t),this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}return C(t,[{key:"insert",value:function(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}},{key:"search",value:function(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}},{key:"searchAfter",value:function(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}},{key:"traverse",value:function(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}},{key:"updateHeight",value:function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}},{key:"updateMax",value:function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}},{key:"getBalance",value:function(){var t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}},{key:"isLeftChild",value:function(){return null!==this.parent&&this.parent.left===this}},{key:"left",get:function(){return this._left},set:function(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}},{key:"right",get:function(){return this._right},set:function(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}},{key:"dispose",value:function(){this.parent=null,this._left=null,this._right=null,this.event=null}}]),t}(),op=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["volume"]))).name="Volume";var i=Zc(n.getDefaults(),arguments,["volume"]);return t.input=t.output=new Gh({context:t.context,gain:i.volume,units:"decibels"}),t.volume=t.output.gain,mh(s(t),"volume"),t._unmutedVolume=i.volume,t.mute=i.mute,t}return C(n,[{key:"mute",get:function(){return this.volume.value===-1/0},set:function(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.input.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{mute:!1,volume:0})}}]),n}(zh),sp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments))).name="Destination",t.input=new op({context:t.context}),t.output=new Gh({context:t.context}),t.volume=t.input.volume;var i=Zc(n.getDefaults(),arguments);return Uh(t.input,t.output,t.context.rawContext.destination),t.mute=i.mute,t._internalChannels=[t.input,t.context.rawContext.destination,t.output],t}return C(n,[{key:"mute",get:function(){return this.input.mute},set:function(t){this.input.mute=t}},{key:"chain",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Uh.apply(void 0,B(e)),this}},{key:"maxChannelCount",get:function(){return this.context.rawContext.destination.maxChannelCount}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{mute:!1,volume:0})}}]),n}(zh);uh((function(t){t.destination=new sp({context:t})})),ch((function(t){t.destination.dispose()}));var up=function(t){"use strict";O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this)).name="TimelineValue",i._timeline=new oh({memory:10}),i._initialValue=t,i}return C(n,[{key:"set",value:function(t,e){return this._timeline.add({value:t,time:e}),this}},{key:"get",value:function(t){var e=this._timeline.get(t);return e?e.value:this._initialValue}}]),n}(Jc),lp=function(){"use strict";function t(e,n){c(this,t),this.id=t._eventId++;var i=Object.assign(t.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=i.time}return C(t,[{key:"invoke",value:function(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}},{key:"dispose",value:function(){return this.callback=void 0,this}}],[{key:"getDefaults",value:function(){return{callback:gh,once:!1,time:0}}}]),t}();lp._eventId=0;var cp=function(t){"use strict";O(n,t);var e=P(n);function n(t,i){var r;c(this,n),(r=e.call(this,t,i))._currentId=-1,r._nextId=-1,r._nextTick=r.time,r._boundRestart=r._restart.bind(s(r));var a=Object.assign(n.getDefaults(),i);return r.duration=new ip(t.context,a.duration).valueOf(),r._interval=new ip(t.context,a.interval).valueOf(),r._nextTick=a.time,r.transport.on("start",r._boundRestart),r.transport.on("loopStart",r._boundRestart),r.context=r.transport.context,r._restart(),r}return C(n,[{key:"invoke",value:function(t){this._createEvents(t),V(M(n.prototype),"invoke",this).call(this,t)}},{key:"_createEvents",value:function(t){var e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ip(this.context,this._nextTick).toSeconds()))}},{key:"_restart",value:function(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;var e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new ip(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ip(this.context,this._nextTick).toSeconds())}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}],[{key:"getDefaults",value:function(){return Object.assign({},lp.getDefaults(),{duration:1/0,interval:1,once:!1})}}]),n}(lp),hp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments))).name="Transport",t._loop=new up(!1),t._loopStart=0,t._loopEnd=0,t._scheduledEvents={},t._timeline=new oh,t._repeatedEvents=new rp,t._syncedSignals=[],t._swingAmount=0;var i=Zc(n.getDefaults(),arguments);return t._ppq=i.ppq,t._clock=new np({callback:t._processTick.bind(s(t)),context:t.context,frequency:0,units:"bpm"}),t._bindClockEvents(),t.bpm=t._clock.frequency,t._clock.frequency.multiplier=i.ppq,t.bpm.setValueAtTime(i.bpm,0),mh(s(t),"bpm"),t._timeSignature=i.timeSignature,t._swingTicks=i.ppq/2,t}return C(n,[{key:"_processTick",value:function(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){var n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new ip(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(function(e){return e.invoke(t)}))}},{key:"schedule",value:function(t,e){var n=new lp(this,{callback:t,time:new Bh(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}},{key:"scheduleRepeat",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,r=new cp(this,{callback:t,duration:new Lh(this.context,i).toTicks(),interval:new Lh(this.context,e).toTicks(),time:new Bh(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}},{key:"scheduleOnce",value:function(t,e){var n=new lp(this,{callback:t,once:!0,time:new Bh(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}},{key:"clear",value:function(t){if(this._scheduledEvents.hasOwnProperty(t)){var e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}},{key:"_addEvent",value:function(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}},{key:"cancel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,n=this.toTicks(t);return this._timeline.forEachFrom(n,(function(t){return e.clear(t.id)})),this._repeatedEvents.forEachFrom(n,(function(t){return e.clear(t.id)})),this}},{key:"_bindClockEvents",value:function(){var t=this;this._clock.on("start",(function(e,n){n=new ip(t.context,n).toSeconds(),t.emit("start",e,n)})),this._clock.on("stop",(function(e){t.emit("stop",e)})),this._clock.on("pause",(function(e){t.emit("pause",e)}))}},{key:"state",get:function(){return this._clock.getStateAtTime(this.now())}},{key:"start",value:function(t,e){var n;return Pc(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}},{key:"stop",value:function(t){return this._clock.stop(t),this}},{key:"pause",value:function(t){return this._clock.pause(t),this}},{key:"toggle",value:function(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}},{key:"timeSignature",get:function(){return this._timeSignature},set:function(t){Dc(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}},{key:"loopStart",get:function(){return new Lh(this.context,this._loopStart,"i").toSeconds()},set:function(t){this._loopStart=this.toTicks(t)}},{key:"loopEnd",get:function(){return new Lh(this.context,this._loopEnd,"i").toSeconds()},set:function(t){this._loopEnd=this.toTicks(t)}},{key:"loop",get:function(){return this._loop.get(this.now())},set:function(t){this._loop.set(t,this.now())}},{key:"setLoopPoints",value:function(t,e){return this.loopStart=t,this.loopEnd=e,this}},{key:"swing",get:function(){return this._swingAmount},set:function(t){this._swingAmount=t}},{key:"swingSubdivision",get:function(){return new ip(this.context,this._swingTicks).toNotation()},set:function(t){this._swingTicks=this.toTicks(t)}},{key:"position",get:function(){var t=this.now(),e=this._clock.getTicksAtTime(t);return new ip(this.context,e).toBarsBeatsSixteenths()},set:function(t){var e=this.toTicks(t);this.ticks=e}},{key:"seconds",get:function(){return this._clock.seconds},set:function(t){var e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}},{key:"progress",get:function(){if(this.loop){var t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}},{key:"ticks",get:function(){return this._clock.ticks},set:function(t){if(this._clock.ticks!==t){var e=this.now();if("started"===this.state){var n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}},{key:"getTicksAtTime",value:function(t){return Math.round(this._clock.getTicksAtTime(t))}},{key:"getSecondsAtTime",value:function(t){return this._clock.getSecondsAtTime(t)}},{key:"PPQ",get:function(){return this._clock.frequency.multiplier},set:function(t){this._clock.frequency.multiplier=t}},{key:"nextSubdivision",value:function(t){if(t=this.toTicks(t),"started"!==this.state)return 0;var e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}},{key:"syncSignal",value:function(t,e){if(!e){var n=this.now();if(0!==t.getValueAtTime(n)){var i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}var r=new Gh(e);return this.bpm.connect(r),r.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:r,signal:t}),t.value=0,this}},{key:"unsyncSignal",value:function(t){for(var e=this._syncedSignals.length-1;e>=0;e--){var n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._clock.dispose(),_h(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qh.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}}]),n}(qh);ph.mixin(hp),uh((function(t){t.transport=new hp({context:t})})),ch((function(t){t.transport.dispose()}));var pp=function(t){"use strict";O(n,t);var e=P(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).input=void 0,i._state=new Xh("stopped"),i._synced=!1,i._scheduled=[],i._syncedStart=gh,i._syncedStop=gh,i._state.memory=100,i._state.increasing=!0,i._volume=i.output=new op({context:i.context,mute:t.mute,volume:t.volume}),i.volume=i._volume.volume,mh(s(i),"volume"),i.onstop=t.onstop,i}return C(n,[{key:"state",get:function(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}},{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"_clampToCurrentTime",value:function(t){return this._synced?t:Math.max(t,this.context.currentTime)}},{key:"start",value:function(t,e,n){var i=Tc(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){var r=this,a=this._state.get(i);a&&(a.offset=this.toSeconds(Qc(e,0)),a.duration=n?this.toSeconds(n):void 0);var o=this.context.transport.schedule((function(t){r._start(t,e,n)}),i);this._scheduled.push(o),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else xc(this.context),this._start(i,e,n);else wc(eh(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}},{key:"stop",value:function(t){var e=Tc(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Pc(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){var n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}},{key:"restart",value:function(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}},{key:"sync",value:function(){if(!this._synced){var t=this;this._synced=!0,this._syncedStart=function(e,n){if(n>0){var i=t._state.get(n);if(i&&"started"===i.state&&i.time!==n){var r,a=n-t.toSeconds(i.time);i.duration&&(r=t.toSeconds(i.duration)-a),t._start(e,t.toSeconds(i.offset)+a,r)}}},this._syncedStop=function(e){var n=t.context.transport.getSecondsAtTime(Math.max(e-t.sampleTime,0));"started"===t._state.getValueAtTime(n)&&t._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)}return this}},{key:"unsync",value:function(){var t=this;return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((function(e){return t.context.transport.clear(e)})),this._scheduled=[],this._state.cancel(0),this._stop(0),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.onstop=gh,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{mute:!1,onstop:gh,volume:0})}}]),n}(zh);function vp(t,n){return jc(this,void 0,void 0,e(ia).mark((function i(){var r,a,o;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n/t.context.sampleRate,a=new bh(1,r,t.context.sampleRate),new t.constructor(Object.assign(t.get(),{frequency:2/r,detune:0,context:a})).toDestination().start(0),e.next=6,a.render();case 6:return o=e.sent,e.abrupt("return",o.getChannelData(0));case 8:case"end":return e.stop()}}),i)})))}var fp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["frequency","type"]))).name="ToneOscillatorNode",t._oscillator=t.context.createOscillator(),t._internalChannels=[t._oscillator];var i=Zc(n.getDefaults(),arguments,["frequency","type"]);return Wh(t._oscillator,t._gainNode),t.type=i.type,t.frequency=new jh({context:t.context,param:t._oscillator.frequency,units:"frequency",value:i.frequency}),t.detune=new jh({context:t.context,param:t._oscillator.detune,units:"cents",value:i.detune}),mh(s(t),["frequency","detune"]),t}return C(n,[{key:"start",value:function(t){var e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}},{key:"_stopSource",value:function(t){this._oscillator.stop(t)}},{key:"setPeriodicWave",value:function(t){return this._oscillator.setPeriodicWave(t),this}},{key:"type",get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Kh.getDefaults(),{detune:0,frequency:440,type:"sine"})}}]),n}(Kh),dp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","type"]))).name="Oscillator",t._oscillator=null;var e=Zc(i.getDefaults(),arguments,["frequency","type"]);return t.frequency=new Qh({context:t.context,units:"frequency",value:e.frequency}),mh(s(t),"frequency"),t.detune=new Qh({context:t.context,units:"cents",value:e.detune}),mh(s(t),"detune"),t._partials=e.partials,t._partialCount=e.partialCount,t._type=e.type,e.partialCount&&"custom"!==e.type&&(t._type=t.baseType+e.partialCount.toString()),t.phase=e.phase,t}return C(i,[{key:"_start",value:function(t){var e=this,n=this.toSeconds(t),i=new fp({context:this.context,onended:function(){return e.onstop(e)}});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}},{key:"_stop",value:function(t){var e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}},{key:"_restart",value:function(t){var e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}},{key:"syncFrequency",value:function(){return this.context.transport.syncSignal(this.frequency),this}},{key:"unsyncFrequency",value:function(){return this.context.transport.unsyncSignal(this.frequency),this}},{key:"_getCachedPeriodicWave",value:function(){if("custom"===this._type){var t=this;return i._periodicWaveCache.find((function(e){return e.phase===t._phase&&(n=e.partials,i=t._partials,n.length===i.length&&n.every((function(t,e){return i[e]===t})));var n,i}))}var e=this,n=i._periodicWaveCache.find((function(t){return t.type===e._type&&t.phase===e._phase}));return this._partialCount=n?n.partialCount:this._partialCount,n}},{key:"type",get:function(){return this._type},set:function(t){this._type=t;var e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{var n=this._getCachedPeriodicWave();if(Pc(n)){var r=n.partials,a=n.wave;this._wave=a,this._partials=r,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{var o=F(this._getRealImaginary(t,this._phase),2),s=o[0],u=o[1],l=this.context.createPeriodicWave(s,u);this._wave=l,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),i._periodicWaveCache.push({imag:u,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),i._periodicWaveCache.length>100&&i._periodicWaveCache.shift()}}}},{key:"baseType",get:function(){return this._type.replace(this.partialCount.toString(),"")},set:function(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}},{key:"partialCount",get:function(){return this._partialCount},set:function(t){kc(t,0);var e=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{var i=new Float32Array(t);this._partials.forEach((function(t,e){return i[e]=t})),this._partials=Array.from(i),this.type=this._type}}},{key:"_getRealImaginary",value:function(t,e){var n=2048,i=new Float32Array(n),r=new Float32Array(n),a=1;if("custom"===t){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,0===this._partials.length)return[i,r]}else{var o=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);o?(a=parseInt(o[2],10)+1,this._partialCount=parseInt(o[2],10),t=o[1],n=a=Math.max(a,2)):this._partialCount=0,this._partials=[]}for(var s=1;s<n;++s){var u=2/(s*Math.PI),l=void 0;switch(t){case"sine":l=s<=a?1:0,this._partials[s-1]=l;break;case"square":l=1&s?2*u:0,this._partials[s-1]=l;break;case"sawtooth":l=u*(1&s?1:-1),this._partials[s-1]=l;break;case"triangle":l=1&s?u*u*2*(s-1>>1&1?-1:1):0,this._partials[s-1]=l;break;case"custom":l=this._partials[s-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==l?(i[s]=-l*Math.sin(e*s),r[s]=l*Math.cos(e*s)):(i[s]=0,r[s]=0)}return[i,r]}},{key:"_inverseFFT",value:function(t,e,n){for(var i=0,r=t.length,a=0;a<r;a++)i+=t[a]*Math.cos(a*n)+e[a]*Math.sin(a*n);return i}},{key:"getInitialValue",value:function(){for(var t=F(this._getRealImaginary(this._type,0),2),e=t[0],n=t[1],i=0,r=2*Math.PI,a=0;a<32;a++)i=Math.max(this._inverseFFT(e,n,a/32*r),i);return ah(-this._inverseFFT(e,n,this._phase)/i,-1,1)}},{key:"partials",get:function(){return this._partials.slice(0,this.partialCount)},set:function(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}},{key:"phase",get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pp.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}}]),i}(pp);dp._periodicWaveCache=[];var mp=function(t){"use strict";O(n,t);var e=P(n);function n(){return c(this,n),e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["context"])))}return C(n,[{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $h(this,t,e,n),this}}]),n}(zh),_p=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["mapping","length"])))).name="WaveShaper",t._shaper=t.context.createWaveShaper(),t.input=t._shaper,t.output=t._shaper;var i=Zc(n.getDefaults(),arguments,["mapping","length"]);return Dc(i.mapping)||i.mapping instanceof Float32Array?t.curve=Float32Array.from(i.mapping):Ac(i.mapping)&&t.setMap(i.mapping,i.length),t}return C(n,[{key:"setMap",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=new Float32Array(e),i=0,r=e;i<r;i++){var a=i/(r-1)*2-1;n[i]=t(a,i)}return this.curve=n,this}},{key:"curve",get:function(){return this._shaper.curve},set:function(t){this._shaper.curve=t}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(t){wc(["none","2x","4x"].some((function(e){return e.includes(t)})),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._shaper.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Qh.getDefaults(),{length:1024})}}]),n}(mp),gp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="AudioToGain",t._norm=new _p({context:t.context,mapping:function(t){return(t+1)/2}}),t.input=t._norm,t.output=t._norm,t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._norm.dispose(),this}}]),n}(mp),yp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["value"])))).name="Multiply",t.override=!1;var i=Zc(n.getDefaults(),arguments,["value"]);return t._mult=t.input=t.output=new Gh({context:t.context,minValue:i.minValue,maxValue:i.maxValue}),t.factor=t._param=t._mult.gain,t.factor.setValueAtTime(i.value,0),t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Qh.getDefaults(),{value:0})}}]),n}(Qh),bp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","type","modulationType"]))).name="AMOscillator",t._modulationScale=new gp({context:t.context}),t._modulationNode=new Gh({context:t.context});var e=Zc(i.getDefaults(),arguments,["frequency","type","modulationType"]);return t._carrier=new dp({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(s(t))},phase:e.phase,type:e.type}),t.frequency=t._carrier.frequency,t.detune=t._carrier.detune,t._modulator=new dp({context:t.context,phase:e.phase,type:e.modulationType}),t.harmonicity=new yp({context:t.context,units:"positive",value:e.harmonicity}),t.frequency.chain(t.harmonicity,t._modulator.frequency),t._modulator.chain(t._modulationScale,t._modulationNode.gain),t._carrier.chain(t._modulationNode,t.output),mh(s(t),["frequency","detune","harmonicity"]),t}return C(i,[{key:"_start",value:function(t){this._modulator.start(t),this._carrier.start(t)}},{key:"_stop",value:function(t){this._modulator.stop(t),this._carrier.stop(t)}},{key:"_restart",value:function(t){this._modulator.restart(t),this._carrier.restart(t)}},{key:"type",get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}},{key:"modulationType",get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}},{key:"phase",get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}},{key:"partials",get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(dp.getDefaults(),{harmonicity:1,modulationType:"square"})}}]),i}(pp),wp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","type","modulationType"]))).name="FMOscillator",t._modulationNode=new Gh({context:t.context,gain:0});var e=Zc(i.getDefaults(),arguments,["frequency","type","modulationType"]);return t._carrier=new dp({context:t.context,detune:e.detune,frequency:0,onstop:function(){return t.onstop(s(t))},phase:e.phase,type:e.type}),t.detune=t._carrier.detune,t.frequency=new Qh({context:t.context,units:"frequency",value:e.frequency}),t._modulator=new dp({context:t.context,phase:e.phase,type:e.modulationType}),t.harmonicity=new yp({context:t.context,units:"positive",value:e.harmonicity}),t.modulationIndex=new yp({context:t.context,units:"positive",value:e.modulationIndex}),t.frequency.connect(t._carrier.frequency),t.frequency.chain(t.harmonicity,t._modulator.frequency),t.frequency.chain(t.modulationIndex,t._modulationNode),t._modulator.connect(t._modulationNode.gain),t._modulationNode.connect(t._carrier.frequency),t._carrier.connect(t.output),t.detune.connect(t._modulator.detune),mh(s(t),["modulationIndex","frequency","detune","harmonicity"]),t}return C(i,[{key:"_start",value:function(t){this._modulator.start(t),this._carrier.start(t)}},{key:"_stop",value:function(t){this._modulator.stop(t),this._carrier.stop(t)}},{key:"_restart",value:function(t){return this._modulator.restart(t),this._carrier.restart(t),this}},{key:"type",get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}},{key:"modulationType",get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}},{key:"phase",get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}},{key:"partials",get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(dp.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}}]),i}(pp),kp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","width"]))).name="PulseOscillator",t._widthGate=new Gh({context:t.context,gain:0}),t._thresh=new _p({context:t.context,mapping:function(t){return t<=0?-1:1}});var e=Zc(i.getDefaults(),arguments,["frequency","width"]);return t.width=new Qh({context:t.context,units:"audioRange",value:e.width}),t._triangle=new dp({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(s(t))},phase:e.phase,type:"triangle"}),t.frequency=t._triangle.frequency,t.detune=t._triangle.detune,t._triangle.chain(t._thresh,t.output),t.width.chain(t._widthGate,t._thresh),mh(s(t),["width","frequency","detune"]),t}return C(i,[{key:"_start",value:function(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}},{key:"_restart",value:function(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}},{key:"phase",get:function(){return this._triangle.phase},set:function(t){this._triangle.phase=t}},{key:"type",get:function(){return"pulse"}},{key:"baseType",get:function(){return"pulse"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"carrierType",set:function(t){this._triangle.type=t}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pp.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}}]),i}(pp),xp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","type","spread"]))).name="FatOscillator",t._oscillators=[];var e=Zc(i.getDefaults(),arguments,["frequency","type","spread"]);return t.frequency=new Qh({context:t.context,units:"frequency",value:e.frequency}),t.detune=new Qh({context:t.context,units:"cents",value:e.detune}),t._spread=e.spread,t._type=e.type,t._phase=e.phase,t._partials=e.partials,t._partialCount=e.partialCount,t.count=e.count,mh(s(t),["frequency","detune"]),t}return C(i,[{key:"_start",value:function(t){t=this.toSeconds(t),this._forEach((function(e){return e.start(t)}))}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._forEach((function(e){return e.stop(t)}))}},{key:"_restart",value:function(t){this._forEach((function(e){return e.restart(t)}))}},{key:"_forEach",value:function(t){for(var e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}},{key:"type",get:function(){return this._type},set:function(t){this._type=t,this._forEach((function(e){return e.type=t}))}},{key:"spread",get:function(){return this._spread},set:function(t){if(this._spread=t,this._oscillators.length>1){var e=-t/2,n=t/(this._oscillators.length-1);this._forEach((function(t,i){return t.detune.value=e+n*i}))}}},{key:"count",get:function(){return this._oscillators.length},set:function(t){if(kc(t,1),this._oscillators.length!==t){this._forEach((function(t){return t.dispose()})),this._oscillators=[];for(var e=0;e<t;e++){var n=this,i=new dp({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?function(){return n.onstop(n)}:gh});"custom"===this.type&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[e]=i}this.spread=this._spread,"started"===this.state&&this._forEach((function(t){return t.start()}))}}},{key:"phase",get:function(){return this._phase},set:function(t){var e=this;this._phase=t,this._forEach((function(t,n){return t.phase=e._phase+n/e.count*360}))}},{key:"baseType",get:function(){return this._oscillators[0].baseType},set:function(t){this._forEach((function(e){return e.baseType=t})),this._type=this._oscillators[0].type}},{key:"partials",get:function(){return this._oscillators[0].partials},set:function(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((function(e){return e.partials=t})))}},{key:"partialCount",get:function(){return this._oscillators[0].partialCount},set:function(t){this._partialCount=t,this._forEach((function(e){return e.partialCount=t})),this._type=this._oscillators[0].type}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this._forEach((function(t){return t.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(dp.getDefaults(),{count:3,spread:20,type:"sawtooth"})}}]),i}(pp),Cp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","modulationFrequency"]))).name="PWMOscillator",t.sourceType="pwm",t._scale=new yp({context:t.context,value:2});var e=Zc(i.getDefaults(),arguments,["frequency","modulationFrequency"]);return t._pulse=new kp({context:t.context,frequency:e.modulationFrequency}),t._pulse.carrierType="sine",t.modulationFrequency=t._pulse.frequency,t._modulator=new dp({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(s(t))},phase:e.phase}),t.frequency=t._modulator.frequency,t.detune=t._modulator.detune,t._modulator.chain(t._scale,t._pulse.width),t._pulse.connect(t.output),mh(s(t),["modulationFrequency","frequency","detune"]),t}return C(i,[{key:"_start",value:function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}},{key:"_restart",value:function(t){this._modulator.restart(t),this._pulse.restart(t)}},{key:"type",get:function(){return"pwm"}},{key:"baseType",get:function(){return"pwm"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"phase",get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pp.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}}]),i}(pp),Ep={am:bp,fat:xp,fm:wp,oscillator:dp,pulse:kp,pwm:Cp},Mp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["frequency","type"]))).name="OmniOscillator";var e=Zc(i.getDefaults(),arguments,["frequency","type"]);return t.frequency=new Qh({context:t.context,units:"frequency",value:e.frequency}),t.detune=new Qh({context:t.context,units:"cents",value:e.detune}),mh(s(t),["frequency","detune"]),t.set(e),t}return C(i,[{key:"_start",value:function(t){this._oscillator.start(t)}},{key:"_stop",value:function(t){this._oscillator.stop(t)}},{key:"_restart",value:function(t){return this._oscillator.restart(t),this}},{key:"type",get:function(){var t=this,e="";return["am","fm","fat"].some((function(e){return t._sourceType===e}))&&(e=this._sourceType),e+this._oscillator.type},set:function(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}},{key:"partials",get:function(){return this._oscillator.partials},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}},{key:"partialCount",get:function(){return this._oscillator.partialCount},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}},{key:"set",value:function(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),V(M(i.prototype),"set",this).call(this,t),this}},{key:"_createNewOscillator",value:function(t){if(t!==this._sourceType){var e=this;this._sourceType=t;var n=Ep[t],i=this.now();if(this._oscillator){var r=this._oscillator;r.stop(i),this.context.setTimeout((function(){return r.dispose()}),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=function(){return e.onstop(e)},"started"===this.state&&this._oscillator.start(i)}}},{key:"phase",get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t}},{key:"sourceType",get:function(){return this._sourceType},set:function(t){var e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}},{key:"_getOscType",value:function(t,e){return t instanceof Ep[e]}},{key:"baseType",get:function(){return this._oscillator.baseType},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}},{key:"width",get:function(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}},{key:"count",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&Sc(t)&&(this._oscillator.count=t)}},{key:"spread",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&Sc(t)&&(this._oscillator.spread=t)}},{key:"modulationType",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0},set:function(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Rc(t)&&(this._oscillator.modulationType=t)}},{key:"modulationIndex",get:function(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}},{key:"harmonicity",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}},{key:"modulationFrequency",get:function(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vp(this,t));case 1:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(dp.getDefaults(),wp.getDefaults(),bp.getDefaults(),xp.getDefaults(),kp.getDefaults(),Cp.getDefaults())}}]),i}(pp),Tp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["value"])))).override=!1,t.name="Add",t._sum=new Gh({context:t.context}),t.input=t._sum,t.output=t._sum,t.addend=t._param,Uh(t._constantSource,t._sum),t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Qh.getDefaults(),{value:0})}}]),n}(Qh),Pp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["min","max"])))).name="Scale";var i=Zc(n.getDefaults(),arguments,["min","max"]);return t._mult=t.input=new yp({context:t.context,value:i.max-i.min}),t._add=t.output=new Tp({context:t.context,value:i.min}),t._min=i.min,t._max=i.max,t.input.connect(t.output),t}return C(n,[{key:"min",get:function(){return this._min},set:function(t){this._min=t,this._setRange()}},{key:"max",get:function(){return this._max},set:function(t){this._max=t,this._setRange()}},{key:"_setRange",value:function(){this._add.value=this._min,this._mult.value=this._max-this._min}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._add.dispose(),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(mp.getDefaults(),{max:1,min:0})}}]),n}(mp);function Ap(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){kc(i,t,e),n.set(this,i)}})}}function Sp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){kc(this.toSeconds(i),t,e),n.set(this,i)}})}}var Vp=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["url","onload"]))).name="Player",t._activeSources=new Set;var e=Zc(i.getDefaults(),arguments,["url","onload"]);return t._buffer=new yh({onload:t._onload.bind(s(t),e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),t.autostart=e.autostart,t._loop=e.loop,t._loopStart=e.loopStart,t._loopEnd=e.loopEnd,t._playbackRate=e.playbackRate,t.fadeIn=e.fadeIn,t.fadeOut=e.fadeOut,t}return C(i,[{key:"load",value:function(t){return jc(this,void 0,void 0,e(ia).mark((function n(){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._buffer.load(t);case 2:return this._onload(),e.abrupt("return",this);case 4:case"end":return e.stop()}}),n,this)})))}},{key:"_onload",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gh;t(),this.autostart&&this.start()}},{key:"_onSourceEnd",value:function(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}},{key:"start",value:function(t,e,n){return V(M(i.prototype),"start",this).call(this,t,e,n),this}},{key:"_start",value:function(t,e,n){e=this._loop?Qc(e,this._loopStart):Qc(e,0);var i=this.toSeconds(e),r=n;n=Qc(n,Math.max(this._buffer.duration-i,0));var a=this.toSeconds(n);a/=this._playbackRate,t=this.toSeconds(t);var o=new Hh({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+a),this._state.setStateAtTime("stopped",t+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Tc(r)?o.start(t,i):o.start(t,i,a-this.toSeconds(this.fadeOut))}},{key:"_stop",value:function(t){var e=this.toSeconds(t);this._activeSources.forEach((function(t){return t.stop(e)}))}},{key:"restart",value:function(t,e,n){return V(M(i.prototype),"restart",this).call(this,t,e,n),this}},{key:"_restart",value:function(t,e,n){this._stop(t),this._start(t,e,n)}},{key:"seek",value:function(t,e){var n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){var i=this.toSeconds(t);this._stop(n),this._start(n,i)}return this}},{key:"setLoopPoints",value:function(t,e){return this.loopStart=t,this.loopEnd=e,this}},{key:"loopStart",get:function(){return this._loopStart},set:function(t){this._loopStart=t,this.buffer.loaded&&kc(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((function(e){e.loopStart=t}))}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this.buffer.loaded&&kc(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((function(e){e.loopEnd=t}))}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer.set(t)}},{key:"loop",get:function(){return this._loop},set:function(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((function(e){e.loop=t})),t)){var e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){this._playbackRate=t;var e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((function(t){return t.cancelStop()}))),this._activeSources.forEach((function(n){n.playbackRate.setValueAtTime(t,e)}))}},{key:"reverse",get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t}},{key:"loaded",get:function(){return this._buffer.loaded}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this._activeSources.forEach((function(t){return t.dispose()})),this._activeSources.clear(),this._buffer.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pp.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:gh,onerror:gh,playbackRate:1,reverse:!1})}}]),i}(pp);qc([Sp(0)],Vp.prototype,"fadeIn",void 0),qc([Sp(0)],Vp.prototype,"fadeOut",void 0);var Op=function(t){"use strict";O(i,t);var n=P(i);function i(){var t;c(this,i),(t=n.call(this,Zc(i.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="Envelope",t._sig=new Qh({context:t.context,value:0}),t.output=t._sig,t.input=void 0;var e=Zc(i.getDefaults(),arguments,["attack","decay","sustain","release"]);return t.attack=e.attack,t.decay=e.decay,t.sustain=e.sustain,t.release=e.release,t.attackCurve=e.attackCurve,t.releaseCurve=e.releaseCurve,t.decayCurve=e.decayCurve,t}return C(i,[{key:"value",get:function(){return this.getValueAtTime(this.now())}},{key:"_getCurve",value:function(t,e){if(Rc(t))return t;var n;for(n in Dp)if(Dp[n][e]===t)return n;return t}},{key:"_setCurve",value:function(t,e,n){if(Rc(n)&&Reflect.has(Dp,n)){var i=Dp[n];Vc(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Dc(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}},{key:"attackCurve",get:function(){return this._getCurve(this._attackCurve,"In")},set:function(t){this._setCurve("_attackCurve","In",t)}},{key:"releaseCurve",get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(t){this._setCurve("_releaseCurve","Out",t)}},{key:"decayCurve",get:function(){return this._decayCurve},set:function(t){wc(["linear","exponential"].some((function(e){return e===t})),"Invalid envelope curve: ".concat(t)),this._decayCurve=t}},{key:"triggerAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",t,e),t=this.toSeconds(t);var n=this.toSeconds(this.attack),i=n,r=this.toSeconds(this.decay),a=this.getValueAtTime(t);if(a>0){var o=1/i,s=1-a;i=s/o}if(i<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,i,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,i,t);else{this._sig.cancelAndHoldAtTime(t);for(var u=this._attackCurve,l=1;l<u.length;l++)if(u[l-1]<=a&&a<=u[l]){(u=this._attackCurve.slice(l))[0]=a;break}this._sig.setValueCurveAtTime(u,t,i,e)}if(r&&this.sustain<1){var c=e*this.sustain,h=t+i;this.log("decay",h),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(c,r+h):this._sig.exponentialApproachValueAtTime(c,h,r)}return this}},{key:"triggerRelease",value:function(t){this.log("triggerRelease",t),t=this.toSeconds(t);var e=this.getValueAtTime(t);if(e>0){var n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(wc(Dc(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}},{key:"getValueAtTime",value:function(t){return this._sig.getValueAtTime(t)}},{key:"triggerAttackRelease",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}},{key:"cancel",value:function(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}},{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $h(this,t,e,n),this}},{key:"asArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return jc(this,void 0,void 0,e(ia).mark((function n(){var i,r,a,o,s,u,l,c;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t/this.context.sampleRate,r=new bh(1,i,this.context.sampleRate),a=this.toSeconds(this.attack)+this.toSeconds(this.decay),o=a+this.toSeconds(this.release),u=o+(s=.1*o),(l=new this.constructor(Object.assign(this.get(),{attack:i*this.toSeconds(this.attack)/u,decay:i*this.toSeconds(this.decay)/u,release:i*this.toSeconds(this.release)/u,context:r})))._sig.toDestination(),l.triggerAttackRelease(i*(a+s)/u,0),e.next=11,r.render();case 11:return c=e.sent,e.abrupt("return",c.getChannelData(0));case 13:case"end":return e.stop()}}),n,this)})))}},{key:"dispose",value:function(){return V(M(i.prototype),"dispose",this).call(this),this._sig.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}}]),i}(zh);qc([Sp(0)],Op.prototype,"attack",void 0),qc([Sp(0)],Op.prototype,"decay",void 0),qc([Ap(0,1)],Op.prototype,"sustain",void 0),qc([Sp(0)],Op.prototype,"release",void 0);var Dp=function(){var t,e,n=128,i=[];for(t=0;t<n;t++)i[t]=Math.sin(t/127*(Math.PI/2));var r=[];for(t=0;t<127;t++){e=t/127;var a=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;r[t]=a/10+.83*e}r[127]=1;var o=[];for(t=0;t<n;t++)o[t]=Math.ceil(t/127*5)/5;var s=[];for(t=0;t<n;t++)e=t/127,s[t]=.5*(1-Math.cos(Math.PI*e));var u,l=[];for(t=0;t<n;t++){e=t/127;var c=4*Math.pow(e,3)+.2,h=Math.cos(c*Math.PI*2*e);l[t]=Math.abs(h*(1-e))}function p(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:p(l),Out:l},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:p(r)},sine:{In:s,Out:p(s)},step:{In:o,Out:p(o)}}}(),Rp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments)))._scheduledEvents=[],t._synced=!1,t._original_triggerAttack=t.triggerAttack,t._original_triggerRelease=t.triggerRelease;var i=Zc(n.getDefaults(),arguments);return t._volume=t.output=new op({context:t.context,volume:i.volume}),t.volume=t._volume.volume,mh(s(t),"volume"),t}return C(n,[{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}},{key:"_syncState",value:function(){var t=!1;return this._synced||(this._synced=!0,t=!0),t}},{key:"_syncMethod",value:function(t,e){var n=this,i=this["_original_"+t]=this[t];this[t]=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var o=n,s=r[e],u=n.context.transport.schedule((function(t){r[e]=t,i.apply(o,r)}),s);n._scheduledEvents.push(u)}}},{key:"unsync",value:function(){var t=this;return this._scheduledEvents.forEach((function(e){return t.context.transport.clear(e)})),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}},{key:"triggerAttackRelease",value:function(t,e,n,i){var r=this.toSeconds(n),a=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+a),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{volume:0})}}]),n}(zh),Lp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),t=e.call(this,Zc(n.getDefaults(),arguments));var i=Zc(n.getDefaults(),arguments);return t.portamento=i.portamento,t.onsilence=i.onsilence,t}return C(n,[{key:"triggerAttack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",t,e,n);var i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}},{key:"triggerRelease",value:function(t){this.log("triggerRelease",t);var e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}},{key:"setNote",value:function(t,e){var n=this.toSeconds(e),i=t instanceof Ih?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){var r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,r,n)}else this.frequency.setValueAtTime(i,n);return this}}],[{key:"getDefaults",value:function(){return Object.assign(Rp.getDefaults(),{detune:0,onsilence:gh,portamento:0})}}]),n}(Rp);qc([Sp(0)],Lp.prototype,"portamento",void 0);var Ip=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="AmplitudeEnvelope",t._gainNode=new Gh({context:t.context,gain:0}),t.output=t._gainNode,t.input=t._gainNode,t._sig.connect(t._gainNode.gain),t.output=t._gainNode,t.input=t._gainNode,t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._gainNode.dispose(),this}}]),n}(Op),Np=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments))).name="Synth";var i=Zc(n.getDefaults(),arguments);return t.oscillator=new Mp(Object.assign({context:t.context,detune:i.detune,onstop:function(){return t.onsilence(s(t))}},i.oscillator)),t.frequency=t.oscillator.frequency,t.detune=t.oscillator.detune,t.envelope=new Ip(Object.assign({context:t.context},i.envelope)),t.oscillator.chain(t.envelope,t.output),mh(s(t),["oscillator","frequency","detune","envelope"]),t}return C(n,[{key:"_triggerEnvelopeAttack",value:function(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}},{key:"_triggerEnvelopeRelease",value:function(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.oscillator.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Lp.getDefaults(),{envelope:Object.assign($c(Op.getDefaults(),Object.keys(zh.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign($c(Mp.getDefaults(),B(Object.keys(pp.getDefaults())).concat(["frequency","detune"])),{type:"triangle"})})}}]),n}(Lp),Fp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["frequency","type"]))).name="BiquadFilter";var i=Zc(n.getDefaults(),arguments,["frequency","type"]);return t._filter=t.context.createBiquadFilter(),t.input=t.output=t._filter,t.Q=new jh({context:t.context,units:"number",value:i.Q,param:t._filter.Q}),t.frequency=new jh({context:t.context,units:"frequency",value:i.frequency,param:t._filter.frequency}),t.detune=new jh({context:t.context,units:"cents",value:i.detune,param:t._filter.detune}),t.gain=new jh({context:t.context,units:"decibels",convert:!1,value:i.gain,param:t._filter.gain}),t.type=i.type,t}return C(n,[{key:"type",get:function(){return this._filter.type},set:function(t){wc(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._filter.type=t}},{key:"getFrequencyResponse",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,e=new Float32Array(t),n=0;n<t;n++){var i=Math.pow(n/t,2),r=19980*i+20;e[n]=r}var a=new Float32Array(t),o=new Float32Array(t),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(e,a,o),a}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}}]),n}(zh),Bp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["frequency","type","rolloff"]))).name="Filter",t.input=new Gh({context:t.context}),t.output=new Gh({context:t.context}),t._filters=[];var i=Zc(n.getDefaults(),arguments,["frequency","type","rolloff"]);return t._filters=[],t.Q=new Qh({context:t.context,units:"positive",value:i.Q}),t.frequency=new Qh({context:t.context,units:"frequency",value:i.frequency}),t.detune=new Qh({context:t.context,units:"cents",value:i.detune}),t.gain=new Qh({context:t.context,units:"decibels",convert:!1,value:i.gain}),t._type=i.type,t.rolloff=i.rolloff,mh(s(t),["detune","frequency","gain","Q"]),t}return C(n,[{key:"type",get:function(){return this._type},set:function(t){wc(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._type=t,this._filters.forEach((function(e){return e.type=t}))}},{key:"rolloff",get:function(){return this._rolloff},set:function(t){var e=Sc(t)?t:parseInt(t,10),n=[-12,-24,-48,-96],i=n.indexOf(e);wc(-1!==i,"rolloff can only be ".concat(n.join(", "))),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((function(t){return t.disconnect()})),this._filters=new Array(i);for(var r=0;r<i;r++){var a=new Fp({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[r]=a}this._internalChannels=this._filters,Uh.apply(void 0,[this.input].concat(B(this._internalChannels),[this.output]))}},{key:"getFrequencyResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,e=new Fp({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((function(){return 1}));return this._filters.forEach((function(){e.getFrequencyResponse(t).forEach((function(t,e){return n[e]*=t}))})),e.dispose(),n}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._filters.forEach((function(t){t.dispose()})),_h(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}}]),n}(zh),qp=[1,1.483,1.932,2.546,2.63,3.897],jp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments))).name="MetalSynth",t._oscillators=[],t._freqMultipliers=[];var i=Zc(n.getDefaults(),arguments);t.detune=new Qh({context:t.context,units:"cents",value:i.detune}),t.frequency=new Qh({context:t.context,units:"frequency"}),t._amplitude=new Gh({context:t.context,gain:0}).connect(t.output),t._highpass=new Bp({Q:0,context:t.context,type:"highpass"}).connect(t._amplitude);for(var r=0;r<qp.length;r++){var a=new wp({context:t.context,harmonicity:i.harmonicity,modulationIndex:i.modulationIndex,modulationType:"square",onstop:0===r?function(){return t.onsilence(s(t))}:gh,type:"square"});a.connect(t._highpass),t._oscillators[r]=a;var o=new yp({context:t.context,value:qp[r]});t._freqMultipliers[r]=o,t.frequency.chain(o,a.frequency),t.detune.connect(a.detune)}return t._filterFreqScaler=new Pp({context:t.context,max:7e3,min:t.toFrequency(i.resonance)}),t.envelope=new Op({attack:i.envelope.attack,attackCurve:"linear",context:t.context,decay:i.envelope.decay,release:i.envelope.release,sustain:0}),t.envelope.chain(t._filterFreqScaler,t._highpass.frequency),t.envelope.connect(t._amplitude.gain),t._octaves=i.octaves,t.octaves=i.octaves,t}return C(n,[{key:"_triggerEnvelopeAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;return this.envelope.triggerAttack(t,e),this._oscillators.forEach((function(e){return e.start(t)})),0===this.envelope.sustain&&this._oscillators.forEach((function(e){e.stop(t+n.toSeconds(n.envelope.attack)+n.toSeconds(n.envelope.decay))})),this}},{key:"_triggerEnvelopeRelease",value:function(t){var e=this;return this.envelope.triggerRelease(t),this._oscillators.forEach((function(n){return n.stop(t+e.toSeconds(e.envelope.release))})),this}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"modulationIndex",get:function(){return this._oscillators[0].modulationIndex.value},set:function(t){this._oscillators.forEach((function(e){return e.modulationIndex.value=t}))}},{key:"harmonicity",get:function(){return this._oscillators[0].harmonicity.value},set:function(t){this._oscillators.forEach((function(e){return e.harmonicity.value=t}))}},{key:"resonance",get:function(){return this._filterFreqScaler.min},set:function(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._oscillators.forEach((function(t){return t.dispose()})),this._freqMultipliers.forEach((function(t){return t.dispose()})),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Xc(Lp.getDefaults(),{envelope:Object.assign($c(Op.getDefaults(),Object.keys(zh.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}}]),n}(Lp),zp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments))).name="MembraneSynth",t.portamento=0;var i=Zc(n.getDefaults(),arguments);return t.pitchDecay=i.pitchDecay,t.octaves=i.octaves,mh(s(t),["oscillator","envelope"]),t}return C(n,[{key:"setNote",value:function(t,e){var n=this.toSeconds(e),i=this.toFrequency(t instanceof Ih?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this}}],[{key:"getDefaults",value:function(){return Xc(Lp.getDefaults(),Np.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}}]),n}(Np);qc([Ap(0)],zp.prototype,"octaves",void 0),qc([Sp(0)],zp.prototype,"pitchDecay",void 0);var Up=new Set;function Wp(t){Up.add(t)}function Gp(t,e){var n='registerProcessor("'.concat(t,'", ').concat(e,")");Up.add(n)}Wp('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Wp("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Wp("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");var Kp="feedback-comb-filter";Gp(Kp,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');var Hp=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"))).name="Sampler",t._activeSources=new Map;var i=Zc(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),r={};return Object.keys(i.urls).forEach((function(e){var n=parseInt(e,10);if(wc(Lc(e)||Sc(n)&&isFinite(n),"url key is neither a note or midi pitch: ".concat(e)),Lc(e)){var a=new Ih(t.context,e).toMidi();r[a]=i.urls[e]}else Sc(n)&&isFinite(n)&&(r[n]=i.urls[n])})),t._buffers=new Th({urls:r,onload:i.onload,baseUrl:i.baseUrl,onerror:i.onerror}),t.attack=i.attack,t.release=i.release,t.curve=i.curve,t._buffers.loaded&&Promise.resolve().then(i.onload),t}return C(n,[{key:"_findClosest",value:function(t){for(var e=0;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: ".concat(t))}},{key:"triggerAttack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=this;return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((function(t){var r=i,a=Dh(new Ih(i.context,t).toFrequency()),o=Math.round(a),s=a-o,u=i._findClosest(o),l=o-u,c=i._buffers.get(l),h=Sh(u+s),p=new Hh({url:c,context:i.context,curve:i.curve,fadeIn:i.attack,fadeOut:i.release,playbackRate:h}).connect(i.output);p.start(e,0,c.duration/h,n),Dc(i._activeSources.get(o))||i._activeSources.set(o,[]),i._activeSources.get(o).push(p),p.onended=function(){if(r._activeSources&&r._activeSources.has(o)){var t=r._activeSources.get(o),e=t.indexOf(p);-1!==e&&t.splice(e,1)}}})),this}},{key:"triggerRelease",value:function(t,e){var n=this;return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((function(t){var i=new Ih(n.context,t).toMidi();if(n._activeSources.has(i)&&n._activeSources.get(i).length){var r=n._activeSources.get(i);e=n.toSeconds(e),r.forEach((function(t){t.stop(e)})),n._activeSources.set(i,[])}})),this}},{key:"releaseAll",value:function(t){var e=this.toSeconds(t);return this._activeSources.forEach((function(t){for(;t.length;){t.shift().stop(e)}})),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"triggerAttackRelease",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.toSeconds(n);if(this.triggerAttack(t,r,i),Dc(e)){var a=this;wc(Dc(t),"notes must be an array when duration is array"),t.forEach((function(t,n){var i=e[Math.min(n,e.length-1)];a.triggerRelease(t,r+a.toSeconds(i))}))}else this.triggerRelease(t,r+this.toSeconds(e));return this}},{key:"add",value:function(t,e,n){if(wc(Lc(t)||isFinite(t),"note must be a pitch or midi: ".concat(t)),Lc(t)){var i=new Ih(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._buffers.dispose(),this._activeSources.forEach((function(t){t.forEach((function(t){return t.dispose()}))})),this._activeSources.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Rp.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:gh,onerror:gh,release:.1,urls:{}})}}]),n}(Rp);qc([Sp(0)],Hp.prototype,"attack",void 0),qc([Sp(0)],Hp.prototype,"release",void 0);var Yp=e(ia).mark(fv),Xp=e(ia).mark(vv),Zp=e(ia).mark(pv),Qp=e(ia).mark(hv),$p=e(ia).mark(cv),Jp=e(ia).mark(lv),tv=e(ia).mark(uv),ev=e(ia).mark(ov),nv=e(ia).mark(av),iv=e(ia).mark(rv);function rv(t){var n;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=8;break}return n=sv(n,t),e.next=5,t[n];case 5:n++,e.next=1;break;case 8:case"end":return e.stop()}}),iv)}function av(t){var n;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.length-1;case 1:if(!(n>=0)){e.next=8;break}return n=sv(n,t),e.next=5,t[n];case 5:n--,e.next=1;break;case 8:case"end":return e.stop()}}),nv)}function ov(t,n){return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(n(t),"t0",2);case 2:e.next=0;break;case 4:case"end":return e.stop()}}),ev)}function sv(t,e){return ah(t,0,e.length-1)}function uv(t,n){var i;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n?0:t.length-1;case 1:return i=sv(i,t),e.next=5,t[i];case 5:n?++i>=t.length-1&&(n=!1):--i<=0&&(n=!0),e.next=1;break;case 8:case"end":return e.stop()}}),tv)}function lv(t){var n,i;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,i=0;case 2:if(!(n<t.length)){e.next=10;break}return n=sv(n,t),e.next=6,t[n];case 6:i++,n+=i%2?2:-1,e.next=2;break;case 10:case"end":return e.stop()}}),Jp)}function cv(t){var n,i;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.length-1,i=0;case 2:if(!(n>=0)){e.next=10;break}return n=sv(n,t),e.next=6,t[n];case 6:i++,n+=i%2?-2:1,e.next=2;break;case 10:case"end":return e.stop()}}),$p)}function hv(t){var n;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.floor(Math.random()*t.length),e.next=4,t[n];case 4:e.next=0;break;case 6:case"end":return e.stop()}}),Qp)}function pv(t){var n,i,r,a;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],i=0;i<t.length;i++)n.push(i);case 2:if(!(n.length>0)){e.next=9;break}return r=n.splice(Math.floor(n.length*Math.random()),1),a=sv(r[0],t),e.next=7,t[a];case 7:e.next=2;break;case 9:case"end":return e.stop()}}),Zp)}function vv(t){var n;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.floor(Math.random()*t.length);case 1:return 0===n?n++:n===t.length-1||Math.random()<.5?n--:n++,e.next=5,t[n];case 5:e.next=1;break;case 7:case"end":return e.stop()}}),Xp)}function fv(t){var n,i=arguments;return e(ia).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:"up",i.length>2&&void 0!==i[2]?i[2]:0,wc(t.length>0,"The array must have more than one value in it"),e.t0=n,e.next="up"===e.t0?5:"down"===e.t0?6:"upDown"===e.t0?7:"downUp"===e.t0?8:"alternateUp"===e.t0?9:"alternateDown"===e.t0?10:"random"===e.t0?11:"randomOnce"===e.t0?12:"randomWalk"===e.t0?13:14;break;case 5:return e.delegateYield(ov(t,rv),"t1",6);case 6:return e.delegateYield(ov(t,av),"t2",7);case 7:return e.delegateYield(uv(t,!0),"t3",8);case 8:return e.delegateYield(uv(t,!1),"t4",9);case 9:return e.delegateYield(ov(t,lv),"t5",10);case 10:return e.delegateYield(ov(t,cv),"t6",11);case 11:return e.delegateYield(hv(t),"t7",12);case 12:return e.delegateYield(ov(t,pv),"t8",13);case 13:return e.delegateYield(vv(t),"t9",14);case 14:case"end":return e.stop()}}),Yp)}var dv=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Object.assign(Zc(n.getDefaults(),arguments,["pan"])))).name="Panner",t._panner=t.context.createStereoPanner(),t.input=t._panner,t.output=t._panner;var i=Zc(n.getDefaults(),arguments,["pan"]);return t.pan=new jh({context:t.context,param:t._panner.pan,value:i.pan,minValue:-1,maxValue:1}),t._panner.channelCount=i.channelCount,t._panner.channelCountMode="explicit",mh(s(t),"pan"),t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._panner.disconnect(),this.pan.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{pan:0,channelCount:1})}}]),n}(zh),mv="bit-crusher";Gp(mv,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");var _v=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["solo"]))).name="Solo";var i=Zc(n.getDefaults(),arguments,["solo"]);return t.input=t.output=new Gh({context:t.context}),n._allSolos.has(t.context)||n._allSolos.set(t.context,new Set),n._allSolos.get(t.context).add(s(t)),t.solo=i.solo,t}return C(n,[{key:"solo",get:function(){return this._isSoloed()},set:function(t){t?this._addSolo():this._removeSolo(),n._allSolos.get(this.context).forEach((function(t){return t._updateSolo()}))}},{key:"muted",get:function(){return 0===this.input.gain.value}},{key:"_addSolo",value:function(){n._soloed.has(this.context)||n._soloed.set(this.context,new Set),n._soloed.get(this.context).add(this)}},{key:"_removeSolo",value:function(){n._soloed.has(this.context)&&n._soloed.get(this.context).delete(this)}},{key:"_isSoloed",value:function(){return n._soloed.has(this.context)&&n._soloed.get(this.context).has(this)}},{key:"_noSolos",value:function(){return!n._soloed.has(this.context)||n._soloed.has(this.context)&&0===n._soloed.get(this.context).size}},{key:"_updateSolo",value:function(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),n._allSolos.get(this.context).delete(this),this._removeSolo(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{solo:!1})}}]),n}(zh);_v._allSolos=new Map,_v._soloed=new Map;var gv=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["pan","volume"]))).name="PanVol";var i=Zc(n.getDefaults(),arguments,["pan","volume"]);return t._panner=t.input=new dv({context:t.context,pan:i.pan,channelCount:i.channelCount}),t.pan=t._panner.pan,t._volume=t.output=new op({context:t.context,volume:i.volume}),t.volume=t._volume.volume,t._panner.connect(t._volume),t.mute=i.mute,mh(s(t),["pan","volume"]),t}return C(n,[{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}}]),n}(zh),yv=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;c(this,n),(t=e.call(this,Zc(n.getDefaults(),arguments,["volume","pan"]))).name="Channel";var i=Zc(n.getDefaults(),arguments,["volume","pan"]);return t._solo=t.input=new _v({solo:i.solo,context:t.context}),t._panVol=t.output=new gv({context:t.context,pan:i.pan,volume:i.volume,mute:i.mute,channelCount:i.channelCount}),t.pan=t._panVol.pan,t.volume=t._panVol.volume,t._solo.connect(t._panVol),mh(s(t),["pan","volume"]),t}return C(n,[{key:"solo",get:function(){return this._solo.solo},set:function(t){this._solo.solo=t}},{key:"muted",get:function(){return this._solo.muted||this.mute}},{key:"mute",get:function(){return this._panVol.mute},set:function(t){this._panVol.mute=t}},{key:"_getBus",value:function(t){return n.buses.has(t)||n.buses.set(t,new Gh({context:this.context})),n.buses.get(t)}},{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._getBus(t),i=new Gh({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}},{key:"receive",value:function(t){return this._getBus(t).connect(this),this}},{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}}]),n}(zh);yv.buses=new Map;var bv=function(t){"use strict";O(n,t);var e=P(n);function n(){var t;return c(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Listener",t.positionX=new jh({context:t.context,param:t.context.rawContext.listener.positionX}),t.positionY=new jh({context:t.context,param:t.context.rawContext.listener.positionY}),t.positionZ=new jh({context:t.context,param:t.context.rawContext.listener.positionZ}),t.forwardX=new jh({context:t.context,param:t.context.rawContext.listener.forwardX}),t.forwardY=new jh({context:t.context,param:t.context.rawContext.listener.forwardY}),t.forwardZ=new jh({context:t.context,param:t.context.rawContext.listener.forwardZ}),t.upX=new jh({context:t.context,param:t.context.rawContext.listener.upX}),t.upY=new jh({context:t.context,param:t.context.rawContext.listener.upY}),t.upZ=new jh({context:t.context,param:t.context.rawContext.listener.upZ}),t}return C(n,[{key:"dispose",value:function(){return V(M(n.prototype),"dispose",this).call(this),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zh.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}}]),n}(zh);uh((function(t){t.listener=new bv({context:t})})),ch((function(t){t.listener.dispose()}));var wv=xh().transport;xh().destination,xh().destination;xh().listener;xh().draw;var kv=xh();var xv=new WeakSet,Cv=function(){"use strict";function t(e){c(this,t),_(this,xv),this.pane=e,this.bell=new jp({harmonicity:12,resonance:800,modulationIndex:20,envelope:{decay:.4},volume:-15}).toDestination(),this.baseSoundsOscFreq=["B3","E3","A3","D3","F#3"],this.baseSoundOsc=new xp("B3","square",10),this.baseSoundOscDst=this.baseSoundOsc.toDestination(),this.baseSoundOscDst.volume.value=-25,this.baseSoundOscDst.start(),wv.bpm.value=115,wv.stop(),m(this,xv,Ev).call(this)}return C(t,[{key:"onLeafGrow",value:function(t){"running"!==kv.state&&kv.resume()}},{key:"onLeafWither",value:function(){this.bell.triggerAttackRelease(100,"8n")}},{key:"onPlantGrow",value:function(){var t=Math.floor(Math.random()*this.baseSoundsOscFreq.length);this.baseSoundOsc.frequency.rampTo(this.baseSoundsOscFreq[t],.2)}}]),t}();function Ev(){if(this.pane){var t=this.pane.addFolder({title:"audio"});t.addButton({title:"play"}).on("click",(function(){return wv.start()})),t.addButton({title:"stop"}).on("click",(function(){return wv.stop()}))}}var Mv=new WeakMap,Tv=new WeakMap,Pv=new WeakMap,Av=new WeakMap,Sv=new WeakSet,Vv=new WeakSet,Ov=new WeakSet,Dv=new WeakSet,Rv=new WeakSet,Lv=new WeakSet,Iv=new WeakSet,Nv=new WeakSet,Fv=new WeakSet,Bv=new WeakSet,qv=new WeakSet,jv=new WeakSet,zv=new WeakSet,Uv=function(){"use strict";function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c(this,t),_(this,Sv),_(this,Vv),_(this,Ov),_(this,Dv),_(this,Rv),_(this,Lv),_(this,Iv),_(this,Nv),_(this,Fv),_(this,Bv),_(this,qv),_(this,jv),_(this,zv),A(this,"oninit",void 0),f(this,Mv,{writable:!0,value:0}),f(this,Tv,{writable:!0,value:0}),f(this,Pv,{writable:!0,value:0}),f(this,Av,{writable:!0,value:!1}),A(this,"camera",{matrix:j.create(),near:60,far:155,distance:100,orbit:zt.create(),position:Ut.create(),rotation:Ut.create(),up:Ut.fromValues(0,1,0)}),A(this,"animate",!0),A(this,"plantSettings",{showGuides:!1}),this.canvas=e,this.pane=n,this.oninit=i,m(this,Rv,Hv).call(this)}return C(t,[{key:"resize",value:function(){var t,e,n,i,r=this.gl;(t=r.canvas,e=t.clientWidth,n=t.clientHeight,(i=t.width!==e||t.height!==n)&&(t.width=e,t.height=n),i)&&(r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),m(this,Nv,Qv).call(this,r)),this.blurScale=r.canvas.clientHeight/550,m(this,jv,ef).call(this,r)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this;this.fpsGraph&&this.fpsGraph.begin(),d(this,Pv,Math.min(32,t-p(this,Mv))),d(this,Mv,t),this.animate&&d(this,Tv,p(this,Tv)+p(this,Pv)/16),p(this,Av)||(this.control.update(p(this,Pv)),j.fromQuat(this.drawUniforms.worldMatrix,this.control.rotationQuat),j.invert(this.drawUniforms.worldInverseTransposeMatrix,this.drawUniforms.worldMatrix),j.transpose(this.drawUniforms.worldInverseTransposeMatrix,this.drawUniforms.worldInverseTransposeMatrix),j.invert(this.drawUniforms.inversProjectionMatrix,this.drawUniforms.projectionMatrix),this.plant.update(p(this,Tv)),m(this,Sv,Wv).call(this),this.fpsGraph&&this.fpsGraph.end(),requestAnimationFrame((function(t){return e.run(t)})))}},{key:"destroy",value:function(){d(this,Av,!0)}},{key:"initTweakpane",value:function(){if(this.pane){var t=this;this.fpsGraph=this.pane.addBlade({view:"fpsgraph",label:"fps",lineCount:1,maxValue:120,minValue:0}),this.pane.addInput(this,"animate",{label:"animate"});var e=this.pane.addFolder({title:"Camera"});m(this,zv,nf).call(this,e,this.camera,"near","near",1,200,null,(function(){return m(t,jv,ef).call(t,t.gl)})),m(this,zv,nf).call(this,e,this.camera,"far","far",1,200,null,(function(){return m(t,jv,ef).call(t,t.gl)}))}}}]),t}();function Wv(){var t=this.gl;Si(t,this.plantFBO,this.drawBufferSize[0],this.drawBufferSize[1]),t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.plant.render(this.drawUniforms,this.plantSettings.showGuides),Si(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Si(t,this.deltaDepthFBO,this.drawBufferSize[0],this.drawBufferSize[1]),t.useProgram(this.deltaDepthProgram),t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.plantColorTexture),t.uniform1i(this.deltaDepthLocations.u_colorTexture,0),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.plantDepthTexture),t.uniform1i(this.deltaDepthLocations.u_depthTexture,1),t.uniformMatrix4fv(this.deltaDepthLocations.u_viewMatrix,!1,this.drawUniforms.viewMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_projectionMatrix,!1,this.drawUniforms.projectionMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_inversProjectionMatrix,!1,this.drawUniforms.inversProjectionMatrix),t.uniformMatrix4fv(this.deltaDepthLocations.u_worldMatrix,!1,this.drawUniforms.worldMatrix),t.bindVertexArray(this.vesselVAO),t.drawElements(t.TRIANGLES,this.vesselBuffers.numElem,t.UNSIGNED_SHORT,0),Si(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Si(t,this.hBlurFBO,this.drawBufferSize[0],this.drawBufferSize[1]),m(this,Vv,Gv).call(this,this.deltaDepthColorTexture),Si(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),Si(t,this.vBlurFBO,this.drawBufferSize[0],this.drawBufferSize[1]),m(this,Vv,Gv).call(this,this.hBlurTexture,!0),Si(t,null,this.drawBufferSize[0],this.drawBufferSize[1]),t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),m(this,Ov,Kv).call(this,!1)}function Gv(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.gl;n.useProgram(this.blurProgram),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t),n.uniform1i(this.blurLocations.u_colorTexture,0),e?n.uniform2f(this.blurLocations.u_direction,0,1):n.uniform2f(this.blurLocations.u_direction,1,0),n.uniform1f(this.blurLocations.u_scale,this.blurScale),n.bindVertexArray(this.quadVAO),n.drawArrays(n.TRIANGLES,0,this.quadBuffers.numElem)}function Kv(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.gl;n.useProgram(this.vesselProgram),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);var i=this.drawUniforms.worldInverseTransposeMatrix;t&&(n.cullFace(n.FRONT),i=j.scale(j.create(),this.drawUniforms.worldInverseTransposeMatrix,Ut.fromValues(-1,-1,-1))),e||(n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.vBlurTexture),n.uniform1i(this.vesselLocations.u_colorTexture,0)),n.uniformMatrix4fv(this.vesselLocations.u_viewMatrix,!1,this.drawUniforms.viewMatrix),n.uniformMatrix4fv(this.vesselLocations.u_projectionMatrix,!1,this.drawUniforms.projectionMatrix),n.uniform3f(this.vesselLocations.u_cameraPosition,this.camera.position[0],this.camera.position[1],this.camera.position[2]),n.uniformMatrix4fv(this.vesselLocations.u_worldMatrix,!1,this.drawUniforms.worldMatrix),n.uniformMatrix4fv(this.vesselLocations.u_worldInverseTransposeMatrix,!1,i),n.bindVertexArray(this.vesselVAO),n.drawElements(n.TRIANGLES,this.vesselBuffers.numElem,n.UNSIGNED_SHORT,0),n.cullFace(n.BACK)}function Hv(){var t=this;this.gl=this.canvas.getContext("webgl2",{antialias:!1,alpha:!1});var n=this.gl;if(!n)throw new Error("No WebGL 2 context!");n.getExtension("EXT_color_buffer_float")||(console.error("FLOAT color buffer not available"),document.body.innerHTML="This example requires EXT_color_buffer_float which is unavailable on this system."),this.deltaDepthProgram=Mi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\n\nout vec3 v_position;\n\nvoid main() {\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_position = viewPosition.xyz;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform mat4 u_inversProjectionMatrix;\nuniform sampler2D u_colorTexture;\nuniform sampler2D u_depthTexture;\n\nin vec3 v_position;\n\nout vec4 outColor;\n\n// reconstructs the view space position given the screen space coordinates\n// along with the depth\nvec3 reconstructPosition(vec2 uv, float depth, mat4 inversProjectionMatrix) {\n    float x = uv.x * 2. - 1.;   // = x / w\n    float y = uv.y * 2. - 1.;   // = y / w\n    float z = depth * 2. - 1.;\n    vec4 projectedPosition = vec4(x, y, z, 1.);\n    vec4 pos = inversProjectionMatrix * projectedPosition;\n    return pos.xyz / pos.w;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_colorTexture, 0));\n    float vesselRadius = 20.;\n    float cameraDistance = 100.;\n\n    float plantDepth = texture(u_depthTexture, uv).r;\n    vec3 plantPosition = reconstructPosition(uv, plantDepth, u_inversProjectionMatrix);\n    // get the normalized plant z position\n    float plantNormZ = (cameraDistance + vesselRadius + plantPosition.z) / (2. * vesselRadius);\n    // get the normalized vessel z position\n    float vesselNormZ = (cameraDistance + vesselRadius + v_position.z) / (2. * vesselRadius);\n    float deltaBlur = smoothstep(0.15, 0.4, vesselNormZ - plantNormZ);\n    float deltaFog = smoothstep(0.0, 1.1, vesselNormZ - plantNormZ);\n    vec4 color = mix(texture(u_colorTexture, uv), vec4(1.), deltaFog);\n\n    outColor = vec4(color.rgb, deltaBlur);\n}\n")],null,{a_position:0}),this.blurProgram=Mi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_colorTexture;\nuniform float u_scale;\nuniform vec2 u_direction;\n\nout vec4 blurColor;\n\nfloat getRadius(float depth) {\n    return clamp(depth, 0.0, 1.);\n}\n\nvoid blur(\n    in vec2 A,\n    in vec2 direction,\n    in float scale,\n    in sampler2D inTexture,\n    out vec4 outColor\n) {\n    const int KERNEL_SIZE = 6;\n    float gaussian[KERNEL_SIZE];  \n    gaussian[5] = 0.04153263993208;\n    gaussian[4] = 0.06352050813141;\n    gaussian[3] = 0.08822292796029;\n    gaussian[2] = 0.11143948794984;\n    gaussian[1] = 0.12815541114232;\n    gaussian[0] = 0.13425804976814;\n\n    vec4 resultColor = vec4(0.);\n    float weightSum = 0.;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(inTexture, 0));\n    vec4 colorA = texture(inTexture, A);\n    float depthA = colorA.a;\n    float rA = getRadius(depthA);\n\n    // scatter as you gather loop\n    for(int i = -KERNEL_SIZE + 1; i < KERNEL_SIZE; ++i) {\n        vec2 B = A + direction * ((float(i) * scale) * texelSize);\n        vec4 colorB = texture(inTexture, B);\n        float depthB = colorB.a;\n        float rB = getRadius(depthB);\n\n        float blurWeight = gaussian[abs(i)];\n\n        // only consider if B is in front of A\n        float bNearerWeight = clamp(abs(rA) - abs(rB) + 1., 0., .5);\n        float weight = bNearerWeight * blurWeight;\n        weightSum += weight;\n        resultColor.rgb += colorB.rgb * weight;\n    }\n\n    // apply total weights\n    resultColor.rgb /= weightSum;\n    resultColor.a = colorA.a;\n\n    outColor = resultColor;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_colorTexture, 0));\n\n    blur(\n        uv,\n        u_direction,\n        u_scale,\n        u_colorTexture,\n        blurColor\n    );\n\n    //blurColor = vec4(texture(u_colorTexture, uv).a);\n}")],null,{a_position:0}),this.vesselProgram=Mi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec3 v_position;\nout vec3 v_viewPosition;\nout vec3 v_normal;\nout vec3 v_viewNormal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (u_worldInverseTransposeMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n    v_position = a_position.xyz;\n    v_viewPosition = viewPosition.xyz;\n    v_viewNormal = (u_viewMatrix * vec4(v_normal, 0.)).xyz;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_colorTexture;\nuniform float u_frames;\n\nin vec3 v_position;\nin vec3 v_normal;\nin vec3 v_viewNormal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\nin vec3 v_viewPosition;\n\nout vec4 outColor;\n\n#define PI 3.1415926535\n\nvoid main() {\n    vec2 texelSize = 1. / vec2(textureSize(u_colorTexture, 0));\n    vec2 uv = gl_FragCoord.xy * texelSize;\n\n    vec3 pos = v_position;\n    vec3 N = normalize(v_normal);\n    vec3 VN = normalize(v_viewNormal);\n    vec3 V = normalize(v_surfaceToView);\n    vec3 L = normalize(vec3(0., .5, 4.));\n    float NdL = max(0., dot(N, L));\n\n    // calculate the half vector\n    vec3 H = normalize(V + N);\n\n    // specular term\n    float specular = pow(max(0., max(0., dot(H, L))), 100.) * .6;\n\n    // diffuse term\n    float diffuse = NdL * .3 + .7;\n\n    // edge darkening term\n    float edge = min(1., pow(min(1., NdL + 0.5), 3.) + 0.6);\n\n    // ambient light color\n    vec4 ambient = vec4(0.9, 0.9, 1., 1.);\n    \n    vec4 innerColor = texture(u_colorTexture, uv);\n\n    vec4 vesselColor = ambient * diffuse + vec4(specular) * 1.5;\n    vesselColor *= edge;\n\n    outColor = innerColor * 0.9 + vesselColor * 0.1 + vec4(N.zyx, 1.) * 0.05;\n}\n")],null,{a_position:0,a_normal:1,a_uv:2}),this.titleProgram=Mi(n,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_titleTexture;\nuniform float u_frames;\n\nin vec2 v_uv;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 uv = vec2(v_uv.x - u_frames * 0.00025, v_uv.y);\n    vec4 color = 1. - texture(u_titleTexture, uv * vec2(-4., 0.99));\n    //color = mix(vec4(248. / 255., 248. / 255., 222. / 255., 1.), vec4(1.), color);\n    color = mix(vec4(228. / 255., 238. / 255., 255. / 255., 1.), vec4(1.), color);\n    //color = mix(vec4(55. / 255., 25. / 255., 22. / 255., 1.), vec4(1.), color);\n\n    color = mix(color, vec4(1.), sin(v_uv.x * 9.5) * 0.5 + 0.5);\n\n    outColor = color;\n}\n")],null,{a_position:0,a_uv:1}),this.deltaDepthLocations={a_position:n.getAttribLocation(this.deltaDepthProgram,"a_position"),u_worldMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_projectionMatrix"),u_inversProjectionMatrix:n.getUniformLocation(this.deltaDepthProgram,"u_inversProjectionMatrix"),u_colorTexture:n.getUniformLocation(this.deltaDepthProgram,"u_colorTexture"),u_depthTexture:n.getUniformLocation(this.deltaDepthProgram,"u_depthTexture")},this.blurLocations={a_position:n.getAttribLocation(this.blurProgram,"a_position"),u_colorTexture:n.getUniformLocation(this.blurProgram,"u_colorTexture"),u_scale:n.getUniformLocation(this.blurProgram,"u_scale"),u_direction:n.getUniformLocation(this.blurProgram,"u_direction")},this.vesselLocations={a_position:n.getAttribLocation(this.vesselProgram,"a_position"),a_normal:n.getAttribLocation(this.vesselProgram,"a_normal"),a_uv:n.getAttribLocation(this.vesselProgram,"a_uv"),u_worldMatrix:n.getUniformLocation(this.vesselProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.vesselProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.vesselProgram,"u_projectionMatrix"),u_worldInverseTransposeMatrix:n.getUniformLocation(this.vesselProgram,"u_worldInverseTransposeMatrix"),u_cameraPosition:n.getUniformLocation(this.vesselProgram,"u_cameraPosition"),u_colorTexture:n.getUniformLocation(this.vesselProgram,"u_colorTexture")},this.titleLocations={a_position:n.getAttribLocation(this.titleProgram,"a_position"),a_uv:n.getAttribLocation(this.titleProgram,"a_uv"),u_worldMatrix:n.getUniformLocation(this.titleProgram,"u_worldMatrix"),u_viewMatrix:n.getUniformLocation(this.titleProgram,"u_viewMatrix"),u_projectionMatrix:n.getUniformLocation(this.titleProgram,"u_projectionMatrix"),u_titleTexture:n.getUniformLocation(this.titleProgram,"u_titleTexture"),u_frames:n.getUniformLocation(this.titleProgram,"u_frames")},this.drawUniforms={worldMatrix:j.create(),viewMatrix:j.create(),cameraMatrix:j.create(),projectionMatrix:j.create(),inversProjectionMatrix:j.create(),worldInverseTransposeMatrix:j.create()},this.VESSEL_HEIGHT=50,this.VESSEL_RADIUS=20,this.VESSEL_BEVEL_RADIUS=13,this.vesselGeometry=new Hi(this.VESSEL_HEIGHT,this.VESSEL_RADIUS,this.VESSEL_BEVEL_RADIUS),this.vesselBuffers={position:Pi(n,this.vesselGeometry.vertices,n.STATIC_DRAW),normal:Pi(n,this.vesselGeometry.normals,n.STATIC_DRAW),numElem:this.vesselGeometry.indices.length},this.vesselVAO=Ti(n,[[this.vesselBuffers.position,this.vesselLocations.a_position,3],[this.vesselBuffers.normal,this.vesselLocations.a_normal,3]],this.vesselGeometry.indices);var i=[-1,-1,3,-1,-1,3];this.quadBuffers={position:Pi(n,new Float32Array(i),n.STATIC_DRAW),numElem:i.length/2},this.quadVAO=Ti(n,[[this.quadBuffers.position,0,2]]),this.plant=new xr(n,this.VESSEL_HEIGHT,this.VESSEL_RADIUS,this.VESSEL_BEVEL_RADIUS,(function(){return t.plant.generate(p(t,Tv))})),this.plant.generate(p(this,Tv)),this.titleRibbonGeometry=m(this,Bv,Jv).call(this,50,8,60,1),this.titleRibbonBuffers={position:Pi(n,new Float32Array(this.titleRibbonGeometry.vertices),n.STATIC_DRAW),uv:Pi(n,new Float32Array(this.titleRibbonGeometry.uvs),n.STATIC_DRAW),numElem:this.titleRibbonGeometry.count},this.titleRibbonVAO=Ti(n,[[this.titleRibbonBuffers.position,this.titleLocations.a_position,3],[this.titleRibbonBuffers.uv,this.titleLocations.a_uv,2]],this.titleRibbonGeometry.indices);var r=Rn.fromValues(n.canvas.clientWidth,n.canvas.clientHeight);this.drawBufferSize=Rn.clone(r),this.plantColorTexture=m(this,Lv,Yv).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.plantDepthTexture=m(this,Lv,Yv).call(this,n,n.DEPTH_COMPONENT32F,r,n.NEAREST,n.NEAREST,n.REPEAT,n.REPEAT),this.plantFBO=Ai(n,[this.plantColorTexture],this.plantDepthTexture),this.deltaDepthColorTexture=m(this,Lv,Yv).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.deltaDepthFBO=Ai(n,[this.deltaDepthColorTexture]),this.hBlurTexture=m(this,Lv,Yv).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.vBlurTexture=m(this,Lv,Yv).call(this,n,n.RGBA,r,n.LINEAR,n.LINEAR,n.REPEAT,n.REPEAT),this.hBlurFBO=Ai(n,[this.hBlurTexture]),this.vBlurFBO=Ai(n,[this.vBlurTexture]),this.control=new Di(this.canvas),this.resize(),m(this,Iv,Zv).call(this),this.camera.position[2]=this.camera.distance,m(this,qv,tf).call(this),m(this,jv,ef).call(this,n),this.initTweakpane(),this.audioEffects=new Cv(this.pane),this.oninit&&this.oninit(this)}function Yv(t,e,n,i,r,a,o){var s=Vi(t,i,r,a,o);return t.bindTexture(t.TEXTURE_2D,s),e===t.RGBA?t.texImage2D(t.TEXTURE_2D,0,e,n[0],n[1],0,e,t.UNSIGNED_BYTE,null):e===t.DEPTH_COMPONENT32F?t.texImage2D(t.TEXTURE_2D,0,e,n[0],n[1],0,t.DEPTH_COMPONENT,t.FLOAT,null):e===t.RGBA16F&&t.texStorage2D(t.TEXTURE_2D,1,t.RGBA16F,n[0],n[1]),t.bindTexture(t.TEXTURE_2D,null),s}var Xv;function Zv(){var t=this,e=this.gl;this.titleTexture=Vi(e,e.LINEAR,e.LINEAR,e.REPEAT,e.REPEAT),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var n=new Image;n.width=2e3,n.addEventListener("load",(function(){e.bindTexture(e.TEXTURE_2D,t.titleTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_2D,null)})),n.src=new URL(Xv)}function Qv(t){var e=Rn.fromValues(t.canvas.clientWidth,t.canvas.clientHeight);this.drawBufferSize=Rn.clone(e),m(this,Fv,$v).call(this,t,this.plantColorTexture,t.RGBA,e),m(this,Fv,$v).call(this,t,this.plantDepthTexture,t.DEPTH_COMPONENT32F,e),m(this,Fv,$v).call(this,t,this.deltaDepthColorTexture,t.RGBA,e),m(this,Fv,$v).call(this,t,this.hBlurTexture,t.RGBA,e),m(this,Fv,$v).call(this,t,this.vBlurTexture,t.RGBA,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}function $v(t,e,n,i){t.bindTexture(t.TEXTURE_2D,e),n===t.RGBA?t.texImage2D(t.TEXTURE_2D,0,n,i[0],i[1],0,n,t.UNSIGNED_BYTE,null):n===t.DEPTH_COMPONENT32F&&t.texImage2D(t.TEXTURE_2D,0,n,i[0],i[1],0,t.DEPTH_COMPONENT,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,null)}function Jv(t,e,n,i){for(var r=2*Math.PI/n,a=e/i,o=n*i*6,s=[],u=[],l=[],c=[],h=n+1,p=-e/2,v=0;v<=i;++v)for(var f=0;f<=n;++f){var d={x:t*Math.sin(r*f),y:p+a*v,z:t*Math.cos(r*f)},m={x:0,y:0,z:1};s.push(d.x,d.y,d.z),u.push(m.x,m.y,m.z),l.push(f/n,v/i)}for(var _=0;_<i;++_)for(var g=0;g<n;++g)c.push(_*h+g,(_+1)*h+g+1,_*h+g+1),c.push((_+1)*h+g+1,_*h+g,(_+1)*h+g);return{vertices:s,normals:u,uvs:l,indices:c,count:o}}function tf(){j.targetTo(this.camera.matrix,this.camera.position,[0,0,0],this.camera.up),j.invert(this.drawUniforms.viewMatrix,this.camera.matrix),j.copy(this.drawUniforms.cameraMatrix,this.camera.matrix)}function ef(t){var e=t.canvas.clientWidth/t.canvas.clientHeight;j.perspective(this.drawUniforms.projectionMatrix,Math.PI/4,e,this.camera.near,this.camera.far)}function nf(t,e,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7?arguments[7]:void 0,u=t.addBlade({view:"slider",label:i,min:r,max:a,step:o,value:e[n]});u.on("change",(function(t){e[n]=t.value,s&&s()}))}Xv=a("aNJCr").getBundleURL("7EiNB")+a("iE7OH").resolve("9VljA");var rf,af,of=window.location.search,sf=null!==new URLSearchParams(of).get("debug");window.addEventListener("load",(function(){var t,e=document.body.querySelector("#c");sf&&(t=new o.Pane({title:"Settings"})).registerPlugin(q),rf=new Uv(e,t,(function(t){t.run()}))})),window.addEventListener("resize",(function(){rf&&(af&&clearTimeout(af),af=setTimeout((function(){af=null,rf.resize()}),300))}))}();
//# sourceMappingURL=index.d685fbb8.js.map
